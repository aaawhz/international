var AttachConst={ScreeSnapId:"ScreenSnapshot"};function SWFObject(a,b,c,d,e,f){this.params={};this.variables={};this.attributes={};this.setAttribute("id",b);this.setAttribute("name",b);this.setAttribute("width",c);this.setAttribute("height",d);this.setAttribute("swf",a);this.setAttribute("classid","clsid:D27CDB6E-AE6D-11cf-96B8-444553540000");e&&this.setAttribute("version",e);f&&this.addParam("bgcolor",f)}SWFObject.prototype.addParam=function(a,b){this.params[a]=b};SWFObject.prototype.getParam=function(a){return this.params[a]};
SWFObject.prototype.addVariable=function(a,b){this.variables[a]=b};SWFObject.prototype.getVariable=function(a){return this.variables[a]};SWFObject.prototype.setAttribute=function(a,b){this.attributes[a]=b};SWFObject.prototype.getAttribute=function(a){return this.attributes[a]};SWFObject.prototype.getVariablePairs=function(){var a=[];for(key in this.variables)a.push(key+"="+this.variables[key]);return a};
SWFObject.prototype.getHTML=function(){var a="",b="",b="",c=location.protocol;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){a+='<embed class="flash" type="application/x-shockwave-flash"  pluginspage="'+c+'//www.macromedia.com/go/getflashplayer" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';for(b in this.params)a+=[b]+'="'+this.params[b]+
'" ';b=this.getVariablePairs().join("&");b.length>0&&(a+='flashvars="'+b+'"');a+="/>"}else{a='<object class="flash" id="'+this.getAttribute("id")+'" classid="'+this.getAttribute("classid")+'"  codebase="'+c+"//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+this.setAttribute("version")+',0,0,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';for(b in this.params)a+='<param name="'+
b+'" value="'+this.params[b]+'" />';b=this.getVariablePairs().join("&");b.length>0&&(a+='<param name="flashvars" value="'+b+'" />');a+="</object>"}return a};SWFObject.prototype.write=function(a){var b=this.getHTML();typeof a=="undefined"?document.write(b):(a=typeof a=="string"?document.getElementById(a):a)&&(a.innerHTML=b)};
var upload_template={frame:'{closeBtn}<i class="big_{fileIconClass} fl"></i><div class="sk_lt">    <div class="clearfix sk_cont">        <div class="fl fup_name">{prefix}.{suffix}</div>        {action}    </div>    <div class="clearfix">        {state}        <span id="{taskId}_size" class="fr">{fileSizeText}</span>    </div></div>',close:'<a style="top:5px; right:5px;" class="i-fakeTxt-close" href="javascript:fGoto();" id="" taskid="{taskId}" fileid="{fileId}" uploadType="{uploadType}" fileType="{fileType}" command="DeleteFile"></a>',
process:'<div class="prisdr-progress-bar fl" style="width:98px; overflow:hidden;">   <div class="prisdr-progress"></div>   <div class="prisdr-progress-cur ta_c" style="width:{progress}%;"></div></div><var class="fl" style=" margin:-2px 0 0 5px; color:#a2b0c6;font-size:11px; -webkit-text-size-adjust:none;-webkit-transform:scale(0.875);">{progress}%</var>',"continue":'<a href="javascript:fGoto();" class="fr" command="ResumeUpload" taskid="{taskId}">\u7eed\u4f20</a>',"delete":'<a href="#" class="fr ml_15" taskid="{taskId}" fileid="{fileId}" uploadType="{uploadType}" fileType="{fileType}" command="DeleteFile" onclick="javascript:fGoto()">\u5220\u9664</a>',
error:'<p class="fl"><i class="i-warm mr_5"></i><span class="inbm col_red">\u4e0a\u4f20\u5931\u8d25</span></p>',success:'<p class="fl"><i class="i-gsuss mr_5"></i><span class="inbm col_green">\u4e0a\u4f20\u6210\u529f</span></p>',cancel:'<a href="#" class="fr ml_15" taskid="{taskId}" fileid="{fileId}" uploadType="{uploadType}" fileType="{fileType}" command="CancelUpload" onclick="javascript:fGoto()">\u5220\u9664</a>',waiting:'<p class="fl"><img src="'+parent.CC.getResourceAbsoluteURL()+'/images/load.gif"></p>',
removeDiskFile:'<a style="top:5px; right:5px;" class="i-fakeTxt-close" href="javascript:fGoto();" onclick="attach.deleteDiskFiles(\'{fileId}\',\'{index}\');return false;"></a>'},attach={id:"",ulId:"attachContainer",ajax:parent.MM,uploadUrl:"",uploadType:0,isSupportFlash:!1,frmPath:parent.gMain.frmPath,attachList:[],composeAttachs:[],ul:null,frm:null,form:null,liUpload:null,composeId:"",data:[],maxSize:parent.gMain.attachMaxSize-0||50,maxNameLen:60,sid:parent.gMain.sid,delegateFun:{},sizeCount:0,needUploadCount:0,
uploadedCount:0,fileCheckMode:0,$:function(a){return document.getElementById(a)},regMatchFile:/(var\s+return_obj=[\s\S]+)<\/script>/i,init:function(a){this.uploadUrl=this.getUploadUrl(a);this.ul=this.$(this.ulId);this.liUpload=this.$("liUpload");this.frm=this.$("frmAttach");this.form=this.$("formAttach");this.composeId=oWrite.id;this.needUpdatePosition=!1;upload_module.createUploadManager()},initUI:function(){upload_module.init(this)},render:function(a){if(a&&a.attachments)this.composeAttachs=a.attachments.concat();
uploadManager.refresh()},setFormat:function(a){this.format=a},delegate:function(a,b){a&&typeof b=="function"&&(this.delegateFun[a]=b)},checkFormat:function(a,b){var c=a.lastIndexOf(".")>-1?a.substr(a.lastIndexOf(".")):"";b.substr(0,1)!=","&&(b=","+b);b.substr(b.length-1)!=","&&(b+=",");b=b.toLowerCase();c=","+c.toLowerCase()+",";return b.indexOf(c)>-1?!0:!1},checkAttach:function(a){a=a.fileName||"";switch(this.fileCheckMode){case "1":return this.format&&this.format.toString().trim()!=""&&!this.checkFormat(a,
this.format)&&this.delegateFun.onFormatError&&typeof this.delegateFun.onFormatError=="function"?(this.delegateFun.onFormatError(a,this.format),a=!1):a=!0,a;case "2":return this.format&&this.format.toString().trim()!=""&&this.checkFormat(a,this.format)&&this.delegateFun.onFormatError&&typeof this.delegateFun.onFormatError=="function"?(this.delegateFun.onFormatError(a,this.format),a=!1):a=!0,a;default:return!0}},getUploadUrl:function(a,b,c){var a=a||oWrite.id,d="{0}?func={1}&sid={2}&composeId={3}&rnd={4}";
c&&(d="{0}?from=control&func={1}&sid={2}&composeId={3}&rnd={4}");b==1?d+="&type=internal":b==3&&(d+="&type=attach");b=parent.gConst.uploadUrl;parent.gMain.rmSvr==""&&(b=window.location.protocol+"//"+window.location.host+b);return d.format(b,parent.gConst.func.upload,this.sid,a,GC.gRnd())},getDeleteUrl:function(a){return"{0}?func={1}&sid={2}&fileId={3}".format(parent.gConst.uploadUrl,parent.gConst.func.deleteAttach,this.sid,a)},getShowAttachUrl:function(a,b){return"{0}?func={1}&sid={2}&fileId={3}&fileName={4}".format(parent.gConst.downloadUrl,
parent.gConst.func.getAttach,this.sid,a||"",b||"")},btnAddAttach:function(){if(PageState==PageStateTypes.Uploading)return CC.alert(Lang.Mail.Write.fileUploading),!1},btnAddAttachFromDisk:function(){(new parent.DiskDialog).create(attach.tempDiskCall)},tempDiskCall:function(a){var b=oWrite.composeId;parent.GE.diskFiles[b]||(parent.GE.diskFiles[b]=[]);attach.addDiskFiles(a,!0);attach.setSize();attach.setAttachHeight()},btnAddAttachFromTempDisk:function(){parent.CC.showHtml({id:"attachFromTempDisk",title:parent.Lang.Mail.tips060,
url:parent.gMain.webPath+"/se/disk/commontempdisk.do?sid="+parent.gMain.sid,width:"493",height:"430",scoll:"no",zindex:1800})},fileOnChange:function(a){document.getElementById("frmAttach");var b=parent.Util.getFileNameByPath(a.value),c=this.$("formAttach");c.action=this.getUploadUrl();if(PageState==PageStateTypes.Uploading)CC.alert(Lang.Mail.Write.fileUploading);else{if(attach.checkFileExist(b))return CC.alert(Lang.Mail.Write.sameFile),!1;if(!attach.checkAttach({fileName:b}))return!1;try{c.submit()}catch(d){}c=
{uploadType:"form"};c.fileId=b;c.fileName=b;a.value="";this.tempFileObject=c}},frmAttachOnLoad:function(a){var b=a.contentWindow,c=this.$("formAttach"),a=attach.tempFileObject,d;c.reset();$("uploadInput").value="";try{if(b&&b.return_obj){var e=b.return_obj,f=e["var"]||{};if(e.code=="S_OK"){if(jQuery.isArray(f))for(var e=0,g=f.length;e<g;e++){var j=f[e];if(a.fileId==j.fileName){d=j.fileId;f=j;break}}else d=f.fileId;this.uploadOk("form",d,f);upload_module_common.updateUI()}else this.uploadFail(e.code)}}catch(h){this.uploadFail("FS_UNKNOWN")}},
uploadOk:function(a,b,c){a!="form"&&(a=c.type||"upload",this.data.push({type:a,taskId:b,fileId:c.fileId,fileSize:c.fileSize,fileName:c.fileName}),this.attachList.push({type:a,taskId:b,fileId:c.fileId,fileSize:c.fileSize,fileName:c.fileName}));attach.uploadedCount++;if(!uploadManager.isUploading())PageState=PageStateTypes.Common,oWrite.status=WriteState.none},uploadFail:function(a,b,c){c=c||{};b=c.errorMsg||"";if(this.$("liUpload"))this.$("liUpload").style.display="none";this.setAttachHeight();c=parent.isDeug?
b:"";PageState=PageStateTypes.Common;var d=Lang.Mail.Write.uploadFailed;if(a=="FA_ATTACH_SIZE_EXCEED")d=Lang.Mail.Write.attachmentSize;parent.CC.alert(d+c);this.setSize();parent.Util.writeLogError(parent.gConst.logFunc.js,"attachUpload","uid="+parent.gMain.userNumber+" | sid="+this.sid+"| msg="+b+"|stack="+parent.Util.getStack())},checkFileExist:function(a){var b=$("attachContainer");if(b.childNodes)for(var b=top.El.cleanWhitespace(b),c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];if(d.id!=
"liUpload"&&d.title==a)return!0}return!1},checkFileSize:function(a){return parent.Util.getSizeByByte(this.maxSize,"M")>a+this.sizeCount},setSize:function(){try{oWrite.setSize()}catch(a){}},showProgress:function(a,b,c){PageState=PageStateTypes.Uploading;$("frmAttach").style.display="none";this.$(this.ulId);var d="";if(b&&!isNaN(c)){if(a!="form")d=$("upload_processing_"+b),d.style.width=c+"%"}else this.setSize()},cancelUpload:function(){PageState=PageStateTypes.Common;this.deleteTasks();this.$("liUpload").style.display=
"none";$("uploadInput").value="";$("formAttach").reset();this.refreshAttach();this.setSize()},refreshAttach:function(){this.frm.src="about:blank"},removeFile:function(a,b){b=b||0;if(typeof a=="string"||typeof a==="number"){parent.El.remove(this.$("li_"+a));this.sizeCount-=b;for(var c=0;c<this.attachList.length;c++)(this.attachList[c].fileId==a||this.attachList[c].taskId==a)&&this.attachList.splice(c,1);for(c=0;c<this.data.length;c++)(this.data[c].fileId==a||this.data[c].taskId==a)&&this.data.splice(c,
1)}else if(typeof a=="object"&&a instanceof Array)for(var d=0;d<a.length;d++){parent.El.remove(this.$("li_"+a[d]));this.sizeCount-=b;for(c=0;c<this.attachList.length;c++)(this.attachList[c].fileId==a||this.attachList[c].taskId==a)&&this.attachList.splice(c,1);for(c=0;c<this.data.length;c++)(this.data[c].fileId==a||this.data[c].taskId==a)&&this.data.splice(c,1)}this.sizeCount=Math.max(0,this.sizeCount);PageState=PageStateTypes.Common;attach.needUploadCount--;attach.setAttachHeight()},removeData:function(a){for(var b=
0;b<this.data.length;b++)if(this.data[b].taskId==a){this.data.splice(b,1);break}},deleteAttach:function(a,b,c){a=="flash"?FlashUpload.deleteAttach(b,c):a=="activex"?UploadActivex.deleteAttach(b,c):a=="formInternal"?this.deleteTasks(b,function(){attach.deleteImage(b);attach.removeFile(b,c)}):this.deleteTasks(b,function(){attach.removeFile(b,c)})},deleteTasks:function(a,b){typeof a=="string"&&(a=[a]);parent.MM.mailRequestApi({func:parent.gConst.func.deleteAttach,data:{composeId:oWrite.id,items:a},call:function(c){try{c.code==
"S_OK"?typeof b=="function"&&(b(a),attach.uploadedCount--):parent.CC.alert(parent.Lang.Mail.Write.deleteAttachError+"<br>"+(c["var"]||""))}catch(d){parent.ch("delete attach error."+d)}},msg:parent.Lang.Mail.Write.deletingAttach})},getAttachList:function(){parent.MM.mailRequestApi({func:parent.gConst.func.refreshAttach,data:{id:oWrite.id},call:function(a){try{a.code=="S_OK"&&oWrite.showAttachContainer(a["var"])}catch(b){parent.ch("delete attach error."+b)}},msg:""})},addAttachContainer:function(a){var b=
this.$(this.ulId),c=a.uploadType||"form",d=a.fileId,d=a.taskId||d,e=subject=a.fileName,f=e.substr(e.lastIndexOf(".")+1),e=e.substr(0,e.length-f.length-1),g=a.fileSize||0,g=a.fileRealSize||g,j=this.getFileShortName(e),h=this.formatSize(g,2),k=[],l=document.createElement("div"),d=d.toString().encodeHTML().replace(/&nbsp;/g," ");attach.needUploadCount++;l.title=e;l.id="li_"+d;l.className="clearfix zz_comb fup";k.push('<div class="upLoadBg">');k.push('<div id="upload_processing_'+d+'" class="process" style="width:0%;">&nbsp;</div>');
k.push("</div>");k.push('<div class="upLoadText">');k.push('<span class="fileName"><i class="i_video '+parent.Util.getFileClasssName(a.fileName)+'"></i><span class="uploadFile_name">'+j.encodeHTML()+"."+f+"</span>");k.push('<span id="'+d+'_size" class="gray">');c!="form"&&k.push(h);k.push("</span>");k.push("</span>");k.push('<a href="javascript:fGoto();" onclick="attach.deleteAttach(\''+c+"', '"+d+"', '"+g+'\');return false;"><i class="i_u_close" onmouseover="this.className=\'i_u_close_hover\'" onmouseout="this.className=\'i_u_close\'"></i></a>');
k.push("</div>");l.innerHTML=k.join("");this.sizeCount+=g;b.appendChild(l);this.attachList.push(a);oWrite.setSubjectTxt(subject,!0)},getFileType:function(a){for(var a=a.toLowerCase(),b="other",c="other,tif,txt,psd,rar,zip,xml,html,java,fon,jpg,gif,png,bmp,tiff,mpeg,avi,wmv,mov,mpg,vob,rmvb,mp3,wma,wav,asf,mp4,sis,sisx,cab,doc,docx,pdf,xls,xlsx,ppt,pptx,swf,fla,share,folder,mp3-hover,upload,i-hand,flv,folder-m,folder-p,exe,css,rm,midi,chm,iso,vsd,no-load".split(","),d=0;d<c.length;d++)if(a.indexOf(c[d])>=
0){b=c[d];break}return b},addDiskFiles:function(a,b){var c=$(this.ulId),d=parent.GE.diskFiles[oWrite.composeId],e=0;if(b)e=d.length,parent.GE.diskFiles[oWrite.composeId]=parent.GE.diskFiles[oWrite.composeId].concat(a);if(a){for(d=0;d<a.length;d++){var f=a[d],g=f.id,j=subject=f.name,h=j.substr(j.lastIndexOf(".")+1),k=parent.Util.getFileClasssName(j),j=j.substr(0,j.length-h.length-1);this.getFileShortName(j);var l=f.fileSize||f.size,l=parent.Util.str2Num(l),l=this.formatSize(l,2),f=upload_template.frame,
o=document.createElement("div");o.title=j;o.id="FromDiskFiles_"+g+"_"+(e+d);o.className="clearfix zz_comb fup bigAttach";f=Utils.format(f,{closeBtn:upload_template.removeDiskFile,state:upload_template.success,prefix:"{prefix}",suffix:"{suffix}",fileSizeText:"{fileSizeText}",fileIconClass:"{fileIconClass}"});g={fileIconClass:k,prefix:j,suffix:h,fileSizeText:l,fileId:g.toString().trim(),fileType:"disk",index:e+d};o.innerHTML=Utils.format(f,g);c.appendChild(o);attach.setAttachHeight();oWrite.setSubjectTxt(subject,
!0)}this.setAttachHeight()}},deleteDiskFiles:function(a,b){var c=$(this.ulId),d=$("FromDiskFiles_"+a+"_"+b);c.removeChild(d);document.all&&d.removeNode();c=parent.GE.diskFiles[oWrite.composeId];for(d=0;d<c.length;d++)c[d].id==a&&c.splice(d,1);this.setAttachHeight();this.setSize()},showAttachContainer:function(a){a=a||"";try{for(i=0;i<a.length;i++)this.addAttachContainer(a[i])}catch(b){}this.setAttachHeight()},setProcessing:function(a){jQuery(".upLoadBg div").each(function(){jQuery(this).css({width:a+
"%"}).removeClass("process").addClass("processed")})},singleComplete:function(a){var b=$(attach.ulId),c=document.createElement("li");c.innerHTML="<i></i>"+a+"["+Lang.Mail.Write.Uploaded+"]";b.appendChild(c)},setAttachHeight:function(){var a=this.$(this.ulId);a.getElementsByTagName("div").length>0?(parent.El.removeClass(a,"hide"),jQuery(a).show(),jQuery(a).show()):(parent.El.addClass(a,"hide"),utool.hideBigAttachTransformTips());oWrite.needAutoSave=!0;this.setSize()},getFilesByString:function(a){return!a?
null:(a=a.match(attach.regMatchFile))?(eval(a[1]),return_obj&&return_obj["var"]?(a=return_obj["var"],{code:return_obj.code,taskId:a.fileId,fileId:a.fileId,fileName:a.fileName,fileSize:a.fileSize}):null):null},getFileShortName:function(a){return parent.Util.getFileShortName(a,attach.maxNameLen)},formatSize:function(a,b){return parent.Util.formatSize(a,null,b||2)},insertImageToEditor:function(a,b,c){if(c)a=this.getShowAttachUrl(c.fileId,encodeURIComponent(c.fileName)),Editor.doMenu("InsertImage",a),
PageState=PageStateTypes.Common,c.uploadType="formInternal",c.type="internal"},deleteImage:function(a){a=RegExp('<img src="'+parent.gConst.downloadUrl+"\\?func="+parent.gConst.func.getAttach+"[^<]*"+a+'[^>]*">',"i");a=Editor.getEditorValue().replace(a,"");Editor.setEditorValue(a)}},UploadActivex={isCaptureing:!1,captureCount:0,captureTaskId:0,data:{},isSetup:function(){var a=!1;if(!top.Browser.isIE)return CC.alert(Lang.Mail.Write.browseError),!1;if(top.AttachControl.isSetup!=void 0)return a=top.AttachControl.isSetup;
try{var b=new ActiveXObject("ydRIMailToolAutoUpdateCtrl.AutoUpdate.1");if(b==null)return!1;b.GetActiveXVersion("ydCxdndctrl.Upload.1");return!0}catch(c){}if(!a)return parent.CC.showHtml({id:"Setup",title:Lang.Mail.Write.softwareSetup,url:top.gConst.composeSetupUrl,width:"348",height:"160",scoll:"no",buttons:[]}),!1;delete window.obj;return top.AttachControl.isSetup=a},writeScreenControl:function(){top.AttachControl={isSetup:void 0};if(top.Browser.isIE){var a='<OBJECT ID="ScreenSnapshotctrlID" name="ScreenSnapshotctrl" CLASSID="CLSID:49C9C3AD-42B5-45e0-ACC3-093AD3F1369D"></OBJECT>\r\n';
a+='<script language="JavaScript" for="ScreenSnapshotctrl" ';a+='event="ScreenSnapshotCtrlOnProgress(id, nProgress, nTotalSize, nUsedTime)">';a+="ScreenSnapProgress(id,nProgress, nTotalSize, nUsedTime);";a+='<\/script>\r\n<script language="JavaScript" for="ScreenSnapshotctrl" ';a+='event="ScreenSnapshotCtrlOnStop(id, nResult, strResponse)">';a+="ScreenSnapComplete(id, nResult, strResponse);";a+='<\/script>\r\n<script language="JavaScript" for="ScreenSnapshotctrl" ';a+='event="SSCUploadClipboardFileOnStart(id, nFileCount, iFileIndex, strFileName)">';
a+="ClipboardFileOnStart(id, nFileCount, iFileIndex, strFileName);";a+='<\/script><script language="JavaScript" for="ScreenSnapshotctrl" ';a+='event="SSCUploadClipboardFileOnProgress(id, nFileCount, iFileIndex, strFileName,nProgress,nTotalSize, nTime)">';a+="ClipboardFileOnProgress(id, nFileCount, iFileIndex, strFileName,nProgress,nTotalSize, nTime);";a+='<\/script><script language="JavaScript" for="ScreenSnapshotctrl" ';a+='event="SSCUploadClipboardFileOnStop(id, nFileCount,iFileIndex,strFileName, nResult, strResponse)">';
a+="ClipboardFileComplete(id, nFileCount,iFileIndex,strFileName, nResult, strResponse);";a+="<\/script>";$("ScreenControl").innerHTML=a}},captureScreen:function(){try{if(this.isSetup()){var a=attach.getUploadUrl("",1,!0);ScreenSnapshotctrl.GetScreenSnapshotImg(this.captureTaskId,a,"");this.captureTaskId++}}catch(b){}},deleteAttach:function(a,b){var c=this.data[a];c&&attach.deleteTasks(c,function(){attach.deleteImage(c);attach.removeFile(a,b)})}},activeXAttach={taskId:1,init:function(){var a=MultiThreadUpload.showDialog();
this.uploadUrl=attach.getUploadUrl("",3,!0);for(var b=0,c=a.length;b<c;b++){var d=a[b],d=d.fileName.indexOf("\\")?d.fileName.substr(d.fileName.lastIndexOf("\\")+1):d.fileName;a[b].fileName=d;a[b].uploaded=!1;a[b].uploadType="multiThread";a[b].taskId=this.taskId++;a[b].fileId=a[b].taskId}this.files=a;uploadManager.uploadFile(a)},upload:function(){var a=this.files[this.currentIndex];attach.addAttachContainer(a);attach.setAttachHeight();MultiThreadUpload.commandUpload(a)},getStatus:function(a){var b=
this.timer,c=MultiThreadUpload.getStatus(),d=!1;if(c&&c.length){for(var e=null,f=0;f<c.length;f++)if(c[f].taskId==a){e=c[f];break}e?(c=e.completedSize/e.totalSize*100,attach.showProgress("ActiveX",a,c),c>=100&&(d=!0)):d=!0}else d=!0;d&&clearInterval(b)}};
function ScreenSnapProgress(a,b,c,d){a=AttachConst.ScreeSnapId+a;if(UploadActivex.isCaptureing){var c=(b/c*100).toString(),e=0;d>0&&(e=b/d);attach.showProgress("activex",a,c,e)}else attach.addAttachContainer({taskId:a,uploadType:"activex",fileName:a+".jpg",fileSize:c}),UploadActivex.isCaptureing=!0,UploadActivex.data[a]=""}
function ScreenSnapComplete(a,b,c){var d=AttachConst.ScreeSnapId+a;UploadActivex.captureCount++;UploadActivex.isCaptureing=!1;if(b==0&&(b=attach.getFilesByString(c)))attach.insertImageToEditor("activex",AttachConst.ScreeSnapId+a,b),UploadActivex.data[d]=b.fileId}
(function(a){var b={init:function(a){function b(){f.isSupportFlashUpload&&(upload_module_flash.init(),g=!1);f.isSupportAJAXUpload&&(upload_module_ajax.init(),g=!1);g&&upload_module_common.init();if(g||f.isSupportAJAXUpload)bindAttachFrameOnload(),e("#formUpload").css({zIndex:9999,top:0}),e("#formAttach").show()}this.model=a;var e=jQuery,f=supportUploadType=this.getSupportUpload(),g=!0;f.isSupportMultiThreadUpload?(upload_module_multiThread.init(),a=(a=parent.gMain.tempUploadMaxFileSize||0)?parent.Util.formatSize(parent.Util.str2Num(a),
null,2):"1G",jQuery("#aattach").html((jQuery("#aattach").html()+"(\u6700\u5927{0})").format(a)),(jQuery.browser.mozilla||navigator.userAgent.indexOf("Windows NT 6.3")>-1)&&b(),utool.registerBigAttachTipsEvent()):(window.captureScreen=function(){upload_module_multiThread.init()},b(),window.VBArray&&jQuery(utool.autoUploadObjectString).appendTo(jQuery(document.body)));PageState=PageStateTypes.Common},createUploadManager:function(){uploadManager=new UploadManager({container:document.getElementById("attachContainer")});
this.commonMouseEvent()},getSupportUpload:function(){var a={};a.isSupportMultiThreadUpload=upload_module_multiThread.isSupport();a.isSupportFlashUpload=upload_module_flash.isSupport();a.isSupportOldFlashUpload=!1;a.isSupportAJAXUpload=upload_module_ajax.isSupport();a.isSupportScreenShotUpload=a.isSupportMultiThreadUpload;return a},deleteFile:function(a){var d=a.file,a=d.fileId,e=d.filePath;if(d.uploadType=="multiThread")e=d.fileName;(function(a,b){if(a.indexOf("\\")!=-1)return!0;var c=attach;if(c.composeAttachs)for(var d=
0;d<c.composeAttachs.length;d++)if(b==c.composeAttachs[d].id)return!1;return!0})(e,a)&&parent.MM.mailRequestApi({func:parent.gConst.func.deleteAttach,data:{composeId:b.model.composeId,items:[a]},call:function(a){try{a.code=="S_OK"&&(uploadManager.removeFile(d),refreshAttach(!0))}catch(b){parent.ch("delete attach error."+b)}},msg:parent.Lang.Mail.Write.deletingAttach})},deletePreuploadFile:function(a){RequestBuilder.call("upload:deleteTasks",{composeId:b.model.composeId,items:[a]},function(d){if(d.code==
"S_OK")top.Debug.write("\u5220\u9664\u672c\u6b21\u4e0a\u4f20\u7684\u9644\u4ef6:"+a),b.asynDeletedFile=""})},commonMouseEvent:function(){var b=this;supportUploadType.isSupportFlashUpload||a("#aattach,#formUpload").mouseover(function(){var d={host:a(this),text:utool.getUploadTipMessage()};b.showUploadTip(d)}).mouseout(function(){a(document).unbind("mousemove").bind("mousemove",a.proxy(b.hideUploadTip,b))}).mousemove(function(a){top.EV.stopEvent(a)})},showUploadTip:function(c){c||(c={host:a("#aattach"),
text:utool.getUploadTipMessage()});var d=this;d.appendUploadTipDom();var e=a("#divUploadTip");e.html(c.text);(function(a,b){var c=a.offset();b.css({display:"block",left:c.left,top:c.top+a.height()+1,position:"",zIndex:10086})})(c.host,e);e.unbind("mouseover").unbind("mouseout").show();e.bind("mouseover",function(a){parent.EV.stopEvent(a);b.listining_tips_shown=!0;b.t1&&clearTimeout(b.t1);b.t2&&clearTimeout(b.t2)});e.bind("mouseout",function(a){parent.EV.stopEvent(a);b.listining_tips_shown=!1;b.t2=
setTimeout(function(){d.hideUploadTip()},20)})},hideUploadTip:function(){a("#divUploadTip").hide()},appendUploadTipDom:function(){var b=a("#divUploadTip");b.length==0&&(b=a('<div id="divUploadTip" class="tips write-tips"></div>').appendTo(document.body),b.mousemove(function(a){top.EV.stopEvent(a)}),b.css("z-index",128))}};window.upload_module=b})(jQuery);
JSForFlashUpload={getUploadUrl:function(){return attach.getUploadUrl("","",!0)},onselect:function(a){for(var a=a.replace(/[\t\s]+/g,""),a=parent.Util.str2Dom(a).firstChild.childNodes,b=[],c=0;c<a.length;c++){var d=a[c],e=parseInt(parent.Util.getXMLValue(d.childNodes[2]),10),f=parent.Util.getXMLValue(d.childNodes[1]),d={taskId:parent.Util.getXMLValue(d.childNodes[0]),fileName:f,fileSize:e,uploadType:"flash"};b.push(d)}if(b.length>0)return uploadManager.uploadFile(b)},onprogress:function(a,b,c){if(a=
utool.getFileById(a))window.currentFileId=a.fileId,a.state="uploading",a.sendedSize=b,a.uploadSpeed=c,a.progress=parseInt(b/a.fileSize*100,10),a.updateUI()},oncomplete:function(a,b){window.currentFileId=null;window.currentSip=null;var c=utool.getFileById(a),d=utool.checkUploadResultWithResponseText({fileName:c.filePath,responseText:b});d.success?(c.state="complete",c.fileId=d.fileId,c.updateUI(),attach.uploadOk("flash",a,d)):(c.state="error",c.updateUI(),CC.alert("\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u5220\u9664\u540e\u91cd\u8bd5\uff01"));
uploadManager.autoUpload()},onerror:function(a){if(a=utool.getFileById(a))a.state="blockerror",a.updateUI()},onmouseover:function(){upload_module.showUploadTip();upload_module.t2&&clearTimeout(upload_module.t2)},onmouseout:function(){upload_module.t1=setTimeout(function(){upload_module.listining_tips_shown||upload_module.hideUploadTip()},20)},onclick:function(){return PageState==PageStateTypes.Uploading?(CC.alert(Lang.Mail.Write.fileUploading),!1):!0}};
utool={autoUploadObjectString:'<object id="autoUploadControl" height="1" width="1" classid="clsid:63A691E7-E028-4254-8BD5-BDFDB8EF6E66" codebase="'+parent.CC.getResourceAbsoluteURL()+'/mail/activex/RIMSetup.CAB#version=1,0,0,0"></object>',getMaxUploadSize:function(){return attach.maxSize},getMaxUploadSizeWithUnit:function(){var a=utool.getMaxUploadSize(),b="";return a>0&&a<1?a*1024+"K":a+"M"},checkFileExist:function(a){for(var a=utool.getFileNameByPath(a),b=uploadManager.fileList,c=0;c<b.length;c++)if(b[c].fileName==
a)return!0;return!1},getUploadTipMessage:function(){var a=Utils.format("\u6dfb\u52a0\u5c0f\u4e8e{0}\u7684\u9644\u4ef6",[utool.getMaxUploadSizeWithUnit()]);jQuery("#aattach");supportUploadType.isSupportScreenShotUpload?(parent.GC.check("DISK")?(a=(a=parent.gMain.tempUploadMaxFileSize||0)?parent.Util.formatSize(parent.Util.str2Num(a),null,2):"1G","\u6dfb\u52a0\u6700\u5927{0}\u7684\u9644\u4ef6".format(a)):a="1G",a="\u6dfb\u52a0\u6700\u5927{0}\u7684\u9644\u4ef6<br/>\u53ef\u4f7f\u7528Ctrl+V\u7c98\u8d34\u4e0a\u4f20\u9644\u4ef6".format(a)):
navigator.platform.indexOf("Mac")===-1&&(a+="<br/>\u5b89\u88c5<a hideFocus='1' style='color:blue' target='_blank' href='"+parent.gMain.frmPath+"/activex/MailThinkmail_Tool.exe'>\u90ae\u7bb1\u5c0f\u5de5\u5177</a>\uff0c\u5373\u53efCtrl+V\u7c98\u8d34\u4e0a\u4f20\u9644\u4ef6");return a},registerBigAttachTipsEvent:function(){var a=jQuery("#aattach");if(upload_module){var b=parent.gMain.tempUploadMaxFileSize||0,b=b?parent.Util.formatSize(parent.Util.str2Num(b),null,2):"1G",b="\u6dfb\u52a0\u6700\u5927{0}\u7684\u9644\u4ef6<br/>\u53ef\u4f7f\u7528Ctrl+V\u7c98\u8d34\u4e0a\u4f20\u9644\u4ef6".format(b),
c=jQuery('<div id="bigFileUploadTips1" class="tips write-tips" style="display:none;"></div>').append(b).appendTo(jQuery(document.body)).css("z-index",128);a.attr("title","");a.unbind("mouseover").unbind("mouseout").unbind("mousemove").bind("mouseover",function(){var b=a.offset();c.css({display:"block",left:b.left,top:b.top+a.height()+1,position:"",zIndex:10086});c.show()}).bind("mouseout",function(){jQuery(document).bind("mousemove",function(){c.hide()})}).bind("mousemove",function(a){parent.EV.stopEvent(a)})}},
hideToolTips:function(){jQuery("#bigFileUploadTips1").hide()},showDisableFlashMsg:function(){if(confirm("\u60a8\u662f\u5426\u8981\u7981\u7528Flash\u4e0a\u4f20\u7ec4\u4ef6?")){var a=new Date;a.setFullYear(2099);$Cookie.set({name:"flashUploadDisabled",value:"1",expries:a});alert("Flash\u4e0a\u4f20\u7ec4\u4ef6\u5df2\u7ecf\u7981\u7528\uff0c\u60a8\u4e0b\u6b21\u6253\u5f00\u5199\u4fe1\u9875\u5c06\u4f7f\u7528\u539f\u59cb\u4f46\u662f\u7a33\u5b9a\u7684\u4e0a\u4f20\u65b9\u5f0f\u3002")}},checkSizeSafe:function(a){return this.getRemainSize()>
a},getSizeNow:function(){for(var a=0,b=uploadManager.fileList,c=0;c<b.length;c++){var d=b[c];d.fileSize&&(a+=d.fileSize)}return a},getRemainSize:function(){return this.getMaxUploadSize()*1048576-this.getSizeNow()},shortName:function(a){if(a.length<=30)return a;var b=a.lastIndexOf(".");return b==-1||a.length-b>5?a.substring(0,28)+"\u2026":a.replace(/^(.{26}).*(\.[^.]+)$/,"$1\u2026$2")},getFileNameByPath:function(a){return a.replace(/^.+?\\([^\\]+)$/,"$1")},getFileById:function(a){for(var b=uploadManager.fileList,
c=0;c<b.length;c++){var d=b[c];if(d.fileId==a||d.taskId==a)return d}return null},getAttachFiles:function(){var a=upload_module.model.composeAttachs;try{for(var b=0;b<a.length;b++){var c=a[b];!c.fileName&&!c.name&&(a.splice(b,1),b--)}}catch(d){}for(b=0;b<a.length;b++)if(c=a[b],c.fileRealSize)c.base64Size=c.fileSize,c.fileSize=c.fileRealSize;return a},getControlUploadUrl:function(a){return attach.getUploadUrl("",a?1:3)},getBlockUploadUrl:function(){return window.location.protocol+"//"+window.location.host+
"/RmWeb/mail?func=attach:upload2&sid="+upload_module.model.sid+"&composeId="+upload_module.model.composeId},checkUploadResultWithResponseText:function(a){var b={},a=attach.getFilesByString(a.responseText)||{};a.code=="S_OK"?(b=a,b.success=!0,addCompleteAttach(b)):b.success=!1;return b},isScreenShotUploading:function(){return Boolean(window.upload_module_screenShot&&upload_module_screenShot.isUploading)},showUploadTip:function(){var a=$("#divUploadTip");a.length==0&&(jQuery.browser.safari||(a=$("<div id='divUploadTip' style='position:absolute;display:none'>\u5b89\u88c5\u5c0f\u5de5\u5177</div>").appendTo(document.body)));
var b=$("#realUploadButton").offset();a.css({left:b.left,top:b.top-document.body.scrollTop+20,display:""})},hideUploadTip:function(){$("#divUploadTip").hide()},isImageFile:function(a){return/\.(?:jpg|jpeg|gif|png|bmp)$/i.test(a)},fillSubject:function(a){var b=document.getElementById("txtSubject");if(b.value=="")b.value=a,upload_module.model.autoSaveTimer.subMailInfo.subject=a},logUpload:function(){},showBigAttachTransformTips:function(){this.hideBigAttachTransformTips();var a=jQuery('<div id="bigAttachTransform_tips" class="yellowTips p_relative" style=""><i id="bigAttachTransformCloseBtn" style="right:2px; top:2px;" class="i-fakeTxt-close"></i>\u9644\u4ef6\u8d85\u8fc7{0}, \u5c06\u4f5c\u4e3a\u8d85\u5927\u9644\u4ef6\u4e0a\u4f20, \u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u8f6c\u7ad9, 15\u5929\u5185\u6709\u6548, \u82e5\u88ab\u5220\u9664\u6216\u8fc7\u671f, \u6536\u4ef6\u4eba\u5c06\u65e0\u6cd5\u4e0b\u8f7d.</div>'.format(attach.maxSize+
"M"));jQuery(".edi_container").prepend(a);jQuery("#bigAttachTransform_tips").show();jQuery("#bigAttachTransformCloseBtn").unbind("click").bind("click",function(){jQuery("#bigAttachTransform_tips").hide()})},hideBigAttachTransformTips:function(){jQuery("#bigAttachTransform_tips")&&jQuery("#bigAttachTransform_tips").hide().remove()},mergeBigAttachList:function(a){parent.GE.diskFiles[oWrite.composeId]||(parent.GE.diskFiles[oWrite.composeId]=[]);for(var b=parent.GE.diskFiles[oWrite.composeId],c={},d=
[],e=0;e<b.length;e++)b[e].url&&(c[b[e].url]=!0);for(e=0;e<a.length;e++)a[e].url&&!c.hasOwnProperty(a[e].url)&&d.push(a[e]);d.length&&(parent.GE.diskFiles[oWrite.composeId]=parent.GE.diskFiles[oWrite.composeId].concat(d))},deleteBigAttachById:function(a){var b=parent.GE.diskFiles[oWrite.composeId];if(a&&b)for(var c=0;c<b.length;c++)b[c].url&&b[c].id&&b[c].id==a&&(parent.GE.diskFiles[oWrite.composeId]=parent.GE.diskFiles[oWrite.composeId].splice(c,1))}};
UploadLogs={CommonStart:5001,CommonCancel:5002,CommonSuccess:5003,CommonFail:5004,CommonFailInfo:5005,AjaxStart:5051,AjaxCancel:5052,AjaxSuccess:5053,AjaxFail:5054,AjaxFailInfo:5055,FlashStart:6001,FlashCancel:6002,FlashSuccess:6003,FlashFail:6004,FlashFailInfo:6005,MultiStart:7001,MultiStop:7002,MultiContinue:7003,MultiCancel:7004,MultiSuccess:7005,MultiFail1:7006,MultiFail2:7007};
function getFileIdByName(a){for(var b=uploadManager.fileList,c=0;c<b.length;c++){var d=b[0];if(d.filePath==a||d.fileName==a)return d.fileId}return null}var UploadManager=function(){this.init.apply(this,arguments)},TaskID=1E4;
UploadManager.prototype={init:function(a){var b=this;this.currentUploadType="none";this.fileList=[];this.container=a.container;this.jContainer=jQuery(a.container);this.jContainer.click(function(a){a=a.target;if((a.tagName=="I"||a.tagName=="A")&&a.getAttribute("command")){var d=a.getAttribute("taskid"),e=a.getAttribute("fileid"),d=utool.getFileById(d||e);b.doCommand({command:a.getAttribute("command"),file:d});upload_module.model.autoSendMail=!1}})},doCommand:function(a){switch(a.command){case "RemoveFile":this.removeFile(a.file);
break;case "DeleteFile":upload_module.deleteFile(a);break;case "CancelUpload":a.file.cancelUpload();uploadManager.autoUpload();PageState=PageStateTypes.Common;break;case "ResumeUpload":UploadFacade.uploadResume()}},isUploadAble:function(){return!this.isUploading()},uploadFile:function(a){top.jQuery.isArray(a)||(a=[a]);var b=0,c=!1;oWrite.changed=!0;for(var d=0;d<a.length;d++){var e=a[d];if(e.uploadType!="screenShot"&&utool.checkFileExist(e.fileName)&&!e.replaceImage)return a=ComposeMessages.FileNameExist,
e=Utils.htmlEncode(utool.getFileNameByPath(e.fileName)),e=Utils.format(a,[e]),CC.alert(e),!1;if(e.uploadType!="screenShot"&&!attach.checkAttach(e))return!1;if(e.uploadType=="multiThread"&&e.fileSize==0&&!e.replaceImage)return a=ComposeMessages.NoFileSize,e=Utils.htmlEncode(utool.getFileNameByPath(e.fileName)),e=Utils.format(a,[e]),CC.alert(e),!1;if(!c&&(e.uploadType=="multiThread"||jQuery.browser.mozilla))c=!0;e.fileSize&&(b+=e.fileSize);e.size=e.fileSize;e.path=e.fileName;e.name=e.fileName.substr(e.fileName.lastIndexOf("\\")+
1)}if(!utool.checkSizeSafe(b))return parent.GC.check("MAIL_VAS_HUB")?c?jQuery.browser.mozilla?(e={id:"attach-mbx",type:"div",width:"480",text:Utils.format(ComposeMessages.FileSizeOverFlow,[utool.getMaxUploadSizeWithUnit()]),buttons:[{text:"\u4f7f\u7528\u8d85\u5927\u9644\u4ef6\u4e0a\u4f20",clickEvent:function(){setTimeout(attach.btnAddAttachFromTempDisk,30)},isCancelBtn:!1},{text:"\u53d6\u6d88\u4e0a\u4f20",clickEvent:function(){}}]},CC.msgBox(e)):changeToBigFileUpload(a):(e={id:"attach-mbx",type:"div",
width:"480",text:'<div class="pop-wrap"><div class="j_tool_w">    <p class="j_tool_note">\u4e0a\u4f20\u8d85\u5927\u9644\u4ef6, \u9700\u8981\u5148\u5b89\u88c5\u4f01\u90ae\u5c0f\u5de5\u5177\u63d2\u4ef6.</p>    <div class="j_tool_b">        <p>\u5b89\u88c5\u540e\uff1a\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u529f\u80fd\uff1a</p>        <ul class="j_tool_ul clearfix">            <li>                <i class="j_upload mr_10"></i><span>\u4e0a\u4f20 <var class="col_green">1G</var> \u8d85\u5927\u9644\u4ef6</span>            </li>            <li>                <i class="i-zt mr_10"></i><span>\u7c98\u8d34\u56fe\u5230\u6b63\u6587<br>\u7c98\u8d34\u65b9\u5f0f\u4e0a\u4f20\u9644\u4ef6</span>            </li>                <li style="">                    <i class="i-snap mr_10"></i><span>\u622a\u5c4f</span>                </li>            </ul>        </div>    </div></div>',
title:"\u4f01\u90ae\u5c0f\u5de5\u5177\u5b89\u88c5\u63d0\u793a",buttons:[{text:"\u4e0b\u8f7d\u5b89\u88c5",clickEvent:function(){window.open(parent.CC.getResourceAbsoluteURL()+"/mail/activex/MailThinkmail_Tool.exe")},isCancelBtn:!1},{text:"\u53d6\u6d88",clickEvent:function(){}}]},CC.msgBox(e)):CC.alert(parent.Lang.Mail.Write.attachmentSize),!1;for(d=0;d<a.length;d++)e=a[d],b={},b.uploadType=e.uploadType,b.fileName=e.fileName,b.fileSize=e.fileSize||0,b.taskId=e.taskId||TaskID++,b.fileObj=e.fileObj,b.insertImage=
e.insertImage,b.replaceImage=e.replaceImage,b.state=b.uploadType=="common"?"uploading":e.state,this.fileList.push(new UploadFileItem(b));this.render({type:"add"});var f=this;oWrite.getComposeId(function(){f.autoUpload()});attach.setAttachHeight();return!0},removeFile:function(a){for(var b=this.fileList,c=0;c<b.length;c++){var d=b[c];if(d.taskId==a.taskId){b.splice(c,1);d.remove();removeFromAttach(d.fileId);attach.removeFile(a.taskId,a.fileSize);break}}this.render({type:"remove"})},autoUpload:function(){var a=
this.fileList;if(!this.isUploading()){for(var b=0;b<a.length;b++){var c=a[b];if(c.state=="waiting")return c.upload(),!0}upload_module.model.autoSendMail&&setTimeout(function(){upload_module.model.autoSendMail&&$("#topSend").click()},2E3)}return!1},isUploading:function(){for(var a=this.fileList,b=0;b<a.length;b++)if(a[b].state=="uploading")return!0;return!1},render:function(a){var b=jQuery(this.container),c=this.fileList;a&&a.type=="refresh"&&b.find(".fup").each(function(){jQuery(this).hasClass("bigAttach")||
jQuery(this).remove()});for(a=0;a<c.length;a++){var d=c[a];d.insertImage||d.replaceImage?d.updateUI():d.hasUI()?d.updateUI():b.append(d.createUI())}b[b.html()!=""?"show":"hide"]();b[b.html()!=""?"removeClass":"addClass"]("hide")},refresh:function(){var a=this.fileList=[],b;b=utool.getAttachFiles();for(var c=0;c<b.length;c++){var d=b[c],d=new UploadFileItem({type:"Common",fileName:d.fileName||d.name,fileId:d.id||d.fileId,fileSize:d.fileSize||d.size||0,insertImage:d.insertImage,replaceImage:d.replaceImage,
isComplete:!0});a.push(d)}this.render({type:"refresh"})},onUploadError:function(a){CC.alert(a)},cancelUploading:function(){for(var a=0;a<this.fileList.length;a++){var b=this.fileList[a];b.state=="uploading"&&b.cancelUpload()}}};
var ComposeMessages={PleaseUploadSoon:"\u9644\u4ef6\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u6dfb\u52a0\u65b0\u7684\u9644\u4ef6",FileSizeOverFlow:'<div class="pop-wrap"><div class="j_tool_w"><p style="padding:0 10px"><strong>\u60a8\u6dfb\u52a0\u7684\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7{0}</strong></p><p class="j_tool_note"><font style="color:#333;">\u4e0d\u7528\u62c5\u5fc3 \u60a8\u53ef\u4ee5\u4f7f\u7528\u8d85\u5927\u9644\u4ef6\u6765\u53d1\u9001\u3002</font><br/>\u8d85\u5927\u9644\u4ef6\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u8f6c\u7ad9\u4e2d\uff0c\u66f4\u73af\u4fdd\uff0c\u5bf9\u65b9\u4e5f\u53ef\u4ee5\u9ad8\u901f\u4e0b\u8f7d.</p></div></div>',FileNameExist:'"{0}"\u76f8\u540c\u7684\u6587\u4ef6\u540d\u5df2\u7ecf\u5b58\u5728,\u8bf7\u91cd\u547d\u540d\u540e\u518d\u4e0a\u4f20',
FileUploadError:"\u6587\u4ef6\"{0}'\u4e0a\u4f20\u5931\u8d25",FileIsUsing:"\u5bf9\u4e0d\u8d77\uff0c\u6587\u4ef6\u6b63\u5728\u88ab\u5176\u5b83\u5e94\u7528\u7a0b\u5e8f\u5360\u7528\uff0c\u8bf7\u5173\u95ed\u6587\u4ef6\u540e\u518d\u8bd5\u3002",BrowserDonotSuppertScreenShot:"\u60a8\u7684\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301\u622a\u5c4f\u529f\u80fd",GetLargeAttachFail:"\u83b7\u53d6\u5927\u9644\u4ef6\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",ExistFileName:"\u5df2\u4e0a\u4f20\u9644\u4ef6\u4e2d\u5b58\u5728\u76f8\u540c\u6587\u4ef6\u540d\uff0c\u8bf7\u91cd\u547d\u540d\u540e\u518d\u8bd5\u3002",
NoFileSize:'"{0}"\u6587\u4ef6\u5927\u5c0f\u4e3a 0 \u5b57\u8282\uff0c\u65e0\u6cd5\u4e0a\u4f20'};
upload_module_common={init:function(){var a=document.getElementById("uploadInput");a.onchange=function(){function a(){e.action=utool.getControlUploadUrl();try{upload_module_common.showUploading(d),e.submit()}catch(b){c("#frmAttach").attr("src","/blank.htm").load(function(){c(this).unbind("load",arguments.callee);e.submit()})}}var c=jQuery,d=this.value;if(d){var e=document.forms.formAttach;utool.checkFileExist(d)?(CC.alert(ComposeMessages.ExistFileName),e.reset()):(attach.tempFileObject={uploadType:"form",
fileId:d,fileName:d},oWrite.getComposeId(function(){a()}))}};a.onclick=function(){oWrite.getComposeId();if(uploadManager.isUploading())return CC.alert(ComposeMessages.PleaseUploadSoon),!1}},showUploading:function(a){uploadManager.uploadFile({fileName:a,uploadType:"common"})},updateUI:function(){uploadManager.render()}};
var upload_module_flash={init:function(){var a=parent.gMain.resourceServer+"/se/mail/activex/muti_upload.swf";supportUploadType.isSupportOldFlashUpload&&(a=parent.gMain.rmSvr+"/RmWeb/upload.swf");var b=jQuery("#aattach"),c=50;b.html()!=""&&(b=jQuery("<span>"+b.html()+"</span>").appendTo(document.body),c=b.width()+2,b.hide().remove());a=new SWFObject(a,"flashplayer",c,"20");a.addParam("wmode","transparent");a.addParam("allowscriptaccess","sameDomain");a.write("boxSwfControl");!supportUploadType.isSupportOldFlashUpload&&
setTimeout(function(){if(!upload_module_flash.isRealOK){var a=!1;try{document.getElementById("flashplayer").upload||(a=!0),UploadFacade.init()}catch(b){a=!0}if(a)upload_module_common.init(),jQuery("#formAttach").show(),supportUploadType.isSupportFlashUpload=!1,GC.setCookie("flashUploadDisabled","1"),document.getElementById("flashplayer").style.display="none"}},3E3)},upload:function(a){UploadFacade.upload(a);a=utool.getFileById(a);a.state="uploading";a.updateUI()},cancel:function(a){var b=window.currentFileId;
window.currentFileId=null;window.currentSip=null;UploadFacade.cancel(a.taskId);parent.MM.mailRequestApi({func:parent.gConst.func.deleteAttach,data:{composeId:upload_module.model.composeId,items:[b]},call:function(b){try{b.code=="S_OK"&&(uploadManager.removeFile(a),uploadManager.autoUpload())}catch(d){parent.ch("delete attach error."+d)}},msg:parent.Lang.Mail.Write.deletingAttach})},isSupport:function(){if(document.all&&(window.ActiveXObject||/rv:11.0/.test(navigator.userAgent)))try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10")}catch(b){try{a=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash.9")}catch(c){}}else a=navigator.plugins["Shockwave Flash"];return a?!0:!1}};
UploadFacade={getFlashObj:function(){return document.getElementById("flashplayer")},init:function(){var a=utool.getBlockUploadUrl(!0),b=this.getFlashObj();b.setUploadUrl(a);b.setOptions({})},getUploadUrl:function(){return utool.getBlockUploadUrl(!0)},onclick:function(){if(!upload_module.model.composeId)upload_module.model.composeId=Math.random();return!0},_blockInfo:{},getBlockInfo:function(){},onrequest:function(a){result={type:1,filesize:a.fileSize,timestamp:(new Date).toDateString(),range:a.offset+
"-"+(Number(a.offset)+Number(a.length)).toString()};if(window.currentFileId)result.fileid=window.currentFileId,result.sip=window.currentSip;return result},onprogress:function(a){var b=a.data.match(/'fileId':'(.+?)'/)[1],c=a.data.match(/'sip':'(.+?)'/)[1];window.currentFileId=b;window.currentSip=c;window.currentSip&&(b=utool.getBlockUploadUrl(!0)+"&sip="+window.currentSip,this.getFlashObj().setUploadUrl(b));if(b=utool.getFileById(a.taskId))b.state="uploading",b.sendedSize=a.bytesLoaded,b.uploadSpeed=
a.speed,b.progress=a.percent,b.updateUI()},oncomplete:function(a){window.currentFileId=null;window.currentSip=null;var b=utool.getFileById(a.taskId),c=utool.checkUploadResultWithResponseText({fileName:b.filePath,responseText:a.data});c.success?(b.state="complete",b.fileId=c.fileId,b.updateUI(),attach.uploadOk("flash",a.taskId,c)):(b.state="error",b.updateUI(),CC.alert("\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u5220\u9664\u540e\u91cd\u8bd5\uff01"));uploadManager.autoUpload()},onselect:function(a){for(var b=
[],c=0;c<a.length;c++){var d=a[c],d={taskId:d.taskId,fileName:decodeURIComponent(d.fileName),fileSize:d.fileSize,uploadType:"flash"};b.push(d)}if(b.length>0&&!uploadManager.uploadFile(b))return!1},onerror:function(a){if(a=utool.getFileById(a.taskId))a.state="blockerror",a.updateUI()},uploadResume:function(){this.getFlashObj().uploadResume()},upload:function(a){if(supportUploadType.isSupportOldFlashUpload)try{UploadFacade.getFlashObj()&&UploadFacade.getFlashObj().upload(a)}catch(b){CC.alert(b)}},cancel:function(a){UploadFacade.getFlashObj().cancel(a)},
onmouseover:function(){upload_module.showUploadTip();upload_module.t2&&clearTimeout(upload_module.t2)},onmouseout:function(){upload_module.t1=setTimeout(function(){upload_module.listining_tips_shown||upload_module.hideUploadTip()},20)}};upload_module_screenShot={isSupport:function(){return!1}};
var upload_module_ajax={init:function(){this.registerDocEvent(document);var a=document.getElementById("uploadInput");a.onmouseover=function(){oWrite.getComposeId();a.onmouseover=null};a.setAttribute("multiple",!0);a.onchange=function(){var a=this.files;oWrite.getComposeId(function(){_uploadFiles(a)});this.value=""};a.onclick=function(){if(upload_module_screenShot.isUploading)return CC.alert(ComposeMessages.PleaseUploadSoon),!1}},registerDocEvent:function(a){document.documentMode!=9&&(a.body.addEventListener("dragenter",
_dragenter,!1),a.body.addEventListener("dragover",_dragover,!1),a.body.addEventListener("drop",_drop,!1),a.body.addEventListener("dragleave",_dragleave,!1))},upload:function(a){a&&a.fileObj&&HTML5AJAXUpload.upload(a)},cancel:function(){HTML5AJAXUpload.stop();HTML5AJAXUpload.currentFile&&uploadManager.removeFile(HTML5AJAXUpload.currentFile);uploadManager.autoUpload()},isSupport:function(){return window.FormData&&/Chrome|Firefox|MSIE 1\d|rv:1\d/i.test(navigator.userAgent)?!0:!1}},HTML5AJAXUpload={upload:function(a){var b=
a.fileObj,c=this;this.currentFile=a;var d=this.getFileUploadXHR();d.upload.onprogress=d.upload.onloadstart=d.upload.onload=function(a){if(a.lengthComputable){var b=c.currentFile;b.sendedSize=a.loaded;b.progress=parseInt(b.sendedSize/b.fileSize*100);b.state="uploading";b.updateUI()}};var e=utool.getControlUploadUrl();d.open("POST",e,!0);d.onreadystatechange=function(){if(d.readyState==4&&d.responseText){var a=c.currentFile,b=utool.checkUploadResultWithResponseText({responseText:d.responseText,fileName:a.fileName});
b.success?(a.fileId=b.fileId,a.state="complete",a.updateUI(),utool.logUpload(UploadLogs.AjaxSuccess)):(a.state="uploading",a.updateUI(),utool.logUpload(UploadLogs.AjaxFail),a=d.responseText,a.indexOf("FA_ATTACH_SIZE_EXCEED")>0?CC.alert(Utils.format(ComposeMessages.FileSizeOverFlow,[utool.getMaxUploadSizeWithUnit()])):a.indexOf("FS_UNKNOWN")>0&&CC.alert("\u5bf9\u4e0d\u8d77\uff0c\u4e0a\u4f20\u9644\u4ef6\u5931\u8d25\uff0c\u8bf7\u5220\u9664\u540e\u91cd\u8bd5\uff01"));uploadManager.autoUpload()}};e=new FormData;
e.append("Filedata",b);d.send(e);a.state="uploading";a.updateUI();utool.logUpload(UploadLogs.AjaxStart)},stop:function(){this.getFileUploadXHR().abort();utool.logUpload(UploadLogs.AjaxCancel)},getFileUploadXHR:function(){window.fileUploadXHR||(fileUploadXHR=new XMLHttpRequest);return fileUploadXHR}},drapTimer=null;
function _dragenter(a){var b=jQuery(".editorWrap");upload_module.model.composeId&&a.dataTransfer.files&&a.dataTransfer.files.length!=0&&(b.find(".R0_in").length<1?b.append('<div class="R0"><div class="R0_in">\u8bf7\u628a\u6587\u4ef6\u62d6\u653e\u5230\u8fd9\u4e2a\u533a\u57df\uff0c\u5c31\u53ef\u4f5c\u4e3a\u9644\u4ef6\u6dfb\u52a0\u3002</div></div>'):(b.find(".R0").show(),drapTimer&&clearTimeout(drapTimer)),oWrite.getComposeId(),a.preventDefault())}
function _dragover(a){var b=jQuery(".editorWrap");upload_module.model.composeId&&a.dataTransfer.files&&a.dataTransfer.files.length!=0&&(b.find(".R0_in").length<1?b.append('<div class="R0"><div class="R0_in">\u8bf7\u628a\u6587\u4ef6\u62d6\u653e\u5230\u8fd9\u4e2a\u533a\u57df\uff0c\u5c31\u53ef\u4f5c\u4e3a\u9644\u4ef6\u6dfb\u52a0\u3002</div></div>'):(b.find(".R0").show(),drapTimer&&clearTimeout(drapTimer)),a.preventDefault())}
function _dragleave(a){drapTimer=setTimeout(function(){jQuery(".editorWrap").find(".R0").hide()},50);a.preventDefault()}
function _drop(a){a.preventDefault();if(upload_module.model.composeId&&a.dataTransfer.files&&a.dataTransfer.files.length!=0){for(var b=a.dataTransfer.files,c=0;c<b.length;c++)if(b[c].fileSize==0){CC.alert("\u4e0d\u80fd\u62d6\u653e\u6587\u4ef6\u5939\uff0c\u4ee5\u53ca\u5927\u5c0f\u4e3a\u96f6\u7684\u6587\u4ef6");return}drapTimer=setTimeout(function(){jQuery(".editorWrap").find(".R0").hide()},50);_uploadFiles(a.dataTransfer.files)}}
function _uploadFiles(a){if(a&&a.length!=0){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({fileName:d.fileName||d.name,fileSize:d.fileSize||d.size,fileObj:d,uploadType:"ajax"})}uploadManager.uploadFile(b)}}UploadFileItem=function(){this.init.apply(this,arguments)};getPreviewScrollImg=[];
UploadFileItem.prototype={init:function(a){this.uploadType=a.uploadType;this.fileType=a.fileType||"common";this.filePath=a.fileName;this.fileName=decodeURIComponent(utool.getFileNameByPath(a.fileName));this.fileSize=parseInt(a.fileSize);this.taskId=a.taskId||Math.random();this.fileId=a.fileId;this.fileObj=a.fileObj;this.insertImage=a.insertImage;this.replaceImage=a.replaceImage;this.state=(this.isComplete=Boolean(a.isComplete))?"complete":a.state||"waiting";this.lastUIState="none";this.showProgress=
this.uploadType!="common";this.knownFileSize=a.uploadType!="common"},template:upload_template,hasUI:function(){return Boolean(this.container)},createUI:function(a){var b=document.createElement("div");b.className="";this.container=b;this.updateUI(a);return b},remove:function(){if(this.hasUI())try{this.container.parentNode.removeChild(this.container)}catch(a){}},updateUI:function(){var a=jQuery,b=this.state=="uploading"&&this.showProgress&&this.lastUIState=="uploading";if(this.insertImage||this.replaceImage)this.updateInsertImageLoading();
else{if(b)this.updateProgress();else{b="";switch(this.state){case "waiting":b=this.getWaitingHTML();break;case "complete":b=this.getCompleteHTML();oWrite.setSubjectTxt(this.fileName,!0);PageState=PageStateTypes.Common;break;case "uploading":b=this.showProgress?this.getProgressUploadingHTML():this.getCommonUploadingHTML();break;case "blockerror":b=this.getProgressUploadingHTML({resume:!0});break;case "error":b=this.container.innerHTML}this.container.className="clearfix zz_comb fup";this.container.innerHTML=
b;a(this.container).show()}this.lastUIState=this.state}},updateInsertImageLoading:function(){switch(this.state){case "waiting":case "uploading":CC.showMsg("\u56fe\u7247\u52a0\u8f7d\u4e2d...");break;case "complete":CC.hideMsg()}this.lastUIState=this.state},isUploading:!1,getWaitingHTML:function(){var a=this.template.frame,a=Utils.format(a,{closeBtn:this.template.close.replace("DeleteFile","RemoveFile"),state:this.template.waiting,prefix:"{prefix}",suffix:"{suffix}",action:"",fileSizeText:"{fileSizeText}",
fileIconClass:"{fileIconClass}"}),b=utool.shortName(this.fileName),c=b.substring(0,b.lastIndexOf(".")+1),b=b.substring(b.lastIndexOf(".")+1,b.length),c={fileIconClass:parent.Util.getFileClasssName(this.fileName),prefix:c,suffix:b,fileId:this.taskId,fileSizeText:"",fileType:this.fileType,uploadType:this.uploadType,taskId:this.taskId};if(this.knownFileSize)c.fileSizeText=this.fileType=="largeAttach"?this.fileSize:Utils.getFileSizeText(this.fileSize,{maxUnit:"K",comma:!0});return a=Utils.format(a,c)},
getCompleteHTML:function(){var a=this.template.frame,a=Utils.format(a,{closeBtn:this.template.close,state:this.template.success,action:"",prefix:"{prefix}",suffix:"{suffix}",fileSizeText:"{fileSizeText}",fileIconClass:"{fileIconClass}"}),b=utool.shortName(this.fileName),c=b.substring(0,b.lastIndexOf(".")+1),b=b.substring(b.lastIndexOf(".")+1,b.length),c={fileIconClass:parent.Util.getFileClasssName(this.fileName),prefix:c,suffix:b,fileSizeText:this.fileType=="largeAttach"?this.fileSize:Utils.getFileSizeText(this.fileSize,
{maxUnit:"M",comma:!0}),fileId:this.fileId,fileType:this.fileType};return a=Utils.format(a,c)},getCommonUploadingHTML:function(){var a=this.template.frame,a=Utils.format(a,{closeBtn:this.template.close,action:"",state:this.template.waiting,prefix:"{prefix}",suffix:"{suffix}",fileSizeText:"{fileSizeText}",fileIconClass:"{fileIconClass}"}),b=utool.shortName(this.fileName),c=b.substring(0,b.lastIndexOf(".")+1),b=b.substring(b.lastIndexOf(".")+1,b.length),c={fileIconClass:parent.Util.getFileClasssName(this.fileName),
prefix:c,suffix:b,uploadType:"common",taskId:this.taskId};return a=Utils.format(a,c)},getProgressUploadingHTML:function(a){var b=this.template.frame,c=[],d=utool.shortName(this.fileName),e=d.substring(0,d.lastIndexOf(".")+1),d=d.substring(d.lastIndexOf(".")+1,d.length),f=parent.Util.getFileClasssName(this.fileName);a&&a.resume&&c.unshift(this.template["continue"]);b=Utils.format(b,{closeBtn:this.template.close,action:c.join(""),state:this.template.process,prefix:"{prefix}",suffix:"{suffix}",fileSizeText:"{fileSizeText}",
fileIconClass:"{fileIconClass}"});a={fileIconClass:f,prefix:e,suffix:d,uploadTipText:"\u4e0a\u4f20\u4e2d",progress:Math.min(this.progress||0,99),fileSizeText:this.fileType=="largeAttach"?this.fileSize:Utils.getFileSizeText(this.fileSize,{maxUnit:"M",comma:!0}),uploadType:this.uploadType,taskId:this.taskId};return b=Utils.format(b,a)},updateProgress:function(){jQuery(this.container).html(this.getProgressUploadingHTML())},upload:function(){PageState=PageStateTypes.Uploading;this.uploadType=="flash"?
upload_module_flash.upload(this.taskId):this.uploadType=="multiThread"?upload_module_multiThread.upload(this):this.uploadType=="ajax"&&upload_module_ajax.upload(this)},cancelUpload:function(){if(this.uploadType=="common")refreshAttach();else if(this.uploadType=="flash")return upload_module_flash.cancel(this);else this.uploadType=="multiThread"?upload_module_multiThread.cancel(this):this.uploadType=="ajax"&&upload_module_ajax.cancel(this);refreshAttach(!0);PageState=PageStateTypes.Common}};
function addCompleteAttach(a){for(var b=uploadManager.fileList,c=0;c<b.length;c++){var d=b[c];if(d.fileName==a.fileName){a.insertImage=d.insertImage;a.replaceImage=d.replaceImage;break}}for(b=0;b<upload_module.model.composeAttachs.length;b++)if(upload_module.model.composeAttachs[b].fileId==a.fileId)return;upload_module.model.composeAttachs.push({fileId:a.fileId,fileName:a.fileName,fileSize:a.fileSize,insertImage:a.insertImage,replaceImage:a.replaceImage})}
function removeFromAttach(a){for(var b=0;b<upload_module.model.composeAttachs.length;b++)if(upload_module.model.composeAttachs[b].fileId==a){upload_module.model.composeAttachs.splice(b,1);break}}
var upload_module_multiThread={init:function(a){function b(){var a=MultiThreadUpload.getClipboardData(),b=[],f=!1;if(a.copyFiles.length>0)b=a.copyFiles;else if(a.imageFiles.length>0)b=a.imageFiles,f=!0;else if(a.htmlFiles.length>0)b=a.imageFiles;if(b.length>0){if(uploadManager.isUploading())return CC.alert(ComposeMessages.PleaseUploadSoon),!1}else return!0;var g=a.html?!0:!1;c(b);if(f)for(var f=b,j=0;j<f.length;j++){var h=f[j];if(utool.isImageFile(h.fileName))g?h.replaceImage=!0:h.insertImage=!0}uploadManager.uploadFile(b);
if(b.length>0){if(a.html)upload_module_multiThread.html=a.html;return!1}}function c(a){jQuery(a).each(function(){this.uploadType="multiThread"})}upload_module_multiThread.isSupport()&&MultiThreadUpload.create(a);document.getElementById("aattach").onclick=function(){if(!upload_module_multiThread.isSetup())return!1;oWrite.getComposeId();utool.hideToolTips();var a=MultiThreadUpload.showDialog();c(a);uploadManager.uploadFile(a);return!1};window.captureScreen=function(){upload_module_multiThread.isSetup()&&
MultiThreadUpload.screenShot()};window.captureClipboard=function(){if(!upload_module_multiThread.isSetup())return!0;if(window.loadCaptureTime&&new Date-window.loadCaptureTime<1E3)return!1;window.loadCaptureTime=new Date;return b()};MultiThreadUpload.onScreenShot=function(a){a.insertImage=!0;a.uploadType="multiThread";uploadManager.uploadFile(a)};MultiThreadUpload.checkUploadResultWithResponseText=function(a){var b=a.responseText.match(/"fileId\":\"([^\"]+)"/i)[1],a=attach.getShowAttachUrl(b,encodeURIComponent(a.fileName));
Editor.doMenu("InsertImage",a)}},taskId:0,upload:function(a){MultiThreadUpload.commandUpload(a)},cancel:function(a){MultiThreadUpload.cancel(a)},isSetup:function(){return!this.isSupport()?(parent.CC.showHtml({id:"Setup",title:Lang.Mail.Write.softwareSetup,url:top.gConst.composeSetupUrl,width:"348",height:"160",scoll:"no",buttons:[]}),!1):!0},isSupport:function(){if(navigator.userAgent.indexOf("Opera")>-1)return!1;if(window.ActiveXObject||/rv:11.0/.test(navigator.userAgent))try{return(new ActiveXObject("ydRIMail139ActiveX.InterfaceClass")).Command("<param><command>common_getversion</command></param>"),
!0}catch(a){}else{var b=navigator.mimeTypes&&navigator.mimeTypes["application/x-yd-mail139activex"];if(b&&b.enabledPlugin)return!0}return!1}};
MultiThreadUpload={create:function(a){var b="mtUploader"+Math.random(),c=jQuery.browser.msie?'<OBJECT style="display:none" width="0" height="0" id="'+b+'" CLASSID="CLSID:354D8141-29AB-41CB-93FA-1908477CAD0C"></OBJECT>':'<embed id="'+b+'" type="application/x-yd-mail139activex" height="1" width="1" hidden="true"></embed>',d=navigator.userAgent.indexOf("Firefox")>-1;d?jQuery(c).appendTo(top.document.body):a?jQuery(c).appendTo(document.body):document.write(c);this.control=d?top.document.getElementById(b):
document.getElementById(b)},getUploadUrl:function(a){return attach.getUploadUrl("",a?1:3)},doCommand:function(a,b){function c(){var a=getXmlDoc(g),b=[];jQuery(a).find("file").each(function(){var a=jQuery(this),a={filePath:a.find("name").text(),fileSize:parseInt(a.find("size").text())};a.fileName=a.filePath;b.push(a)});return b}function d(){var a=getXmlDoc(g),a=jQuery(a),b={text:"",html:"",htmlFiles:"",imageFiles:[],copyFiles:[],otherFiles:[]};b.text=a.find("CF_TEXT").text();b.html=a.find("CF_HTML Fragment").text();
a.find("CF_HTML file").each(function(){var a=jQuery(this),a={filePath:a.find("name").text(),fileSize:parseInt(a.find("size").text())};a.fileName=a.filePath;b.imageFiles.push(a)});a.find("CF_BITMAP file").each(function(){var a=jQuery(this),a={filePath:a.find("name").text(),fileSize:parseInt(a.find("size").text())};a.fileName=a.filePath;b.imageFiles.push(a)});a.find("CF_HDROP file").each(function(){var a=jQuery(this),a={filePath:a.find("name").text(),fileSize:parseInt(a.find("size").text())};a.fileName=
a.filePath;b.copyFiles.push(a)});a.find("CF_OTHERS file").each(function(){var a=jQuery(this),a={filePath:a.find("name").text(),fileSize:parseInt(a.find("size").text())};a.fileName=a.filePath;b.otherFiles.push(a)});return b}function e(){var a=getXmlDoc(g),a=jQuery(a),b=new Date(parseInt(a.find("time").text())),c=parseInt(a.find("oprResult").text());if(c==0){var d={filePath:a.find("name:eq(0)").text(),fileSize:parseInt(a.find("size:eq(0)").text())};d.fileName=d.filePath}return{time:b,oprResult:c,file:d}}
function f(){var a=getXmlDoc(g),b=[];jQuery(a).find("file").each(function(){var a=jQuery(this),c={taskId:a.find("taskId").text(),fileName:a.find("fileName").text(),status:a.find("status").text(),attachId:a.find("attachId").text(),totalSize:parseInt(a.find("totalSize").text()),completedSize:parseInt(a.find("completedSize").text()),transSpeed:parseInt(a.find("transSpeed").text()),needTime:parseInt(a.find("needTime").text()),stopReason:a.find("stopReason").text(),errorCode:a.find("errorCode").text()};
if(g.indexOf("<httpSvrPostResp>")!=-1&&(c.isCommonUpload=!0,a=a.find("httpSvrPostResp").text(),c.responseText=a,a=utool.checkUploadResultWithResponseText({responseText:a,fileName:c.fileName}),a.success))c.attachId=a.fileId;b.push(c)});return b}var g=this.control.Command(b);switch(a){case "getopenfilename":return c();case "getscreensnapshot":return g.indexOf("<result>0</result>")>0;case "getlastscreensnapshot":return e();case "getclipboardfiles":return d();case "getversion":return parseInt(g.replace(/\D+/g,
""));case "upload":return g.indexOf("<result>0</result>")>0;case "suspend":return g.indexOf("<result>0</result>")>0;case "continue":return g.indexOf("<result>0</result>")>0;case "cancel":return g.indexOf("<result>0</result>")>0;case "getstatus":return f();case "setbreakpointstorepoint":return g.indexOf("<result>0</result>")>0;case "commonupload":return g.indexOf("<result>0</result>")>0}},getClipboardData:function(){return this.doCommand("getclipboardfiles","<param><command>localfile_getclipboardfiles</command></param>")},
getVersion:function(){return this.doCommand("getversion","<param><command>getversion</command></param>")},showDialog:function(){return this.doCommand("getopenfilename","<param><command>localfile_getopenfilename</command><title>"+parent.Lang.Mail.tips061+"</title><filter>*.*</filter></param>")},uploadFileCount:0,upload:function(a){var b=!1;if(a.insertImage||a.replaceImage)b=!0;var c="<param>            <command>attachupload_upload</command>            <taskId>{taskId}</taskId>            <svrUrl>{svrUrl}</svrUrl>            <sid>{sid}</sid>            <composeId>{composeId}</composeId>            <referer></referer>            <cookie>{cookie}</cookie>            <filePathName>{fileName}</filePathName>\t            <size>{fileSize}</size>            </param>",
b={svrUrl:encodeXML(this.getUploadUrl(b)),sid:upload_module.model.sid,composeId:upload_module.model.composeId,fileName:encodeXML(a.filePath),fileSize:a.fileSize,taskId:a.taskId,cookie:""},c=Utils.format(c,b);this.doCommand("upload",c)?(a.state="uploading",a.updateUI(),this.startWatching(),this.uploadFileCount++,utool.logUpload(UploadLogs.MultiStart)):(a.state="error",uploadManager.removeFile(a))},commandUpload:function(a){var b=!1;if(a.insertImage||a.replaceImage)b=!0;var c="<param>            <command>attachupload_commonupload</command>            <taskId>{taskId}</taskId>            <svrUrl>{svrUrl}</svrUrl>            <cookie>{cookie}</cookie>            <filePathName>{fileName}</filePathName>            <size>{fileSize}</size>            </param>",
b={svrUrl:encodeXML(this.getUploadUrl(b)),fileName:encodeXML(a.filePath),fileSize:a.fileSize,taskId:a.taskId,cookie:""},c=Utils.format(c,b);this.doCommand("commonupload",c)?(a.state="uploading",a.updateUI(),this.startWatching(a),this.uploadFileCount++):(parent.CC.alert(parent.Lang.Mail.tips062),a.state="error",uploadManager.removeFile(a))},"continue":function(a){(a=this.doCommand("continue","<param><command>attachupload_continue</command><taskId>"+a.taskId+"</taskId></param>"))&&this.startWatching();
return a},startCheckClipBoard:function(){var a=this,b=a.getLastScreenShotAction();clearInterval(a.checkClipBoardTimer);a.checkClipBoardTimer=setInterval(function(){var c=a.getLastScreenShotAction();if(c.time.getTime()!=b.time.getTime()&&(clearInterval(a.checkClipBoardTimer),c.oprResult==0&&a.onScreenShot))a.onScreenShot(c.file)},1E3)},getStatus:function(){return this.doCommand("getstatus","<param><command>attachupload_getstatus</command></param>")},stop:function(a){if(a)return this.doCommand("suspend",
"<param><command>attachupload_suspend</command><taskId>"+a.taskId+"</taskId></param>")},cancel:function(a){a&&this.doCommand("cancel","<param><command>attachupload_cancel</command><taskId>"+a.taskId+"</taskId></param>")&&file&&this.uploadFileCount>0&&this.uploadFileCount--},screenShot:function(){try{var a=this.doCommand("getscreensnapshot","<param><command>screensnapshot_getscreensnapshot</command></param>");a&&this.startCheckClipBoard();return a}catch(b){}},getLastScreenShotAction:function(){return this.doCommand("getlastscreensnapshot",
"<param><command>screensnapshot_getlastscreensnapshot</command></param>")},startWatching:function(a){var b=this;if(!this.watchTimer)this.watchTimer=setInterval(function(){try{b.test(a)}catch(c){}},300)},stopWatching:function(){clearInterval(this.watchTimer);this.watchTimer=0},test:function(){var a=this.getStatus();this.uploadFileCount==0&&this.stopWatching();for(var b=0;b<a.length;b++){var c=a[b];if(c&&c.taskId){var d=utool.getFileById(c.taskId);if(!d)break;if(c.status<4)d.sendedSize=c.completedSize,
d.uploadSpeed=c.transSpeed,d.needTime=c.needTime,d.progress=parseInt((d.sendedSize/d.fileSize||0)*100),d.state="uploading",d.fileId=c.attachId,d.updateUI();else{if(c.status==4)if(c.stopReason==1){if(c.isCommonUpload&&c.attachId)d.state="complete",d.fileId=c.attachId,d.updateUI(),(d.insertImage||d.replaceImage)&&MultiThreadUpload.checkUploadResultWithResponseText({responseText:c.responseText,fileName:c.fileName});attach.uploadOk("ActiveX",c.taskId,c)}else c.stopReason!=2&&c.stopReason!=3&&(c.stopReason==
0?this.uploadFileCount++:c.stopReason==4&&c.errorCode&&/^(5|6|17|24)$/.test(c.errorCode));this.uploadFileCount>0&&this.uploadFileCount--;c.status==4&&uploadManager.autoUpload();if(c.stopReason>2){var e="multiThread upload fail,stopReason:{stopReason},fileName:{fileName},fileSize:{fileSize},sendedSize:{sendedSize}";try{e=Utils.format(e,{stopReason:c.stopReason,fileName:d.fileName,fileSize:d.fileSize,sendedSize:d.sendedSize}),e="\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",uploadManager.onUploadError(e)}catch(f){}}}}}}};
function bindAttachFrameOnload(){jQuery("#frmAttach").load(function(){commonAttachFrameOnLoad(window.frames.frmAttach)})}
function commonAttachFrameOnLoad(a,b){if(window.uploadManager&&uploadManager.isUploading()||b){var c=document.forms.formAttach;try{if(a.location.href.indexOf("blank.htm")>0)return;var d=a.return_obj;if(d&&d.code=="S_OK"){var e=d["var"];e.insertImage=b;upload_module.model.composeAttachs.push(e);uploadManager.refresh();upload_module.model.autoSendMail&&oWrite.doSend();c.reset();return!0}else d&&d.code=="FA_ATTACH_SIZE_EXCEED"?CC.alert(Utils.format(ComposeMessages.FileSizeOverFlow,[utool.getMaxUploadSizeWithUnit()])):
CC.confirm("\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\u3002",function(){c.submit()},"\u4e0a\u4f20\u9644\u4ef6",function(){c.reset();uploadManager.cancelUploading()});c.reset()}catch(f){CC.confirm("\u9644\u4ef6\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\u3002",function(){c.submit()},"\u4e0a\u4f20\u9644\u4ef6",function(){c.reset();uploadManager.cancelUploading()})}return!1}}
function refreshAttach(a){if(upload_module.model.autoSendMail)PageState=PageStateTypes.Common,upload_module.model.autoSendMail=!1;else if(!a)document.getElementById("frmAttach").src="blank.htm";upload_module.model.composeId&&parent.MM.mailRequestApi({func:parent.gConst.func.refreshAttach,data:{id:upload_module.model.composeId},call:function(a){try{if(a.code=="S_OK"){upload_module.model.composeAttachs=a["var"];for(var c=uploadManager.fileList,a=0;a<c.length;a++)for(var d=c[a],e=0;e<upload_module.model.composeAttachs.length;e++)if(upload_module.model.composeAttachs[e].fileId==
d.fileId)upload_module.model.composeAttachs[e].insertImage=d.insertImage,upload_module.model.composeAttachs[e].replaceImage=d.replaceImage;uploadManager.refresh()}}catch(f){parent.ch("refresh attach error."+f)}},msg:"\u5237\u65b0\u9644\u4ef6\u5931\u8d25"});attach.setAttachHeight()}
function createIEXMLObject(){var a="Microsoft.XMLDOM,MSXML2.DOMDocument.6.0,MSXML2.DOMDocument.5.0,MSXML2.DOMDocument.4.0,MSXML2.DOMDocument.3.0,MSXML.DOMDocument".split(",");if(window.enabledXMLObjectVersion)return new ActiveXObject(enabledXMLObjectVersion);for(var b=0;b<a.length;b++)try{var c=a[b],d=new ActiveXObject(c);if(d)return enabledXMLObjectVersion=c,d}catch(e){}return null}
function getXmlDoc(a){if(document.all){var b=createIEXMLObject();b.loadXML(a);return b}return(new DOMParser).parseFromString(a,"text/xml")}function encodeXML(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function replaceAttachImage(){if(upload_module_multiThread.html)upload_module_multiThread.html=""}attach.fileCheckMode=parent.gMain.attachUploadType;
attach.fileCheckMode!="0"&&(attach.setFormat(parent.gMain.attachUploadList),attach.delegate("onFormatError",function(a,b){attach.fileCheckMode==1?parent.CC.alert(parent.Lang.Mail.tips063.format(b)):parent.CC.alert(parent.Lang.Mail.tips064.format(b))}));var bigUpload;
function changeToBigFileUpload(a){bigUpload||(bigUpload=controlUpload.init({containerId:"attachContainer",containerClass:"clearfix zz_comb fup bigAttach",fastMaxFileSzie:parent.gMain.tempUploadMaxFileSize||1073741824,itemTag:"div",filelength:80}),bigUpload.on("afterRender",function(){PageState=PageStateTypes.Uploading;attach.setAttachHeight()}),bigUpload.on("afterComplete",function(){PageState=PageStateTypes.Common;for(var a=bigUpload.getUploadSuccessList(),c=[],d=0;d<a.length;d++)c.push({id:a[d].clientTaskno||
"",name:a[d].name,size:a[d].size,url:a[d].shareUrl,shareTime:a[d].validateTime});utool.mergeBigAttachList(c);attach.setAttachHeight()}),bigUpload.on("afterDelete",function(a){PageState=PageStateTypes.Common;attach.setAttachHeight();utool.deleteBigAttachById(a)}));bigUpload.app.selectCall(a);utool.showBigAttachTransformTips()}
(function(a,b){b.Utils={focusTextBox:function(a){try{if(document.all){var b=a.createTextRange();b.moveStart("character",a.value.length);b.collapse(!0);b.select()}else a.setSelectionRange(a.value.length,a.value.length),a.focus()}catch(e){}},getFileSizeText:function(a,b){var e="B";b||(b={});if(b.byteChar&&(e=b.byteChar,b.maxUnit=="B"))b.maxUnit=e;var f=b.maxUnit||"G";e!=f&&a>=1024&&(e="K",a/=1024,e!=f&&a>=1024&&(e="M",a/=1024,e!=f&&a>=1024&&(e="G",a/=1024)),a=Math.ceil(a*100)/100);if(b.comma){f=/(\d)(\d{3})($|\.)/;
for(a=a.toString();f.test(a);)a=a.replace(f,"$1,$2$3")}return a+e},getTextOverFlow:function(a,b,e){return a.length<=b?a:a.substring(0,b)+(e?"...":"")},getTextOverFlow2:function(a,b,e){for(var f=a.split(""),g=0,j=RegExp("[A-Z]|[^\x00-\u00ff]","g"),h=0;h<f.length;h++){var k=f[h].match(j);g+=k==null?1:2;if(g>b)return a.substring(0,h)+(e?"...":"")}return a},format:function(b,d){var e;e=a.isArray(d)?/\{([\d]+)\}/g:/\{([\w]+)\}/g;return b.replace(e,function(a,b){var c=d[b];return c!==void 0?c:""})},getBytes:function(a){var b=
a.match(/[^\x00-\xff]/ig);return a.length+(b==null?0:b.length)},getXmlDoc:function(a){if(document.all){var b=this.createIEXMLObject();b.loadXML(a);return b}return(new DOMParser).parseFromString(a,"text/xml")},createIEXMLObject:function(){var a="Microsoft.XMLDOM,MSXML2.DOMDocument.6.0,MSXML2.DOMDocument.5.0,MSXML2.DOMDocument.4.0,MSXML2.DOMDocument.3.0,MSXML.DOMDocument".split(",");if(b.enabledXMLObjectVersion)return new ActiveXObject(enabledXMLObjectVersion);for(var d=0;d<a.length;d++)try{var e=a[d],
f=new ActiveXObject(e);if(f)return enabledXMLObjectVersion=e,f}catch(g){}return null},htmlEncode:function(a){if(typeof a=="undefined")return"";a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\"/g,"&quot;");a=a.replace(/ /g,"&nbsp;");return a=a.replace(/&amp;#([^\;]+);/ig,"&#$1;")},parseSingleEmail:function(b){var b=a.trim(b),d={},e=/^([\s\S]*?)<([^>]+)>$/;b.indexOf("<")==-1?(d.addr=b,d.name=b.split("@")[0],d.all=b):(e=b.match(e))?(d.name=a.trim(e[1]).replace(/^"|"$/g,
""),d.addr=e[2],d.name=d.name.replace(/\\["']/g,"").replace(/^["']+|["']+$/g,""),d.all='"'+d.name.replace(/"/g,"")+'"<'+d.addr+">"):(d.addr=b,d.name=b,d.all=b);if(d.name)d.name=this.htmlEncode(d.name);return d},getFileIcoClass:function(a,b){var e=b.split(".").length,e=b.split(".")[e-1].toLowerCase();return/\.(?:doc|docx|xls|xlsx|ppt|pptx|pdf|txt|html|htm|jpg|jpeg|jpe|jfif|gif|png|bmp|tif|tiff|ico|rar|zip|7z|exe|apk|ipa|mp3|wav|iso|avi|rmvb|wmv|flv|bt|fla|swf|dvd|cd|fon)$/i.test(b)?a==1?"i_file i_f_"+
e:"i_file_16 i_m_"+e:a==1?"i_file i_f_139":"i_file_16 i_m_139"},textFocusEnd:function(a){if(a){a.focus();var b=a.value.length;if(document.selection)a=a.createTextRange(),a.moveStart("character",b),a.collapse(),a.select();else if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number")a.selectionStart=a.selectionEnd=b}}}})(jQuery,window);
var MailTool={getAddr:function(a){return MailTool.checkEmailText(a)?MailTool.getAccount(a)+"@"+MailTool.getDomain(a):""},checkEmailText:function(a){if(typeof a!="string")return!1;a=jQuery.trim(a);return this.checkEmail(a)?!0:(a=a.match(RegExp('^(?:"[^"]*"\\s?|[^<>;,\uff0c\uff1b"]*)<([^<>\\s]+)>$')))?this.checkEmail(a[1])?!0:!1:!1},checkEmail:function(a){if(typeof a!="string")return!1;a=jQuery.trim(a);return RegExp("^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$",
"i").test(a)},getDomain:function(a){if(typeof a!="string")return"";a=jQuery.trim(a);return this.checkEmail(a)?a.split("@")[1].toLowerCase():this.checkEmailText(a)?a.match(/@([^@]+)>$/)[1].toLowerCase():""},getAccount:function(a){if(typeof a!="string")return"";a=jQuery.trim(a);return this.checkEmail(a)?a.split("@")[0]:this.checkEmailText(a)?a.match(/<([^@<>]+)@[^@<>]+>$/)[1]:""},getName:function(a){if(typeof a!="string")return"";a=jQuery.trim(a);if(this.checkEmail(a))return a.split("@")[0];else if(this.checkEmailText(a)){var b=
a.replace(/<[^@<>]+@[^@<>]+>$/,""),b=jQuery.trim(b.replace(/"/g,""));return b==""?MailTool.getAccount(a):b}else return""}};
NumberTool={add86:function(a){typeof a!="string"&&(a=a.toString());return a.trim().replace(/^(?:86)?(?=\d{11}$)/,"86")},remove86:function(a){typeof a!="string"&&(a=a.toString());return a.trim().replace(/^86(?=\d{11}$)/,"")},isChinaMobileNumber:function(a){a=a.toString();if(a.length!=13&&a.length!=11)return!1;a.length==11&&(a="86"+a);return RegExp("^86(134|135|136|137|138|139|147|150|151|152|157|158|159|182|183|184|187|188|130|131|132|145|155|156|185|186|133|153|180|181|189)\\d{8}$").test(a)},checkMobile:function(a,
b){return(b?RegExp(b):/^(86)?((13[4-9]{1})|(15[0-2 7-9]{1})|(18[2-4 7-8]{1}))+\d{8}$/).test(a)},checkMobileText:function(a,b){b=b||"";if(/^\d+$/.test(a))return this.checkMobile(a,b);var c=a.match(/^(?:"[^"]*"|[^"<>;,\uff1b\uff0c]*)\s*<(\d+)>$/);return c?this.checkMobile(c[1],b):!1},isChinaMobileNumberText:function(a){return/^\d+$/.test(a)?this.isChinaMobileNumber(a):(a=a.match(/^(?:"[^"]*"|[^"<>;,\uff1b\uff0c]*)\s*<(\d+)>$/))?this.isChinaMobileNumber(a[1]):!1},getName:function(a){return this.isChinaMobileNumberText(a)&&
a.indexOf("<")!=-1?a.replace(/<\d+>$/,"").replace(/^["']|["']$/g,""):""},getNumber:function(a){if(this.isChinaMobileNumberText(a))if(a.indexOf("<")==-1)return a;else if(a=a.match(/<(\d+)>$/))return a[1];return""},compareNumber:function(a,b){if(typeof a==="undefined"||typeof b==="undefined")return!1;a=a.toString();b=b.toString();a=this.remove86(this.getNumber(a));b=this.remove86(this.getNumber(b));return a&&a==b?!0:!1},parse:function(a){var b={error:""};if(typeof a!="string")return b.error="\u53c2\u6570\u4e0d\u5408\u6cd5",
b;for(var a=a.split(/[;,\uff0c\uff1b]/),c=b.numbers=[],d=0;d<a.length;d++){var e=$.trim(a[d]);if(e!="")this.isChinaMobileNumberText(e)?c.push(e):b.error="\u8be5\u53f7\u7801\u4e0d\u662f\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\uff1a\u201c"+e+"\u201d"}b.success=b.error?!1:!0;return b},getSendText:function(a,b){return!Utils.isString(a)||!Utils.isString(b)?"":'"'+a.replace(/[\s;,\uff1b\uff0c<>"]/g," ")+'"<'+b.replace(/\D/g,"")+">"}};
var PageStateTypes={Initializing:1,Uploading:2,Sending:3,Saving:4,Common:5},WriteState={none:0,send:1,save:2},TimeUnit={Second:1E3,Minutes:6E4,Hour:36E5,Day:864E5,Week:6048E5,TwoWeek:12096E5,HalfMonth:1296E6,Month:2592E6,HalfYear:15552E6,Year:31536E6},PageState=PageStateTypes.Common,$=function(a){return document.getElementById(a)},fBlank=null,isIE=document.all,El=parent.El,CC=parent.CC,writeInputHeight=60,oWrite={id:"",status:WriteState.none,objectName:"oWrite",textArea:["recipient","ccopy","bccopy"],
textSizeEvent:{},subIndex:0,focusId:"rib_input_1",times:0,minutes:parent.gMain.autoSaveTime||5,sendMaxLen:10,toMaxNum:parseInt(parent.gMain.recipientMaxNum)||200,denyForwardMaxAttachSize:20,denyForwardAttachTypes:"doc|docx|xls|xlsx|ppt|pptx|pdf|txt|html|htm|jpg|jpeg|jpe|gif|png|rar|zip",sysSubjectNum:12,isReply:!1,isForward:!1,isDrag:!1,isReplyAll:!1,isForwardAll:!1,btnSendId:"btnSend",btnSaveId:"btnSave",btnCancelId:"btnCancel",PageState:PageStateTypes.Initializing,frmAttachReady:!1,isAutoSave:!1,
interval:0,href:location.href,funcid:GC.getUrlParamValue(location.href,"funcid")||"mbox:compose",func:GC.getUrlParamValue(location.href,"func"),fromError:GC.getUrlParamValue(location.href,"fromsomeerror"),composeId:GC.getUrlParamValue(location.href,"composeid"),mid:GC.getUrlParamValue(location.href,"mid"),tid:GC.getUrlParamValue(location.href,"tid"),to:GC.getUrlParamValue(location.href,"to"),msg:GC.getUrlParamValue(location.href,"msg"),senderUser:GC.getUrlParamValue(location.href,"senderUser"),withAttachments:GC.getUrlParamValue(location.href,
"withAttachments"),userNumber:parent.gMain.userNumber,sendList:[],signList:parent.signList||[],corpSignList:parent.corpSignList||[],defaultSign:"",sysSubject:[],pageOnLoaded:!1,editOnLoaded:!1,initData:{},dragId:0,omid:"",isSchedule:!1,isCC:!0,isSCC:!1,isLookAllAsSingle:!1,richInputBox:null,ribs:[],autoFillObjects:[],originalRecipient:[],denyForward:"0",initilized:!1,highLightKeys:[],scanThread:0,highLightResult:{},filterKeywords:parent.GC.check("MAIL_INBOX_SEN"),encryptMail:parent.GC.check("MAIL_INBOX_ENCRYPTION"),
recipientTipsTimeout:3,unlockTime:15,receiveBegin:5,oldData:{subject:"",content:""},subjectPrefix:{1:"Re:",2:">",3:"Reply:"},quickSubject:["\u7d27\u6025\uff01","\u4f1a\u8bae\u9080\u8bf7","\u4f1a\u8bae\u7eaa\u8981","\u4f1a\u8bae\u6750\u6599"],isAutoDestroy:!1,isShowBigAttachTips:!1,clearSubjectTimer:null,init:function(){if(this.initilized!=!0){var a=this;a.firstLoad=!0;if(this.mid)this.composeId="compose_"+this.mid;this.defaultSign=this.getDefaultSign();this.sendList=aliasList;this.changed=this.needAutoSave=
!1;try{var b=window.name.indexOf("compose"),c=window.name.substr(b);parent.CC.showMenu(c)}catch(d){}a.pageLoaded=!0;parent.AutoFill.datas.email=parent.LMD.allContactList_autoFile;a.initControl();a.loadSendList();a.loadSubjectList();a.loadMailInfo();oWrite.oldData=oWrite.getCurrData();a.initEvent();a.loadPlugins();CC.power.offQuickSubject()&&a.initQuickSubject();parent.El.show(parent.GE.tab.doc.getElementById(parent.gConst.mainToolbar+parent.GE.tab.curid));if(GC.check("CONTACTS")){try{var e=jQuery("#send_to_self");
if(e){var f=parent.gMain.loginName||"",g=(parent.gMain.trueName||"")+"<"+f+">";e.find("a").unbind("click").bind("click",function(){a.selectMail(f,g)})}a.loadAddrList()}catch(j){}$("tab_li0").click()}else oWrite.doTabClick("tab_li1"),$("tab_li1").click();a.initilized=!0;parent.documentEventManager&&parent.documentEventManager.addDoc(document)}},dispose:function(){oWrite.interval&&clearInterval(oWrite.interval);oWrite.scanThread&&clearInterval(oWrite.scanThread)},ajaxRequest:function(a){var b=a.url||
"",a={func:a.func||"",data:a.data||[],call:a.callback||function(){},failCall:a.failback||function(){}};b!=""?(a.url=b,parent.MM.mailRequestWebApi(a)):parent.MM.mailRequest(a)},addPlugins:function(a){if(!this.plugins)this.plugins=[];for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);this.plugins.push({name:a,args:b})},loadPlugins:function(){if(this.plugins)for(var a=0;a<this.plugins.length;a++)(new Plugins(this.plugins[a].name,this.plugins[a].args)).run()},bindEventStyle:function(){function a(){jQuery("#editor_body").removeClass("focusCol")}
function b(){jQuery("#editor_body").addClass("focusCol")}this.bindFocusBlur("rib_input_1","recipient_container");this.bindFocusBlur("rib_input_2","cc_container");this.bindFocusBlur("txtsubject","dvSubContainer");document.all?(document.getElementById("htmlEditor").attachEvent("onblur",a),document.getElementById("htmlEditor").attachEvent("onfocus",b)):(document.getElementById("htmlEditor").contentWindow.addEventListener("blur",a,!1),document.getElementById("htmlEditor").contentWindow.addEventListener("focus",
b,!1))},bindFocusBlur:function(a,b){jQuery("#"+a+"").bind("focus",function(){jQuery("#"+b+"").addClass("focusCol")});jQuery("#"+a+"").bind("blur",function(){jQuery("#"+b+"").removeClass("focusCol")})},initControl:function(){function a(){var c=!1;if(k&&k.length){for(var d=0;d<k.length;d++)if(parent.LMD.autoFillInstances[k[d].id]instanceof parent.AutoFill){if(!k[d].loaded)b.autoFillObjects.push(parent.LMD.autoFillInstances[k[d].id]),k[d].loaded=!0}else c=!0;c&&o<=30&&(o++,setTimeout(a,100))}}var b=
this,c=function(){for(var a=0;a<3;a++)b.ribs[a].interval&&(clearTimeout(b.ribs[a].interval),jQuery(b.ribs[a].container).parent().parent().parent().find(".richinputbox_tips").remove())},d=function(a,b){jQuery(b.container).parent().parent().parent().append(a)},e=function(a,b){d(a,b);b.interval=setTimeout(function(){c()},oWrite.recipientTipsTimeout*1E3)},f={type:"email",autoHeight:!0,maxHeight:writeInputHeight,maxMailNum:b.toMaxNum,skinAble:!0,change:function(){var a=0;b.needAutoSave=!0;b.changed=!0;
b.setHeight(this.container);(function(c){for(var d=0,e={},f=c[0].getItems().concat(c[1].getItems()).concat(c[2].getItems()),g=0;g<f.length;g++)e.hasOwnProperty(f[g].allText)||(d++,e[f[g].allText]=1);a=b.toMaxNum-d;for(d=0;d<c.length;d++)c[d].maxMailNum=a})(b.ribs)},itemCreated:function(a){var b=this.maxMailNum,d="",f="",a=a||{},f=(a.mode||"")=="paste"&&a.fail>0?'<div class="richinputbox_tips" style="border:solid 1px #ccc; background:#eee; line-height:24px; padding-left:12px;"><span class="red-commend">{1}</span>\u4eba\u672a\u6dfb\u52a0\uff0c\u6700\u591a\u6dfb\u52a0<span class="red-commend">{0}</span>\u4eba</div>'.format(oWrite.toMaxNum,
a.fail):'<div class="richinputbox_tips" style="border:solid 1px #ccc; background:#eee; line-height:24px; padding-left:12px;">\u6536\u4ef6\u4eba\u6570\u5df2\u8d85\u8fc7\u4e0a\u9650<span class="red-commend">{0}</span>\u4eba\uff0c\u4e0d\u80fd\u7ee7\u7eed\u6dfb\u52a0\uff01</div>'.format(oWrite.toMaxNum);c();b<=oWrite.receiveBegin&&(d='<div class="richinputbox_tips" style="border:solid 1px #ccc; background:#eee; line-height:24px; padding-left:12px;">\u8fd8\u53ef\u4ee5\u8f93\u5165<span class=\'red-commend\'>{0}</span>\u4e2a</div>'.format(b),
b<=0&&(d=f),e(d,this))},itemDeleted:function(){var a=this.maxMailNum;c();a<=oWrite.receiveBegin&&e('<div class="richinputbox_tips" style="border:solid 1px #ccc; background:#eee; line-height:24px; padding-left:12px;">\u8fd8\u53ef\u4ee5\u8f93\u5165<span class=\'red-commend\'>{0}</span>\u4e2a</div>'.format(a),this)},mailNumError:function(a){var b="",b=a.statusInfo||{};c();b=a.createMode=="paste"?'<div class="richinputbox_tips" style="border:solid 1px #ccc; background:#eee; line-height:24px; padding-left:12px;"><span class="red-commend">{1}</span>\u4eba\u672a\u6dfb\u52a0\uff0c\u6700\u591a\u6dfb\u52a0<span class="red-commend">{0}</span>\u4eba</div>'.format(oWrite.toMaxNum,
b.fail||"\u6240\u6709\u7c98\u8d34\u7684"):'<div class="richinputbox_tips" style="border:solid 1px #ccc; background:#eee; line-height:24px; padding-left:12px;">\u6536\u4ef6\u4eba\u6570\u5df2\u8d85\u8fc7\u4e0a\u9650<span class="red-commend">{0}</span>\u4eba\uff0c\u4e0d\u80fd\u7ee7\u7eed\u6dfb\u52a0\uff01</div>'.format(oWrite.toMaxNum);e(b,a)}};f.container=$("recipient_container");var g=[],j=new RichInputBox(f);f.container=$("cc_container");var h=new RichInputBox(f);f.container=$("bcc_container");f=
new RichInputBox(f);j.autoDataSource=parent.AutoFill.datas.email;h.autoDataSource=parent.AutoFill.datas.email;f.autoDataSource=parent.AutoFill.datas.email;g.push(j);g.push(h);g.push(f);this.ribs=g;var k=[],l=function(){if(b.personErrTips&&b.personErrTips instanceof ToolTips)b.personErrTips.close(),b.personErrTips=null;if(b.titleErrTips&&b.titleErrTips instanceof ToolTips)b.titleErrTips.close(),b.titleErrTips=null};jQuery(".RichInputBoxLayout").each(function(){jQuery(this).unbind("click",l).bind("click",
l)});jQuery(".RichInputBoxLayout input").each(function(a){var c=jQuery(this).attr("id");jQuery(this).unbind("focus").bind("focus",function(){b.doTextFocus(c);b.focusId=c;b.richInputBox=g[a]});parent.LMD.fillEmail(jQuery(this)[0],window,{setCall:b.selectMail,fromType:"autoComplete",showTemplate:'<span class="autoComplete_name">&quot;$NAME$&quot;</span> &lt;$VALUE$&gt;',offsetFun:function(){var b=parent.El.getX(this.objText)||0,c=parent.El.docWidth(),d=parent.El.width(top.window.document.getElementById(top.gConst.divLeft)),
b=c-d-b-430;b>0&&(b=0);return[b,-(jQuery(".RichInputBoxLayout").eq(a)[0].scrollTop||0)]},fixWidth:400});k.push({id:c,loaded:!1})});var o=0;a();GC.check("MAIL_INBOX_FORWARD");if(b.encryptMail){j=jQuery("#writer_func_container",document);h=jQuery(".edi_container",document);f=jQuery('<div id="setPasswordContainer" style="display:inline; position:relative;"><input id="chkSetPassword" type="checkbox" title="'+parent.Lang.Mail.tips001+'" tabindex="21" /><label style="margin:0;" for="chkSetPassword" title="'+
parent.Lang.Mail.tips001+'">'+parent.Lang.Mail.tips001+"</label></div>");jQuery.browser.msie&&~~jQuery.browser.version<=6&&f.css("float","left");var q=jQuery('<div id="encryptMailTips" class="yellowTips" style="display:none;"><i class="i-mail-lock mr_10"></i>'+parent.Lang.Mail.tips002+'\u3002<span id="encryptMailPwd" style="display:none;"></span> <a id="encryptMailLookPassword" href="javascript:fGoto()" onclick="return false;" class="ml_10">'+parent.Lang.Mail.tips003+'</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a id="encryptMailClearPassword" href="javascript:fGoto()" onclick="return false;">'+
parent.Lang.Mail.tips004+"</a></div>"),p=[];p.push('<div id="encryptMailPanel" class="tipBox" style="position:absolute; top:-141px; left:-121px; width:400px; padding:0; display: none;">');p.push('<div class="tipBox-con">');p.push('<ul class="encript">');p.push('<li><span class="left">&nbsp;</span>'+parent.Lang.Mail.tips005+"</li>");p.push('<li style="height: 19px;"><div><span class="left" style="float:left;display:inline;">'+parent.Lang.Mail.tips006+'\uff1a</span><input id="encryptMail_pwd" type="password" class="encript_txt"><span id="encryptMail_pwd_error" class="error"></span></div></li>');
p.push('<li style="height: 19px;"><div><span class="left" style="float:left;display:inline;">'+parent.Lang.Mail.tips007+'\uff1a</span><input id="encryptMail_repwd" type="password" class="encript_txt"><span id="encryptMail_repwd_error" class="error"></span></div></li>');p.push("</ul>");p.push('<div class="forbiden-bline ta_r">');p.push('<a id="encryptMail_ok" href="javascript:fGoto()" class="xxs-greyBtn" onclick="return false;">'+parent.Lang.Mail.tips006+"</a>");p.push('<a id="encryptMail_cancel" href="javascript:fGoto()" class="xxs-greyBtn ml_5" onclick="return false;">'+
parent.Lang.Mail.tips008+"</a>");p.push("</div>");p.push("</div>");p.push('<i class="tipBox-direc-b"></i>');p.push("</div>");p=jQuery(p.join(""));j.append(f);h.prepend(q);jQuery("#setPasswordContainer",document).append(p)}var s=jQuery("#attachTempDisk");if(s&&upload_module){var j=(j=parent.gMain.tempUploadMaxFileSize||0)?parent.Util.formatSize(parent.Util.str2Num(j),null,2):"1G",j="\u6dfb\u52a0\u6700\u5927{0}\u7684\u9644\u4ef6\u548c\u6587\u4ef6\u4e2d\u8f6c\u7ad9\u6587\u4ef6".format(j),u=jQuery('<div id="bigFileUploadTips" class="tips write-tips" style="display:none;"></div>').append(j).appendTo(jQuery(document.body)).css("z-index",
128);s.attr("title","");s.unbind("mouseover").unbind("mouseout").unbind("mousemove").bind("mouseover",function(){var a=s.offset();u.css({display:"block",left:a.left,top:a.top+s.height()+1,position:"",zIndex:10086});u.show()}).bind("mouseout",function(){jQuery(document).unbind("mousemove").bind("mousemove",function(){u.hide()})}).bind("mousemove",function(a){parent.EV.stopEvent(a)})}parent.CC.power.offAutoDestroy()&&(b.addAutoDesLabelHtml(jQuery("#writer_func_container")),b.addAutoDesTipsHtml(jQuery("#writer_func_container")),
b.addAutoDesMsgHtml())},addAutoDesLabelHtml:function(a){var b="";b+=' <input id="chkAutoDestroy" tabindex="21" type="checkbox" title="\u90ae\u4ef6\u9605\u8bfb\u540e\u81ea\u9500\u6bc1\u6216\u90ae\u4ef6\u8d85\u8fc7\u9650\u5236\u5929\u6570\u540e\u81ea\u9500\u6bc1"><label for="chkAutoDestroy" title="\u90ae\u4ef6\u9605\u8bfb\u540e\u81ea\u9500\u6bc1\u6216\u90ae\u4ef6\u8d85\u8fc7\u9650\u5236\u5929\u6570\u540e\u81ea\u9500\u6bc1">';b+=" \u81ea\u9500\u6bc1\u90ae\u4ef6";b+="</label>";a.append(b)},addAutoDesMsgHtml:function(){var a=
"";a+='<div id="autoDestroyMailTips" class="yellowTips" style="display: none;"></div>';jQuery(a).insertBefore(jQuery(".edi_container>.writeTable"))},addAutoDesTipsHtml:function(a){var b="";b+='<div id="tipsAutoDestroy" class="tipBox" style="position: absolute; display: none; width: 430px; top: -155px; padding: 0px; background: #ffffff;">';b+='<div class="tipBox-con">';b+='<ul class="pop_destroy_txt">';b+='<li class="pb_5">';b+="<label>";b+='<input id="ckbAutoDestroy" type="checkbox" class="rm_cb">\u9605\u8bfb\u5b8c\u6210\u81ea\u52a8\u9500\u6bc1';
b+="</label>";b+="</li>";b+='<li class="pb_5" style="height:27px;">';b+="<label>";b+='<input id="ckbDaysDestroy" type="checkbox" class="rm_cb">\u9650\u5236\u90ae\u4ef6\u9605\u8bfb\u5929\u6570';b+='</label> <input id="inputReadDays" type="text" value="1" maxlength="30" class="set-txt-b ml_5 mr_5" style="width: 25px;">\u5929 <span id="textReadDays" class="gray ml_20">\u8bf7\u8f93\u51651-100\u4e4b\u95f4\u7684\u6570\u503c</span></li>';b+='<li><p class="gray">1.\u53ea\u5728web\u767b\u5f55\u4f7f\u7528\u7684\u7cfb\u7edf\u5185\u90e8\u90ae\u7bb1\u751f\u6548\uff08\u5305\u542b\u76f8\u540c\u90ae\u7bb1\u7cfb\u7edf\u7684\u5176\u5b83\u57df\uff09\u3002</br>2.\u81ea\u9500\u6bc1\u90ae\u4ef6\u4e0d\u5141\u8bb8\u6dfb\u52a0\u9644\u4ef6\u3002</p></li>';
b+="</ul>";b+='<div class="forbiden-bline ta_r">';b+='<a id="btnAutoDestroyOk" href="javascript:;" class="xxs-greyBtn">\u786e\u5b9a</a>';b+='<a id="btnAutoDestroyCancel" href="javascript:;" class="xxs-greyBtn ml_5">\u53d6\u6d88</a>';b+="</div>";b+="</div>";b+='<i class="tipBox-direc-b"></i>';b+="</div>";a.append(b)},initEvent:function(){function a(){if(b.autoFillObjects&&b.autoFillObjects.length)try{for(var a=0;a<b.autoFillObjects.length;a++)b.autoFillObjects[a].div&&parent.El.hide(b.autoFillObjects[a].div)}catch(c){}}
var b=this;GC.check("CONTACTS")&&GC.check("CONTACTS_OPER")&&parent.EV.observe($("searchDelete"),"click",function(){});parent.EV.addEvent(window,"resize",b.setSize);parent.EV.addEvent(parent.GE.tab.doc.body,"click",function(){Editor&&Editor.menu&&Editor.hideMenu();RichInputBox&&RichInputBox.dispose();a()});parent.EV.addEvent(window,"unload",function(){parent.El.gc(document)});var c=parent.GE.tab.doc.getElementById(parent.gConst.ifrm+parent.GE.tab.curid).contentWindow;c&&parent.EV.addEvent(c.document.body,
"click",function(b){parent.El.descendantOf(b.target||b.srcElement,c.document.getElementById("editor_body"))||Editor.hideMenu();RichInputBox&&RichInputBox.dispose();a()});Editor&&Editor.body&&parent.EV.addEvent(Editor.body,"click",function(){a();RichInputBox&&RichInputBox.dispose()});b.interval=setInterval(function(){if(!Editor.checkValueChange())b.needAutoSave=!0;b.needAutoSave&&(parent.CC.showMsg(Lang.Mail.Write.savingToDraft,!1,!1,"loading"),b.autoSave())},6E4*b.minutes);GC.check("CONTACTS")?$("tabSwitch").onclick=
function(){b.doSepClick()}:(oWrite.doSepClick(!1),$("tabSwitch").style.display="none");GC.check("CONTACTS")?$("tab_li0").onclick=function(){oWrite.doTabClick("tab_li0");jQuery("#tab_li1").unbind("mouseover").bind("mouseover",function(){jQuery(this).removeClass("li1").addClass("li1_on")}).unbind("mouseout").bind("mouseout",function(){jQuery(this).removeClass("li1_on").addClass("li1")});jQuery("#tab_li0").unbind("mouseover").unbind("mouseout").removeClass("li0_on").addClass("li0")}:$("tab_li0").innerHTML=
"";$("tab_li1").onclick=function(){oWrite.doTabClick("tab_li1");jQuery("#tab_li0").unbind("mouseover").bind("mouseover",function(){jQuery(this).removeClass("li0").addClass("li0_on")}).unbind("mouseout").bind("mouseout",function(){jQuery(this).removeClass("li0_on").addClass("li0")});jQuery("#tab_li1").unbind("mouseover").unbind("mouseout").removeClass("li1_on").addClass("li1")};GC.check("CONTACTS")||b.doSepClick(!1);jQuery("#chkSaveToSentBox, #chkUrgent, #chkReceipt").bind("click",function(){b.needAutoSave=
!0;b.changed=!0});var d=function(){var a=[];GC.check("CONTACTS_ENT")&&a.push("0");GC.check("CONTACTS_PER")&&a.push("2");oWrite.contact=new parent.Contact("window.frames['"+parent.gConst.ifrm+parent.GE.tab.curid+"'].oWrite.contact");oWrite.contact.groupMap=parent.LMD.groupMap;oWrite.contact.addAsGroup=!0;oWrite.contact.group_contactListMap=parent.LMD.group_contactListMap_mail;oWrite.contact.inItContanct("publicPerson_ContactDialog",a,function(a){for(var b=0,c=a.length;b<c;b++)oWrite.selectMail("",
a[b].value)},null)},e=function(){var a=jQuery("#recipient_container input")[0].id;b.focusId=a;b.richInputBox=b.ribs[0];d()},f=function(){var a=jQuery(h).find("input")[0].id;b.focusId=a;b.richInputBox=b.ribs[1];d()},g=function(){var a=jQuery(k).find("input")[0].id;b.focusId=a;b.richInputBox=b.ribs[2];d()},j=$("recipient_person"),h=$("compose_CC"),k=$("compose_SCC"),l=$("cc_and_scc"),o=$("lookAllAsSingleLink"),q=parent.Lang.Mail.Write.Receiper,p=parent.Lang.Mail.Write.addCC,s=parent.Lang.Mail.Write.delCC,
u=parent.Lang.Mail.Write.addSCC,B=parent.Lang.Mail.Write.delSCC,D=parent.Lang.Mail.Write.lbt_unsinglesend,z=parent.Lang.Mail.Write.lbt_singlesend,v=parent.Lang.Mail.Write.justSeeSelfMessage;jQuery("#recipient_person").unbind("click").bind("click",e);jQuery("#cc_person").unbind("click").bind("click",f);var C=function(){return function(){var a=$("ccLink"),c=$("sccLink");a.onclick=function(){var c=jQuery(h).find("input")[0];a.innerHTML.trim()==p?(a.innerHTML=s,h.style.display="",c.focus(),b.focusId=
c.id,b.richInputBox=b.ribs[1],b.isCC=!0,jQuery("#cc_person").unbind("click").bind("click",f)):(a.innerHTML=p,h.style.display="none",b.isCC=!1);b.needAutoSave=!0;b.setSize()};c.onclick=function(){var a=jQuery(k).find("input")[0];c.innerHTML.trim()==u?(c.innerHTML=B,k.style.display="",a.focus(),b.focusId=a.id,b.richInputBox=b.ribs[2],b.isSCC=!0,jQuery("#scc_person").unbind("click").bind("click",g)):(c.innerHTML=u,k.style.display="none",b.isSCC=!1);b.needAutoSave=!0;b.setSize()}}}();(function(a){function b(){clearTimeout(e);
e=setTimeout(function(){a("#modIBCTip").hide()},100)}function c(){clearTimeout(e);a("#modIBCTip").show()}function d(){function a(){c("#ibcpass").val("");c("#ibcpass_error").val("");c("#checksign_tip").hide()}function b(){c("#ibcpass_error").text("");return c("#ibcpass").val().trim()===""?(c("#ibcpass_error").text("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!0):c("#ibcpass").val().trim().length<6||c("#ibcpass").val().trim().length>30?(c("#ibcpass_error").text("\u5bc6\u7801\u957f\u5ea6\u97006-64\u4f4d"),
!0):(e=c("#autopass")[0].checked?1:0,parent.MM.doService({func:"mail:SoapVerifyIbcPwd",absUrl:(parent.gMain?parent.gMain.webPath||"":"")+"/service/mail/ibcsoap",data:{oldpwd:c("#ibcpass").val().trim(),autosign:e},call:f,failCall:g}),!1)}var c=jQuery,e=0,f=function(b){if(typeof b!=="undefined")if(b=parseInt(b["var"].result,10),b===1){c("#divDialogCloseconfirm",parent.document).click();CC.showMsg("\u9a8c\u8bc1\u901a\u8fc7",!0,!1,"option");if((e=c("#autopass").attr("checked")?1:0)&&typeof top.gMain!=
"undefined"&&typeof top.gMain.userAttrs!="undefined")top.gMain.userAttrs.autosign="1";c("#numberSign").attr("checked",!0);a()}else b===0?CC.showMsg("\u79c1\u94a5\u5bc6\u7801\u9519\u8bef",!0,!1,"error"):b===2&&CC.showMsg("\u5bc6\u7801\u9519\u8bef\u6b21\u6570\u8fbe\u5230\u9650\u5236\uff0c\u8bf7\u4e8e10\u5206\u949f\u540e\u91cd\u8bd5",!0,!1,"error")},g=g||function(){CC.showMsg("\u89e3\u5bc6\u5931\u8d25",!0,!1,"error")};c("#ibcpass",parent.document).focus();c("#checksign_ok").bind("click",b);c("#checksign_cancel").bind("click",
a);c("#ibcpass").unbind().bind("keyup",function(a){a.keyCode==13&&b()})}if(CC.isSecurityMail){var e,f=!1;typeof top.gMain!="undefined"&&typeof top.gMain.userAttrs!="undefined"&&(f=top.gMain.userAttrs.firstuseibc=="1"?!0:!1);a("#numberSign, #numberSign_label, #numberEncrypt, #numberEncrypt_label").bind("mouseover",c);a("#numberSign, #numberSign_label, #numberEncrypt, #numberEncrypt_label").bind("mouseout",b);a("#modIBCTip").bind("mouseover",c);a("#modIBCTip").bind("mouseout",b);a("#numberEncrypt, #numberEncrypt_label").bind("mouseover",
function(){a("#txtDes").text("\u7ed9\u90ae\u4ef6\u8fdb\u884c\u52a0\u5bc6\uff0c\u4fdd\u8bc1\u90ae\u4ef6\u5168\u7a0b\u5b89\u5168\uff0c\u9632\u6b62\u90ae\u4ef6\u5185\u5bb9\u6cc4\u9732\u3002")});a("#numberSign, #numberSign_label").bind("mouseover",function(){a("#txtDes").text("\u7ed9\u90ae\u4ef6\u8fdb\u884c\u7b7e\u540d\uff0c\u4ee5\u9632\u6b62\u4ed6\u4eba\u5192\u5145\u60a8\u7684\u8eab\u4efd\u3002")});a("#modIBCPwd").bind("click",function(){CC.showModIBCdiv()});f||a("#numberEncrypt").unbind().bind("click",
function(){var a=top.gMain.userAttrs.firstuseibc;if(this.checked&&(a=="0"||typeof a=="undefined"))this.checked=!1,oWrite.numberEncryptCheck=!0,CC.showModIBCdiv()});a("#numberSign").unbind().bind("click",function(){var b=top.gMain.userAttrs.firstuseibc;if(this.checked)b=="0"||typeof b=="undefined"?(this.checked=!1,oWrite.numberSignCheck=!0,CC.showModIBCdiv()):typeof top.gMain!=="undefined"&&typeof top.gMain.userAttrs!=="undefined"&&top.gMain.userAttrs.autosign!="1"&&(a("#numberSign").attr("checked",
!1),a("#checksign_tip").show(),a("#ibcpass").focus(),d())})}})(jQuery);(function(a){function c(a){parent.MM.doService({url:"/mail/conf",func:"mail:setColorTheme",data:{colorThemId:a},failCall:function(){},call:function(){},param:""})}function d(a){return'<li><a href="javascript:void(0);"><b style="background:'+a.value+'"></b>'+a.name+"</a></li>"}function e(a){var b=!1,a=a.trim().decodeHTML();a==parent.Lang.Mail.tips010&&(b=!0);if(b)oWrite.isDefaultSubject=!0;return b}var f=a("#subjectColor"),g=!1,
h="",j=a("#txtsubject"),k=[],l=[],n=0,o=0,p=[],q=parent.Util.str2Num(parent.gMain.curColor),t;if(parent.gConst.subjectColor&&parent.gConst.subjectColor.length){parent.gConst.subjectColor[0].hasOwnProperty("sort")&&parent.gConst.subjectColor.sort(function(a,b){return a.sort>b.sort});for(o=0;o<parent.gConst.subjectColor.length;o++)if(k.push(parent.gConst.subjectColor[o]),l.push(parent.gConst.subjectColor[o].name+parent.Lang.Mail.tips009),p.push(d({name:parent.gConst.subjectColor[o].name,value:parent.gConst.subjectColor[o].value})),
q&&q==parent.gConst.subjectColor[o].val)t=parent.gConst.subjectColor[o].value;n=k.length}a("#subjectColor .dataUl").html(p.join(""));t&&j.css("color",t);f.mouseover(function(){h&&clearTimeout(h);g=!0});f.mouseout(function(){h=setTimeout(function(){g&&(f.hide(),g=!1)},500)});a("#spanColorPicker").click(function(){f.hide();clearTimeout(a);var a=setTimeout(function(){f.show()},100);return!1});a(document).click(function(){f.hide()});a("#subjectColor ul li").each(function(){a(this).mouseover(function(){var b=
"mouseon_color",b=a(this).find("b").hasClass("curr")?"mouseon_color_on":"mouseon_color";a(this).find("a").attr("class",b)}).mouseout(function(){var b="mouseon_color",b=a(this).find("b").hasClass("curr")?"mouseon_color_on":"mouseon_color";a(this).find("a").removeClass(b)})});j.focus(function(){clearTimeout(b.clearSubjectTimer);if(e(j.val().trim().encodeHTML()))j.val(""),oWrite.isDefaultSubject=!1});for(o=0;o<n;o++)(function(d){a("#subjectColor ul li")[d].onclick=function(){j.css("color",k[d].value);
parent.gMain.curColor=k[d].val;a(".mouseon_color_on").removeClass("mouseon_color_on");a(".curr").removeClass("curr");a(this).find("a").attr("class","mouseon_color_on");a(this).find("b").addClass("curr");e(j.val().trim().encodeHTML())&&j.val(parent.Lang.Mail.tips010);j.val().trim()==""&&j.val(parent.Lang.Mail.tips010);c(d);clearTimeout(b.clearSubjectTimer);if(e(j.val().trim().encodeHTML()))j.val(parent.Lang.Mail.tips010),b.clearSubjectTimer=setTimeout(function(){j.val("");oWrite.isDefaultSubject=!1},
5E3)}})(o)})(jQuery);o.onclick=function(){if(o.innerHTML.trim()==z){var a=jQuery("#recipient_container input")[0];o.innerHTML=D;j.innerHTML=z;l.innerHTML=v;h.style.display="none";k.style.display="none";j.parentNode.style.padding="0";a.focus();b.focusId=a.id;b.richInputBox=b.ribs[0];b.isLookAllAsSingle=!0;jQuery("#recipient_person").unbind("click").bind("click",e);a=b.ribs[0].getItems();b.originalRecipient=a;b.originalCC=b.ribs[1].getItems();b.originalSCC=b.ribs[2].getItems();if(b.isCC){var c=b.ribs[1].getItems();
if(c&&c.length)for(var a=0,d=c.length;a<d;a++)c[a].remove(),b.ribs[0].insertItem(c[a].allText)}if(b.isSCC&&(c=b.ribs[2].getItems())&&c.length){a=0;for(d=c.length;a<d;a++)c[a].remove(),b.ribs[0].insertItem(c[a].allText)}}else{a=[];d=p;c=u;if(b.isCC)d=s,h.style.display="";if(b.isSCC)c=B,k.style.display="";a.push('<a id="ccLink" href="javascript:fGoto();" title="'+parent.Lang.Mail.tips011+'" class="ws-font">'+d+"</a>");a.push("&nbsp;&nbsp; - &nbsp;&nbsp;");a.push('<a id="sccLink" href="javascript:fGoto();" title="'+
parent.Lang.Mail.tips012+'" class="ws-font">'+c+"</a>");o.innerHTML=z;j.innerHTML=q;j.parentNode.style.padding="0 10px 0 3px";l.innerHTML=a.join("");C();b.isLookAllAsSingle=!1;var c=b.ribs[0].getItems(),f=b.originalCC,g=b.originalSCC,n=b.originalRecipient.concat(f).concat(g),t={},r=[];if(n&&n.length){a=0;for(d=n.length;a<d;a++)t[n[a].allText]=1}if(c&&c.length){a=0;for(d=c.length;a<d;a++)t.hasOwnProperty(c[a].allText)||r.push(c[a]),c[a].remove()}if(b.originalRecipient){a=0;for(d=b.originalRecipient.length;a<
d;a++)b.ribs[0].insertItem(b.originalRecipient[a].allText)}if(r&&r.length){a=0;for(d=r.length;a<d;a++)b.ribs[0].insertItem(r[a].allText)}if(f){a=0;for(d=f.length;a<d;a++)b.ribs[1].insertItem(f[a].allText)}if(g){a=0;for(d=g.length;a<d;a++)b.ribs[2].insertItem(g[a].allText)}}b.needAutoSave=!0;b.setSize()};C();if(this.ribs[0]&&this.ribs[0]instanceof RichInputBox)this.ribs[0].textbox.onkeyup=function(){if(b.personErrTips&&b.personErrTips instanceof ToolTips)b.personErrTips.close(),b.personErrTips=null};
$("txtsubject").onkeydown=function(a){if(b.titleErrTips&&b.titleErrTips instanceof ToolTips)b.titleErrTips.close(),b.titleErrTips=null;b.needAutoSave=!0;b.changed=!0;if((a=parent.EV.getEvent(a))&&parent.EV.getCharCode(a)==9&&!a.shiftKey)parent.EV.stopEvent(a),Editor.body.focus()};$("txtsubject").onclick=function(){if(b.titleErrTips&&b.titleErrTips instanceof ToolTips)b.titleErrTips.close(),b.titleErrTips=null};$("trAttach").style.display="";if($("aattach"))$("aattach").style.display="";if($("flashplayer"))$("flashplayer").style.display=
"";var x={checkForbidden:function(a){b.encryptMail&&b.encryptMailClass&&(a=="1"?(b.encryptMailClass.clearPwd(),b.encryptMailClass.hideTips(),b.encryptMailClass.control.chkbox.attr("disabled","true"),b.encryptMailClass.control.chkbox.attr("title","\u60a8\u5df2\u9009\u62e9\u7981\u6b62\u8f6c\u53d1\uff0c\u4e0d\u80fd\u540c\u65f6\u7ed9\u90ae\u4ef6\u8bbe\u7f6e\u5bc6\u7801")):(b.encryptMailClass.control.chkbox.removeAttr("disabled"),b.encryptMailClass.control.chkbox.attr("title","\u7ed9\u90ae\u4ef6\u8bbe\u7f6e\u5bc6\u7801")))},
checkEncrypt:function(a){if(a){if(GC.check("MAIL_INBOX_FORWARD"))a=jQuery("#chkForbiddenForward"),b.denyForward="0",a[0].checked=!1,a.attr("disabled","true"),a.attr("title","\u60a8\u5df2\u9009\u62e9\u7ed9\u90ae\u4ef6\u8bbe\u7f6e\u5bc6\u7801\uff0c\u4e0d\u80fd\u540c\u65f6\u518d\u9009\u62e9\u7981\u6b62\u8f6c\u53d1")}else GC.check("MAIL_INBOX_FORWARD")&&(a=jQuery("#chkForbiddenForward"),a.removeAttr("disabled"),a.attr("title","\u8bbe\u7f6e\u7981\u6b62\u8f6c\u53d1\u8be5\u90ae\u4ef6"))}};if(GC.check("MAIL_INBOX_FORWARD")){var A=
$("chkForbiddenForward");if(A)A.onclick=function(){jQuery("#writer_func_container").css("zIndex",3E3);var a=$("denyForwardTips");if(a){var c=parent.El.height(a),d=$("chkForbiddenForward").offsetLeft;c&&(c=-c+"px");a.style.top=c;jQuery(a).css("left",d-107.5+6+"px")}a=this.checked?"1":"0";if((top.gMain.denyForwardTips==""||top.gMain.denyForwardTips=="1")&&a=="1")$("writer_func_container"),$("denyForwardTips").style.display="block",b.topTips(jQuery("#denyForwardTips")),$("denyForward_close").onclick=
function(){b.denyForwardClose();b.reRender()},b.reRender(),b.denyForwardPanelShown=!0;b.denyForward=a;x.checkForbidden(a)}}if(b.encryptMail){var n;b.encryptMailClass=n={init:function(){this.control={chkbox:jQuery("#chkSetPassword"),panel:jQuery("#encryptMailPanel"),pwd:jQuery("#encryptMail_pwd"),repwd:jQuery("#encryptMail_repwd"),pwdError:jQuery("#encryptMail_pwd_error"),repwdError:jQuery("#encryptMail_repwd_error"),btnOk:jQuery("#encryptMail_ok"),btnCancel:jQuery("#encryptMail_cancel"),tips_container:jQuery("#encryptMailTips"),
tips_lookup:jQuery("#encryptMailLookPassword"),tips_cancel:jQuery("#encryptMailClearPassword"),tips_pwd:jQuery("#encryptMailPwd"),funcContainer:jQuery("#writer_func_container")};this.pwd="";this.initEvent()},initEvent:function(){var a=this;this.control.chkbox.unbind("click").bind("click",function(){var b=jQuery(this)[0].checked;jQuery("#writer_func_container").css("zIndex",3E3);b?a.showPanel():(a.hidePanel(),n.control.chkbox[0].checked=!1,n.hideTips());x.checkEncrypt(b)});this.control.btnCancel.unbind("click").bind("click",
function(){a.hidePanel()});this.control.btnOk.unbind("click").bind("click",function(){a.checkPassword()&&(parent.CC.showMsg(parent.Lang.Mail.tips013,!0,!1,"option"),a.showTips(),a.hidePanel(),parent.GE&&(parent.GE["smsPwd_"+oWrite.composeId]=n.pwd.encodeHTML()))});this.control.tips_lookup.unbind("click").bind("click",function(){a.showPassword()});this.control.tips_cancel.unbind("click").bind("click",function(){a.clearPwd();a.hideTips()})},showPanel:function(){n.control.panel.show();b.topTips(n.control.panel);
b.setSize();b.reRender();b.encryptPanelShown=!0},hidePanel:function(){n.control.panel.hide();b.setSize();b.encryptPanelShown=!1},showTips:function(){n.control.tips_container.show();b.setSize()},hideTips:function(){n.control.tips_container.hide();b.setSize()},clearPwd:function(){n.pwd="";n.control.pwd.val("");n.control.repwd.val("");n.hidePanel();n.clearError();n.control.chkbox[0].checked=!1;x.checkEncrypt(!1);parent.GE["smsPwd_"+oWrite.composeId]=""},showPassword:function(){n.updatePassword();n.control.tips_pwd.show();
n.control.tips_lookup.html(parent.Lang.Mail.tips014).unbind("click").bind("click",function(){n.hidePassword()})},hidePassword:function(){n.control.tips_pwd.hide();n.control.tips_lookup.html(parent.Lang.Mail.tips015).unbind("click").bind("click",function(){n.showPassword()})},updatePassword:function(){n.control.tips_pwd.html(parent.Lang.Mail.tips016+"\uff1a"+n.pwd.encodeHTML())},clearError:function(){n.control.pwdError.html("");n.control.repwdError.html("")},restorePassword:function(a){n.control.chkbox[0].checked=
!0;n.pwd=a;n.control.pwd.val(a);n.control.repwd.val(a);n.showTips();n.showPassword();x.checkEncrypt(!0)},checkPassword:function(){var a=n.control.pwd.val().trim(),b=n.control.repwd.val().trim();n.clearError();if(a=="")return n.control.pwdError.html(parent.Lang.Mail.tips017),n.showPanel(),n.control.pwd.focus(),!1;if(b!=a)return n.control.repwdError.html(parent.Lang.Mail.tips018),n.showPanel(),n.control.repwd.focus(),!1;n.pwd=a;n.updatePassword();return!0}};n.init()}try{var w=jQuery("#recipient_container input")[0];
w.focus();b.focusId=w.id;b.doTextFocus(b.focusId);b.richInputBox=ribs[0]}catch(E){}b.getFilterKeyWords();oWrite.setSize();var r=jQuery("#disk_transform_action"),y=!1;if(r){var t=parent.El.getSize(jQuery("#trAttach th")[0]),t=t?t.width+9:62;r.bind("mouseover",function(a){jQuery("#composeBarHai").css("zIndex",3E3);var b=parent.El.pos(r[0]);y=!0;b&&b[0]&&jQuery("#transform_panel").css("left",b[0]-t+"px");jQuery("#transform_panel").show("normal",function(){jQuery("#transform_disk").unbind("click").bind("click",
function(){(new parent.DiskDialog).create(attach.tempDiskCall,0);jQuery("#transform_panel").hide()});jQuery("#transform_tempDisk").unbind("click").bind("click",function(){(new parent.DiskDialog).create(attach.tempDiskCall,1);jQuery("#transform_panel").hide()})});parent.EV.stopPropagation(a)}).bind("mouseout",function(){y=!1;jQuery("#composeBarHai").css("zIndex",3E3)});jQuery("#transform_panel").hover(function(){jQuery("#composeBarHai").css("zIndex","3000");y=!0},function(){y=!1;jQuery("#composeBarHai").css("zIndex",
"3000")}).bind("mousemove",function(a){parent.EV.stopPropagation(a)});jQuery(document).bind("mousemove",function(){y||jQuery("#transform_panel").hide()});jQuery(Editor.doc).bind("mousemove",function(){y||jQuery("#transform_panel").hide()})}(function(a){var b=a.browser,c=b.msie;b.opera?a(document).bind("keydown",function(a){if(a.ctrlKey&&a.which===86)return window.captureClipboard&&window.captureClipboard()}):a(c?document.body:document).bind(c?"beforepaste":"paste",function(){return window.captureClipboard&&
window.captureClipboard()})})(jQuery);parent.CC.power.offAutoDestroy()&&this.bindAutoDestroy(jQuery)},initQuickSubject:function(){var a=0;for(html="",data=this.quickSubject,me=this;a<data.length;a++)html+='<li><a href="javascript:;">'+data[a]+"</a></li>";jQuery("#dropQuickSubject").html(html).on("click","li > a",function(a){jQuery("#txtsubject").val(jQuery(this).text());clearTimeout(me.clearSubjectTimer);oWrite.isDefaultSubject=!1;jQuery("#dropQuickSubject").hide();a.stopPropagation()});jQuery("#btnQuickSubject").click(function(a){jQuery("#dropQuickSubject").is(":hidden")?
jQuery(this).css("zIndex","4000"):jQuery(this).css("zIndex","4090");jQuery("#dropQuickSubject").toggle();a.stopPropagation()});jQuery("#dropQuickSubject").mouseleave(function(){jQuery(this).hide();jQuery("#btnQuickSubject").css("zIndex","4000")});/msie 6/i.test(navigator.userAgent)&&jQuery("#btnQuickSubject").mouseover(function(){jQuery(this).parent().addClass("toolNew-on")}).mouseout(function(){jQuery(this).parent().removeClass("toolNew-on")});jQuery(document.body).click(function(a){jQuery("#dropQuickSubject").hide();
jQuery("#morewraphai").hide();a.stopPropagation()})},bindAutoDestroy:function(a){var b=this,c=a("#chkAutoDestroy"),d=a("#tipsAutoDestroy");c.change(function(){jQuery("#writer_func_container").css("zIndex",3E3);var e=c[0].offsetLeft;a(this).prop("checked")?(d.css("left",e-216+6+"px").show(),b.topTips(d)):(b.isAutoDestroy=!1,a("#autoDestroyMailTips").hide(),d.hide())});a("#btnAutoDestroyCancel").click(function(){b.isAutoDestroy=!1;a("#chkAutoDestroy").prop("checked",!1);d.hide()});a("#btnAutoDestroyOk").click(function(c){var f=
"";if(a("#ckbAutoDestroy").prop("checked"))f="\u8fd9\u662f\u4e00\u5c01\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u5bf9\u65b9\u9605\u8bfb\u5b8c\u540e\uff0c\u90ae\u4ef6\u5c06\u81ea\u52a8\u9500\u6bc1";else if(a("#ckbDaysDestroy").prop("checked")){f=~~a("#inputReadDays").val();if(!(f>=1&&f<=100))return a("#textReadDays").css("color","red"),c.preventDefault(),!1;f="\u8fd9\u662f\u4e00\u5c01\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u5bf9\u65b9\u6536\u5230\u90ae\u4ef6"+f+"\u5929\u540e\uff0c\u90ae\u4ef6\u5c06\u81ea\u52a8\u9500\u6bc1"}else a("#chkAutoDestroy").prop("checked",
!1),b.isAutoDestroy=!1;if(f.length>0)b.isAutoDestroy=!0,a("#autoDestroyMailTips").html(f).show();d.hide()});a("#ckbAutoDestroy").change(function(){a(this).prop("checked")&&a("#ckbDaysDestroy").prop("checked",!1)});a("#ckbDaysDestroy").change(function(){a(this).prop("checked")&&a("#ckbAutoDestroy").prop("checked",!1)})},topTips:function(a){jQuery("#writer_func_container").find(".tipBox").css("zIndex",1);a.css("zIndex",2)},reRender:function(){document.body.style.zoom=1.1;document.body.style.zoom=""},
needToChangeZIndex:function(){var a=this.denyForwardPanelShown||!1;return!(this.encryptPanelShown||a)},denyForwardClose:function(){var a=$("denyForward_checkbox").checked?1:0;$("writer_func_container");var b=$("denyForwardTips");if(a)parent.gMain.denyForwardTips="0",this.ajaxRequest({func:"user:setAttrs",data:{_custom_denyForwardTips:"0"}});b.style.display="none";this.denyForwardPanelShown=!1},setHeight:function(){},autoSave:function(){if(oWrite.status==0)this.times++,this.isAutoSave=!0,this.saveDraftType=
"auto",this.doMailInfo(!0)},loadSendList:function(){$("selFrom");var a=$("showWriterCase"),b=$("writer_panel"),c=$("writer_sender_pop"),d=parent.gMain.trueName||"",e="",f=this.sendMaxLen,g=e="",j=[],h;d.length>this.sendMaxLen&&d.substring(0,f);e=this.sendList[0].value.encodeHTML();g=""+d+"&lt;"+e+"&gt;";if(this.sendList.length>1){a=0;for(f=this.sendList.length;a<f;a++)if(h=this.sendList[a],(e=h.value)&&parent.Email.match(e))g=d?"<strong>"+d+"</strong>&lt;"+e+"&gt;":e,h=h.isLoginName?' class="current"><i></i>':
"><i></i>",j.push('<li><a href="javascript:fGoto();" onclick="oWrite.setSender(this);" title="'+g.encodeHTML()+'"'+h+e.encodeHTML()+"</a></li>");j.push('<li class="line"></li>');j.push('<li><a href="javascript:fGoto();">'+Lang.Mail.Write.setDefaultSenderAndAlias+"</a></li>");c.innerHTML=j.join("");jQuery("#showWriterCase").bind("click",function(){var a=jQuery(b);a.show();var c=parent.El.getSize(a[0]);a.css({top:-c.height+"px",left:c.width-10+"px"})})}else jQuery(a).hide()},checkDenyForwardAttach:function(){var a=
0,b=!0,c,d=parent.Util.getSizeByByte(this.denyForwardMaxAttachSize,"M"),e=this.denyForwardAttachTypes,f=[];if(upload_module.model.composeAttachs.length>0)f=upload_module.model.composeAttachs;else if(attach.attachList.length>0)f=attach.attachList;else if(attach.data.length>0)f=attach.data;e.substr(0,1)!="|"&&(e="|"+e);e.substr(e.length-1)!="|"&&(e+="|");for(var g=0;g<f.length;g++)a+=f[g].fileSize,c="|"+this.getFileType(f[g].fileName)+"|",b&&e.indexOf(c)<=-1&&(b=!1);return!b?!1:d<a?!1:!0},clearRegString:function(a){for(var b=
/[\\\|\[\]\/\*\.\^\$\?\(\)]/ig,c=0,d=a.length;c<d;c++)a[c]=a[c].toString().replace(b,function(a){return"\\"+a});return a},clearHTMLKeyValue:function(a,b){var c;if(!b.length)return a;c=oWrite.clearRegString(b).join("|");return a.replace(RegExp("("+c+")\\s*=\\s*['\"]?[^'\"]+\u0002?","gi"),"")},highLightWords:function(a,b){var c=oWrite.highLightResult||{},d=oWrite.clearRegString(oWrite.highLightKeys).join("|");if(!a||d=="")return a;a=oWrite.clearHTMLKeyValue(a,["title","alt"]);d=d.replace(/\|\s*\|/g,
"|");d=d.replace(/\|+/g,"|");c.keys=c.keys||{};a=a.replace(RegExp('(<font color="?red"?>)?('+d+")(</font>)?","g"),function(a,d,g,j){c.keys[g]=1;return b?b:d&&j&&d!=""&&j!=""?a:'<font color="red">{0}</font>'.format(a)});oWrite.highLightResult=c;return a},mailNumError:function(a){(new ToolTips({id:"aaa",direction:ToolTips.direction.Bottom})).show(a.textbox,Lang.Mail.Write.addrCount.format(oWrite.toMaxNum))},setSender:function(a){var b=a.title;$("selFrom").innerHTML=b;jQuery("#writer_sender_pop a").removeClass("current");
parent.El.addClass(a,"current");jQuery("#writer_panel").hide()},loadSubjectList:function(){},refreshAddr:function(){oWrite.al&&oWrite.al.init(!0);oWrite.initAutoFill()},initAutoFill:function(){},getFilterKeyWords:function(){var a=this;if(this.filterKeywords)parent.GE.highLightKeys?this.highLightKeys=parent.GE.highLightKeys:this.ajaxRequest({func:"spam:querySensitWord",url:"/RmWeb/mail",callback:function(b){if(b&&b.code=="S_OK"&&(b=b["var"],b.sensitWords&&b.sensitWords.length))parent.GE.highLightKeys=
a.highLightKeys=b.sensitWords},failback:function(){}})},loadAddrList:function(){var a=[];contact.isShowValue=!1;contact.addAsGroup=!0;if(parent.CC.isRmAddr())contact.isAsyn=!1;contact.setValue=function(a,b){oWrite.selectMail(b,a+" <"+b+">")};contact.showLinkMan(a,"contact_addr_container");GC.check("CONTACTS_PER")&&a.push("5");GC.check("CONTACTS_ENT")&&parent.window.IsOA==0&&a.push("0");GC.check("CONTACTS_PER")&&a.push("2");parent.gMain.hideMailGroup!="1"&&a.push("3");$("searchDelete");var b=$("searchKey"),
c=parent.Lang.Mail.tips019;b.value=c;parent.EV.observe(b,"focus",function(){jQuery(b).val()==c&&(jQuery(b).val(""),jQuery(b).css("color","black"))});parent.EV.observe(b,"blur",function(){jQuery(b).val().trim()==""&&(jQuery(b).val(c),jQuery(b).css("color",""))});var d={div:"tab_search_div",setCall:this.selectMail,line:20,text:"searchKey",autocomplete:!0,noHideDiv:!0,statsCall:function(a){(a||0)==0?(jQuery("#searchDelete").removeClass("searchDelete"),$("tab_list_div").style.display="",$("tab_search_div").style.display=
"none"):(jQuery("#searchDelete").addClass("searchDelete"),$("tab_list_div").style.display="none",$("tab_search_div").style.display="")}};parent.LMD.fillEmail("searchKey",window,d);parent.EV.observe($("searchDelete"),"click",function(){$("searchKey").value=c;$("searchKey").style.color="";d.statsCall(0)})},seachDeptUser_asyn:function(a){var b={div:"tab_search_div",setCall:this.selectMail,line:20,noHideDiv:!0,autocomplete:!1,statsCall:function(a){(a||0)==0?(jQuery("#searchDelete").removeClass("searchDelete"),
$("tab_list_div").style.display="",$("tab_search_div").style.display="none"):(jQuery("#searchDelete").addClass("searchDelete"),$("tab_list_div").style.display="none",$("tab_search_div").style.display="")}},c=parent.AutoFill.datas.email;parent.MM.doService({url:"/addr/user",func:"addr:listUser",data:{key:a,depId:0,type:"2",paging:1,pageNo:0,pageSize:20,count:-1,letter:"",groupId:0},failCall:function(a){parent.CC.alert(a.summary)},call:function(a){for(var a=a["var"].list,e=0;e<a.length;e++)c.push({id:a[e].id,
name:a[e].userName,value:a[e].email,word:a[e].fullNameFullWord,fullword:a[e].fullNameWord});parent.AutoFill.datas.email=c;a=parent.LMD.fillEmail("searchKey",window,b);a.showList(a)},param:""})},loadDiskFiles:function(){var a=this.composeId;a&&attach.addDiskFiles(parent.GE.diskFiles[a])},getDefaultSign:function(){for(var a=this.signList,b=0;b<this.signList.length;b++)if(a[b].isDefault)return a[b].content;return""},setDefaultSign:function(){for(var a=this.signList,b=this.corpSignList,c=0;c<a.length;c++)if(a[c].isDefault){Editor.setDefaultSign(a[c]);
return}for(a=0;a<b.length;a++)if(b[a].isDefault){Editor.setDefaultSign(b[a]);break}},setSize:function(){var a=-5;isIE&&(a=0);upload_module_flash.isSupport();var b=parent.El.docHeight(window)-45-a;parent.El.docWidth(window);var c=$("encryptMailTips"),a=$("sourceEditor"),d=parent.El.height($("editorToolbar")),e=parent.El.height(c);parent.El.visible(c)||(e=0);var f=$("writeTop").offsetHeight+2,c=parent.El.height($("searchButton")),g=parent.El.height($("spanDefiniteTime")),j=parent.El.height($("compose_top_action")),
h=parent.El.height($("compose_bottom_action"));$("writeSidebar");var k=$("tabSwitch"),l=$("tab_li0_div"),o=$("tab_li1_div"),q=b-j-h;parent.El.visible($("spanDefiniteTime"))||(g=0);d=b-j-e-f-d-g-h-5;parent.El.height($("htmlEditor"),d);parent.El.height(a,d);d>250?(parent.El.height($("tab_search_div"),b-j-h-59-c),parent.El.height($("letterPaper"),b-j-h-45),parent.El.height($("addrList"),b-j-h-c-61),parent.El.height(l,q-e-37),parent.El.height(o,q-e-45)):(parent.El.height($("htmlEditor"),250),parent.El.height($("tab_search_div"),
358-c),parent.El.height($("letterPaper"),372),parent.El.height($("addrList"),380-c-23),parent.El.height(l,379),parent.El.height(o,372));parent.El.setStyle(k,{marginTop:parseInt(q/2)+"px"});$("formUpload");b=$("aattach");$("flashplayer");parent.El.getY(b);parent.El.width(a,$("writeContent").offsetWidth-10)},getComposeId:function(a){var b=oWrite;b.id?typeof a=="function"&&a.call(b,b.id):parent.MM.mailRequestApi({func:parent.gConst.func.getComposeId,data:null,method:"get",call:function(c){try{if(c.code==
"S_OK"){if(!oWrite.id)oWrite.isNewCreate=!0,oWrite.setDefaultSign(),oWrite.oldData=oWrite.getCurrData(),oWrite.id=c["var"];typeof a=="function"&&a.call(b,oWrite.id)}}catch(d){}},failCall:function(){},msg:""})},loadMailInfo:function(){function a(){parent.MM.mailRequestApi({func:f,data:d,call:function(a){try{if(a.code=="S_OK")oWrite.id=a["var"].id,attach.init(oWrite.id),b.initData=a["var"],b.pageLoaded=!0,b.fillMailData(),b.firstLoad=!1,oWrite.oldData=oWrite.getCurrData()}catch(c){parent.ch("loadMailInfo error."+
c)}},failCall:function(){},msg:""})}var b=this,c=this.mid,d={},e=!0,f=this.funcid,g=this.msg,j=decodeURI(this.to),h=this.tid,e=parent.gConst.func,k=this.withAttachments,g=decodeURIComponent(g),g=g.encodeHTML();switch(f){case e.compose:e=!1;b.initData={to:j,saveSentCopy:parent.CC.getSentSaveDefault(),headers:{color:parent.gMain.curColor||0},content:g};h?(oWrite.id=h,attach.init(h)):b.getComposeId(function(a){attach.init(a)});b.pageLoaded=!0;b.fillMailData();b.firstLoad=!1;break;case e.reply:d={mid:c,
toAll:0};if(k)d.withAttachments=k;e=b.isReply=!0;break;case e.replyAll:f=e.reply;d={mid:c,toAll:1};if(k)d.withAttachments=k;e=b.isReplyAll=!0;break;case e.forward:d={ids:[c],mode:"quote"};e=b.isForward=!0;if(CC.isSecurityMail()){CC.getSmailNoVerify(c,function(b){if(b["var"])d.smailNoVerify=b["var"].smailNoVerify,a()});return}break;case "forwardMore":f=e.forward;d={ids:parent.MM.folder.data,mode:"attach"};e=b.isForwardAll=!0;if(CC.isSecurityMail()){CC.getSmailNoVerify(c,function(b){if(b["var"])d.smailNoVerify=
b["var"].smailNoVerify,a()});return}break;case "mbox:restoreDraft":d={mid:c};b.dragId=c;e=b.isDrag=!0;break;case "mbox:editMessage":d={mid:c};e=b.isDrag=!0;break;default:e=!1,b.firstLoad=!1}e&&a()},doSubjectClick:function(){$("txtsubject").value=this.sysSubject[this.subIndex];this.subIndex++;if(this.subIndex>=this.sysSubject.length)this.subIndex=0},showSubjectList:function(){parent.El.show($("dvSubject"));var a=parent.EV.getEvent()||window.event;parent.EV.stopEvent(a)},setSubject:function(a){$("txtsubject").value=
a.innerHTML;parent.El.hide($("dvSubject"))},initTimeSend:function(a){var b=$("chkDefiniteTime"),c=$("spanDefiniteTime"),d=[],e=new Date,f=null,g=this;a&&a>0&&(f=new Date(parseInt(a,10)*1E3));var j=e.getFullYear(),h=e.getMonth()+1,k=e.getDate(),l=j,o=h,q=dm=m=0,h=this.getDays(j,h),q=e.getHours();dm=m=e.getMinutes();dm=Math.ceil(dm/10)*10;dm>50&&(dm=0,e=e.addMilliseconds(36E5),l=e.getFullYear(),o=e.getMonth()+1,k=e.getDate(),q=e.getHours());f&&(l=f.getFullYear(),o=f.getMonth()+1,k=f.getDate());f&&(q=
f.getHours(),dm=f.getMinutes());d.push('<a id="close_btn_definiteTime" href="javascript:fGoto();" class="i_t_close"><i></i></a>');d.push('<p class="m_clearfix"><select id="selYear">');for(e=j;e<j+5;e++)d.push('<option value="{0}" {1}>{2}</option>'.format(e,e==l?' selected="true"':"",e));d.push("</select><label for='selYear'>{0}</label>".format(Lang.Mail.Write.lb_timesend_year));d.push('<select id="selMonth">');for(e=1;e<13;e++)d.push('<option value="{0}" {1}>{2}</option>'.format(e,e==o?' selected="true"':
"",e));d.push("</select><label for='selMonth'>{0}</label>".format(Lang.Mail.Write.lb_timesend_month));d.push('<select id="selDay">');for(e=1;e<=h;e++)d.push('<option value="{0}" {1}>{2}</option>'.format(e,e==k?' selected="true"':"",e));d.push("</select><label for='selDay'>{0}</label>".format(Lang.Mail.Write.lb_timesend_day));d.push('<select id="selHour">');for(e=0;e<24;e++)d.push('<option value="{0}" {1}>{2}</option>'.format(e,e==q?' selected="true"':"",e));d.push("</select><label for='selHour'>{0}</label>".format(Lang.Mail.Write.lb_timesend_hour));
d.push('<select id="selMinute">');j=10;typeof timeInterval!="undefined"&&(j=timeInterval);for(e=0;e<60;e+=j)d.push('<option value="{0}" {1}>{2}</option>'.format(e,e==dm?' selected="true"':"",e));d.push("</select><label for='selMinute'>{0}</label>".format(Lang.Mail.Write.lb_timesend_minute));d.push("</p>");d.push('<p id="time_define_container" class="m_clearfix"></p>');c.innerHTML=d.join("");if(a>0)b.checked=!0,c.style.display="";$("close_btn_definiteTime").onclick=function(a){$("chkDefiniteTime").click();
parent.EV.stopEvent(a)};jQuery("#selYear, #selMonth, #selDay, #selHour, #selMinute").unbind("change").bind("change",function(){(jQuery(this).attr("id")=="selMonth"||jQuery(this).attr("id")=="selYear")&&oWrite.changeDays();g.setDefineTimeTips();g.needAutoSave=!0;g.changed=!0});g.setDefineTimeTips()},setDefineTimeTips:function(){var a=this.getDefinenationTime();(new Date).dateDiff(a.dateTime)>0?$("time_define_container").innerHTML=parent.Lang.Mail.tips020:$("time_define_container").innerHTML=Lang.Mail.Write.timingToSendTip.format('<strong id="definite_time_diff_tip">'+
oWrite.getMeaningfulDate(a.year,a.month,a.day,a.hour,a.minute)+"</strong>")},changeDays:function(){var a=document.getElementById("selDay");a.options.length=0;var b=new Date($("selYear").value,$("selMonth").value,0);for(i=1;i<=b.getDate();i++){var c=new Option(i,i);a.options.add(c)}},getDefinenationTime:function(){var a=$("selYear").options[$("selYear").options.selectedIndex].value,b=$("selMonth").options[$("selMonth").options.selectedIndex].value,c=$("selDay").options[$("selDay").options.selectedIndex].value,
d=$("selHour").options[$("selHour").options.selectedIndex].value,e=$("selMinute").options[$("selMinute").options.selectedIndex].value;return{dateTime:new Date(a+"/"+b+"/"+c+" "+d+":"+e+":00"),year:a,month:b,day:c,hour:d,minute:e}},getMeaningfulDate:function(a,b,c,d,e){var f=new Date,g=f.getFullYear(),j=f.getMonth()+1,f=f.getDate(),a=parseInt(a),b=parseInt(b),c=parseInt(c),h=[];if(a>g)b>j?(h.push(a-g+Lang.Mail.Write.lb_timesend_year),c>=f?(h.push(b-j+Lang.Mail.Write.timesend_month),c>f&&(c-f<10&&h.push(Lang.Mail.Write.Zero),
h.push(c-f+Lang.Mail.Write.Day))):c<f&&(b-j-1>0&&h.push(b-j-1+Lang.Mail.Write.timesend_month),c+30-f<10&&h.push(Lang.Mail.Write.Zero),h.push(c+30-f+Lang.Mail.Write.Day))):(b==j?c<f?(a-g-1>0&&h.push(a-g-1+Lang.Mail.Write.lb_timesend_year),h.push("11"+Lang.Mail.Write.timesend_month)):h.push(a-g+Lang.Mail.Write.lb_timesend_year):(a-g-1>0&&h.push(a-g-1+Lang.Mail.Write.lb_timesend_year),c<f?b+12-j-1>0&&h.push(b+12-j-1+Lang.Mail.Write.timesend_month):h.push(b+12-j+Lang.Mail.Write.timesend_month)),c<f&&
(c+=30),c>f&&(c-f<10&&h.push(Lang.Mail.Write.Zero),h.push(c-f+Lang.Mail.Write.Day))),h.push(Lang.Mail.Write.After);else{if(a<g)return"";if(b<j)return"";else if(b==j){if(c<f)return"";c==f?h.push(Lang.Mail.Write.Today):c-f==1?h.push(Lang.Mail.Write.Tomorrow):c-f==2?h.push(Lang.Mail.Write.afterTomorrow):h.push(c-f+Lang.Mail.Write.Day+Lang.Mail.Write.After)}else c>f?(h.push(b-j+Lang.Mail.Write.timesend_month),c-f<10&&h.push(Lang.Mail.Write.Zero),h.push(c-f+Lang.Mail.Write.Day+Lang.Mail.Write.After)):
c==f?h.push(b-j+Lang.Mail.Write.timesend_month+Lang.Mail.Write.After):b-j-1>0?(h.push(b-j-1+Lang.Mail.Write.timesend_month),c+30-f<10&&h.push(Lang.Mail.Write.Zero),h.push(c+30-f+Lang.Mail.Write.Day+Lang.Mail.Write.After)):c+30-f==1?h.push(Lang.Mail.Write.Tomorrow):c+30-f==2?h.push(Lang.Mail.Write.afterTomorrow):h.push(c+30-f+Lang.Mail.Write.Day+Lang.Mail.Write.After)}h.push(d+":"+("0"+e).right(2));return h.join("")},getDays:function(a,b){var c=new Date;c.setFullYear(a);c.setDate(1);c.setMonth(b);
c.setDate(0);return c.getDate()},getDefiniteTime:function(){return $("chkDefiniteTime").checked?(new Date($("selYear").value,$("selMonth").value-1,$("selDay").value,$("selHour").value,$("selMinute").value)).getTime()/1E3:0},showDefiniteTime:function(){var a=$("chkDefiniteTime");$("spanDefiniteTime").style.display=a.checked?"":"none";this.changed=this.needAutoSave=!0;this.setSize()},doMailInfo:function(a,b){function c(){return e.isSchedule&&(new Date).dateDiff(e.getDefinenationTime().dateTime)>0?(CC.alert(parent.Lang.Mail.tips020),
parent.CC.hideMsg(),!1):!0}function d(b){j.join(",");var c=$("selFrom").getAttribute("value")||this.userNumber,d=0,f=jQuery("#numberSign"),g=jQuery("#numberEncrypt");f.is(":checked")&&g.is(":checked")?d=3:f.is(":checked")?d=1:g.is(":checked")&&(d=2);parent.CC.writeUserAttributesToServer({cruAliasName:c});c=((parent.gMain.trueName||"").encodeHTML()+"&lt;"+c+"&gt;").decodeHTML().replace(/&#034;/g,"");u&&(p=q="");c={account:c,to:o,cc:q,bcc:p,showOneRcpt:u,isHtml:x,subject:s,content:v,priority:B,requestReadReceipt:D,
saveSentCopy:z,inlineResources:0,scheduleDate:A,denyForward:C,smailType:d,normalizeRfc822:0,id:oWrite.id||"",headers:{"X-RM-FontColor":parent.gMain.curColor||0}};if(w)c.keepFlag=w,c.keepDay=E,c.denyForward=1;parent.IsExtMail&&parent.gMain.mailId!=parent.gMain.uid?(c.isCommonUser=1,c.sender=parent.gMain.mailId+"@"+parent.gMain.domain):c.isCommonUser=0;if(e.dragId)c.mid=e.dragId;if(e.omid)c.omid=e.omid;if(e.filterKeywords&&e.sendWay){d=[];f=[];c.sendWay=e.sendWay;if(e.sendWay==2)c.encryptCode=e.encryptCode;
if(e.highLightKeysForLog){for(var h in e.highLightKeysForLog.title)f.push(h);f.length&&d.push("1:"+f.join(","));f.length=0;for(h in e.highLightKeysForLog.content)f.push(h);f.length&&d.push("2:"+f.join(","));f.length=0;for(h in e.highLightKeysForLog.attach)f.push(h);f.length&&d.push("3:"+f.join(","));c.hitKeywords=d.join("&")}}if(e.encryptMail&&e.sendWay&&e.sendWay==3)c.sendWay=e.sendWay,c.encryptCode=e.encryptCode;if(Plugins.able("securityMail"))c.securityLevel=Plugins.find("securityMail").result.level;
if(!a&&parent.GE.diskFiles){h=[];if(d=parent.GE.diskFiles[oWrite.composeId])for(f=0;f<d.length;f++)d[f].isAttachForward||h.push(d[f]);if(h&&h.length>0){d='<div class="attrBody" style="border:2px solid #e9e9e9; margin-top:12px;">';d+='<h3 style="background:#e9e9e9; height:32px; line-height:32px; padding-left:10px; margin:0; color:#666; font-weight:bold; font-size:13px;">'+parent.gMain.trueName+parent.Lang.Mail.tips022+"</h3>";d+='<div class="attr-ul-wrap" style="padding:15px; background:#fff;">';d+=
"<ul id='disk_attach_file_list_for_readmail' style=\"padding:0; margin:0;list-style:none; overflow:hidden; zoom:1;\">";for(f=0;f<h.length;f++)if(g=h[f]){fileSize=g.size||0;var k="",l=g.name,n=g.shareTime?' <span style="font-size:12px;">('+g.shareTime+" "+parent.Lang.Mail.tips023+")</span>":"";l.indexOf(".")>0&&(k="."+e.getFileType(l),l=l.substring(0,l.lastIndexOf(".")));d+='<li style="float:left; margin:5px 45px 5px 0; border: 1px solid #fff; " file_name="{0}"><div style="position:relative; width:240px; padding:5px; overflow:hidden;" ><a href="{2}" target="_blank" style="float:left; display:block; padding:6px 4px 4px; margin-right:2px;"><img src="{3}" alt="{0}" style="border:none;" type="extral-img" /></a><dl style="margin:2px;overflow:hidden; zoom:1;"><dt style="font-size:12px;overflow: hidden; color:#333;" title="{0}({4})"><span style=\'overflow: hidden;text-overflow: ellipsis;white-space: nowrap;  display:inline-block; vertical-align:middle;\'>{5}</span>{6}<span style="color:#666;">({4})</span></dt><dd style=" margin:0;"><a href="{2}" target="_blank" style="color: #014282;text-decoration: none; font-size:12px;">{1}</a>{7}</dd></dl></div></li>'.format(g.name,
Lang.Mail.Write.download,g.url,e.getFileImg(g.name),e.formatSize(fileSize),l.left(10,!0),k,n)}d+="</ul>";d+="</div></div>";h=/<DIV\s*id="divsignature">/i;h.test(v)?v=v.replace(h,d+"<DIV id='divsignature'>"):v+=d;c.content=v}}e.sendMail(c,a,b);return!0}var e=this,f=!0,g=$("selFrom"),j=[],h=$("rib_input_1"),k=$("rib_input_2"),l=$("rib_input_3"),o="",q="",p="",s=oWrite.isDefaultSubject?"":$("txtsubject").value.trim(),u=e.isLookAllAsSingle?1:0,B=$("chkUrgent").checked?parent.GE.priority.hight:parent.GE.priority.common,
D=$("chkReceipt").checked?1:0,z=$("chkSaveToSentBox").checked?1:0,v=Editor.getEditorValue().replace(/<span[^<]+class=['"]?errorWord['"]?[^>]+>([^<]*)<\/span\s*>/gi,"$1")||"",C=e.denyForward,x=Editor.getEditorMode()?1:0,A=this.getDefiniteTime();e.isSchedule=A>0?!0:!1;g.getAttribute("value").decodeHTML();g=g="";if(e.ribs[0])for(var n in e.ribs[0].items)g=e.ribs[0].items[n].allText,o+=g+";";if(e.isCC&&e.ribs[1])for(n in e.ribs[1].items)g=e.ribs[1].items[n].allText,q+=g+";";if(e.isSCC&&e.ribs[2])for(n in e.ribs[2].items)g=
e.ribs[2].items[n].allText,p+=g+";";var w,E;e.isAutoDestroy&&(jQuery("#ckbAutoDestroy").prop("checked")?w=2:jQuery("#ckbDaysDestroy").prop("checked")&&(w=1,E=jQuery("#inputReadDays").val()));if(a)return d(b);else{if(e.isAutoDestroy&&jQuery("#attachContainer").find(".zz_comb").length>0)return parent.CC.alert("\u4e3a\u4e86\u4fdd\u8bc1\u90ae\u4ef6\u53ca\u9644\u4ef6\u7684\u5b89\u5168\u6027\uff0c\u81ea\u9500\u6bc1\u90ae\u4ef6\u4e0d\u5141\u8bb8\u6dfb\u52a0\u9644\u4ef6\uff0c\u8bf7\u60a8\u5220\u9664\u9644\u4ef6\u540e\u518d\u53d1\u9001\u3002",
null,"\u7cfb\u7edf\u63d0\u793a"),parent.CC.hideMsg(),!1;if(e.ribs[0].getErrorText())return l=new ToolTips({id:"recepitent_tips",direction:ToolTips.direction.Bottom}),l.show($("rib_input_1"),parent.Lang.Mail.tips021),parent.CC.hideMsg(),f=!1,e.personErrTips=l,!1;if(h=e.checkMail(o,h,Lang.Mail.Write.Receiper)){n=0;for(var r=h.length;n<r;n++)g=MailTool.getName(h[n]),g.length>20&&(h[n]=h[n].replace(g,g.substr(0,20)));j=j.concat(h);o=h.join(",");if(k=e.checkMail(q,k,Lang.Mail.Write.titleCS)){n=0;for(r=
k.length;n<r;n++)g=MailTool.getName(k[n]),g.length>20&&(k[n]=k[n].replace(g,g.substr(0,20)));j=j.concat(k);q=k.join(",");if(l=e.checkMail(p,l,Lang.Mail.Write.titleMS)){n=0;for(r=l.length;n<r;n++)g=MailTool.getName(l[n]),g.length>20&&(l[n]=l[n].replace(g,g.substr(0,20)));j=j.concat(l);p=l.join(",");if(j.length==0||h.length==0)return l=new ToolTips({id:"recepitent_tips",direction:ToolTips.direction.Bottom}),l.show($("rib_input_1"),Lang.Mail.Write.receiperAddr),RichInputBox.Tool.blinkBox(jQuery("#recipient_container div:first"),
"blinkColor"),parent.CC.hideMsg(),e.personErrTips=l,f=!1;parent.GE&&(parent.GE["recipients_"+oWrite.composeId]=j);if(j.length>this.toMaxNum){l=new ToolTips({id:"recepitent_tips",direction:ToolTips.direction.Bottom});l.show($("rib_input_1"),Lang.Mail.Write.addrCount.format(this.toMaxNum));parent.CC.hideMsg();e.personErrTips=l;if(e.titleErrTips&&e.titleErrTips instanceof ToolTips)e.titleErrTips.close(),e.titleErrTips=null;return f=!1}if(!c())return f=!1;if(s=="")return l=new ToolTips({id:"subject_tips",
type:ToolTips.type.Confirm,ok:function(){if(!c())return f=!1;s=Lang.Mail.Write.comeFrom+":"+oWrite.userNumber;f=!0;oWrite.doBtnStatus(!0,WriteState.send);d(b)},cancel:function(){$("txtsubject").focus()}}),l.show($("txtsubject"),Lang.Mail.Write.confirmTitle),RichInputBox.Tool.blinkBox(jQuery("#dvSubject").parent(),"blinkColor"),parent.CC.hideMsg(),e.titleErrTips=l,f=!1;if(f)return d(b)}}}}},formatSize:function(a,b){return parent.Util.formatSize(a,null,b||2)},doSend:function(a){var b=/\u9644\u4ef6/,
c=jQuery("#txtsubject").val(),d=Editor.getEditorValue();jQuery("#attachContainer").find(".uploadFile_name");(c.match(b)||d.match(b))&&jQuery("#attachContainer").find(".zz_comb").length==0?CC.confirm("\u60a8\u7684\u90ae\u4ef6\u4e2d\u63d0\u5230\u4e86\u9644\u4ef6\uff0c\u60a8\u53ef\u80fd\u5fd8\u8bb0\u6dfb\u52a0\u9644\u4ef6\uff0c\u662f\u5426\u7ee7\u7eed\u53d1\u9001\uff1f",function(){oWrite.confirmDoSend(a)}):oWrite.confirmDoSend(a)},confirmDoSend:function(){if(oWrite.doStatusMessage()){var a=window.mailSecurityOff||
"false";if(GC.check("MAIL_INBOX_SECURITY")==1&&a!="true"){a=0;Plugins.find("securityMail")&&Plugins.find("securityMail").result&&(a=Plugins.find("securityMail").result.level||0);if(a<0)return CC.showMsg("\u8bf7\u9009\u62e9\u90ae\u4ef6\u5bc6\u7ea7",!0,!1,"error"),!1;var b=["\u516c\u5f00","\u79d8\u5bc6","\u673a\u5bc6"],c=jQuery("#attachContainer").find(".uploadFile_name");if(c&&c.length>0)for(var d=0;d<c.length;d++){for(var e=c[d].innerHTML,f=-1,g=0;g<b.length;g++){var j=e.match(/\u516c\u5f00|\u79d8\u5bc6|\u673a\u5bc6/g);
if(!j||j.length!=1)return CC.showMsg('\u9644\u4ef6\u5bc6\u7ea7\u6807\u8bc6\u540e\u624d\u80fd\u53d1\u9001\uff0c\u9644\u4ef6\u540d\u9700\u5305\u542b"\u516c\u5f00"\u3001"\u79d8\u5bc6"\u6216"\u673a\u5bc6"\u4e2d\u7684\u4e00\u4e2a',!0,!1,"error"),!1;if(b[g]==j[0]){f=g;break}}if(f>a||f==-1)return CC.showMsg("\u9644\u4ef6\u5bc6\u7ea7\u4e0d\u80fd\u9ad8\u4e8e\u90ae\u4ef6\u5bc6\u7ea7,\u8bf7\u91cd\u65b0\u6807\u8bc6\u518d\u53d1\u9001",!0,!1,"error"),!1}}PageState==PageStateTypes.Uploading?parent.CC.alert(Lang.Mail.Write.notSendMail+
"!"):oWrite.denyForward==1&&!oWrite.checkDenyForwardAttach()?parent.CC.alert(('<div style="text-indent:2em; margin-bottom:12px;">'+parent.Lang.Mail.tips024+'</div><div style="text-indent:2em;">'+parent.Lang.Mail.tips025+"</div>").format(oWrite.denyForwardAttachTypes.replace(/\|/g,"\u3001"))):!oWrite.isShowBigAttachTips&&oWrite.denyForward==1&&parent.GE.diskFiles[oWrite.composeId]&&parent.GE.diskFiles[oWrite.composeId].length>0?CC.msgBox({id:"confirm_denyForward2",title:"\u7cfb\u7edf\u63d0\u793a",
type:"div",text:"<div style='padding:15px;'>\u60a8\u7684\u90ae\u4ef6\u90ae\u4ef6\u5f00\u542f\u4e86\u7981\u6b62\u8f6c\u53d1\u9009\u9879\uff0c\u542b\u6709\u8d85\u5927\u9644\u4ef6\u7684\u90ae\u4ef6\uff0c\u6536\u4ef6\u4eba\u53ef\u4ee5\u4e0b\u8f7d\u5e76\u8f6c\u53d1\u3002\u662f\u5426\u7ee7\u7eed\u53d1\u9001\uff1f</div>",changeStyle:!1,zindex:1090,dragStyle:1,width:400,buttons:[{text:Lang.Mail.Ok,clickEvent:function(){oWrite.isShowBigAttachTips=!0;oWrite.doSend()}},{text:Lang.Mail.Cancel,clickEvent:function(){},
isCancelBtn:!0}]}):oWrite.checkEncryptMail()?oWrite.encryptMailClass.checkPassword()&&oWrite.showEncryptConfirmDialog():oWrite.justSendMail()}},doSave:function(a){if(oWrite.doStatusMessage())if(PageState==PageStateTypes.Uploading)parent.CC.alert(Lang.Mail.Write.uploadWaiting+"!");else{typeof a=="object"?(this.saveDraftType="hand",parent.CC.showMsg(Lang.Mail.Write.savingToDraft,!1,!1,"loading")):this.saveDraftType="auto";this.doBtnStatus(!0,WriteState.save);try{if(this.checkEncryptMail()){if(this.encryptMailClass.checkPassword())this.sendWay=
3,this.encryptCode=this.encryptMailClass.pwd,this.doMailInfo(!0)||this.doBtnStatus(!1,WriteState.none)}else this.doMailInfo(!0)||this.doBtnStatus(!1,WriteState.none)}catch(b){}}},justSendMail:function(){var a=!1;if(this.plugins){for(var b=0;b<this.plugins.length;b++)Plugins.able(this.plugins[b].name)&&(a=!0,Plugins.find(this.plugins[b].name).sendBefore(oWrite));if(!a)oWrite.onlySendMail()}else oWrite.onlySendMail()},onlySendMail:function(){parent.CC.showMsg(Lang.Mail.Write.emailIsSendingNow,!1,!1,
"loading");this.doBtnStatus(!0,WriteState.send);try{this.doMailInfo()||this.doBtnStatus(!1,WriteState.none)}catch(a){}},checkEncryptMail:function(){return this.encryptMail?this.encryptMailClass&&this.encryptMailClass.control.chkbox[0].checked?!0:!1:!1},showConfirmDialog:function(){function a(a){return'<div style="padding: 0px 12px; line-height:24px;">'+a+"</div>"}function b(){var a=parent.Lang.Mail.tips032+"<br/>";a+=parent.Lang.Mail.tips033+'\uff1a<input type="password" id="security_password" class="" /><br/>';
a+=parent.Lang.Mail.tips034+'\uff1a<input type="password" id="security_repassword" class="" />';return a}var c=this,d={id:"confirm_filter_keywords",title:parent.Lang.Mail.Write.sysPrompt,text:a(parent.Lang.Mail.tips026),type:"text",zindex:10001,buttons:[{text:parent.Lang.Mail.tips027,clickEvent:function(){var a=jQuery("#txtsubject"),b=Editor.getEditorValue();Editor.setEditorValue(oWrite.highLightWords(b,"**"));a.val(oWrite.highLightWords(a.val(),"**"));oWrite.highLightResult.keys={}},"class":"n_btn mt_8"},
{text:parent.Lang.Mail.tips029,clickEvent:function(){c.isAutoDestroy?parent.CC.msgBox({id:"confirm-autodestroy",title:parent.Lang.Mail.Write.sysPrompt,type:"text",width:460,text:"\u60a8\u5df2\u7ecf\u8bbe\u7f6e\u4e86\u8be5\u90ae\u4ef6\u4e3a\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u4e0d\u5141\u8bb8\u6dfb\u52a0\u9644\u4ef6\uff0c\u800c\u90ae\u4ef6\u52a0\u5bc6\u540e\uff0c\u5c06\u4f1a\u4ee5\u9644\u4ef6\u5f62\u5f0f\u53d1\u9001\uff0c\u8bf7\u60a8\u53d6\u6d88\u81ea\u9500\u6bc1\u8bbe\u7f6e\u518d\u53d1\u9001",zindex:20011,
dragStyle:1,buttonType:"confirm",buttons:[{text:Lang.Mail.Cancel,clickEvent:function(){},isCancelBtn:!0}]}):parent.CC.alert(a(b()),function(){var a=jQuery("#security_password",parent.document).val(),b=jQuery("#security_repassword",parent.document).val();if(a.trim()=="")return alert(parent.Lang.Mail.tips017),!0;else if(a!=b)return alert(parent.Lang.Mail.tips031),!0;else c.sendWay=2,c.encryptCode=a,c.justSendMail()})},"class":"n_btn mt_8"}]};parent.CC.msgBox(d)},showEncryptConfirmDialog:function(){var a=
this;parent.CC.msgBox({id:"confirm_encrypt_mail",title:parent.Lang.Mail.Write.sysPrompt,text:'<div class="encript_popc"><i class="i-exclam" style=""></i>'+parent.Lang.Mail.tips035+""+parent.Lang.Mail.tips036+"</div>",type:"text",zindex:10001,buttons:[{text:parent.Lang.Mail.tips037,clickEvent:function(){a.sendWay=3;a.encryptCode=a.encryptMailClass.pwd;a.justSendMail()},"class":"n_btn mt_8"},{text:parent.Lang.Mail.tips038,clickEvent:function(){a.justSendMail()},"class":"n_btn mt_8"}]})},doStatusMessage:function(){if(oWrite.status==
1)CC.alert(Lang.Mail.Write.sendingMailWait);else if(oWrite.status==2)CC.alert(Lang.Mail.Write.saveingDraftWait);else return!0},doPreview:function(){window.open(parent.gConst.composeReviewUrl,"Preview","toolbar=no,menubar=no,location=no,resizable=yes,scrollbars=yes,menubar=no,width=800,height=600,top=30,left=50")},doBtnStatus:function(a,b){var c=$(oWrite.btnSendId),d=$(oWrite.btnSaveId),e=$(oWrite.btnCancelId),f=parent.$(CC.getCurLabId()+"_"+oWrite.btnSendId),g=parent.$(CC.getCurLabId()+"_"+oWrite.btnSaveId),
j=parent.$(CC.getCurLabId()+"_"+oWrite.btnCancelId);if(a){if(c&&c.disabled)c.disabled=!0;if(f&&f.disabled)f.disabled=!0;if(d&&d.disabled)d.disabled=!0;if(g&&g.disabled)g.disabled=!0;if(e&&e.disabled)e.disabled=!0;if(j&&j.disabled)j.disabled=!0;oWrite.status=b;oWrite.sendLock=window.setTimeout(function(){oWrite.status==WriteState.none&&oWrite.doBtnStatus(!1)},oWrite.unlockTime*1E3)}else{if(c&&c.disabled)c.disabled=!1;if(d&&d.disabled)d.disabled=!1;if(e&&e.disabled)e.disabled=!1;if(f&&f.disabled)f.disabled=
!1;if(g&&g.disabled)g.disabled=!1;if(j&&j.disabled)j.disabled=!1;oWrite.status=WriteState.none}},getFileImg:function(a){var b=parent.gMain.resourceRoot;b.length>=4&&b.substr(0,4).toLocaleLowerCase()!="http"&&(b=window.location.protocol+"//"+window.location.host+b);b+="/images/fileExt/";var a=this.getFileType(a),c="other",d={other:"other",tif:"jpg",txt:"txt",psd:"psd",rar:"rar","7z":"rar",zip:"rar",xml:"xml",html:"html",java:"other",fon:"ttf",jpg:"jpg",gif:"jpg",png:"jpg",bmp:"jpg",tiff:"jpg",mpeg:"jpg",
avi:"media",wmv:"media",mov:"media",mpg:"media",vob:"media",rmvb:"media",mp3:"mp3",wma:"mp3",wav:"mp3",asf:"mp3",mp4:"mp3",sis:"other",sisx:"other",cab:"other",doc:"doc",docx:"doc",pdf:"pdf",xls:"xls",xlsx:"xls",ppt:"ppt",pptx:"ppt",swf:"swf",fla:"swf",share:"other",upload:"upload",flv:"media",exe:"exe",css:"css",rm:"media",midi:"media",chm:"txt",iso:"iso",vsd:"other"};d.hasOwnProperty(a)&&(c=d[a]);return b+c+".png"},getFileType:function(a){a=a.toLowerCase();return a.indexOf(".")>0?a.substr(a.lastIndexOf(".")+
1):""},checkEmptyObject:function(a){for(var b in a)if(b&&a[b])return!1;return!0},checkMail:function(a,b){for(var c=parent.Email.get(a,!0),d=c.fail,c=c.success.toArray(),e=[],f="",g=0,j=c.length;g<j;g++)f=MailTool.getAddr(c[g]),f.length>59&&e.push(c[g]);return d.length>0?(d.join("<br>"),parent.CC.hideMsg(),d=new ToolTips({id:b.id,direction:ToolTips.direction.Bottom}),d.show(b,parent.Lang.Mail.tips039),!1):e.length>0?(e.join("<br>"),parent.CC.hideMsg(),d=new ToolTips({id:b.id,direction:ToolTips.direction.Bottom}),
d.show(b,parent.Lang.Mail.tips040),!1):c},dealSensitiveMail:function(){oWrite.highLightResult={};var a=jQuery("#txtsubject").val(),b=Editor.getEditorValue(),c=oWrite.highLightWords(b),d=[],e={},f={},g=parent.GE.diskFiles?parent.GE.diskFiles[oWrite.composeId]:[],j=attach.data;if(g&&g.length)for(var h=0;h<g.length;h++)d.push(g[h].name);if(j.length)for(h=0;h<j.length;h++)d.push(j[h].fileName);Editor.getEditorMode()||(c=b);Editor.setEditorValue(c);if(!oWrite.checkEmptyObject(oWrite.highLightResult)){e.content=
oWrite.highLightResult.keys;for(var k in e.content)f[k]=e.content[k];oWrite.highLightResult={}}oWrite.highLightWords(a);if(!oWrite.checkEmptyObject(oWrite.highLightResult)){e.title=oWrite.highLightResult.keys;for(k in e.title)f[k]=e.title[k];oWrite.highLightResult={}}if(d.length&&(oWrite.highLightWords(d.join(",")),!oWrite.checkEmptyObject(oWrite.highLightResult))){e.attach=oWrite.highLightResult.keys;for(k in e.attach)f[k]=e.attach[k];oWrite.highLightResult={}}oWrite.highLightResult={keys:f};oWrite.highLightKeysForLog=
e},updateStatus:function(){this.changed=this.needAutoSave=!0},composeFailCallback:function(a,b,c){var d="",c=c||0;this.doBtnStatus(!1,0);PageState=PageStateTypes.Common;var e=a.code;if(typeof isOpenSgcc!=="undefined"&&isOpenSgcc==="true"&&e==="FA_IS_SPAM_IP_CON_DENY")return this.sensConfirm(a),!1;switch(e){case "FA_ATTACH_EXCEED_LIMIT":d=Lang.Mail.Write.attachmentSize;break;case "FA_RECEIVER_EXCEED_LIMIT":d=Lang.Mail.Write.ReceiverLimit;break;case "FA_ID_NOT_FOUND":d=Lang.Mail.Write.composeid;break;
case "FA_FORBIDDEN":d=Lang.Mail.Write.forbidden;break;case "FA_OVERFLOW":d=Lang.Mail.Write.Overflow;break;case "FA_NO_RECEIPT":d=Lang.Mail.Write.NoReceipt;break;case "FA_WRONG_RECEIPT":d=Lang.Mail.Write.WrongReceipt;break;case "FA_INVALID_DATE":d=Lang.Mail.Write.noTime;break;case "FA_NEED_VERIFY_CODE":d=Lang.Mail.Write.needCode;break;case "FA_INVALID_VERIFY_CODE":d=Lang.Mail.Write.codeErr;break;case "FA_INVALID_ACCOUNT":d=Lang.Mail.Write.accountErr;break;case "FA_IS_SPAM":CC.alertNoSysClose("\u60a8\u53ef\u80fd\u6ca1\u6709\u6743\u9650\u7ed9\u6536\u4ef6\u4eba\u4e2d\u7684\u67d0\u4e2a\u7528\u6237\u53d1\u4fe1\uff0c\u8bf7\u68c0\u67e5\u540e\u53d1\u9001\u3002",
{},"\u7cfb\u7edf\u63d0\u793a");return;case "FA_INVALID_PARAMETER":d=Lang.Mail.Write.ParamErr;break;case "FA_FORBIDDEN_FORWARD_OUT_USER":d=Lang.Mail.tips041;break;case "FA_IS_SPAM_SENSIT_WORD":oWrite.dealSensitiveMail();oWrite.showConfirmDialog();return;default:d=a.summary||Lang.Mail.sysW}top.IsDebug&&(d+=" code:"+(e||"")+" msg:"+(a["var"]||a.summary||""));d=c?(this.isAutoSave?Lang.Mail.Write.autoSaveFail:Lang.Mail.Write.draftSaveFail)+","+d:d.replace(/\n/g,"<br />");CC.showMsg(d,!0,!1,"error");top.Util.writeLogError(top.gConst.logFunc.js,
b||"","method=oWrite.composeFailCallback.composeFailCallback | code="+e+" | summary="+d+(a["var"]||""))},sensConfirm:function(a){var b=this;CC.msgBox({id:"confirmSens",title:"\u7cfb\u7edf\u63d0\u793a",type:"text",width:460,text:"\u60a8\u5728\u529e\u516c\u533a\uff0c\u8bf7\u60a8\u4f7f\u7528\u5185\u7f51\u90ae\u7bb1\u7ed9\u57df\u5185\u7528\u6237\u53d1\u4fe1\uff0c\u662f\u5426\u6e05\u9664\u57df\u5185\u7528\u6237\uff1f",zindex:20011,dragStyle:1,buttonType:"confirm",buttons:[{text:Lang.Mail.Ok,clickEvent:function(){b.modInDomainItem(a)}},
{text:Lang.Mail.Cancel,clickEvent:function(){},isCancelBtn:!0}]})},modInDomainItem:function(a){var b="",c="",d="",e="",f;if(this.ribs[0]){for(f in this.ribs[0].items)b=this.ribs[0].items[f].allText,this.checkLocal(a,this.ribs[0].items[f].addr)||(c+=b+";");this.ribs[0].clear();this.ribs[0].insertItem(c)}if(this.isCC&&this.ribs[1]){for(f in this.ribs[1].items)b=this.ribs[1].items[f].allText,this.checkLocal(a,this.ribs[1].items[f].addr)||(d+=b+";");this.ribs[1].clear();this.ribs[1].insertItem(d)}if(this.isSCC&&
this.ribs[2]){for(f in this.ribs[2].items)b=this.ribs[2].items[f].allText,this.checkLocal(a,this.ribs[2].items[f].addr)||(e+=b+";");this.ribs[2].clear();this.ribs[2].insertItem(e)}},checkLocal:function(a,b){for(var c=a["var"].local,d=c.length,e=!1;d--;)c[d]===b&&(e=!0);return e},sendMail:function(a,b,c,d){var e=this,f=a.to,g=a.saveSentCopy;a.cc&&(f+=","+a.cc);a.bcc&&(f+=","+a.bcc);a.content="<style> p{margin:5px 0;} td p{margin:0;} table{border-collapse: collapse;}td,th{border:1px solid #DDD;padding: 5px 10px;} ol,ul{margin:0;pading:0;width:95%}li{clear:both;}li.list-cn-1-0{background-image:url(http://bs.baidu.com/listicon/list-cn-1-0.gif)}li.list-cn-1-1{background-image:url(http://bs.baidu.com/listicon/list-cn-1-1.gif)}li.list-cn-1-2{background-image:url(http://bs.baidu.com/listicon/list-cn-1-2.gif)}li.list-cn-1-3{background-image:url(http://bs.baidu.com/listicon/list-cn-1-3.gif)}li.list-cn-1-4{background-image:url(http://bs.baidu.com/listicon/list-cn-1-4.gif)}li.list-cn-1-5{background-image:url(http://bs.baidu.com/listicon/list-cn-1-5.gif)}li.list-cn-1-6{background-image:url(http://bs.baidu.com/listicon/list-cn-1-6.gif)}li.list-cn-1-7{background-image:url(http://bs.baidu.com/listicon/list-cn-1-7.gif)}li.list-cn-1-8{background-image:url(http://bs.baidu.com/listicon/list-cn-1-8.gif)}li.list-cn-1-9{background-image:url(http://bs.baidu.com/listicon/list-cn-1-9.gif)}li.list-cn-1-10{background-image:url(http://bs.baidu.com/listicon/list-cn-1-10.gif)}li.list-cn-1-11{background-image:url(http://bs.baidu.com/listicon/list-cn-1-11.gif)}li.list-cn-1-12{background-image:url(http://bs.baidu.com/listicon/list-cn-1-12.gif)}li.list-cn-1-13{background-image:url(http://bs.baidu.com/listicon/list-cn-1-13.gif)}li.list-cn-1-14{background-image:url(http://bs.baidu.com/listicon/list-cn-1-14.gif)}li.list-cn-1-15{background-image:url(http://bs.baidu.com/listicon/list-cn-1-15.gif)}li.list-cn-1-16{background-image:url(http://bs.baidu.com/listicon/list-cn-1-16.gif)}li.list-cn-1-17{background-image:url(http://bs.baidu.com/listicon/list-cn-1-17.gif)}li.list-cn-1-18{background-image:url(http://bs.baidu.com/listicon/list-cn-1-18.gif)}li.list-cn-1-19{background-image:url(http://bs.baidu.com/listicon/list-cn-1-19.gif)}li.list-cn-1-20{background-image:url(http://bs.baidu.com/listicon/list-cn-1-20.gif)}li.list-cn-1-21{background-image:url(http://bs.baidu.com/listicon/list-cn-1-21.gif)}li.list-cn-1-22{background-image:url(http://bs.baidu.com/listicon/list-cn-1-22.gif)}li.list-cn-1-23{background-image:url(http://bs.baidu.com/listicon/list-cn-1-23.gif)}li.list-cn-1-24{background-image:url(http://bs.baidu.com/listicon/list-cn-1-24.gif)}li.list-cn-1-25{background-image:url(http://bs.baidu.com/listicon/list-cn-1-25.gif)}li.list-cn-1-26{background-image:url(http://bs.baidu.com/listicon/list-cn-1-26.gif)}li.list-cn-1-27{background-image:url(http://bs.baidu.com/listicon/list-cn-1-27.gif)}li.list-cn-1-28{background-image:url(http://bs.baidu.com/listicon/list-cn-1-28.gif)}li.list-cn-1-29{background-image:url(http://bs.baidu.com/listicon/list-cn-1-29.gif)}li.list-cn-1-30{background-image:url(http://bs.baidu.com/listicon/list-cn-1-30.gif)}li.list-cn-1-31{background-image:url(http://bs.baidu.com/listicon/list-cn-1-31.gif)}li.list-cn-1-32{background-image:url(http://bs.baidu.com/listicon/list-cn-1-32.gif)}li.list-cn-1-33{background-image:url(http://bs.baidu.com/listicon/list-cn-1-33.gif)}li.list-cn-1-34{background-image:url(http://bs.baidu.com/listicon/list-cn-1-34.gif)}li.list-cn-1-35{background-image:url(http://bs.baidu.com/listicon/list-cn-1-35.gif)}li.list-cn-1-36{background-image:url(http://bs.baidu.com/listicon/list-cn-1-36.gif)}li.list-cn-1-37{background-image:url(http://bs.baidu.com/listicon/list-cn-1-37.gif)}li.list-cn-1-38{background-image:url(http://bs.baidu.com/listicon/list-cn-1-38.gif)}li.list-cn-1-39{background-image:url(http://bs.baidu.com/listicon/list-cn-1-39.gif)}li.list-cn-1-40{background-image:url(http://bs.baidu.com/listicon/list-cn-1-40.gif)}li.list-cn-1-41{background-image:url(http://bs.baidu.com/listicon/list-cn-1-41.gif)}li.list-cn-1-42{background-image:url(http://bs.baidu.com/listicon/list-cn-1-42.gif)}li.list-cn-1-43{background-image:url(http://bs.baidu.com/listicon/list-cn-1-43.gif)}li.list-cn-1-44{background-image:url(http://bs.baidu.com/listicon/list-cn-1-44.gif)}li.list-cn-1-45{background-image:url(http://bs.baidu.com/listicon/list-cn-1-45.gif)}li.list-cn-1-46{background-image:url(http://bs.baidu.com/listicon/list-cn-1-46.gif)}li.list-cn-1-47{background-image:url(http://bs.baidu.com/listicon/list-cn-1-47.gif)}li.list-cn-1-48{background-image:url(http://bs.baidu.com/listicon/list-cn-1-48.gif)}li.list-cn-1-49{background-image:url(http://bs.baidu.com/listicon/list-cn-1-49.gif)}li.list-cn-1-50{background-image:url(http://bs.baidu.com/listicon/list-cn-1-50.gif)}li.list-cn-1-51{background-image:url(http://bs.baidu.com/listicon/list-cn-1-51.gif)}li.list-cn-1-52{background-image:url(http://bs.baidu.com/listicon/list-cn-1-52.gif)}li.list-cn-1-53{background-image:url(http://bs.baidu.com/listicon/list-cn-1-53.gif)}li.list-cn-1-54{background-image:url(http://bs.baidu.com/listicon/list-cn-1-54.gif)}li.list-cn-1-55{background-image:url(http://bs.baidu.com/listicon/list-cn-1-55.gif)}li.list-cn-1-56{background-image:url(http://bs.baidu.com/listicon/list-cn-1-56.gif)}li.list-cn-1-57{background-image:url(http://bs.baidu.com/listicon/list-cn-1-57.gif)}li.list-cn-1-58{background-image:url(http://bs.baidu.com/listicon/list-cn-1-58.gif)}li.list-cn-1-59{background-image:url(http://bs.baidu.com/listicon/list-cn-1-59.gif)}li.list-cn-1-60{background-image:url(http://bs.baidu.com/listicon/list-cn-1-60.gif)}li.list-cn-1-61{background-image:url(http://bs.baidu.com/listicon/list-cn-1-61.gif)}li.list-cn-1-62{background-image:url(http://bs.baidu.com/listicon/list-cn-1-62.gif)}li.list-cn-1-63{background-image:url(http://bs.baidu.com/listicon/list-cn-1-63.gif)}li.list-cn-1-64{background-image:url(http://bs.baidu.com/listicon/list-cn-1-64.gif)}li.list-cn-1-65{background-image:url(http://bs.baidu.com/listicon/list-cn-1-65.gif)}li.list-cn-1-66{background-image:url(http://bs.baidu.com/listicon/list-cn-1-66.gif)}li.list-cn-1-67{background-image:url(http://bs.baidu.com/listicon/list-cn-1-67.gif)}li.list-cn-1-68{background-image:url(http://bs.baidu.com/listicon/list-cn-1-68.gif)}li.list-cn-1-69{background-image:url(http://bs.baidu.com/listicon/list-cn-1-69.gif)}li.list-cn-1-70{background-image:url(http://bs.baidu.com/listicon/list-cn-1-70.gif)}li.list-cn-1-71{background-image:url(http://bs.baidu.com/listicon/list-cn-1-71.gif)}li.list-cn-1-72{background-image:url(http://bs.baidu.com/listicon/list-cn-1-72.gif)}li.list-cn-1-73{background-image:url(http://bs.baidu.com/listicon/list-cn-1-73.gif)}li.list-cn-1-74{background-image:url(http://bs.baidu.com/listicon/list-cn-1-74.gif)}li.list-cn-1-75{background-image:url(http://bs.baidu.com/listicon/list-cn-1-75.gif)}li.list-cn-1-76{background-image:url(http://bs.baidu.com/listicon/list-cn-1-76.gif)}li.list-cn-1-77{background-image:url(http://bs.baidu.com/listicon/list-cn-1-77.gif)}li.list-cn-1-78{background-image:url(http://bs.baidu.com/listicon/list-cn-1-78.gif)}li.list-cn-1-79{background-image:url(http://bs.baidu.com/listicon/list-cn-1-79.gif)}li.list-cn-1-80{background-image:url(http://bs.baidu.com/listicon/list-cn-1-80.gif)}li.list-cn-1-81{background-image:url(http://bs.baidu.com/listicon/list-cn-1-81.gif)}li.list-cn-1-82{background-image:url(http://bs.baidu.com/listicon/list-cn-1-82.gif)}li.list-cn-1-83{background-image:url(http://bs.baidu.com/listicon/list-cn-1-83.gif)}li.list-cn-1-84{background-image:url(http://bs.baidu.com/listicon/list-cn-1-84.gif)}li.list-cn-1-85{background-image:url(http://bs.baidu.com/listicon/list-cn-1-85.gif)}li.list-cn-1-86{background-image:url(http://bs.baidu.com/listicon/list-cn-1-86.gif)}li.list-cn-1-87{background-image:url(http://bs.baidu.com/listicon/list-cn-1-87.gif)}li.list-cn-1-88{background-image:url(http://bs.baidu.com/listicon/list-cn-1-88.gif)}li.list-cn-1-89{background-image:url(http://bs.baidu.com/listicon/list-cn-1-89.gif)}li.list-cn-1-90{background-image:url(http://bs.baidu.com/listicon/list-cn-1-90.gif)}li.list-cn-1-91{background-image:url(http://bs.baidu.com/listicon/list-cn-1-91.gif)}li.list-cn-1-92{background-image:url(http://bs.baidu.com/listicon/list-cn-1-92.gif)}li.list-cn-1-93{background-image:url(http://bs.baidu.com/listicon/list-cn-1-93.gif)}li.list-cn-1-94{background-image:url(http://bs.baidu.com/listicon/list-cn-1-94.gif)}li.list-cn-1-95{background-image:url(http://bs.baidu.com/listicon/list-cn-1-95.gif)}li.list-cn-1-96{background-image:url(http://bs.baidu.com/listicon/list-cn-1-96.gif)}li.list-cn-1-97{background-image:url(http://bs.baidu.com/listicon/list-cn-1-97.gif)}li.list-cn-1-98{background-image:url(http://bs.baidu.com/listicon/list-cn-1-98.gif)}ol.custom_cn{list-style:none;}ol.custom_cn li{background-position:0 3px;background-repeat:no-repeat}li.list-cn-paddingleft-1{padding-left:25px}li.list-cn-paddingleft-2{padding-left:40px}li.list-cn-paddingleft-3{padding-left:55px}li.list-cn-2-0{background-image:url(http://bs.baidu.com/listicon/list-cn-2-0.gif)}li.list-cn-2-1{background-image:url(http://bs.baidu.com/listicon/list-cn-2-1.gif)}li.list-cn-2-2{background-image:url(http://bs.baidu.com/listicon/list-cn-2-2.gif)}li.list-cn-2-3{background-image:url(http://bs.baidu.com/listicon/list-cn-2-3.gif)}li.list-cn-2-4{background-image:url(http://bs.baidu.com/listicon/list-cn-2-4.gif)}li.list-cn-2-5{background-image:url(http://bs.baidu.com/listicon/list-cn-2-5.gif)}li.list-cn-2-6{background-image:url(http://bs.baidu.com/listicon/list-cn-2-6.gif)}li.list-cn-2-7{background-image:url(http://bs.baidu.com/listicon/list-cn-2-7.gif)}li.list-cn-2-8{background-image:url(http://bs.baidu.com/listicon/list-cn-2-8.gif)}li.list-cn-2-9{background-image:url(http://bs.baidu.com/listicon/list-cn-2-9.gif)}li.list-cn-2-10{background-image:url(http://bs.baidu.com/listicon/list-cn-2-10.gif)}li.list-cn-2-11{background-image:url(http://bs.baidu.com/listicon/list-cn-2-11.gif)}li.list-cn-2-12{background-image:url(http://bs.baidu.com/listicon/list-cn-2-12.gif)}li.list-cn-2-13{background-image:url(http://bs.baidu.com/listicon/list-cn-2-13.gif)}li.list-cn-2-14{background-image:url(http://bs.baidu.com/listicon/list-cn-2-14.gif)}li.list-cn-2-15{background-image:url(http://bs.baidu.com/listicon/list-cn-2-15.gif)}li.list-cn-2-16{background-image:url(http://bs.baidu.com/listicon/list-cn-2-16.gif)}li.list-cn-2-17{background-image:url(http://bs.baidu.com/listicon/list-cn-2-17.gif)}li.list-cn-2-18{background-image:url(http://bs.baidu.com/listicon/list-cn-2-18.gif)}li.list-cn-2-19{background-image:url(http://bs.baidu.com/listicon/list-cn-2-19.gif)}li.list-cn-2-20{background-image:url(http://bs.baidu.com/listicon/list-cn-2-20.gif)}li.list-cn-2-21{background-image:url(http://bs.baidu.com/listicon/list-cn-2-21.gif)}li.list-cn-2-22{background-image:url(http://bs.baidu.com/listicon/list-cn-2-22.gif)}li.list-cn-2-23{background-image:url(http://bs.baidu.com/listicon/list-cn-2-23.gif)}li.list-cn-2-24{background-image:url(http://bs.baidu.com/listicon/list-cn-2-24.gif)}li.list-cn-2-25{background-image:url(http://bs.baidu.com/listicon/list-cn-2-25.gif)}li.list-cn-2-26{background-image:url(http://bs.baidu.com/listicon/list-cn-2-26.gif)}li.list-cn-2-27{background-image:url(http://bs.baidu.com/listicon/list-cn-2-27.gif)}li.list-cn-2-28{background-image:url(http://bs.baidu.com/listicon/list-cn-2-28.gif)}li.list-cn-2-29{background-image:url(http://bs.baidu.com/listicon/list-cn-2-29.gif)}li.list-cn-2-30{background-image:url(http://bs.baidu.com/listicon/list-cn-2-30.gif)}li.list-cn-2-31{background-image:url(http://bs.baidu.com/listicon/list-cn-2-31.gif)}li.list-cn-2-32{background-image:url(http://bs.baidu.com/listicon/list-cn-2-32.gif)}li.list-cn-2-33{background-image:url(http://bs.baidu.com/listicon/list-cn-2-33.gif)}li.list-cn-2-34{background-image:url(http://bs.baidu.com/listicon/list-cn-2-34.gif)}li.list-cn-2-35{background-image:url(http://bs.baidu.com/listicon/list-cn-2-35.gif)}li.list-cn-2-36{background-image:url(http://bs.baidu.com/listicon/list-cn-2-36.gif)}li.list-cn-2-37{background-image:url(http://bs.baidu.com/listicon/list-cn-2-37.gif)}li.list-cn-2-38{background-image:url(http://bs.baidu.com/listicon/list-cn-2-38.gif)}li.list-cn-2-39{background-image:url(http://bs.baidu.com/listicon/list-cn-2-39.gif)}li.list-cn-2-40{background-image:url(http://bs.baidu.com/listicon/list-cn-2-40.gif)}li.list-cn-2-41{background-image:url(http://bs.baidu.com/listicon/list-cn-2-41.gif)}li.list-cn-2-42{background-image:url(http://bs.baidu.com/listicon/list-cn-2-42.gif)}li.list-cn-2-43{background-image:url(http://bs.baidu.com/listicon/list-cn-2-43.gif)}li.list-cn-2-44{background-image:url(http://bs.baidu.com/listicon/list-cn-2-44.gif)}li.list-cn-2-45{background-image:url(http://bs.baidu.com/listicon/list-cn-2-45.gif)}li.list-cn-2-46{background-image:url(http://bs.baidu.com/listicon/list-cn-2-46.gif)}li.list-cn-2-47{background-image:url(http://bs.baidu.com/listicon/list-cn-2-47.gif)}li.list-cn-2-48{background-image:url(http://bs.baidu.com/listicon/list-cn-2-48.gif)}li.list-cn-2-49{background-image:url(http://bs.baidu.com/listicon/list-cn-2-49.gif)}li.list-cn-2-50{background-image:url(http://bs.baidu.com/listicon/list-cn-2-50.gif)}li.list-cn-2-51{background-image:url(http://bs.baidu.com/listicon/list-cn-2-51.gif)}li.list-cn-2-52{background-image:url(http://bs.baidu.com/listicon/list-cn-2-52.gif)}li.list-cn-2-53{background-image:url(http://bs.baidu.com/listicon/list-cn-2-53.gif)}li.list-cn-2-54{background-image:url(http://bs.baidu.com/listicon/list-cn-2-54.gif)}li.list-cn-2-55{background-image:url(http://bs.baidu.com/listicon/list-cn-2-55.gif)}li.list-cn-2-56{background-image:url(http://bs.baidu.com/listicon/list-cn-2-56.gif)}li.list-cn-2-57{background-image:url(http://bs.baidu.com/listicon/list-cn-2-57.gif)}li.list-cn-2-58{background-image:url(http://bs.baidu.com/listicon/list-cn-2-58.gif)}li.list-cn-2-59{background-image:url(http://bs.baidu.com/listicon/list-cn-2-59.gif)}li.list-cn-2-60{background-image:url(http://bs.baidu.com/listicon/list-cn-2-60.gif)}li.list-cn-2-61{background-image:url(http://bs.baidu.com/listicon/list-cn-2-61.gif)}li.list-cn-2-62{background-image:url(http://bs.baidu.com/listicon/list-cn-2-62.gif)}li.list-cn-2-63{background-image:url(http://bs.baidu.com/listicon/list-cn-2-63.gif)}li.list-cn-2-64{background-image:url(http://bs.baidu.com/listicon/list-cn-2-64.gif)}li.list-cn-2-65{background-image:url(http://bs.baidu.com/listicon/list-cn-2-65.gif)}li.list-cn-2-66{background-image:url(http://bs.baidu.com/listicon/list-cn-2-66.gif)}li.list-cn-2-67{background-image:url(http://bs.baidu.com/listicon/list-cn-2-67.gif)}li.list-cn-2-68{background-image:url(http://bs.baidu.com/listicon/list-cn-2-68.gif)}li.list-cn-2-69{background-image:url(http://bs.baidu.com/listicon/list-cn-2-69.gif)}li.list-cn-2-70{background-image:url(http://bs.baidu.com/listicon/list-cn-2-70.gif)}li.list-cn-2-71{background-image:url(http://bs.baidu.com/listicon/list-cn-2-71.gif)}li.list-cn-2-72{background-image:url(http://bs.baidu.com/listicon/list-cn-2-72.gif)}li.list-cn-2-73{background-image:url(http://bs.baidu.com/listicon/list-cn-2-73.gif)}li.list-cn-2-74{background-image:url(http://bs.baidu.com/listicon/list-cn-2-74.gif)}li.list-cn-2-75{background-image:url(http://bs.baidu.com/listicon/list-cn-2-75.gif)}li.list-cn-2-76{background-image:url(http://bs.baidu.com/listicon/list-cn-2-76.gif)}li.list-cn-2-77{background-image:url(http://bs.baidu.com/listicon/list-cn-2-77.gif)}li.list-cn-2-78{background-image:url(http://bs.baidu.com/listicon/list-cn-2-78.gif)}li.list-cn-2-79{background-image:url(http://bs.baidu.com/listicon/list-cn-2-79.gif)}li.list-cn-2-80{background-image:url(http://bs.baidu.com/listicon/list-cn-2-80.gif)}li.list-cn-2-81{background-image:url(http://bs.baidu.com/listicon/list-cn-2-81.gif)}li.list-cn-2-82{background-image:url(http://bs.baidu.com/listicon/list-cn-2-82.gif)}li.list-cn-2-83{background-image:url(http://bs.baidu.com/listicon/list-cn-2-83.gif)}li.list-cn-2-84{background-image:url(http://bs.baidu.com/listicon/list-cn-2-84.gif)}li.list-cn-2-85{background-image:url(http://bs.baidu.com/listicon/list-cn-2-85.gif)}li.list-cn-2-86{background-image:url(http://bs.baidu.com/listicon/list-cn-2-86.gif)}li.list-cn-2-87{background-image:url(http://bs.baidu.com/listicon/list-cn-2-87.gif)}li.list-cn-2-88{background-image:url(http://bs.baidu.com/listicon/list-cn-2-88.gif)}li.list-cn-2-89{background-image:url(http://bs.baidu.com/listicon/list-cn-2-89.gif)}li.list-cn-2-90{background-image:url(http://bs.baidu.com/listicon/list-cn-2-90.gif)}li.list-cn-2-91{background-image:url(http://bs.baidu.com/listicon/list-cn-2-91.gif)}li.list-cn-2-92{background-image:url(http://bs.baidu.com/listicon/list-cn-2-92.gif)}li.list-cn-2-93{background-image:url(http://bs.baidu.com/listicon/list-cn-2-93.gif)}li.list-cn-2-94{background-image:url(http://bs.baidu.com/listicon/list-cn-2-94.gif)}li.list-cn-2-95{background-image:url(http://bs.baidu.com/listicon/list-cn-2-95.gif)}li.list-cn-2-96{background-image:url(http://bs.baidu.com/listicon/list-cn-2-96.gif)}li.list-cn-2-97{background-image:url(http://bs.baidu.com/listicon/list-cn-2-97.gif)}li.list-cn-2-98{background-image:url(http://bs.baidu.com/listicon/list-cn-2-98.gif)}ol.custom_cn1{list-style:none;}ol.custom_cn1 li{background-position:0 3px;background-repeat:no-repeat}li.list-cn1-paddingleft-1{padding-left:30px}li.list-cn1-paddingleft-2{padding-left:40px}li.list-cn1-paddingleft-3{padding-left:55px}li.list-cn-3-0{background-image:url(http://bs.baidu.com/listicon/list-cn-3-0.gif)}li.list-cn-3-1{background-image:url(http://bs.baidu.com/listicon/list-cn-3-1.gif)}li.list-cn-3-2{background-image:url(http://bs.baidu.com/listicon/list-cn-3-2.gif)}li.list-cn-3-3{background-image:url(http://bs.baidu.com/listicon/list-cn-3-3.gif)}li.list-cn-3-4{background-image:url(http://bs.baidu.com/listicon/list-cn-3-4.gif)}li.list-cn-3-5{background-image:url(http://bs.baidu.com/listicon/list-cn-3-5.gif)}li.list-cn-3-6{background-image:url(http://bs.baidu.com/listicon/list-cn-3-6.gif)}li.list-cn-3-7{background-image:url(http://bs.baidu.com/listicon/list-cn-3-7.gif)}li.list-cn-3-8{background-image:url(http://bs.baidu.com/listicon/list-cn-3-8.gif)}li.list-cn-3-9{background-image:url(http://bs.baidu.com/listicon/list-cn-3-9.gif)}li.list-cn-3-10{background-image:url(http://bs.baidu.com/listicon/list-cn-3-10.gif)}li.list-cn-3-11{background-image:url(http://bs.baidu.com/listicon/list-cn-3-11.gif)}li.list-cn-3-12{background-image:url(http://bs.baidu.com/listicon/list-cn-3-12.gif)}li.list-cn-3-13{background-image:url(http://bs.baidu.com/listicon/list-cn-3-13.gif)}li.list-cn-3-14{background-image:url(http://bs.baidu.com/listicon/list-cn-3-14.gif)}li.list-cn-3-15{background-image:url(http://bs.baidu.com/listicon/list-cn-3-15.gif)}li.list-cn-3-16{background-image:url(http://bs.baidu.com/listicon/list-cn-3-16.gif)}li.list-cn-3-17{background-image:url(http://bs.baidu.com/listicon/list-cn-3-17.gif)}li.list-cn-3-18{background-image:url(http://bs.baidu.com/listicon/list-cn-3-18.gif)}li.list-cn-3-19{background-image:url(http://bs.baidu.com/listicon/list-cn-3-19.gif)}li.list-cn-3-20{background-image:url(http://bs.baidu.com/listicon/list-cn-3-20.gif)}li.list-cn-3-21{background-image:url(http://bs.baidu.com/listicon/list-cn-3-21.gif)}li.list-cn-3-22{background-image:url(http://bs.baidu.com/listicon/list-cn-3-22.gif)}li.list-cn-3-23{background-image:url(http://bs.baidu.com/listicon/list-cn-3-23.gif)}li.list-cn-3-24{background-image:url(http://bs.baidu.com/listicon/list-cn-3-24.gif)}li.list-cn-3-25{background-image:url(http://bs.baidu.com/listicon/list-cn-3-25.gif)}li.list-cn-3-26{background-image:url(http://bs.baidu.com/listicon/list-cn-3-26.gif)}li.list-cn-3-27{background-image:url(http://bs.baidu.com/listicon/list-cn-3-27.gif)}li.list-cn-3-28{background-image:url(http://bs.baidu.com/listicon/list-cn-3-28.gif)}li.list-cn-3-29{background-image:url(http://bs.baidu.com/listicon/list-cn-3-29.gif)}li.list-cn-3-30{background-image:url(http://bs.baidu.com/listicon/list-cn-3-30.gif)}li.list-cn-3-31{background-image:url(http://bs.baidu.com/listicon/list-cn-3-31.gif)}li.list-cn-3-32{background-image:url(http://bs.baidu.com/listicon/list-cn-3-32.gif)}li.list-cn-3-33{background-image:url(http://bs.baidu.com/listicon/list-cn-3-33.gif)}li.list-cn-3-34{background-image:url(http://bs.baidu.com/listicon/list-cn-3-34.gif)}li.list-cn-3-35{background-image:url(http://bs.baidu.com/listicon/list-cn-3-35.gif)}li.list-cn-3-36{background-image:url(http://bs.baidu.com/listicon/list-cn-3-36.gif)}li.list-cn-3-37{background-image:url(http://bs.baidu.com/listicon/list-cn-3-37.gif)}li.list-cn-3-38{background-image:url(http://bs.baidu.com/listicon/list-cn-3-38.gif)}li.list-cn-3-39{background-image:url(http://bs.baidu.com/listicon/list-cn-3-39.gif)}li.list-cn-3-40{background-image:url(http://bs.baidu.com/listicon/list-cn-3-40.gif)}li.list-cn-3-41{background-image:url(http://bs.baidu.com/listicon/list-cn-3-41.gif)}li.list-cn-3-42{background-image:url(http://bs.baidu.com/listicon/list-cn-3-42.gif)}li.list-cn-3-43{background-image:url(http://bs.baidu.com/listicon/list-cn-3-43.gif)}li.list-cn-3-44{background-image:url(http://bs.baidu.com/listicon/list-cn-3-44.gif)}li.list-cn-3-45{background-image:url(http://bs.baidu.com/listicon/list-cn-3-45.gif)}li.list-cn-3-46{background-image:url(http://bs.baidu.com/listicon/list-cn-3-46.gif)}li.list-cn-3-47{background-image:url(http://bs.baidu.com/listicon/list-cn-3-47.gif)}li.list-cn-3-48{background-image:url(http://bs.baidu.com/listicon/list-cn-3-48.gif)}li.list-cn-3-49{background-image:url(http://bs.baidu.com/listicon/list-cn-3-49.gif)}li.list-cn-3-50{background-image:url(http://bs.baidu.com/listicon/list-cn-3-50.gif)}li.list-cn-3-51{background-image:url(http://bs.baidu.com/listicon/list-cn-3-51.gif)}li.list-cn-3-52{background-image:url(http://bs.baidu.com/listicon/list-cn-3-52.gif)}li.list-cn-3-53{background-image:url(http://bs.baidu.com/listicon/list-cn-3-53.gif)}li.list-cn-3-54{background-image:url(http://bs.baidu.com/listicon/list-cn-3-54.gif)}li.list-cn-3-55{background-image:url(http://bs.baidu.com/listicon/list-cn-3-55.gif)}li.list-cn-3-56{background-image:url(http://bs.baidu.com/listicon/list-cn-3-56.gif)}li.list-cn-3-57{background-image:url(http://bs.baidu.com/listicon/list-cn-3-57.gif)}li.list-cn-3-58{background-image:url(http://bs.baidu.com/listicon/list-cn-3-58.gif)}li.list-cn-3-59{background-image:url(http://bs.baidu.com/listicon/list-cn-3-59.gif)}li.list-cn-3-60{background-image:url(http://bs.baidu.com/listicon/list-cn-3-60.gif)}li.list-cn-3-61{background-image:url(http://bs.baidu.com/listicon/list-cn-3-61.gif)}li.list-cn-3-62{background-image:url(http://bs.baidu.com/listicon/list-cn-3-62.gif)}li.list-cn-3-63{background-image:url(http://bs.baidu.com/listicon/list-cn-3-63.gif)}li.list-cn-3-64{background-image:url(http://bs.baidu.com/listicon/list-cn-3-64.gif)}li.list-cn-3-65{background-image:url(http://bs.baidu.com/listicon/list-cn-3-65.gif)}li.list-cn-3-66{background-image:url(http://bs.baidu.com/listicon/list-cn-3-66.gif)}li.list-cn-3-67{background-image:url(http://bs.baidu.com/listicon/list-cn-3-67.gif)}li.list-cn-3-68{background-image:url(http://bs.baidu.com/listicon/list-cn-3-68.gif)}li.list-cn-3-69{background-image:url(http://bs.baidu.com/listicon/list-cn-3-69.gif)}li.list-cn-3-70{background-image:url(http://bs.baidu.com/listicon/list-cn-3-70.gif)}li.list-cn-3-71{background-image:url(http://bs.baidu.com/listicon/list-cn-3-71.gif)}li.list-cn-3-72{background-image:url(http://bs.baidu.com/listicon/list-cn-3-72.gif)}li.list-cn-3-73{background-image:url(http://bs.baidu.com/listicon/list-cn-3-73.gif)}li.list-cn-3-74{background-image:url(http://bs.baidu.com/listicon/list-cn-3-74.gif)}li.list-cn-3-75{background-image:url(http://bs.baidu.com/listicon/list-cn-3-75.gif)}li.list-cn-3-76{background-image:url(http://bs.baidu.com/listicon/list-cn-3-76.gif)}li.list-cn-3-77{background-image:url(http://bs.baidu.com/listicon/list-cn-3-77.gif)}li.list-cn-3-78{background-image:url(http://bs.baidu.com/listicon/list-cn-3-78.gif)}li.list-cn-3-79{background-image:url(http://bs.baidu.com/listicon/list-cn-3-79.gif)}li.list-cn-3-80{background-image:url(http://bs.baidu.com/listicon/list-cn-3-80.gif)}li.list-cn-3-81{background-image:url(http://bs.baidu.com/listicon/list-cn-3-81.gif)}li.list-cn-3-82{background-image:url(http://bs.baidu.com/listicon/list-cn-3-82.gif)}li.list-cn-3-83{background-image:url(http://bs.baidu.com/listicon/list-cn-3-83.gif)}li.list-cn-3-84{background-image:url(http://bs.baidu.com/listicon/list-cn-3-84.gif)}li.list-cn-3-85{background-image:url(http://bs.baidu.com/listicon/list-cn-3-85.gif)}li.list-cn-3-86{background-image:url(http://bs.baidu.com/listicon/list-cn-3-86.gif)}li.list-cn-3-87{background-image:url(http://bs.baidu.com/listicon/list-cn-3-87.gif)}li.list-cn-3-88{background-image:url(http://bs.baidu.com/listicon/list-cn-3-88.gif)}li.list-cn-3-89{background-image:url(http://bs.baidu.com/listicon/list-cn-3-89.gif)}li.list-cn-3-90{background-image:url(http://bs.baidu.com/listicon/list-cn-3-90.gif)}li.list-cn-3-91{background-image:url(http://bs.baidu.com/listicon/list-cn-3-91.gif)}li.list-cn-3-92{background-image:url(http://bs.baidu.com/listicon/list-cn-3-92.gif)}li.list-cn-3-93{background-image:url(http://bs.baidu.com/listicon/list-cn-3-93.gif)}li.list-cn-3-94{background-image:url(http://bs.baidu.com/listicon/list-cn-3-94.gif)}li.list-cn-3-95{background-image:url(http://bs.baidu.com/listicon/list-cn-3-95.gif)}li.list-cn-3-96{background-image:url(http://bs.baidu.com/listicon/list-cn-3-96.gif)}li.list-cn-3-97{background-image:url(http://bs.baidu.com/listicon/list-cn-3-97.gif)}li.list-cn-3-98{background-image:url(http://bs.baidu.com/listicon/list-cn-3-98.gif)}ol.custom_cn2{list-style:none;}ol.custom_cn2 li{background-position:0 3px;background-repeat:no-repeat}li.list-cn2-paddingleft-1{padding-left:40px}li.list-cn2-paddingleft-2{padding-left:55px}li.list-cn2-paddingleft-3{padding-left:68px}li.list-num-1-0{background-image:url(http://bs.baidu.com/listicon/list-num-1-0.gif)}li.list-num-1-1{background-image:url(http://bs.baidu.com/listicon/list-num-1-1.gif)}li.list-num-1-2{background-image:url(http://bs.baidu.com/listicon/list-num-1-2.gif)}li.list-num-1-3{background-image:url(http://bs.baidu.com/listicon/list-num-1-3.gif)}li.list-num-1-4{background-image:url(http://bs.baidu.com/listicon/list-num-1-4.gif)}li.list-num-1-5{background-image:url(http://bs.baidu.com/listicon/list-num-1-5.gif)}li.list-num-1-6{background-image:url(http://bs.baidu.com/listicon/list-num-1-6.gif)}li.list-num-1-7{background-image:url(http://bs.baidu.com/listicon/list-num-1-7.gif)}li.list-num-1-8{background-image:url(http://bs.baidu.com/listicon/list-num-1-8.gif)}li.list-num-1-9{background-image:url(http://bs.baidu.com/listicon/list-num-1-9.gif)}li.list-num-1-10{background-image:url(http://bs.baidu.com/listicon/list-num-1-10.gif)}li.list-num-1-11{background-image:url(http://bs.baidu.com/listicon/list-num-1-11.gif)}li.list-num-1-12{background-image:url(http://bs.baidu.com/listicon/list-num-1-12.gif)}li.list-num-1-13{background-image:url(http://bs.baidu.com/listicon/list-num-1-13.gif)}li.list-num-1-14{background-image:url(http://bs.baidu.com/listicon/list-num-1-14.gif)}li.list-num-1-15{background-image:url(http://bs.baidu.com/listicon/list-num-1-15.gif)}li.list-num-1-16{background-image:url(http://bs.baidu.com/listicon/list-num-1-16.gif)}li.list-num-1-17{background-image:url(http://bs.baidu.com/listicon/list-num-1-17.gif)}li.list-num-1-18{background-image:url(http://bs.baidu.com/listicon/list-num-1-18.gif)}li.list-num-1-19{background-image:url(http://bs.baidu.com/listicon/list-num-1-19.gif)}li.list-num-1-20{background-image:url(http://bs.baidu.com/listicon/list-num-1-20.gif)}li.list-num-1-21{background-image:url(http://bs.baidu.com/listicon/list-num-1-21.gif)}li.list-num-1-22{background-image:url(http://bs.baidu.com/listicon/list-num-1-22.gif)}li.list-num-1-23{background-image:url(http://bs.baidu.com/listicon/list-num-1-23.gif)}li.list-num-1-24{background-image:url(http://bs.baidu.com/listicon/list-num-1-24.gif)}li.list-num-1-25{background-image:url(http://bs.baidu.com/listicon/list-num-1-25.gif)}li.list-num-1-26{background-image:url(http://bs.baidu.com/listicon/list-num-1-26.gif)}li.list-num-1-27{background-image:url(http://bs.baidu.com/listicon/list-num-1-27.gif)}li.list-num-1-28{background-image:url(http://bs.baidu.com/listicon/list-num-1-28.gif)}li.list-num-1-29{background-image:url(http://bs.baidu.com/listicon/list-num-1-29.gif)}li.list-num-1-30{background-image:url(http://bs.baidu.com/listicon/list-num-1-30.gif)}li.list-num-1-31{background-image:url(http://bs.baidu.com/listicon/list-num-1-31.gif)}li.list-num-1-32{background-image:url(http://bs.baidu.com/listicon/list-num-1-32.gif)}li.list-num-1-33{background-image:url(http://bs.baidu.com/listicon/list-num-1-33.gif)}li.list-num-1-34{background-image:url(http://bs.baidu.com/listicon/list-num-1-34.gif)}li.list-num-1-35{background-image:url(http://bs.baidu.com/listicon/list-num-1-35.gif)}li.list-num-1-36{background-image:url(http://bs.baidu.com/listicon/list-num-1-36.gif)}li.list-num-1-37{background-image:url(http://bs.baidu.com/listicon/list-num-1-37.gif)}li.list-num-1-38{background-image:url(http://bs.baidu.com/listicon/list-num-1-38.gif)}li.list-num-1-39{background-image:url(http://bs.baidu.com/listicon/list-num-1-39.gif)}li.list-num-1-40{background-image:url(http://bs.baidu.com/listicon/list-num-1-40.gif)}li.list-num-1-41{background-image:url(http://bs.baidu.com/listicon/list-num-1-41.gif)}li.list-num-1-42{background-image:url(http://bs.baidu.com/listicon/list-num-1-42.gif)}li.list-num-1-43{background-image:url(http://bs.baidu.com/listicon/list-num-1-43.gif)}li.list-num-1-44{background-image:url(http://bs.baidu.com/listicon/list-num-1-44.gif)}li.list-num-1-45{background-image:url(http://bs.baidu.com/listicon/list-num-1-45.gif)}li.list-num-1-46{background-image:url(http://bs.baidu.com/listicon/list-num-1-46.gif)}li.list-num-1-47{background-image:url(http://bs.baidu.com/listicon/list-num-1-47.gif)}li.list-num-1-48{background-image:url(http://bs.baidu.com/listicon/list-num-1-48.gif)}li.list-num-1-49{background-image:url(http://bs.baidu.com/listicon/list-num-1-49.gif)}li.list-num-1-50{background-image:url(http://bs.baidu.com/listicon/list-num-1-50.gif)}li.list-num-1-51{background-image:url(http://bs.baidu.com/listicon/list-num-1-51.gif)}li.list-num-1-52{background-image:url(http://bs.baidu.com/listicon/list-num-1-52.gif)}li.list-num-1-53{background-image:url(http://bs.baidu.com/listicon/list-num-1-53.gif)}li.list-num-1-54{background-image:url(http://bs.baidu.com/listicon/list-num-1-54.gif)}li.list-num-1-55{background-image:url(http://bs.baidu.com/listicon/list-num-1-55.gif)}li.list-num-1-56{background-image:url(http://bs.baidu.com/listicon/list-num-1-56.gif)}li.list-num-1-57{background-image:url(http://bs.baidu.com/listicon/list-num-1-57.gif)}li.list-num-1-58{background-image:url(http://bs.baidu.com/listicon/list-num-1-58.gif)}li.list-num-1-59{background-image:url(http://bs.baidu.com/listicon/list-num-1-59.gif)}li.list-num-1-60{background-image:url(http://bs.baidu.com/listicon/list-num-1-60.gif)}li.list-num-1-61{background-image:url(http://bs.baidu.com/listicon/list-num-1-61.gif)}li.list-num-1-62{background-image:url(http://bs.baidu.com/listicon/list-num-1-62.gif)}li.list-num-1-63{background-image:url(http://bs.baidu.com/listicon/list-num-1-63.gif)}li.list-num-1-64{background-image:url(http://bs.baidu.com/listicon/list-num-1-64.gif)}li.list-num-1-65{background-image:url(http://bs.baidu.com/listicon/list-num-1-65.gif)}li.list-num-1-66{background-image:url(http://bs.baidu.com/listicon/list-num-1-66.gif)}li.list-num-1-67{background-image:url(http://bs.baidu.com/listicon/list-num-1-67.gif)}li.list-num-1-68{background-image:url(http://bs.baidu.com/listicon/list-num-1-68.gif)}li.list-num-1-69{background-image:url(http://bs.baidu.com/listicon/list-num-1-69.gif)}li.list-num-1-70{background-image:url(http://bs.baidu.com/listicon/list-num-1-70.gif)}li.list-num-1-71{background-image:url(http://bs.baidu.com/listicon/list-num-1-71.gif)}li.list-num-1-72{background-image:url(http://bs.baidu.com/listicon/list-num-1-72.gif)}li.list-num-1-73{background-image:url(http://bs.baidu.com/listicon/list-num-1-73.gif)}li.list-num-1-74{background-image:url(http://bs.baidu.com/listicon/list-num-1-74.gif)}li.list-num-1-75{background-image:url(http://bs.baidu.com/listicon/list-num-1-75.gif)}li.list-num-1-76{background-image:url(http://bs.baidu.com/listicon/list-num-1-76.gif)}li.list-num-1-77{background-image:url(http://bs.baidu.com/listicon/list-num-1-77.gif)}li.list-num-1-78{background-image:url(http://bs.baidu.com/listicon/list-num-1-78.gif)}li.list-num-1-79{background-image:url(http://bs.baidu.com/listicon/list-num-1-79.gif)}li.list-num-1-80{background-image:url(http://bs.baidu.com/listicon/list-num-1-80.gif)}li.list-num-1-81{background-image:url(http://bs.baidu.com/listicon/list-num-1-81.gif)}li.list-num-1-82{background-image:url(http://bs.baidu.com/listicon/list-num-1-82.gif)}li.list-num-1-83{background-image:url(http://bs.baidu.com/listicon/list-num-1-83.gif)}li.list-num-1-84{background-image:url(http://bs.baidu.com/listicon/list-num-1-84.gif)}li.list-num-1-85{background-image:url(http://bs.baidu.com/listicon/list-num-1-85.gif)}li.list-num-1-86{background-image:url(http://bs.baidu.com/listicon/list-num-1-86.gif)}li.list-num-1-87{background-image:url(http://bs.baidu.com/listicon/list-num-1-87.gif)}li.list-num-1-88{background-image:url(http://bs.baidu.com/listicon/list-num-1-88.gif)}li.list-num-1-89{background-image:url(http://bs.baidu.com/listicon/list-num-1-89.gif)}li.list-num-1-90{background-image:url(http://bs.baidu.com/listicon/list-num-1-90.gif)}li.list-num-1-91{background-image:url(http://bs.baidu.com/listicon/list-num-1-91.gif)}li.list-num-1-92{background-image:url(http://bs.baidu.com/listicon/list-num-1-92.gif)}li.list-num-1-93{background-image:url(http://bs.baidu.com/listicon/list-num-1-93.gif)}li.list-num-1-94{background-image:url(http://bs.baidu.com/listicon/list-num-1-94.gif)}li.list-num-1-95{background-image:url(http://bs.baidu.com/listicon/list-num-1-95.gif)}li.list-num-1-96{background-image:url(http://bs.baidu.com/listicon/list-num-1-96.gif)}li.list-num-1-97{background-image:url(http://bs.baidu.com/listicon/list-num-1-97.gif)}li.list-num-1-98{background-image:url(http://bs.baidu.com/listicon/list-num-1-98.gif)}ol.custom_num{list-style:none;}ol.custom_num li{background-position:0 3px;background-repeat:no-repeat}li.list-num-paddingleft-1{padding-left:25px}li.list-num-2-0{background-image:url(http://bs.baidu.com/listicon/list-num-2-0.gif)}li.list-num-2-1{background-image:url(http://bs.baidu.com/listicon/list-num-2-1.gif)}li.list-num-2-2{background-image:url(http://bs.baidu.com/listicon/list-num-2-2.gif)}li.list-num-2-3{background-image:url(http://bs.baidu.com/listicon/list-num-2-3.gif)}li.list-num-2-4{background-image:url(http://bs.baidu.com/listicon/list-num-2-4.gif)}li.list-num-2-5{background-image:url(http://bs.baidu.com/listicon/list-num-2-5.gif)}li.list-num-2-6{background-image:url(http://bs.baidu.com/listicon/list-num-2-6.gif)}li.list-num-2-7{background-image:url(http://bs.baidu.com/listicon/list-num-2-7.gif)}li.list-num-2-8{background-image:url(http://bs.baidu.com/listicon/list-num-2-8.gif)}li.list-num-2-9{background-image:url(http://bs.baidu.com/listicon/list-num-2-9.gif)}li.list-num-2-10{background-image:url(http://bs.baidu.com/listicon/list-num-2-10.gif)}li.list-num-2-11{background-image:url(http://bs.baidu.com/listicon/list-num-2-11.gif)}li.list-num-2-12{background-image:url(http://bs.baidu.com/listicon/list-num-2-12.gif)}li.list-num-2-13{background-image:url(http://bs.baidu.com/listicon/list-num-2-13.gif)}li.list-num-2-14{background-image:url(http://bs.baidu.com/listicon/list-num-2-14.gif)}li.list-num-2-15{background-image:url(http://bs.baidu.com/listicon/list-num-2-15.gif)}li.list-num-2-16{background-image:url(http://bs.baidu.com/listicon/list-num-2-16.gif)}li.list-num-2-17{background-image:url(http://bs.baidu.com/listicon/list-num-2-17.gif)}li.list-num-2-18{background-image:url(http://bs.baidu.com/listicon/list-num-2-18.gif)}li.list-num-2-19{background-image:url(http://bs.baidu.com/listicon/list-num-2-19.gif)}li.list-num-2-20{background-image:url(http://bs.baidu.com/listicon/list-num-2-20.gif)}li.list-num-2-21{background-image:url(http://bs.baidu.com/listicon/list-num-2-21.gif)}li.list-num-2-22{background-image:url(http://bs.baidu.com/listicon/list-num-2-22.gif)}li.list-num-2-23{background-image:url(http://bs.baidu.com/listicon/list-num-2-23.gif)}li.list-num-2-24{background-image:url(http://bs.baidu.com/listicon/list-num-2-24.gif)}li.list-num-2-25{background-image:url(http://bs.baidu.com/listicon/list-num-2-25.gif)}li.list-num-2-26{background-image:url(http://bs.baidu.com/listicon/list-num-2-26.gif)}li.list-num-2-27{background-image:url(http://bs.baidu.com/listicon/list-num-2-27.gif)}li.list-num-2-28{background-image:url(http://bs.baidu.com/listicon/list-num-2-28.gif)}li.list-num-2-29{background-image:url(http://bs.baidu.com/listicon/list-num-2-29.gif)}li.list-num-2-30{background-image:url(http://bs.baidu.com/listicon/list-num-2-30.gif)}li.list-num-2-31{background-image:url(http://bs.baidu.com/listicon/list-num-2-31.gif)}li.list-num-2-32{background-image:url(http://bs.baidu.com/listicon/list-num-2-32.gif)}li.list-num-2-33{background-image:url(http://bs.baidu.com/listicon/list-num-2-33.gif)}li.list-num-2-34{background-image:url(http://bs.baidu.com/listicon/list-num-2-34.gif)}li.list-num-2-35{background-image:url(http://bs.baidu.com/listicon/list-num-2-35.gif)}li.list-num-2-36{background-image:url(http://bs.baidu.com/listicon/list-num-2-36.gif)}li.list-num-2-37{background-image:url(http://bs.baidu.com/listicon/list-num-2-37.gif)}li.list-num-2-38{background-image:url(http://bs.baidu.com/listicon/list-num-2-38.gif)}li.list-num-2-39{background-image:url(http://bs.baidu.com/listicon/list-num-2-39.gif)}li.list-num-2-40{background-image:url(http://bs.baidu.com/listicon/list-num-2-40.gif)}li.list-num-2-41{background-image:url(http://bs.baidu.com/listicon/list-num-2-41.gif)}li.list-num-2-42{background-image:url(http://bs.baidu.com/listicon/list-num-2-42.gif)}li.list-num-2-43{background-image:url(http://bs.baidu.com/listicon/list-num-2-43.gif)}li.list-num-2-44{background-image:url(http://bs.baidu.com/listicon/list-num-2-44.gif)}li.list-num-2-45{background-image:url(http://bs.baidu.com/listicon/list-num-2-45.gif)}li.list-num-2-46{background-image:url(http://bs.baidu.com/listicon/list-num-2-46.gif)}li.list-num-2-47{background-image:url(http://bs.baidu.com/listicon/list-num-2-47.gif)}li.list-num-2-48{background-image:url(http://bs.baidu.com/listicon/list-num-2-48.gif)}li.list-num-2-49{background-image:url(http://bs.baidu.com/listicon/list-num-2-49.gif)}li.list-num-2-50{background-image:url(http://bs.baidu.com/listicon/list-num-2-50.gif)}li.list-num-2-51{background-image:url(http://bs.baidu.com/listicon/list-num-2-51.gif)}li.list-num-2-52{background-image:url(http://bs.baidu.com/listicon/list-num-2-52.gif)}li.list-num-2-53{background-image:url(http://bs.baidu.com/listicon/list-num-2-53.gif)}li.list-num-2-54{background-image:url(http://bs.baidu.com/listicon/list-num-2-54.gif)}li.list-num-2-55{background-image:url(http://bs.baidu.com/listicon/list-num-2-55.gif)}li.list-num-2-56{background-image:url(http://bs.baidu.com/listicon/list-num-2-56.gif)}li.list-num-2-57{background-image:url(http://bs.baidu.com/listicon/list-num-2-57.gif)}li.list-num-2-58{background-image:url(http://bs.baidu.com/listicon/list-num-2-58.gif)}li.list-num-2-59{background-image:url(http://bs.baidu.com/listicon/list-num-2-59.gif)}li.list-num-2-60{background-image:url(http://bs.baidu.com/listicon/list-num-2-60.gif)}li.list-num-2-61{background-image:url(http://bs.baidu.com/listicon/list-num-2-61.gif)}li.list-num-2-62{background-image:url(http://bs.baidu.com/listicon/list-num-2-62.gif)}li.list-num-2-63{background-image:url(http://bs.baidu.com/listicon/list-num-2-63.gif)}li.list-num-2-64{background-image:url(http://bs.baidu.com/listicon/list-num-2-64.gif)}li.list-num-2-65{background-image:url(http://bs.baidu.com/listicon/list-num-2-65.gif)}li.list-num-2-66{background-image:url(http://bs.baidu.com/listicon/list-num-2-66.gif)}li.list-num-2-67{background-image:url(http://bs.baidu.com/listicon/list-num-2-67.gif)}li.list-num-2-68{background-image:url(http://bs.baidu.com/listicon/list-num-2-68.gif)}li.list-num-2-69{background-image:url(http://bs.baidu.com/listicon/list-num-2-69.gif)}li.list-num-2-70{background-image:url(http://bs.baidu.com/listicon/list-num-2-70.gif)}li.list-num-2-71{background-image:url(http://bs.baidu.com/listicon/list-num-2-71.gif)}li.list-num-2-72{background-image:url(http://bs.baidu.com/listicon/list-num-2-72.gif)}li.list-num-2-73{background-image:url(http://bs.baidu.com/listicon/list-num-2-73.gif)}li.list-num-2-74{background-image:url(http://bs.baidu.com/listicon/list-num-2-74.gif)}li.list-num-2-75{background-image:url(http://bs.baidu.com/listicon/list-num-2-75.gif)}li.list-num-2-76{background-image:url(http://bs.baidu.com/listicon/list-num-2-76.gif)}li.list-num-2-77{background-image:url(http://bs.baidu.com/listicon/list-num-2-77.gif)}li.list-num-2-78{background-image:url(http://bs.baidu.com/listicon/list-num-2-78.gif)}li.list-num-2-79{background-image:url(http://bs.baidu.com/listicon/list-num-2-79.gif)}li.list-num-2-80{background-image:url(http://bs.baidu.com/listicon/list-num-2-80.gif)}li.list-num-2-81{background-image:url(http://bs.baidu.com/listicon/list-num-2-81.gif)}li.list-num-2-82{background-image:url(http://bs.baidu.com/listicon/list-num-2-82.gif)}li.list-num-2-83{background-image:url(http://bs.baidu.com/listicon/list-num-2-83.gif)}li.list-num-2-84{background-image:url(http://bs.baidu.com/listicon/list-num-2-84.gif)}li.list-num-2-85{background-image:url(http://bs.baidu.com/listicon/list-num-2-85.gif)}li.list-num-2-86{background-image:url(http://bs.baidu.com/listicon/list-num-2-86.gif)}li.list-num-2-87{background-image:url(http://bs.baidu.com/listicon/list-num-2-87.gif)}li.list-num-2-88{background-image:url(http://bs.baidu.com/listicon/list-num-2-88.gif)}li.list-num-2-89{background-image:url(http://bs.baidu.com/listicon/list-num-2-89.gif)}li.list-num-2-90{background-image:url(http://bs.baidu.com/listicon/list-num-2-90.gif)}li.list-num-2-91{background-image:url(http://bs.baidu.com/listicon/list-num-2-91.gif)}li.list-num-2-92{background-image:url(http://bs.baidu.com/listicon/list-num-2-92.gif)}li.list-num-2-93{background-image:url(http://bs.baidu.com/listicon/list-num-2-93.gif)}li.list-num-2-94{background-image:url(http://bs.baidu.com/listicon/list-num-2-94.gif)}li.list-num-2-95{background-image:url(http://bs.baidu.com/listicon/list-num-2-95.gif)}li.list-num-2-96{background-image:url(http://bs.baidu.com/listicon/list-num-2-96.gif)}li.list-num-2-97{background-image:url(http://bs.baidu.com/listicon/list-num-2-97.gif)}li.list-num-2-98{background-image:url(http://bs.baidu.com/listicon/list-num-2-98.gif)}ol.custom_num1{list-style:none;}ol.custom_num1 li{background-position:0 3px;background-repeat:no-repeat}li.list-num1-paddingleft-1{padding-left:25px}li.list-num-3-0{background-image:url(http://bs.baidu.com/listicon/list-num-3-0.gif)}li.list-num-3-1{background-image:url(http://bs.baidu.com/listicon/list-num-3-1.gif)}li.list-num-3-2{background-image:url(http://bs.baidu.com/listicon/list-num-3-2.gif)}li.list-num-3-3{background-image:url(http://bs.baidu.com/listicon/list-num-3-3.gif)}li.list-num-3-4{background-image:url(http://bs.baidu.com/listicon/list-num-3-4.gif)}li.list-num-3-5{background-image:url(http://bs.baidu.com/listicon/list-num-3-5.gif)}li.list-num-3-6{background-image:url(http://bs.baidu.com/listicon/list-num-3-6.gif)}li.list-num-3-7{background-image:url(http://bs.baidu.com/listicon/list-num-3-7.gif)}li.list-num-3-8{background-image:url(http://bs.baidu.com/listicon/list-num-3-8.gif)}li.list-num-3-9{background-image:url(http://bs.baidu.com/listicon/list-num-3-9.gif)}li.list-num-3-10{background-image:url(http://bs.baidu.com/listicon/list-num-3-10.gif)}li.list-num-3-11{background-image:url(http://bs.baidu.com/listicon/list-num-3-11.gif)}li.list-num-3-12{background-image:url(http://bs.baidu.com/listicon/list-num-3-12.gif)}li.list-num-3-13{background-image:url(http://bs.baidu.com/listicon/list-num-3-13.gif)}li.list-num-3-14{background-image:url(http://bs.baidu.com/listicon/list-num-3-14.gif)}li.list-num-3-15{background-image:url(http://bs.baidu.com/listicon/list-num-3-15.gif)}li.list-num-3-16{background-image:url(http://bs.baidu.com/listicon/list-num-3-16.gif)}li.list-num-3-17{background-image:url(http://bs.baidu.com/listicon/list-num-3-17.gif)}li.list-num-3-18{background-image:url(http://bs.baidu.com/listicon/list-num-3-18.gif)}li.list-num-3-19{background-image:url(http://bs.baidu.com/listicon/list-num-3-19.gif)}li.list-num-3-20{background-image:url(http://bs.baidu.com/listicon/list-num-3-20.gif)}li.list-num-3-21{background-image:url(http://bs.baidu.com/listicon/list-num-3-21.gif)}li.list-num-3-22{background-image:url(http://bs.baidu.com/listicon/list-num-3-22.gif)}li.list-num-3-23{background-image:url(http://bs.baidu.com/listicon/list-num-3-23.gif)}li.list-num-3-24{background-image:url(http://bs.baidu.com/listicon/list-num-3-24.gif)}li.list-num-3-25{background-image:url(http://bs.baidu.com/listicon/list-num-3-25.gif)}li.list-num-3-26{background-image:url(http://bs.baidu.com/listicon/list-num-3-26.gif)}li.list-num-3-27{background-image:url(http://bs.baidu.com/listicon/list-num-3-27.gif)}li.list-num-3-28{background-image:url(http://bs.baidu.com/listicon/list-num-3-28.gif)}li.list-num-3-29{background-image:url(http://bs.baidu.com/listicon/list-num-3-29.gif)}li.list-num-3-30{background-image:url(http://bs.baidu.com/listicon/list-num-3-30.gif)}li.list-num-3-31{background-image:url(http://bs.baidu.com/listicon/list-num-3-31.gif)}li.list-num-3-32{background-image:url(http://bs.baidu.com/listicon/list-num-3-32.gif)}li.list-num-3-33{background-image:url(http://bs.baidu.com/listicon/list-num-3-33.gif)}li.list-num-3-34{background-image:url(http://bs.baidu.com/listicon/list-num-3-34.gif)}li.list-num-3-35{background-image:url(http://bs.baidu.com/listicon/list-num-3-35.gif)}li.list-num-3-36{background-image:url(http://bs.baidu.com/listicon/list-num-3-36.gif)}li.list-num-3-37{background-image:url(http://bs.baidu.com/listicon/list-num-3-37.gif)}li.list-num-3-38{background-image:url(http://bs.baidu.com/listicon/list-num-3-38.gif)}li.list-num-3-39{background-image:url(http://bs.baidu.com/listicon/list-num-3-39.gif)}li.list-num-3-40{background-image:url(http://bs.baidu.com/listicon/list-num-3-40.gif)}li.list-num-3-41{background-image:url(http://bs.baidu.com/listicon/list-num-3-41.gif)}li.list-num-3-42{background-image:url(http://bs.baidu.com/listicon/list-num-3-42.gif)}li.list-num-3-43{background-image:url(http://bs.baidu.com/listicon/list-num-3-43.gif)}li.list-num-3-44{background-image:url(http://bs.baidu.com/listicon/list-num-3-44.gif)}li.list-num-3-45{background-image:url(http://bs.baidu.com/listicon/list-num-3-45.gif)}li.list-num-3-46{background-image:url(http://bs.baidu.com/listicon/list-num-3-46.gif)}li.list-num-3-47{background-image:url(http://bs.baidu.com/listicon/list-num-3-47.gif)}li.list-num-3-48{background-image:url(http://bs.baidu.com/listicon/list-num-3-48.gif)}li.list-num-3-49{background-image:url(http://bs.baidu.com/listicon/list-num-3-49.gif)}li.list-num-3-50{background-image:url(http://bs.baidu.com/listicon/list-num-3-50.gif)}li.list-num-3-51{background-image:url(http://bs.baidu.com/listicon/list-num-3-51.gif)}li.list-num-3-52{background-image:url(http://bs.baidu.com/listicon/list-num-3-52.gif)}li.list-num-3-53{background-image:url(http://bs.baidu.com/listicon/list-num-3-53.gif)}li.list-num-3-54{background-image:url(http://bs.baidu.com/listicon/list-num-3-54.gif)}li.list-num-3-55{background-image:url(http://bs.baidu.com/listicon/list-num-3-55.gif)}li.list-num-3-56{background-image:url(http://bs.baidu.com/listicon/list-num-3-56.gif)}li.list-num-3-57{background-image:url(http://bs.baidu.com/listicon/list-num-3-57.gif)}li.list-num-3-58{background-image:url(http://bs.baidu.com/listicon/list-num-3-58.gif)}li.list-num-3-59{background-image:url(http://bs.baidu.com/listicon/list-num-3-59.gif)}li.list-num-3-60{background-image:url(http://bs.baidu.com/listicon/list-num-3-60.gif)}li.list-num-3-61{background-image:url(http://bs.baidu.com/listicon/list-num-3-61.gif)}li.list-num-3-62{background-image:url(http://bs.baidu.com/listicon/list-num-3-62.gif)}li.list-num-3-63{background-image:url(http://bs.baidu.com/listicon/list-num-3-63.gif)}li.list-num-3-64{background-image:url(http://bs.baidu.com/listicon/list-num-3-64.gif)}li.list-num-3-65{background-image:url(http://bs.baidu.com/listicon/list-num-3-65.gif)}li.list-num-3-66{background-image:url(http://bs.baidu.com/listicon/list-num-3-66.gif)}li.list-num-3-67{background-image:url(http://bs.baidu.com/listicon/list-num-3-67.gif)}li.list-num-3-68{background-image:url(http://bs.baidu.com/listicon/list-num-3-68.gif)}li.list-num-3-69{background-image:url(http://bs.baidu.com/listicon/list-num-3-69.gif)}li.list-num-3-70{background-image:url(http://bs.baidu.com/listicon/list-num-3-70.gif)}li.list-num-3-71{background-image:url(http://bs.baidu.com/listicon/list-num-3-71.gif)}li.list-num-3-72{background-image:url(http://bs.baidu.com/listicon/list-num-3-72.gif)}li.list-num-3-73{background-image:url(http://bs.baidu.com/listicon/list-num-3-73.gif)}li.list-num-3-74{background-image:url(http://bs.baidu.com/listicon/list-num-3-74.gif)}li.list-num-3-75{background-image:url(http://bs.baidu.com/listicon/list-num-3-75.gif)}li.list-num-3-76{background-image:url(http://bs.baidu.com/listicon/list-num-3-76.gif)}li.list-num-3-77{background-image:url(http://bs.baidu.com/listicon/list-num-3-77.gif)}li.list-num-3-78{background-image:url(http://bs.baidu.com/listicon/list-num-3-78.gif)}li.list-num-3-79{background-image:url(http://bs.baidu.com/listicon/list-num-3-79.gif)}li.list-num-3-80{background-image:url(http://bs.baidu.com/listicon/list-num-3-80.gif)}li.list-num-3-81{background-image:url(http://bs.baidu.com/listicon/list-num-3-81.gif)}li.list-num-3-82{background-image:url(http://bs.baidu.com/listicon/list-num-3-82.gif)}li.list-num-3-83{background-image:url(http://bs.baidu.com/listicon/list-num-3-83.gif)}li.list-num-3-84{background-image:url(http://bs.baidu.com/listicon/list-num-3-84.gif)}li.list-num-3-85{background-image:url(http://bs.baidu.com/listicon/list-num-3-85.gif)}li.list-num-3-86{background-image:url(http://bs.baidu.com/listicon/list-num-3-86.gif)}li.list-num-3-87{background-image:url(http://bs.baidu.com/listicon/list-num-3-87.gif)}li.list-num-3-88{background-image:url(http://bs.baidu.com/listicon/list-num-3-88.gif)}li.list-num-3-89{background-image:url(http://bs.baidu.com/listicon/list-num-3-89.gif)}li.list-num-3-90{background-image:url(http://bs.baidu.com/listicon/list-num-3-90.gif)}li.list-num-3-91{background-image:url(http://bs.baidu.com/listicon/list-num-3-91.gif)}li.list-num-3-92{background-image:url(http://bs.baidu.com/listicon/list-num-3-92.gif)}li.list-num-3-93{background-image:url(http://bs.baidu.com/listicon/list-num-3-93.gif)}li.list-num-3-94{background-image:url(http://bs.baidu.com/listicon/list-num-3-94.gif)}li.list-num-3-95{background-image:url(http://bs.baidu.com/listicon/list-num-3-95.gif)}li.list-num-3-96{background-image:url(http://bs.baidu.com/listicon/list-num-3-96.gif)}li.list-num-3-97{background-image:url(http://bs.baidu.com/listicon/list-num-3-97.gif)}li.list-num-3-98{background-image:url(http://bs.baidu.com/listicon/list-num-3-98.gif)}ol.custom_num2{list-style:none;}ol.custom_num2 li{background-position:0 3px;background-repeat:no-repeat}li.list-num2-paddingleft-1{padding-left:35px}li.list-num2-paddingleft-2{padding-left:40px}li.list-dash{background-image:url(http://bs.baidu.com/listicon/dash.gif)}ul.custom_dash{list-style:none;}ul.custom_dash li{background-position:0 3px;background-repeat:no-repeat}li.list-dash-paddingleft{padding-left:35px}li.list-dot{background-image:url(http://bs.baidu.com/listicon/dot.gif)}ul.custom_dot{list-style:none;}ul.custom_dot li{background-position:0 3px;background-repeat:no-repeat}li.list-dot-paddingleft{padding-left:20px}.list-paddingleft-1{padding-left:0}.list-paddingleft-2{padding-left:30px}.list-paddingleft-3{padding-left:60px} </style> "+
a.content;a={attrs:a,returnInfo:1};a.action=!this.dragId&&b&&this.funcid!="mbox:restoreDraft"?"firstsave":b?"save":e.isReply||e.isReplyAll?"reply":e.isForward?"forward":"deliver";var j=function(a,d){e.doBtnStatus(!1,0);try{if(a.code=="S_OK"){if(b){oWrite.oldData=oWrite.getCurrData();oWrite.changed=!1;if(a["var"]){e.dragId=a["var"];var j=parent.GE.folderObj.draft;parent.GE.tab.exist(j)&&parent.MM[j].refresh(!0)}e.saveDraftType=="auto"?parent.CC.showMsg(e.getNotice("auto"),!0,!1,"option"):e.saveDraftType==
"hand"&&parent.CC.showMsg(e.getNotice("hand"),!0,!1,"option");e.needAutoSave=!1}else e.showOk(f,g,a);typeof c=="function"&&c()}else h(a,d)}catch(q){e.doBtnStatus(!1,0)}PageState=PageStateTypes.Common};typeof c=="function"&&j();var h=function(a,c){e.composeFailCallback(a,c,b)};typeof d=="function"&&(h=function(){PageState=PageStateTypes.Common;d()});parent.MM.mailRequestApi({func:"mbox:compose",data:a,call:j,failCall:h,params:{comefrom:5,categoryId:"103000000",module:"web"},msg:""});oWrite.sendLock&&
clearTimeout(oWrite.sendLock)},showOtherText:function(a,b){var c=$(b),d=Lang.Mail.Write.delCS,e=$("ccopy");$("trCS");if(b!="trCS")d=Lang.Mail.Write.delMS,e=$("bccopy");if(c.style.display=="none")c.style.display="",a.innerHTML=d,e.focus(),oWrite.focusId=e.id,oWrite.setTextHeight(e.id);else{e.value!=""&&parent.CC.confirm(Lang.Mail.Write.confirmDel+d+Lang.Mail.Write.confirmAddr+"\uff1f",function(){e.value=""});d=Lang.Mail.Write.addCC;if(b!="trCS")d=Lang.Mail.Write.addBCC;c.style.display="none";a.innerHTML=
d}this.setSize()},doAllToOneClick:function(a){if(typeof a=="boolean")$("chkAllToOne").checked=a;a=$("chkAllToOne").checked;$("trTO");var b=$("trCS"),c=$("trMS"),d=$("recipient"),e=$("ccopy"),f=$("bccopy"),g="";if(a)this.oldTo=d.value,this.oldCc=e.value,this.oldBc=f.value,this.oldCcShow=parent.El.visible(b),this.oldBcShow=parent.El.visible(c),g=d.value,e.value&&(g+=";"+e.value),f.value&&(g+=";"+f.value),d.value=parent.Email.getEmailString(g),$("hrefCS").style.display="none",$("hrefMS").style.display=
"none",parent.El.hide(b),parent.El.hide(c),e.value="",f.value="";else{this.oldCcShow?(b.style.display="",e.value=this.oldCc,$("hrefCS").innerHTML=Lang.Mail.Write.delCS):$("hrefCS").innerHTML=Lang.Mail.Write.addCC;this.oldBcShow?(c.style.display="",f.value=this.oldBc,$("hrefMS").innerHTML=Lang.Mail.Write.delMS):$("hrefMS").innerHTML=Lang.Mail.Write.addBCC;if(this.oldTo)d.value=this.oldTo;$("hrefCS").style.display="";$("hrefMS").style.display=""}this.doTextBlur("recipient");this.setSize()},doRecipient:function(){this.doSepClick("true");
GC.fireEvent($("tab_li0"),"click")},doSepClick:function(a){var b=$("writeSidebar"),c=$("switchDiv"),d=$("tabSwitch"),e=$("subjectColor"),f=parent.El.width(c),g=parent.El.width(b);parent.El.width(e);var g=f+g,j=$("writeContent"),h=typeof a=="undefined"?!parent.El.visible(b):null,k=$("writeWrapper"),l=$("switchDiv"),o=0;!isIE&&a&&a.type=="click"&&(a=void 0);a||h?(o=212,parent.El.show(b),parent.El.setStyle(j,{marginRight:g+5+"px"}),parent.El.setStyle(c,{marginLeft:-g+"px"}),parent.El.setStyle(k,{marginRight:-o+
"px"}),parent.El.setStyle(l,{marginLeft:"0px"}),parent.El.setStyle(e,{marginRight:g+5+"px"}),parent.El.removeClass(d,"on")):(o=top.Browser.isIE&&top.Browser.ie<7?-2:0,parent.El.hide(b),parent.El.setStyle(j,{marginRight:f+5+"px"}),parent.El.setStyle(c,{marginLeft:-f+"px"}),parent.El.setStyle(k,{marginRight:o+"px"}),parent.El.setStyle(e,{marginRight:f+5+"px"}),parent.El.addClass(d,"on"));oWrite.setSize()},getNotice:function(a){var b=this.times*this.minutes,c=(new Date).toLocaleTimeString();if(a=="auto")return Lang.Mail.Write.autoSaveToDraft.format(b,
c);else if(a=="hand")return Lang.Mail.Write.handSaveToDraft.format(b,c)},showWriteTips:function(a){var b=this.times*this.minutes,c=new Date,d=$("writeTips");parent.El.show(d);c=c.toLocaleTimeString();a?a=("<i></i>"+a+'<a class="close" href="javascript:fGoto();" onclick="oWrite.closeTips()"></a>').format(b,c):this.isAutoSave?(a="<i></i>"+Lang.Mail.Write.autoSaveToDraft+'<a class="close" href="javascript:fGoto();" onclick="oWrite.closeTips()"></a>',a=a.format(b,c),this.isAutoSave=!1):(a="<i></i>"+Lang.Mail.Write.mailSaveToDraft+
'<a class="close" href="javascript:fGoto();" onclick="oWrite.closeTips()"></a>',a=a.format(c));d.innerHTML=a;this.setSize()},closeTips:function(){var a=$("writeTips");a.innerHTML="";a.style.display="none";this.setSize()},showOk:function(a,b,c){try{var d=oWrite.composeId,e=parent.Email.get(a,!0).success.toArray(),f=parent.location.protocol+"//"+parent.location.host,g=e.join(","),a=b?b:0,b="";typeof c=="object"&&(b=c["var"].tid||"");var j=document.createElement("form"),h=document.createElement("input");
h.type="hidden";h.name="to";h.value=g;j.method="post";j.action=f+parent.gConst.composeOkUrl+"&isSchedule="+this.isSchedule+"&ssc="+a+"&tid="+b+"&composeid="+d;j.appendChild(h);document.body.appendChild(j);j.submit();var k=parent.GE.tab.doc.getElementById(parent.gConst.mainToolbar+parent.GE.tab.curid);parent.GE.curBar=k}catch(l){}},doTabClick:function(a){var a=a||"tab_li0",b=a=="tab_li0"?"tab_li1":"tab_li0";parent.El.addClass($(a),"on");parent.El.removeClass($(b),"on");parent.El.show($(a+"_div"));
parent.El.hide($(b+"_div"));a=="tab_li1"&&LP.draw();this.setSize()},setTextHeight:function(){},doTextFocus:function(a){var a=$(a),b=parent.EV.getEvent()||window.event;if(b&&b.type=="focus"){b=parent.El.getNodeType(a,!0);if(a&&(b=="text"||b=="textarea"))this.focusId=a.id;isIE&&parent.El.addClass(a,"focus")}},doTextKeydown:function(a){var a=$(a),b=parent.EV.getEvent()||window.event,c=parent.EV.getCharCode(b),a=parent.EV.getTarget(b),d=a.value,d=d.substring(d.length-1);(d==","||d==";"||d=="")&&(c==186||
c==188)&&parent.EV.stopEvent(b);a.focus();c==13&&parent.EV.stopEvent(b)},doTextKeyUp:function(a){var a=$(a),b=a.value,b=b.replace(/[;,\s]+/gi,";");a.value=b},doTextBlur:function(a){a=$(a);isIE&&parent.El.removeClass(a,"focus")},selectMail:function(a,b){var c=b||a,d=$(oWrite.focusId),e=d.value||"",e=e.replace(/[,]+/gi,";"),e=e.replace(/^;/,""),f=e.lastIndexOf(";"),g=oWrite.richInputBox;if(e=="")d.value=c;else if(e.indexOf(c)<0)e=e.replace(/[;]{2,}/,";"),d.value=f>0?e.substring(0,f+1)+c:c;g instanceof
RichInputBox&&g.createItemFromTextBox();oWrite.needAutoSave=!0;oWrite.changed=!0},getSentSaveDefault:function(){if(parent.gMain.sendSave.toString()==""){if(parent.LoginType==parent.gConst.loginType.pm||parent.LoginType==parent.gConst.loginType.mm)return parent.gMain.defaultPrefSavesendPublic;if(parent.LoginType==parent.gConst.loginType.web)return parent.gMain.defaultPrefSavesend}return parent.gMain.sendSave},changeMail:function(a){for(var a=a.split(/[,;]/g),b=0,c=a.length;b<c;b++)a[b]!=""&&a[b].split("@").length==
1&&b<c-2&&(a[b+1]=a[b]+"."+a[b+1],a[b]="");return a.join(";")},fillMailData:function(){if(this.pageLoaded){var a=this.initData,b=0,c="",c=parent.CC.getSentSaveDefault(),d=a.headers.color||parent.gMain.curColor,e=a.denyForward||0,f=a.headers;if(this.isReplyAll||this.isReply||this.isForward||this.isForwardAll)a.saveSentCopy=c;d&&parent.gConst.subjectColor&&jQuery("#txtsubject").css("color",parent.gConst.subjectColor[d].value);if(a&&typeof a=="object"){if(a.mid)this.mid=a.mid;if(a.omid)this.omid=a.omid;
c=a.to;c=this.changeMail(c);this.ribs.length&&this.ribs[0]instanceof RichInputBox&&this.ribs[0].insertItem(c);if((this.isDrag||this.isReplyAll)&&a.cc)$("compose_CC").style.display="",this.ribs.length&&this.ribs[1]instanceof RichInputBox&&this.ribs[1].insertItem(this.changeMail(a.cc));if(this.isDrag&&a.bcc)$("compose_SCC").style.display="",this.isSCC=!0,$("sccLink").innerHTML=parent.Lang.Mail.Write.delSCC,this.ribs.length&&this.ribs[2]instanceof RichInputBox&&this.ribs[2].insertItem(this.changeMail(a.bcc));
if(b=a.subject){if(b.indexOf(":")>0&&(c=b.substr(0,b.indexOf(":")),d=b.substr(b.indexOf(":")),c=="Re"||c=="Fw"))parent.gMain.replyPrefix==4&&(c=="Re"?b=parent.Lang.Mail.tips042+d:c=="Fw"&&(b=parent.Lang.Mail.tips043+d));$("txtsubject").value=b}a.saveSentCopy=="1"?$("chkSaveToSentBox").checked=!0:$("chkSaveToSentBox").checked=!1;a.attachments&&attach.render(a);if(a.priority)$("chkUrgent").checked=a.priority==parent.GE.priority.hight?!0:!1;if(a.requestReadReceipt)$("chkReceipt").checked=a.requestReadReceipt==
1?!0:!1;if(a.smailType==1)$("numberSign").checked=!0;else if(a.smailType==2)$("numberEncrypt").checked=!0;else if(a.smailType==3)$("numberEncrypt").checked=!0,$("numberSign").checked=!0;b="\u8fd9\u662f\u4e00\u5c01\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u5bf9\u65b9\u9605\u8bfb\u5b8c\u540e\uff0c\u90ae\u4ef6\u5c06\u81ea\u52a8\u9500\u6bc1";if(a.keepFlag==2)jQuery("#ckbAutoDestroy").prop("checked",!0);else if(a.keepFlag==1)this.isAutoDestroy=!0,jQuery("#ckbDaysDestroy").prop("checked",!0),jQuery("#inputReadDays").val(a.keepDay),
b="\u8fd9\u662f\u4e00\u5c01\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u5bf9\u65b9\u6536\u5230\u90ae\u4ef6"+a.keepDay+"\u5929\u540e\uff0c\u90ae\u4ef6\u5c06\u81ea\u52a8\u9500\u6bc1";if(a.keepFlag==1||a.keepFlag==2)this.isAutoDestroy=!0,jQuery("#chkAutoDestroy").prop("checked",!0),this.addAutoDesMsgHtml(),jQuery("#autoDestroyMailTips").html(b).show();if(e&&jQuery("#chkForbiddenForward"))jQuery("#chkForbiddenForward")[0].checked=e;if(e)this.denyForward="1";a.showOneRcpt&&$("lookAllAsSingleLink").click();this.encryptMail&&
f&&f.mailPass&&this.encryptMailClass.restorePassword(f.mailPass);Plugins.able("securityMail")&&f&&f.securityLevel&&Plugins.find("securityMail").recoverStatus(f.securityLevel,this);this.loadDiskFiles();b=a.scheduleDate}this.showMailContent();Editor.editorValue=Editor.getEditorValue();this.initTimeSend(b);this.setSize()}},showMailContent:function(a,b){var c=this.initData,d=typeof c.isHtml=="undefined"?1:c.isHtml,c=c.content||"",e="";d||(c=c.encodeHTML(),c=c.replace(/\n/g,"<br>"));e=b?a+"<div><br><br></div>"+
c:this.isForward||this.isForwardAll?"<div><br /><br /></div>"+(a||c):a||c;if(this.isReply||this.isReplyAll||this.isForward)if(e=e.replace(/id=['"]?divsignature['"]?/,""),e=e.replace(/id=['"]?disk_attach_file_list_for_readmail['"]?/,""),e=e.replace(/([^<]+<blockquote [^>]+)border-left:[^;"]+;?("?)/i,"$1$2"),e=e.replace(/([^<]+<blockquote [^>]+)padding-left:[^;"]+;?("?)/i,"$1$2"),top.gMain.addo=="2"&&!this.isForward){Editor.setEditorValue("<div><br><br></div>");return}b=0;this.funcid!=parent.gConst.compose&&
!d&&(b=1);if(this.isReply||this.isReplyAll||this.isForward)this.isForward||Editor.setEditorValue("<div>&nbsp;</div><div>&nbsp;</div><div>&nbsp;</div>"),this.setDefaultSign(),e=Editor.getEditorValue()+e;Editor.setEditorValue(e+"<div><br><br></div>");b==1&&Editor.changeBackPic()},showTemplateContent:function(a,b){Editor.setEditorValue(a);typeof b=="function"&&b(Editor.win)},setFocus:function(){try{this.funcid==parent.gConst.func.reply||this.func==parent.gConst.func.replyAll?Editor.editorFocus():$("recipient").focus()}catch(a){}},
showLetterPaper:function(){this.doSepClick(!0);GC.fireEvent($("tab_li1"),"click")},setSubjectTxt:function(a,b){var c=$("txtsubject");if(c){if(b){if(c.value.toString().trim()=="")c.value=a}else c.value=a;if(this.titleErrTips&&this.titleErrTips instanceof ToolTips)this.titleErrTips.close(),this.titleErrTips=null;oWrite.needAutoSave=!0;oWrite.changed=!0}},getCurrData:function(){var a="",a=jQuery(".RichInputBox").eq(1).is(":hidden")?"":jQuery(".RichInputBox").eq(1).text(),b="",b=jQuery(".RichInputBox").eq(2).is(":hidden")?
"":jQuery(".RichInputBox").eq(2).text();return{content:Editor.getEditorValue(),subject:jQuery("#txtsubject").val(),tos:jQuery(".RichInputBox").eq(0).text(),cc:a,micc:b,isQunFaDanXian:oWrite.isLookAllAsSingle}},checkChange:function(){var a=oWrite.oldData,b=oWrite.getCurrData(),c;for(c in b)if(a[c]!=b[c])return!0;return!1},test:"",tryInclude:function(a,b){if(a&&b instanceof Array)for(var c=0;c<b.length;c++)if(a.indexOf(b[c])>0)return!0;return!1}},LP={count:14,pageNum:12,list:[],pageArr:[],curPage:0,
path:"",staSmall:"",staOther:"",staBody:"",init:function(){this.path=parent.gMain.resourceRoot.indexOf("http")>-1?parent.gMain.resourceRoot:location.protocol+"//"+location.host+parent.gMain.resourceRoot;this.staSmall=this.path+"/images/letter/";this.staOther=this.path+"/images/letter/";this.staBody=this.path+"/images/letter/";for(i=0;i<this.count;i++)this.list[i]={smallImg:this.staSmall+"pic"+(i+1)+".gif"}},draw:function(){var a=$("tdStationery");if(a.innerHTML==""){this.list.length==0&&this.init();
for(var b=this.count,c=this.pageNum,d=Math.ceil(b/c),e=0,f=[],g=0;g<d;g++){this.pageArr[this.pageArr.length]="LPPage_"+g;f[f.length]='<div id="LPPage_'+g+'" style="';g!=0&&(f[f.length]="display:none;");f[f.length]='">';for(var j=0;j<c&&e<b;j++)f[f.length]='<a href="javascript:fGoto();"  onclick="LP.setStationery('+e+');return false;"><img alt="" src="'+this.list[e].smallImg+'" /></a>',e++;f[f.length]="</div>"}$("spanPageNum").innerHTML="1/"+this.pageArr.length;a.innerHTML=f.join("")}},setStationery:function(a){a=
Math.max(a,0);a=Math.min(a,this.list.length-1);a=this.list[a].smallImg.replace(".gif","")+"/";Editor.setLetter(a);try{oTemplate.setEdit(Editor.win)}catch(b){}},showNextPage:function(){this.curPage++;if(this.curPage>=this.pageArr.length)this.curPage=0;this.showCurPage()},showPrevPage:function(){this.curPage--;if(this.curPage<0)this.curPage=this.pageArr.length-1;this.showCurPage()},showCurPage:function(){$("spanPageNum").innerHTML=this.curPage+1+"/"+this.pageArr.length;for(var a=0;a<this.pageArr.length;a++)a==
this.curPage?$(this.pageArr[a]).style.display="":$(this.pageArr[a]).style.display="none"},clearStationery:function(){Editor.clearLetter()}},b_isIE9=top.Browser.isIE&&top.Browser.ie==9,b_isIEAndNot9=top.Browser.isIE&&top.Browser.ie!=9,savedBookmark=null,Editor={menu:null,isHtml:!0,initilized:!1,lpImgNum:8,signNameLen:20,init:function(){if(this.initilized!=!0){try{var a=$("htmlEditor"),b=a.contentWindow,c=b.document,d=c.body;if(a.style.display!="none"&&(document.addEventListener?c.addEventListener("click",
function(){Editor.hideMenu()},!0):document.attachEvent&&c.attachEvent("onclick",function(){Editor.hideMenu()}),!parent.Browser.isIE))c.designMode="on",c.contentEditable=!0;this.ifmElement=a;this.win=b;this.doc=c;this.body=d;this.editorValue=this.getEditorValue()||"";this.$=function(a){return Editor.doc.getElementById(a)};parent.documentEventManager&&parent.documentEventManager.addDoc(c)}catch(e){}top.Browser.isIE&&this.doc&&this.ifmElement&&(parent.EV.observe(this.ifmElement,"beforedeactivate",function(){savedBookmark=
Editor.getBookMark(Editor.doc)}),parent.EV.observe(this.ifmElement,"activate",function(){savedBookmark&&(Editor.moveToBookMark(Editor.doc,savedBookmark),savedBookmark=null)}));(function(a){var b=a.browser,e=b.msie;b.opera?a(c).bind("keydown",function(a){if(a.ctrlKey&&a.which===86)return window.captureClipboard&&window.captureClipboard()}):a(e?d:c).bind(e?"beforepaste":"paste",function(){return window.captureClipboard&&window.captureClipboard()})})(jQuery);jQuery("#editor_spellcheck").bind("click",
Editor.spellCheck);this.initilized=!0}},showMenu:function(a){Editor.getEditorMode()?(a=$(a),Editor.hideMenu(),a.style.display="block",Editor.menu=a,isIE||Editor.win.blur(),(a=parent.EV.getEvent())&&parent.EV.stopEvent(a)):Editor.menu=null},hideMenu:function(){var a=this.menu;if(a)a.style.display="none"},doMenu:function(a,b){function c(){Editor.win.focus();b?Editor.doc.execCommand(a,!1,b):isIE?Editor.doc.execCommand(a):Editor.doc.execCommand(a,!1,!1)}var d=!0;if(Editor.getEditorMode()){switch(a.toLowerCase()){case "insertimage":if(b_isIEAndNot9){Editor.win.focus();
var e="<img crs='{0}' src='{0}' />".format(b),f=Editor.getSelection(Editor.win),g=Editor.getRangeObj(f);if(f.type&&f.type.toLowerCase()=="control")g.item(0).outerHTML=e;else try{g.pasteHTML(e)}catch(j){Editor.body.innerHTML=e+Editor.body.innerHTML}jQuery("img[crs='{0}']".format(b),Editor.doc).each(function(){this.src=b;jQuery(this).removeAttr("crs")});d=!1}else d=!0;break;case "createlink":if(Editor.getSelectedText(Editor.win)==""){CC.alert(parent.Lang.Mail.tips044);return}CC.prompt({id:"link_promot",
html:parent.Lang.Mail.tips045+"$TEXT$",seize:30,maxlength:500,value:""},function(a){(b=a.value)&&b.indexOf("://")<=0&&(b=window.location.protocol+"//"+b);b&&c()},parent.Lang.Mail.tips046,function(){d=!1});d=!1;break;default:d=!0}d&&c();Editor.hideMenu()}else this.menu=null},getSelectedText:function(a){if(a.getSelection)return a.getSelection().toString();else if(a.document.getSelection)return a.document.getSelection();else if(a.document.selection)return a.document.selection.createRange().text;return""},
createImages:function(){if(Editor.getEditorMode()){Editor.hideMenu();Editor.menu=$("divImage");var a=$("divImage");a.style.display="block";isIE||Editor.win.blur();if(a.innerHTML==""){var b=top.gConst.composeUploadImgUrl;a.innerHTML="<iframe id='frmImg' border=0 marginWidth=0 marginHeight=0 frameBorder=no style='width:350px;height:186px' src='#'></iframe>";$("frmImg").src=b+"&rnd="+ +new Date}(a=parent.EV.getEvent())&&parent.EV.stopEvent(a)}else Editor.menu=null},showPortrait:function(){if(Editor.getEditorMode()){Editor.hideMenu();
Editor.menu=$("divPortrait");var a=$("divPortrait");a.style.display="block";isIE||Editor.win.blur();if(a.innerHTML==""){var b=parent.gConst.portraitUrl;a.innerHTML="<iframe id='frmPortrait' border='0' marginWidth=0 marginHeight=0 frameBorder=no style='width:208px;height:202px' src='#'></iframe>";$("frmPortrait").src=b+"&rnd="+ +new Date}(a=parent.EV.getEvent())&&parent.EV.stopEvent(a)}else Editor.menu=null},captureScreen:function(){window.captureScreen()},addLetters:function(){oWrite.showLetterPaper()},
showSign:function(){if(Editor.getEditorMode()){Editor.hideMenu();Editor.menu=$("sign");var a=$("sign"),b=$("signature");a.style.display="block";b.innerHTML="";var a=Editor.signNameLen,c=oWrite.signList,d=oWrite.corpSignList,e=[],f="",g="";e.push("<li><a href='jacascript:fGoto();' onclick='Editor.setSignIndex(\"-1\"); return false;' title='"+parent.Lang.Mail.tips047+"' class='notuse'>"+parent.Lang.Mail.tips047+"</a>");if(c.length>0){for(var j=0;j<c.length;j++)f=c[j].title,g=c[j].title.decodeHTML().left(a,
!0).encodeHTML(),e.push('<li><a href="javascript:fGoto();" onclick="Editor.setSignIndex(\''+j+'\')" title="'+f+'">'+g+"</a></li>");e.push('<li class="line"></li>')}if(d.length>0){for(j=0;j<d.length;j++)f=d[j].title,g=d[j].title.decodeHTML().left(a,!0).encodeHTML(),e.push('<li><a href="javascript:fGoto();" onclick="Editor.setSignIndex(\''+j+'\', true)" title="'+f+'">'+g+"</a></li>");e.push('<li class="line"></li>')}e.push('<li><a href=\'javascript:fGoto();\' onclick="Editor.addSign()"  class="set">'+
Lang.Mail.Write.msg_edit_sign+"</a></li>");b.innerHTML=e.join("");(b=parent.EV.getEvent())&&parent.EV.stopEvent(b)}else Editor.menu=null},setSignIndex:function(a,b){a=="-1"?Editor.clearSign():(Editor.hideMenu(),Editor.getEditorMode(),Editor.setSign(b?oWrite.corpSignList[a]:oWrite.signList[a]))},setSign:function(a){if(a){var b=a.content.decodeHTML().decodeHTML();a.isAutoDate&&(b+="<br><br>"+top.Util.formatDate(new Date,"yyyy-mm-dd"));var c=Editor.doc.getElementsByTagName("BODY")[0],a=Editor.$("divsignature");
Editor.$("backPic1")?(c=Editor.$("backPic3"),a?a.innerHTML="---------<br>"+b:c.innerHTML=c.innerHTML+"<div>&nbsp;</div><div>&nbsp;</div><div>&nbsp;</div><br><div id='divsignature'>---------<br>"+b+"</div>"):a?a.innerHTML="---------<br>"+b:c.innerHTML=c.innerHTML+"<br><div id='divsignature'>---------<br>"+b+"</div>";oTemplate.setEdit(Editor.win)}},clearSign:function(){var a=Editor.$("divsignature");if(a)a.innerHTML="";Editor.hideMenu()},addSign:function(){Editor.hideMenu();parent.CC.setConfig("sign")},
setDefaultSign:function(){for(var a=parent.signList.concat(parent.corpSignList),b=!1,c=0,d=a.length;c<d;c++)if(a[c].isDefault=="1"){oWrite.ue.setContent('<br/><br/><span id="divsignature">'+a[c].content.decodeHTML()+"<br/>"+(a[c].isAutoDate=="1"?(new Date).format("yyyy-mm-dd"):"")+"</span>");b=!0;break}!b&&a.length>0&&oWrite.ue.setContent('<br/><br/><span id="divsignature">'+a[0].content.decodeHTML()+"<br/>"+(a[0].isAutoDate=="1"?(new Date).format("yyyy-mm-dd"):"")+"</span>")},pureText:function(a){var b=
this;Editor.hideMenu();Editor.menu=null;var c=$("sourceEditor"),d=$("htmlEditor"),e=$("spanEditor"),f=$("editor_tool_bar_up"),g=$("editor_menu_switch"),j=Editor.doc.getElementsByTagName("BODY")[0];b.isHtml?parent.CC.confirm(Lang.Mail.Write.htmltool_texteditor_changetips,function(){c.style.display="";d.style.display="none";f.style.display="none";e.style.visibility="hidden";c.value=Editor.getHtmlToTextContent();a.childNodes[0].innerHTML=Lang.Mail.Write.htmltool_htmlEditor;g.onclick();b.isHtml=!1}):
(c.style.display="none",d.style.display="",f.style.display="",e.style.visibility="visible",j.innerHTML=Editor.getTextToHtmlContent(),a.childNodes[0].innerHTML=Lang.Mail.Write.htmltool_texteditor,g.onclick(),b.isHtml=!0)},getHtmlToTextContent:function(){var a=Editor.doc.getElementsByTagName("BODY")[0],b="";if(isIE)b=a.innerText;else if(a=a.innerHTML,a=a.replace(/<script(?:.*?)>.*?<\/script>/g,""),a=a.replace(/<style(?:.*?)>.*?<\/style>/g,""),a==""||a=="<br>"||a=="<br/>")return"";else a=a.replace(/<br\s?\/?>/ig,
"\n"),b=document.createElement("div"),b.innerHTML=a,b=b.textContent;return b},getTextToHtmlContent:function(){var a=$("sourceEditor").value,b=document.createElement("div");return isIE?(a=a.replace(/\r?\n/g,"<br>"),a=a.replace(/ /g,"&nbsp;"),b.innerHTML=a,b.innerHTML):(b.appendChild(document.createTextNode(a)),b.innerHTML.replace(/\n/g,"<br>"))},getEditorMode:function(){return this.isHtml},setLetter:function(a){var b=oWrite.ue.getContent(),c=!1;jQuery("#oriMsgHtmlSeperator",oWrite.ue.document);for(var d=
1;d<8;d++)obj=jQuery("#backPic"+d,oWrite.ue.document),obj.length>0&&(d==6?obj.attr("src",a+d+".gif"):jQuery(obj).css("background-image","url("+a+d+".gif)"),c=!0);c||oWrite.ue.setContent("<TABLE id='backPic1' cellSpacing='0' cellPadding='0' width='99.9%' style=\"background:url("+a+"1.gif);margin-bottom:0;\" border='0'><TBODY><TR><TD height='100' style='border:0;padding:0' contentEditable=false unselectable=on>&nbsp;</TD></TR></TBODY></TABLE><TABLE cellSpacing='0' id='backPic2' cellPadding='0' width='99.9%' style=\"background:url("+
a+"2.gif);margin-bottom:0;\"><TBODY><TR><TD style='border:0;padding:0' width='5%' contentEditable=false unselectable='on'></TD><TD  id='backPic3' style='FONT-SIZE: 12px; COLOR: #666666; LINE-HEIGHT: 25px; background:url("+a+"3.gif) repeat;border:0;padding:0' vAlign='top' width='90%'><DIV><STATIONERY>"+(b.length>0?"":"<BR><BR>")+"<DIV id='stContent'>"+b+"</DIV></STATIONERY></DIV></TD><TD width='5%' style='border:0;padding:0' contentEditable=false unselectable='on'></TD></TR></TBODY></TABLE><TABLE id='backPic4' style='background:url("+
a+"4.gif) repeat-x 50% top;' cellSpacing='0' cellPadding='0' width='99.9%'><TBODY><TR><TD id='backPic5' style='border:0;padding:0;BACKGROUND-POSITION: 0px 100%; BACKGROUND-REPEAT: no-repeat' width='125' ><IMG id='backPic6' contentEditable=false unselectable=on  height='147' src='"+a+"6.gif' width='320'></TD><TD id='backPic7' contentEditable=false unselectable=on style='border:0;padding:0;background:url("+a+"7.gif) no-repeat 100% 100%;'>&nbsp;</TD></TR></TBODY></TABLE>")},clearLetter:function(){var a=
oWrite.ue.document.getElementsByTagName("BODY")[0],b=oWrite.ue.document.getElementById("backPic1");if(b!=null&&b!=void 0&&(b=oWrite.ue.document.getElementById("backPic3"),b!=null&&b!=void 0))a.innerHTML=b.innerHTML},editorFocus:function(){},setEditorFocus:function(){var a=Editor.doc;if(document.all){var b=a.body.createTextRange();b.moveStart("character",0);b.moveToElementText(a.getElementById("stContent").firstChild.firstChild||a.getElementById("stContent"));b.collapse(!1);b.select()}},getEditorValue:function(){return oWrite.ue.getContent()},
setEditorValue:function(a){oWrite.ue.setContent(a)},checkValueChange:function(){var a=this.editorValue||"",b=this.getEditorValue();this.editorValue=b;return a==b},changeBackPic:function(){if(Editor.getEditorMode()){var a=Editor.$,b=Editor.lpImgNum,c="";if(a("backPic1"))for(var d=2;d<=b;d++)c=a("backPic"+d),c.id+="1"}},blankClick:function(){Editor.hideMenu()},showTableSelect:function(){var a=$("tabSelect"),b=[];Editor.hideMenu();Editor.menu=a;for(var c=0;c<10;c++){b.push("<tr>");for(var d=0;d<10;d++)b.push('<td r="'+
c+'" c="'+d+'"><div></div></td>');b.push("</tr>")}a.innerHTML='<p id="tabSelect_tips">'+Lang.Mail.Write.choseTableSize+"</p><table><tbody>"+b.join("")+"</tbody></table>";Editor.menu.style.display="block";isIE||Editor.win.blur();jQuery("#tabSelect td").unbind("mouseover").bind("mouseover",function(){var a=parseInt(jQuery(this).attr("r")),b=parseInt(jQuery(this).attr("c"));jQuery("#tabSelect_tips").html(Lang.Mail.Write.insertTableTips.format(a+1,b+1));jQuery("#tabSelect td").each(function(){jQuery(this).attr("r")<=
a&&jQuery(this).attr("c")<=b?jQuery(this).addClass("on"):jQuery(this).removeClass("on")})}).unbind("click").bind("click",function(){var a=parseInt(jQuery(this).attr("r")),b=parseInt(jQuery(this).attr("c"));Editor.doc.getElementsByTagName("BODY");for(var c=[],d=0;d<=a;d++){c.push("<tr>");for(var h=0;h<=b;h++)top.Browser.isIE?c.push('<td style="width:50px;">&nbsp;</td>'):c.push('<td style="min-width:50px;">&nbsp;</td>');c.push("</tr>")}a='<table cellspacing="0" cellpadding="0" border="1"><tbody>'+c.join("")+
"</tbody></table>";Editor.insertHTML(a);Editor.hideMenu()})},getRangeObj:function(a){if(a.createRange)return a.createRange();else if(a.getRangeAt)return a.getRangeAt(0);else if(Editor.doc.createRange){var b=Editor.doc.createRange();b.setStart(a.anchorNode,a.anchorOffset);b.setEnd(a.focusNode,a.focusOffset);return b}},getSelection:function(a){var a=a||window,b;if(a.getSelection)b=a.getSelection();else if(a.document.selection)b=a.document.selection;return b},insertHTML:function(a){Editor.win.focus();
var b=this.getSelection(Editor.win),c=this.getRangeObj(b),d=d||parent.Browser;if(d.isIE)if(d.ie>=9)c.deleteContents(),d=Editor.win.document.createElement("div"),d.innerHTML=a,a=d.firstChild,c.insertNode(a),c.setEndAfter(a),c.collapse(!1),b.removeAllRanges(),b.addRange(c);else if(b.type&&b.type.toLowerCase()=="control")c.item(0).outerHTML=a;else try{c.pasteHTML(a)}catch(e){Editor.body.innerHTML=a+Editor.body.innerHTML}else c.deleteContents(),a=c.createContextualFragment(a),d=a.lastChild,c.insertNode(a),
c.setEndAfter(d),c.collapse(!1),b.removeAllRanges(),b.addRange(c)},getBookMark:function(a){var b=a.selection.createRange(),a=a.body.innerHTML.length,c={};if(b.getBookmark)c.bookmark=b.getBookmark(),c.startOffset=b.moveStart("character",-a),c.endOffset=b.moveEnd("character",a);return c},moveToBookMark:function(a,b){if(b&&b.bookmark){var c=a.body.createTextRange(),d=a.body.innerHTML.length;c.moveToBookmark(b.bookmark);var e=c.duplicate(),f=e.moveStart("character",-d),d=e.moveEnd("character",d);if(f!=
b.startOffset||d!=b.endOffset)c.moveStart("character",f-b.startOffset),c.moveEnd("character",d-b.endOffset);try{c.select()}catch(g){}}},spellCheck:function(){if(checkSpell.res.length>0){var a=$("htmlEditor").contentWindow.document;checkSpell.ignoreAll(a)}var b=Editor.getEditorValue(),c=Editor.getHtmlToTextContent()||"";jQuery("#editor_spellcheck").html("\u91cd\u65b0\u68c0\u67e5");checkSpell.checkState==1&&parent.CC.showMsg("\u6b63\u5728\u68c0\u67e5...",!0,!1,"caution");a=!1;/[a-zA-z]+/.test(c)?/[\u4E00-\u9FA5]+/.test(c)?
(c={id:"confirm",title:"\u7cfb\u7edf\u63d0\u793a",type:"text",text:'\u62fc\u5199\u68c0\u67e5\u6682\u4e0d\u652f\u6301\u4e2d\u6587\u3002\u4e0d\u8fc7\uff0c\u6211\u4eec\u4ecd\u53ef\u4ee5\u68c0\u67e5\u60a8\u90ae\u4ef6\u4e2d\u7684\u6240\u6709\u82f1\u6587\u62fc\u5199\u3002<br><br>                         <input id="editorSpellChkTip" type="checkbox"/>&nbsp;\u4e0d\u518d\u63d0\u793a',zindex:1090,dragStyle:1,buttonType:"confirm",buttons:[{text:"\u68c0\u67e5",clickEvent:function(){checkSpell.doCheck(b);jQuery("#editorSpellChkTip",
parent.window.document).prop("checked")&&CC.writeUserAttributesToServer({_custom_editorSpellChkTip:"1"})}},{text:"\u4e0d\u68c0\u67e5",clickEvent:function(){jQuery("#editorSpellChkTip",parent.window.document).prop("checked")&&CC.writeUserAttributesToServer({_custom_editorSpellChkTip:"1"})},isCancelBtn:!0}]},CC.getUserAttributeFromLocal("_custom_editorSpellChkTip")===""?parent.CC.msgBox(c):a=!0):a=!0:(parent.CC.alert("\u5bf9\u4e0d\u8d77\uff0c\u62fc\u5199\u68c0\u67e5\u6682\u65f6\u53ea\u652f\u6301\u82f1\u6587\u3002",
null,"\u7cfb\u7edf\u63d0\u793a"),a=!1);c=/<(script|style)(?:.*?)>.*?<\/\1>/g;checkSpell.toBeAdded=b.match(c)||[];b=b.replace(c,"");a&&checkSpell.doCheck(b)}},checkSpell={checkState:0,res:[],tagArr:[],listNum:5,toBeAdded:[],doCheck:function(a){var a=a.replace(/\r\n|\r|\n/g,"").replace(/(<(\/div|br\s*\/?)>)/gi,"\n$1"),b=/(?:<.*?>)+/g,c=a.match(b)||[],d=a.split(b),d=checkSpell.arrFilter.call(d,function(a){return a!==void 0&&a!==""}),a=d.join(""),e=[],f=[];parent.CC.showMsg("\u6b63\u5728\u68c0\u67e5...",
!0,!1,"option");checkSpell.checkState=1;jQuery(".editorWrap").append('<div id="checkSpellLayout" style="position: absolute; z-index: 1000; height: 100%; width: 100%; top: 0px; left: 0px;"></div>');a=a.decodeHTML();jQuery.ajax({type:"POST",url:top.gMain.urlService+"/mail/conf.do?func="+top.gConst.func.spellCheck+"&sid="+top.gMain.sid+"&r="+(new Date).getTime(),data:a,contentType:"application/json",dataType:"json",success:function(a){var b=0,h=0,k=0;if(a.code=="S_OK"){a=a["var"];if(!(a==null||a.length<
1)){checkSpell.arrrForEach.call(a,function(b,c){var d=new Date,d=d.getTime()+Math.random()+"";a[c].sId=d;a[c].containTag=[];a[c].pos=parseInt(a[c].pos)});checkSpell.res=a;checkSpell.tagArr=c;for(checkSpell.arrrForEach.call(d,function(a,b){d[b]=d[b].decodeHTML()});h<d.length;h++){var l=b;b+=d[h].length;for(f[h]=[];k<a.length;k++)if(a[k].pos<b&&a[k].pos+a[k].src.length>b){f[h].push({src:a[k].src,pos:a[k].pos-l,sId:a[k].sId});break}else if(a[k].pos<l&&a[k].pos+a[k].src.length>l){f[h].push({src:a[k].src,
pos:a[k].pos-l,sId:a[k].sId});k++;break}else if(a[k].pos<b)f[h].push({src:a[k].src,pos:a[k].pos-l,sId:a[k].sId});else break}checkSpell.arrrForEach.call(f,function(a,b){d[b]=checkSpell.addRedSpan(a,d[b])});for(h=0;h<Math.max(c.length,d.length);h++)c[h]&&e.push(c[h]),d[h]&&e.push(d[h].replace(/\n/g,""));b=0;for(h=checkSpell.toBeAdded.length;b<h;b++)e.push(checkSpell.toBeAdded[b]);Editor.setEditorValue(e.join("").replace(/&nbsp;/g," "));var o=$("htmlEditor").contentWindow.document;jQuery("span.errorWord",
o).bind("click",function(a){checkSpell.showSuggestPanel.call(a.currentTarget,o);a.stopPropagation()})}parent.CC.showMsg("\u68c0\u67e5\u6210\u529f",!0,!1,"option");checkSpell.checkState=2;jQuery("#checkSpellLayout").remove()}else parent.CC.showMsg("\u5f88\u62b1\u6b49\uff0c\u62fc\u5199\u68c0\u67e5\u51fa\u9519\u4e86",!0,!1,"error")},fail:function(){jQuery("#checkSpellLayout").remove()}})},hasUnCloseTag:function(a){for(var b="",c=[],d=/^<\/[^>*]>/,c=0;c<checkSpell.res.length;c++)if(checkSpell.res[c].sId==
a){c=checkSpell.res[c].containTag;for(a=0;a<c.length;a++)b+=checkSpell.tagArr[c[a]];break}return/<[^>/]*>$/.test(b)||d.test(d)},addRedSpan:function(a,b){for(var c=[],d=b.length,e=a.length-1;e>=0;e--){var f=a[e].pos,g=a[e].src.length;f>=0?f+g>d?checkSpell.hasUnCloseTag(a[e].sId)?c.unshift(b.substring(f).encodeHTML()):c.unshift("<span class='errorWord' id='"+a[e].sId+"'>"+b.substring(f).encodeHTML()):c.unshift("<span class='errorWord' id='"+a[e].sId+"'>"+b.substring(f,f+g).encodeHTML()+"</span>"+b.substring(f+
g,d).encodeHTML()):f<0&&(Math.abs(f)+d>=g?checkSpell.hasUnCloseTag(a[e].sId)?c.unshift(b.encodeHTML().substring(0,f+g)+b.encodeHTML().substring(f+g)):c.unshift(b.encodeHTML().substring(0,f+g)+"</span>"+b.encodeHTML().substring(f+g)):c.unshift(b.encodeHTML()));d=f}c.unshift(b.substring(0,d).encodeHTML());return c.join("")},showSuggestPanel:function(a){var b=jQuery("#suggestPanel"),c=this.id;b.length<=0?(b=document.createElement("div"),b.id="suggestPanel",b.className="pop_wrapper w135",jQuery("#editor_body").append(b),
b.style.textAlign="center",b.style.zIndex=1001):(b.show(),b=b.get(0));for(var d='<ul class="module_pop">',e=checkSpell.res||[],f=e.length,g=0;g<f;g++)if(e[g].sId==c){if(e[g].cases.length>0)for(c=0;c<Math.min(checkSpell.listNum,e[g].cases.length);c++)d+="<li>"+e[g].cases[c]+"</li>";else d+="<li>\u6682\u65e0\u63d0\u793a</li>";break}d+='<li class="line"></li><li>\u5ffd\u7565</li><li>\u5ffd\u7565\u5168\u90e8</li></ul>';b.innerHTML=d;var j=jQuery(this),d=j.position(),e=a.documentElement.scrollTop||a.body.scrollTop,
e=d.top-e>jQuery("#editor_body").outerHeight()/2?d.top-e+34-b.offsetHeight:d.top-e+34+this.offsetHeight;jQuery(b).css({left:d.left+"px",top:e+"px"});jQuery(b).unbind("click").bind("click",function(b){checkSpell.clickSuggestItem.call(j,b,a);jQuery("#suggestPanel").hide()}).find("li:not(.line)").hover(function(){jQuery(this).css("background","#3b5998")},function(){jQuery(this).css("background","")});parent.documentEventManager&&(parent.documentEventManager.register("hideSpellPanel",function(){jQuery("#suggestPanel").hide()}),
parent.documentEventManager.addEvent("click","hideSpellPanel"),parent.documentEventManager.addDoc(document))},clickSuggestItem:function(a,b){var c=a.target,d=c.innerHTML;jQuery(c).is("li:not(.line)")&&(d.indexOf("\u5168\u90e8")>=0?checkSpell.ignoreAll(b):d.indexOf("\u5ffd\u7565")>=0?checkSpell.ignore(this):d&&d.indexOf("\u6682\u65e0\u63d0\u793a")<0&&checkSpell.wordReplace(this,d))},ignore:function(a){jQuery(a).replaceWith(jQuery(a).text())},wordReplace:function(a,b){jQuery(a).replaceWith(b)},ignoreAll:function(a){jQuery(".errorWord",
a).each(function(){var a=jQuery(this).text();jQuery(this).replaceWith(a)})},ajaxRequest:function(a){var b=a.url||"",a={func:a.func||"",data:a.data||[],call:a.callback||function(){},failCall:a.failback||function(){}};b!=""?(a.url=b,parent.MM.mailRequestWebApi(a)):parent.MM.mailRequest(a)},arrrForEach:function(a,b){for(var c=0,d=this.length;c<d;c++)typeof a==="function"&&Object.prototype.hasOwnProperty.call(this,c)&&a.call(b,this[c],c,this)},arrFilter:function(a,b){var c=[];if(typeof a==="function")for(var d=
0,e=this.length;d<e;d++)a.call(b,this[d],d,this)&&c.push(this[d]);return c}};oWrite.addPlugins("securityMail",{authority:"MAIL_INBOX_SECURITY"});
function loadWriteScript(){oWrite.ue=UE.getEditor("editor",{elementPathEnabled:!1,wordCount:!1,autoHeightEnabled:!1,sourceEditor:"textarea",initialFrameWidth:"100%"});oWrite.ue.ready(function(){oWrite.init();(function(a){var b=oWrite.ue.document;a(b.body).bind("click",function(){a("#suggestPanel").hide()});a(b).bind("paste",function(a){return window.captureClipboard&&window.captureClipboard(a,!0)});window.VBArray&&a(b).bind("keydown",function(a){if(a.ctrlKey&&a.which===86)return window.captureClipboard&&
window.captureClipboard(a,!0)})})(jQuery)});create()}
function create(){var a="mtUploader"+Math.random(),b=window.VBArray?'<OBJECT style="display:none" width="0" height="0" id="'+a+'" CLASSID="CLSID:354D8141-29AB-41CB-93FA-1908477CAD0C"></OBJECT>':'<embed id="'+a+'" type="application/x-yd-mail139activex" height="1" width="1" hidden="true"></embed>',c=navigator.userAgent.indexOf("Firefox")>-1;c?jQuery(b).appendTo(top.document.body):jQuery(document.body).append(b);a=c?top.document.getElementById(a):document.getElementById(a);oWrite.control=a}
PluginsState={unInitiliaze:"0",initiliazing:"1",initiliazed:"2"};function Plugins(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);this.name=a;this.error={};this.info=[];this.status=PluginsState.unInitiliaze;this.attrs={};this.initiliaze.apply(this,b)}Plugins.methodAPI=["render","init","registerEvent","run"];Plugins.items={};Plugins.find=function(a){return Plugins.items.hasOwnProperty(a)?Plugins.items[a]:!1};
Plugins.able=function(a){return(a=Plugins.find(a))?a.status=="complete"?!0:!1:!1};Plugins.add=function(a){a&&a.name&&(Plugins.items[a.name]=a)};Plugins.del=function(a){a&&Plugins.items[a]&&delete Plugins.items[a]};
Plugins.prototype={initiliaze:function(a){var b="",b="";this.status=PluginsState.initiliazing;b=a&&a[0]&&a[0].authority?a[0].authority.toUpperCase():this.name.toUpperCase();if(a&&a.free===!0||parent.GC.check(b)){this.log("initilazing");try{this.instance=new window[this.name](a),this.status=PluginsState.initiliazed,Plugins.items[this.name]=this.instance}catch(c){b=this.name+" create instance failed.",this.log(b),this.error=this.clog(b)}}else b=this.name+" initiliaze failed.",this.log(b),this.error=
this.clog(b)},clog:function(a){return{msg:a,time:(new Date).getTime()}},log:function(a){this.info.push(this.clog(a))},run:function(){if(!this.error||!this.error.msg)if(this.status=PluginsState.initiliazed&&this.instance)for(var a=0,b=Plugins.methodAPI.length;a<b;a++)if(typeof this.instance[Plugins.methodAPI[a]]=="function")this.instance[Plugins.methodAPI[a]](this.instance)}};function securityMail(){this.initiliaze.apply(this,arguments)}
securityMail.prototype={initiliaze:function(a){this.attrs=a||{};this.result={};this.inList=!1;if(jQuery("#security_mail_text")[0])jQuery("#security_mail_text")[0].innerHTML="\u8bf7\u9009\u62e9"},render:function(){},init:function(){var a=this;this.control={listPanel:jQuery("#security_mail_panel"),textPanel:jQuery("#security_mail_text"),trigger:jQuery("#security_mail_switch")};this.result.level=-1;this.maxLevel=parent.gMain.securityLevel||0;this.maxLevel-=0;this.sysCorpSecrecy=!parent.gMain.secretaryLevelCfg||
parent.gMain.secretaryLevelCfg==""?2:parent.gMain.secretaryLevelCfg;this.sysCorpSecrecy-=0;if(this.maxLevel>this.sysCorpSecrecy)this.maxLevel=this.sysCorpSecrecy;this.control.listPanel.find("li").each(function(b,c){b>a.maxLevel&&jQuery(c).hide()})},registerEvent:function(){var a=this;this.stopEvents();this.control.trigger.bind("click",function(){a.control.listPanel.show()});this.control.textPanel.bind("click",function(){a.control.listPanel.show()});this.control.listPanel.bind("mouseout",function(){a.inList=
!1;a.interval=setTimeout(function(){a.inList||a.control.listPanel.hide()},100)}).bind("mouseover",function(){a.inList=!0;a.interval&&clearTimeout(a.interval)});this.control.listPanel.find("li").each(function(){jQuery(this).bind("click",function(){var b=jQuery(this).find("a:eq(0)");a.control.textPanel.html(b.html());a.control.textPanel.html("&nbsp;&nbsp;&nbsp;&nbsp;"+b.html());a.result.level=b.attr("data-val")-0})})},run:function(){this.status="complete"},stopEvents:function(){this.control.trigger.unbind("click");
this.control.textPanel.unbind("click");this.control.listPanel.unbind("mouseout").unbind("mouseover");this.control.listPanel.find("li").each(function(){jQuery(this).unbind("click")})},gotoLevel:function(a){if(a>this.maxLevel)return!1;this.control.listPanel.find("li:eq("+a+")").trigger("click")},fixLevel:function(a){this.gotoLevel(a);this.stopEvents()},sendBefore:function(a){var b=[],c=[],d=[];if(a.ribs){if(a.ribs[0]&&a.ribs[0].items)for(var e in a.ribs[0].items)b.push(parent.Email.getValue(a.ribs[0].items[e].allText));
if(a.ribs[1]&&a.ribs[1].items)for(e in a.ribs[1].items)c.push(parent.Email.getValue(a.ribs[1].items[e].allText));if(a.ribs[2]&&a.ribs[2].items)for(e in a.ribs[2].items)d.push(parent.Email.getValue(a.ribs[2].items[e].allText))}b={func:"mail:GetSecurityClassification",url:"/mail/data.do",data:{mailSecurity:this.result.level||0,to:b.concat(c,d).join(",")},call:function(b){if(b.code=="S_OK")a.onlySendMail()},failCall:function(b){switch(b.code){case "VALIDATE_RECEIVER_ERROR":var c=b["var"];if(c&&c.length)if(c[0]!=
""||c[1]!="")b=[],c[0]!=""&&(b.push(parent.Lang.Mail.tips075),b.push("<br/>"),b.push(c[0]),b.push("<br/>")),c[1]!=""&&(b.push(parent.Lang.Mail.tips076),b.push("<br/>"),b.push(c[1]),b.push("<br/>")),b.push(parent.Lang.Mail.tips077),b={id:"confirm_securitymail",title:parent.Lang.Mail.Write.sysPrompt,text:b.join(""),type:"text",zindex:10001,buttons:[{text:parent.Lang.Mail.tips028,clickEvent:function(){if(c[0]!=""){var b=c[0].split(","),d;if(b&&b.length)for(var e=0;e<b.length;e++)for(var f=0;f<3;f++)(d=
a.ribs[f].getItemByEmail(b[e]))&&d.remove()}a.onlySendMail()},"class":"n_btn mt_8"},{text:parent.Lang.Mail.tips008,clickEvent:function(){},"class":"n_btn mt_8"}]},parent.CC.msgBox(b);else a.onlySendMail();else a.onlySendMail();break;case "VALIDATE_SENDER_ERROR":parent.CC.alert(parent.Lang.Mail.tips078);break;default:parent.CC.alert(parent.Lang.Mail.sysW)}},msg:""};parent.MM.doService(b)},recoverStatus:function(a,b){b.isReply||b.isForward||b.isReplyAll?(this.fixLevel(a),jQuery("#security_mail_switch").hide()):
this.gotoLevel(a)}};
jQuery(function(){function a(a){return(parent.gMain.trueName||"").encodeHTML()+"&lt;"+a+"&gt;"}var b=jQuery,c=!1,d="";cruAliasName=parent.CC.getUserAttributeFromLocal("cruAliasName");if(typeof aliasList!=="undefined"){for(var e=0;e<aliasList.length;e++)d+="<li",cruAliasName&&!oWrite.senderUser?aliasList[e].value===cruAliasName&&(d+=' class="on"'):!oWrite.senderUser&&aliasList[e].value===parent.gMain.loginName&&(d+=' class="on"'),d+='><a href="javascript:;">',d+='<i class="i-mcok"></i>',d+='<span class="pop_wrt_slt" value="'+
aliasList[e].value.encodeHTML()+'">',d+=a(aliasList[e].value),d+="</span>",d+="</a></li>",cruAliasName===aliasList[e].value&&(c=!0);for(var f=CC.getFolders(),g=[],e=0,j=f.length;e<j;e++)f[e].type==6&&(g.push("<li "+(f[e].name==oWrite.senderUser?'class="on"':"")+'><a href="javascript:;"><i class="i-mcok"></i>'),g.push('<span class="pop_wrt_slt" value="'+f[e].userName.encodeHTML()+'">'),g.push(f[e].name.encodeHTML()),g.push("</span></a></li>"));b("#tipsAliasList").find("ul").eq(0).html(d);b("#tipsAliasList").find("ul").eq(1).html(g.join(""))}if(!c||
typeof isSelectAccount==="undefined")cruAliasName=parent.gMain.loginName;oWrite.senderUser?b("#selFrom").html(oWrite.senderUser).attr("value",oWrite.senderUser):b("#selFrom").html(a(cruAliasName)).attr("value",cruAliasName);if(typeof isSelectAccount==="undefined")return!1;b("#btnToggleAlias").click(function(){var a=b(".wrter_tool").offset();b("#tipsAliasList").css("zIndex",3E3);b("#tipsAliasList").toggle().css({top:a.top-b("#tipsAliasList").height(),left:a.left})});b("#tipsAliasList").on("click",
".pop_wrt_slt",function(){var c=b(this).attr("value").encodeHTML();b("#tipsAliasList").find(".on").removeClass("on");b(this).parent().parent().addClass("on");b("#selFrom").attr("value",c).html(a(c));b("#tipsAliasList").hide()});b("#btnToggleFuncBar").click(function(){b(this).hasClass("wrter_switch_off")?(b("#writer_func_container").hide(),b(this).removeClass("wrter_switch_off").addClass("wrter_switch_on")):(b("#writer_func_container").show(),b(this).removeClass("wrter_switch_on").addClass("wrter_switch_off"))})});
var contact={type:3,isShowValue:!0,setValue:null,isAsyn:!0,size:100,clearonclick:null,addAsGroup:!0,showLinkMan:function(a,b,c){c!=null&&(Lang=c);var d=setInterval(function(){if(parent.LMD.loadStatus==1){clearInterval(d);var c=parent.LMD.groupMap,f=contact.type==3?parent.LMD.group_contactListMap_mail:parent.LMD.group_contactListMap_phone,g=parent.LMD.RecentContactsMap,j=[],h=parent.LMD.addrGroup;j["2"]=h[2];j["0"]=parent.langconf?parent.langconf.crop_addr||"":h[0];j["5"]=h[5];j["3"]=h[3];h=[];h.push("<div class='write_contact'>");
h.push("<div class='deptList_div'>");for(var k=0;k<a.length;k++){h.push("<ul >");h.push('<li><a href="javascript:void(0)" style=\'width:188px\' onclick="contact.'+(a[k]=="0"?"showChildLinkMan_Asyn":"showChildLinkMan")+"('"+(a[k]=="2"?"-2":"0")+"',"+a[k]+')" class="fw_b pl_15 contactType_a" onmouseover="this.className=\'fw_b pl_15 contactType_a overColor\'" onmouseout="this.className=\'fw_b pl_15 contactType_a\'"><i id=\'i_'+a[k]+"_"+(a[k]=="2"?"-2":"0")+"' class=\"mr_5 "+(a[k]=="5"?"i-hminus":"i-sadd")+
'"  ></i>'+j[a[k]]+"</a>");h.push("<ul  id='ul_"+a[k]+"_"+(a[k]=="2"?"-2":"0")+"'"+(a[k]!="5"?" style='display:none'":"")+">");var l="";if(a[k]=="2"){if(l=f["2_-1"]&&f["2_-1"].length>0?contact.addAsGroup?"<i  class='addgroup' title='\u6dfb\u52a0\u5168\u90e8' deptId='{0}' type='{1}'     style='position: absolute; right: 2px; top: 1px; display: none;'></i>".format(-1,2):"":"",h.push('<li id=\'li_{3}_{0}\'><span class=\'fw_b pl_27 departList_span\'   onclick="contact.{1}(\'{0}\',{3},1)"><div class="p_relative"><a href="###" class="departList_a"  title ="{2}" style="width:135px"><i class="i-sadd mr_5" id="i_{3}_{0}"></i>{2}</a>{4}</div></span></li>'.format("-1",
"showChildLinkMan",Lang.Mail.noGroupPerson,2,l)),c["2_0"])for(var o=0;o<c["2_0"].length;o++){var q=c["2_0"][o][1],l=f["2_"+q]&&f["2_"+q].length>0?contact.addAsGroup?"<i  class='addgroup' title='\u6dfb\u52a0\u5168\u90e8' deptId='{0}' type='{1}'     style='position: absolute; right: 2px; top: 1px; display: none;'></i>".format(q,2):"":"";h.push('<li id=\'li_{3}_{0}\'><span class=\'fw_b pl_27 departList_span\'   onclick="contact.{1}(\'{0}\',{3},1)"><div class="p_relative"><a href="###" class="departList_a"  title ="{2}" style="width:135px"><i class="i-sadd mr_5" id="i_{3}_{0}"></i>{2}</a>{4}</div></span></li>'.format(q,
"showChildLinkMan",c["2_0"][o][2],2,l))}}else if(a[k]=="3"&&g["3"])for(o=0;o<g["3"].length;o++)h.push("<li style='overflow:hidden' onmouseover=\"this.className='overColor'\" onmouseout=\"this.className=''\" ><a href=\"javascript:void(0);\" class='pl_28 contactList_span' title='"+g["3"][o][2]+"<"+g["3"][o][3]+">' onclick=contact.setValue('"+g["3"][o][2]+"','"+g["3"][o][3]+"')>"+g["3"][o][2]+"</a></li>");else if(a[k]=="5"&&g["5"])for(l=0;l<g["5"].length;l++)contact.type==3&&g["5"][l][3]!=""&&h.push("<li style='overflow:hidden' onmouseover=\"this.className='overColor'\" onmouseout=\"this.className=''\" ><a href=\"javascript:void(0);\" class='pl_28 contactList_span' title='"+
g["5"][l][2]+"<"+g["5"][l][3]+">' onclick=contact.setValue('"+g["5"][l][2]+"','"+g["5"][l][3]+"')>"+g["5"][l][2]+"</a></li>");else contact.showChildLinkMan_Asyn(0,0,0,!0);h.push("</ul></li></ul>")}h.push("</div>");jQuery("#"+b).html(h.join(""));contact.bindEvent();contact.bindAddGroup()}},300)},showChildLinkMan:function(a,b,c){clearTimeout(this.clearonclick);this.clearonclick=setTimeout(function(){if(jQuery("#i_"+b+"_"+a).attr("class")=="mr_5 i-hminus"){if(jQuery("#i_"+b+"_"+a).attr("class","mr_5 i-sadd"),
jQuery("#ul_"+b+"_"+a).length>0){jQuery("#ul_"+b+"_"+a).attr("style","display:none");return}}else if(jQuery("#i_"+b+"_"+a).attr("class","mr_5 i-hminus"),jQuery("#ul_"+b+"_"+a).length>0){jQuery("#ul_"+b+"_"+a).attr("style","display:''");return}var d=parent.LMD.groupMap,e=contact.type==3?parent.LMD.group_contactListMap_mail:parent.LMD.group_contactListMap_phone,f=[],g="padding-left:"+(27+c*16)+"px",j="<li id='li_"+b+"_{0}' style='overflow:hidden' ><span style='"+g+";display:block;'  class='fw_b departList_span'  onclick=\"contact.showChildLinkMan('{0}',"+
b+',{1})" ><div class="p_relative" ><a href="###" title="{2}" class="departList_a" style="'+(NaN-(35+c*16)+"px")+'" ><i class="i-sadd mr_5" id="i_'+b+'_{0}"></i>{2}</a>{3}</div></span></li>';if(d[b+"_"+a]&&b=="0")for(var h=0;h<d[b+"_"+a].length;h++){var k=d[b+"_"+a][h][1],l="";e[b+"_"+k]&&e[b+"_"+k].length>0&&(l="<i  class='addgroup' title='\u6dfb\u52a0\u5168\u90e8' deptId='"+k+"' type='"+b+"'     style='position:absolute;right:2px;top:1px;display:none'></i>");f.push(j.format(k,c+1,d[b+"_"+a][h][2],
l))}if(e[b+"_"+a])for(d=0;d<e[b+"_"+a].length;d++)e[b+"_"+a][d][contact.type]!=""&&e[b+"_"+a][d][0]==b&&(j=e[b+"_"+a][d][2]+"&lt;"+e[b+"_"+a][d][contact.type]+"&gt;",f.push("<li style='overflow:hidden'><span class='contactList_span' onmouseover=\"this.className='overColor contactList_span'\" onmouseout=\"this.className='contactList_span'\" style='display:block;"+g+"'><a  href='javascript:;' title='"+j+"' onclick=contact.setValue('"+e[b+"_"+a][d][2].encodeHTML()+"','"+e[b+"_"+a][d][contact.type]+"','"+
e[b+"_"+a][d][1]+"')>"+(contact.isShowValue==!0?j:e[b+"_"+a][d][2])+"</a></span></li>"));e="";f.join("")!=""&&(e="<ul id='ul_"+b+"_"+a+"'>"+f.join("")+"</ul>");jQuery("#li_"+b+"_"+a).append(e)},300)},showChildLinkMan_Asyn:function(a,b,c,d){clearTimeout(this.clearonclick);var e=this;this.clearonclick=setTimeout(function(){var f=b+"_"+a;if(!d)if(jQuery("#i_"+f).hasClass("i-sadd")){if(jQuery("#i_"+f).removeClass("i-sadd").addClass("i-hminus"),jQuery("#ul_"+f).length>0){jQuery("#ul_"+f).show();return}}else if(jQuery("#i_"+
f).removeClass("i-hminus").addClass("i-sadd"),jQuery("#ul_"+f).length>0){jQuery("#ul_"+f).hide();return}for(var g=[],j="padding-left:"+(27+c*16)+"px",h=parent.LMD.groupMap[b+"_"+a]||[],k=0;k<h.length;k++){var l=h[k][1];g.push('<li id=\'li_{1}_{0}\' style=\'overflow:hidden\' ><span style=\'{2};display:block;\'  class=\'fw_b departList_span\'  onclick="{6}(\'{0}\',{1},{3})" ><div class="p_relative"><a href="###" class="departList_a" title="{4}" ><i class="i-sadd mr_5" id="i_{1}_{0}"></i>{4}</a>{5}</div></span></li>'.format(l,
"0",j,c+1,h[k][2],"<i  class='addgroup' title='\u6dfb\u52a0\u6574\u7ec4' deptId='{0}' type='0'  style='position: absolute; right: 2px; top: 1px; display:none'></i>".format(l),"contact.showChildLinkMan_Asyn"))}h="#ul_0_"+a;jQuery(h).length>0?jQuery(h).append(g.join("")):jQuery("#li_"+f).append("<ul id='ul_0_"+a+"'>"+g.join("")+"</ul>");e.go(null,a,0,j)},300)},go:function(a,b,c,d){var e={total:contact.size,recursive_flag:0,search_flag:1};d?(e.start=c*contact.size+1,e.deptId=b):(c=parseInt(jQuery(a.target).attr("index")),
b=jQuery(a.target).attr("id"),e.start=c*contact.size+1,e.deptId=b,d=jQuery(a.target).attr("a_style"));c>0&&jQuery(a.target).parents("li:eq(0)").remove();var f=[];parent.MM.mailRequest({func:"addr:searchUsers",data:e,call:function(a){var e="0_"+b;if(a.code=="S_OK"){for(var a=a["var"]||[],h=0;h<a.length;h++)f.push("<li style='overflow:hidden'><span class='contactList_span' onmouseover=\"this.className='overColor contactList_span'\" onmouseout=\"this.className='contactList_span'\"  style='display:block;{0}' title='{1}' onclick=contact.setValue('{2}','{1}','{3}')><a href='javascript:;' >{2}</a></span></li>".format(d,
a[h].email,a[h].firstName.encodeHTML(),a[h].id));var h="#ul_0_"+b,k="<li class='ta_c' style='overflow:hidden; padding-bottom:5px;'><a href='javascript:;' style='padding-right:0; color:#003be2;' id='"+b+"' index='"+(c+1)+"' a_style='"+d+"' class='nextPage' >\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a>>  </a></li>";jQuery(h).length>0?jQuery(h).append(f.join("")+(a.length==contact.size?k:"")):jQuery("#li_"+e).append("<ul id='ul_0_"+b+"'>"+f.join("")+"</ul>"+(a.length==contact.size?k:""))}}})},bindEvent:function(){jQuery(".departList_span").live("mouseover",
function(){jQuery(this).addClass("overColor");jQuery(this).find(".addgroup").show()});jQuery(".departList_span").live("mouseout",function(){jQuery(this).removeClass("overColor");jQuery(this).find(".addgroup").hide()});jQuery(".deptList_div").find(".nextPage").live("click",this.go)},bindAddGroup:function(){var a=this;jQuery(".write_contact").click(function(b){b=b.target;b.nodeName=="I"&&jQuery(b).attr("class")=="addgroup"&&a.addAllContact(b.getAttribute("deptId"),b.getAttribute("type"))})},Ajax:function(a,
b,c,d){parent.MM.doService({url:a,func:b,data:c,failCall:function(a){parent.CC.alert(a.summary)},call:function(a){d(a)},param:""})},addAllContact:function(a,b){function c(a){if(a)for(var b=0;b<a.length;b++)contact.setValue(a[b][2],a[b][contact.type],a[b][1])}clearTimeout(contact.clearonclick);var d=parent.LMD.group_contactListMap_mail;b=="2"?c(d[b+"_"+a]):b=="0"&&(d=parent.LMD.deptObj[a])&&contact.setValue(d[2],d[4],d[1])}};
