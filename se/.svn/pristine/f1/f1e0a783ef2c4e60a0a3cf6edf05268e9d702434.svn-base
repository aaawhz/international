var OptionBase=function(){if(RTB_items)for(var a in RTB_items)a&&RTB_items[a]instanceof RichTextBox&&(RTB_items[a]=null,delete RTB_items[a])};
OptionBase.prototype={initService:function(a,b,c){if(this.attrs.free||GC.check(this.attrs.authority)){var d=this;d.doService(a.list.func,a.list.data,function(a){d.initData(a["var"],b)},c)}else CC.forbidden()},doService:function(a,b,c,d,e){MM.doService({url:e||"/mail/conf",func:a,data:b,failCall:d||function(){},call:function(a){typeof c=="function"&&c(a)},param:""})},doServiceInXml:function(a,b,c,d,e){MM.doService({url:e||"/mail/conf",func:a,dataType:"xml",data:b,params:{format:"xml"},failCall:d||
function(){},call:function(a){typeof c=="function"&&c(a)},param:""})},request:function(a,b,c,d){if(this.attrs.free||GC.check(this.attrs.authority)){var e=this;if(a.noReq)e.initData("",b);else{var f=(a.list||{}).data||this.getData(a.data),g=function(a){e.initData(a,b)};d?e.ajaxRequest(a.list.func,f,g,c,a.url,a.ajaxType):e.ajaxRequest(a.list.func,f,g,c,a.ajaxType)}}else CC.forbidden()},ajaxRequest:function(a,b,c,d,e,f){b={data:b,call:function(a){try{typeof c=="function"&&c(a["var"])}catch(b){}},failCall:d||
function(){}};if(f==2||a==="user:getSignatures"){if(a==="user:getSignatures")b.func="user:getSignatures";b.url=e;MM.mailRequestApi(b)}else e?(b.url=e,MM.mailRequestWebApi(b)):(b.func=a,MM.mailRequest(b))},seqRequest:function(a,b,c,d){MM.seqRequest(a,b,null,d)},getData:function(a){var b=[],c;for(c in a)b.push(c.toLowerCase());return b.join("&")},initDataField:function(){var a=this.attrs.data,b;for(b in a){var c=a[b];if(c.attribute)c.attribute.value=""}},initData:function(a,b){var c=this.attrs;try{data=
c.data||c;if(Util.getVarType(a)!="array"&&!this.attrs.noReq)for(var d in data){var e=data[d],f="";if(a&&(f=a[d],typeof f!="undefined")){if(e.format)switch(e.format){case "time":f=parent.Util.formatDate(f);break;case "html":f=(f+"").decodeHTML();break;case "cdata":f+="";break;default:f=(f+"").decodeXML()}if(!e.attribute)e.attribute={};e.attribute.value=f}}typeof b=="function"?b.call(this,c,a):this.getHtml(c,a)}catch(g){CC.alert(g)}},getNavMenu:function(){return""},getHead:function(a,b,c){a="";b?a+=
'<p class="explanation">{0}</p>'.format(b):c&&(a+=c);return a},getBottom:function(a){return a?'<ol class="tips">{0}</ol>'.format(a):""},getTable:function(a,b,c){var d=[];d.push("<fieldset class=\"formSet\"><table cellpadding=\"0\"{0} id='{1}' style='{2}'><tbody>".format(a.tableClass?' class="'+a.tableClass+'"':"",b||"",c||""));for(var e in a.data)if(b=a.data[e],typeof b=="object"&&(typeof b.display=="undefined"||b.display))d.push(this.getTr(e,b,typeof a.data.id!="object"?a.data.id:""));d.push(this.getButtons(a.buttons,
a.data.id));d.push("</tbody></table></fieldset>");return d.join("")},getTableList:function(a){var b=[],c;b.push('<div class="{0}"><h2 style="font-weight:bold">{1}</h2>'.format("bwlist",a.title));b.push("<table class=\"tblSetList\" cellpadding='0'><tbody><tr>");for(c=0;c<a.head.title.length;c++)b.push("<th class='{0}'>{1}</th>".format(a.head.className[c],a.head.title[c]));b.push("</tr>");if(typeof a.items=="object")for(c=0;c<a.items.length;c++){if(a.items[c]){b.push("<tr>");for(var d=0;d<a.items[c].length;d++)b.push("<td class='{0}'>{1}</td>".format(a.head.className[d],
a.items[c][d]));b.push("</tr>")}}else b.push('</tbody><tbody id="tbList"><tr class="msgSetList"><td colspan="3">{0}</td></tr>'.format(a.items));b.push("</tbody></table></div>");return b.join("")},getHtml:function(a){var b=[],c=MM[gConst.setting].menuItem[a.id].name,d=a.tableAfter||"",e=a.tableBefore||"";b.push("<div class=\"bodySet\" style='align:text;'");a.divId&&b.push(' id="{0}"'.format(a.divId));b.push('><div id="container">');b.push(this.getTopHtml());this.attrs.id!="mailSearch"&&b.push(this.getLeftHtml());
b.push('<div class="setWrapper">');b.push(this.getHead(c,a.tips));b.push(e);b.push(this.getTable(a));b.push(d);b.push(this.getBottom(a.bottomHtml));b.push("</div></div></div>");MM[gConst.setting].update(this.attrs.id,b.join(""))},getButtons:function(a,b){b=b||"";a||(a=[{text:Lang.Mail.Ok,clickEvent:this.attrs.id+".save"},{text:Lang.Mail.Cancel,clickEvent:this.attrs.id+".goBack"}]);var c=[];c.push("<tr><td></td><td>");for(var d=0;d<a.length;d++)c.push('<a class="btn" href="javascript:fGoto();" onclick="{0}(\'{1}\');"><b class="r1"></b><span class="rContent"><span>{2}</span></span><b class="r1"></b></a>'.format(a[d].clickEvent,
b,a[d].text));c.push("</td></tr>");return c.join("")},getTr:function(a,b,c){var d=[],e=b.attribute||{},f=b.type,g=this.getFun[f]||function(){},h=b.text||"",k=b.before||"",l=b.after||"",m=b.ext?" "+b.ext:"";if(f=="others")a=this,e=b.values;a=g(a,e,b.items||b.text,c)||b.html||"";b.row?d.push('<tr{4}><td colspan="2">{0}{1}{2}{3}</td></tr>'.format(h,k,a,l,m)):d.push("<tr{4}><th>{0}</th><td>{1}{2}{3}</td></tr>".format(h,k,a,l,m));return d.join("")},getTextValue:function(a){var b="";if(a=this.getEl(a))b=
a.value||"",b=b.trim();return b},getCheckBoxValue:function(a){for(var b=[],a=this.getElementsByName(a),c=0;c<a.length;c++)a[c].checked==!0&&b.push(a[c].value);return b.join(",")||"0"},getRadioValue:function(a){for(var a=this.getElementsByName(a),b=0;b<a.length;b++)if(a[b].checked==!0)return a[b].value;return"0"},getSelectValue:function(a){a=this.getEl(a);return a.options.length>0?a.options[a.selectedIndex].value:"0"},getValue:function(a,b){var c="";switch(b||"text"){case "text":case "textarea":case "password":c=
this.getTextValue(a);break;case "radio":c=this.getRadioValue(a);break;case "select":c=this.getSelectValue(a);break;case "checkbox":c=this.getCheckBoxValue(a)}return c},getFormatValue:function(a,b){b=b||this.attrs.data[a];if(!b)return"";var c=b.format,d=this.getValue(a,b.type);if(d==""||d==null||d==void 0)b.attribute=b.attribute||{},d=b.attribute.defaultValue||"";if(c)switch(b.format){case "int":d-=0;isNaN(d)&&(d=0);break;case "time":d=parent.Util.parseDate(d).getTime()/1E3;break;case "text":d=(d+
"").trim();break;default:d=(d+"").encodeHTML().trim()}else d=(d+"").trim();return d},getEl:function(a){return $("option_"+a)},getElementsByName:function(a){return document.getElementsByName("option_"+a)},getFun:{text:function(a,b,c,d){d=d||"";(c=b.value||b.defaultValue||"")&&typeof c=="string"&&(c=c.replace(/"/g,"&quot;"));return'<input type="text" id="option_{0}" name="option_{0}" value="{1}" maxlength="{2}" class="{3}" {4} {5}/>'.format(a+d,c,b.maxLength||40,b.className||"text",b.ext||"",b.readonly?
" readonly='readonly'":"")},password:function(a,b,c,d){return'<input type="password" id="option_{0}" name="option_{0}" value="{1}" maxlength="{2}" class="{3}"  AUTOCOMPLETE="off" {4}/>'.format(a+(d||""),b.value||b.defaultValue||"",b.maxLength||20,b.className||"text",b.ext||"")},radio:function(a,b,c,d){d=d||"";c=c||[];b.value=""+b.value;var e=b.value||b.defaultValue,f=b.after||"",g=b.before||"",h=[],k;for(k in c){var l=a+k;h.push(g);h.push('<label><input type="radio" name="option_{0}" id="option_{1}" value="{2}" {3} class="{4}"/>{5}</label>'.format(a+
d,l,k,e==k?' checked="true"':"",b.className||"",c[k]));h.push(f)}return h.join("")},checkbox:function(a,b,c,d){d=d||"";c=c||[];b.value=""+b.value;var e=b.value||b.defaultValue,f=b.after||"",g=b.before||"",h=[],k;for(k in c){var l=[],m=b.event||{},n;for(n in m)l.push(n+"="+m[n]+"('"+a+k+"') ");m=a+k;h.push(g);h.push('<label><input type="checkbox" name="option_{0}" id="option_{1}" value="{2}" {3} class="{4}" {6}/>{5}</label>'.format(a+d,m,k,e==k?' checked="true"':"",b.className||"",c[k],l.join(",")));
h.push(f)}return h.join("")},select:function(a,b,c,d){c=c||[];b.value=""+b.value;var e=b.value||b.defaultValue,f=[];f.push('<select name="option_{0}" id="option_{0}" class="{1}" {2}>'.format(a+(d||""),b.className||"",b.ext||""));if(c instanceof Array){var g=function(a,b){for(var c=null,d=!1,h="",r=!1,q="",h="",t=0,u=a.length;t<u;t++)c=a[t],d=c.nodes&&c.nodes.length>0,r=t==a.length-1,q=b||"",h=c.parentId==0?"":r?"\u2514 ":"\u251c ",h=q+h+c.name,f.push('<option value="{0}" {1}>{2}</option>'.format(c.fid,
e==c.fid?' selected="true"':"",h)),d&&(q+=r||c.parentId==0?"&nbsp;":"\u2502 ",g(c.nodes,q))};g(c)}else for(var h in c)f.push('<option value="{0}" {1}>{2}</option>'.format(h,e==h?' selected="true"':"",c[h]));f.push("</select>");return f.join("")},textarea:function(a,b,c,d){return'<textarea type="text" id="option_{0}" name="option_{0}" rows="{1}" cols="{2}" class="{3}">{4}</textarea>'.format(a+(d||""),b.rows||4,b.cols||80,b.className||"",b.value||b.defaultValue||"")},label:function(a,b,c,d){return'<span id="option_{0}" class="{1}">{2}</span>'.format(a+
(d||""),b.className||"",b.value||b.defaultValue||"")},others:function(a,b,c,d){var c=[],e;for(e in b){var f=b[e],f=(0,a.getFun[f.type])(e,f.attribute||{},f.items||f.text,d);c.push(f)}return c.join("")}},getSaveData:function(a,b){var c=!0;typeof b=="function"&&(c=b.call(this));if(c){var c={},d;for(d in a){var e=a[d];!e.noset&&e.type!="label"&&(c[d]=this.getFormatValue(d,e))}return c}},displayErr:function(a){a?($("td_err").innerHtml=a,$("tr_err").display="block"):$("tr_err").display="none"},goBack:function(){CC.setConfig("")},
ok:function(a){CC.showMsg(a,!0,!1,"option")},fail:function(a,b){typeof b=="object"&&IsDebug&&(a+="<br>"+Lang.Mail.ConfigJs.failed_code+(b.errorCode||"")+","+Lang.Mail.ConfigJs.err_message+(b.summary||""));CC.alert(a)},save:function(a){var b=this,c=!0;typeof b.saveBefore=="function"&&(c=b.saveBefore());if(c=c&&b.check())a=a||b.getSaveData(b.attrs.data),b.ajaxRequest(this.attrs.save.func,a,function(a){try{var c=b.saveAfter;typeof c=="function"?c.call(b,a):b.ok(Lang.Mail.Write.saveSucc)}catch(f){b.fail(Lang.Mail.ConfigJs.filter_saveFail,
a)}},function(a){b.fail(Lang.Mail.ConfigJs.filter_saveFail,a)},b.attrs.url||"",b.attrs.ajaxType)},check:function(a,b){var c=this.attrs.data||a||{},d=!0,e;for(e in c)if(d=this.checkItem(e,b),!d)return d;return!0},checkItem:function(a,b){var c=this,d=c.attrs.data[a];if(d.check&&typeof d.check=="object"){var e=d.check,f=e.type,g=d.text||"",g=g.replace(/[\uff1a:]\s*$/i,""),f=e.tips||(f=="empty"?g+Lang.Mail.ConfigJs.option_noEmpty:Lang.Mail.ConfigJs.option_inputReal+g);isOk=Vd.checkData(e.type,c.getValue(a,
d.type),e.reg);if(!isOk)return CC.alert(f,function(){try{c.getEl(a).focus()}catch(b){}}),typeof b=="function"&&b.call(c,isOk),!1}return!0},checkItems:function(a){for(var b=this,c=0;c<a.length;c++){var d=a[c],e=b.getFormatValue(d.id,{type:"text"}),f=d.text,g=d.type;g||(g="empty");if(!Vd.checkData(g,e,d.reg||""))return CC.alert(d.tips||(g=="empty"?f+Lang.Mail.ConfigJs.option_noEmpty:Lang.Mail.ConfigJs.option_inputReal+f),function(){b.getEl(d.id).focus()}),!1}return!0},getFolders:function(a){return CC.getFolders(a)},
getTopHtml:function(){return MM[gConst.setting].getTopHtml(this.attrs.id)},getLeftHtml:function(){var a=MM[gConst.setting].menuItem[this.attrs.id].type,b=[];b.push('<div class="left_setWrapper" id="leftWrap">');b.push("<ul>");var c="",d=this;Util.each(MM[gConst.setting].menuItem,function(b,f){f.type==a&&f.name!=Lang.Mail.tab_Setting&&CC.checkConfig(b)&&(c+=d.attrs.id!=b?"<li><a onclick=\"CC.setConfig('"+b+'\');return false;" href="javascript:fGoto();">'+f.name+"</a></li>":"<li><a onclick=\"CC.setConfig('"+
b+'\');return false;" href="javascript:fGoto();" class="ahover">'+f.name+"</a></li>")});b.push(c);b.push("</ul>");b.push("</div>");return b.join("")},getEmailName:function(a){var a=a.toString(),b=a.lastIndexOf("@");return a&&b>0?a.substring(0,b):a},ifIE6:function(){var a=navigator.appName,b=navigator.appVersion.split(";");return b[1]?(b=b[1].replace(/[ ]/g,""),a=="Microsoft Internet Explorer"&&b=="MSIE6.0"?!0:!1):!1},updatePosition:function(a,b){var c=this,d=jQuery("#leftContainer").css("height"),
b=b!=79?46:83;c.ifIE6()&&(d=parseInt(d)-9);jQuery("#leftWrap").css("height",parseInt(d)-54);jQuery("#"+a).css({height:parseInt(d)-b,"overflow-y":"auto","overflow-x":"hidden",position:"relative"});jQuery(window).resize(function(){var d=jQuery("#leftContainer").css("height");c.ifIE6()&&(d=parseInt(d)-9);jQuery("#leftWrap").css("height",parseInt(d)-54);jQuery("#"+a).css("height",parseInt(d)-b)})},correctWidthInIE6:function(a,b){var c=(window.document.documentElement.clientWidth||window.document.body.clientWidth)-
364,c=jQuery("#main_Setting").width()-jQuery("#leftWrap").outerWidth();jQuery.browser.msie&&jQuery.browser.version=="6.0"?(c-=4,c<638&&jQuery("#"+a).css("width",638)):b&&c<638&&jQuery("#"+a).css("width",638);jQuery(window).resize(function(){var b=(window.document.documentElement.clientWidth||window.document.body.clientWidth)-364;jQuery.browser.msie&&jQuery.browser.version=="6.0"&&(b-=4);b<638&&jQuery("#"+a).css("width",638)})},getFalseTip:function(a,b,c){var d=[];d.push("<div id='"+a+'\' class="tips write-tips"  ');
d.push('style="display:none;margin-top:-2px; margin-left:8px; padding-top: 3px;padding-bottom:3px; z-index:7;">');d.push('<div class="tips-text" id=\''+b+"'>"+c);d.push("</div>");d.push('<div class="tipsLeft diamond"></div>');d.push("</div>");return d.join("")},$:function(a){return document.getElementById(a)},chk:{email:function(a){return/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(a)}}};var account=new OptionBase;
account.getUrl=function(a){return gMain.webPath+"/se/mail/config/alias.do?func={0}&sid={1}".format(a,gMain.sid)};account.attrs={id:"account",authority:"MAIL_CONFIG_NAME",divId:"pageUserAlias",tableClass:"tblFormSet",defaultVal:"",isSucc:!0,list:{type:"url",func:gConst.func.alias,data:{opType:"list"}},update:{func:gConst.func.alias},data:{}};account.init=function(){this.attrs.url=this.getUrl(this.attrs.list.func);this.request(this.attrs,this.getHtml,null,!0)};
account.getHtml=function(a,b){var c=account,d="",e="",f="",g="",h=b[b.length-1],k="";if(h!=""&&h!="undefined"&&h!=null)k=c.attrs.defaultVal=h;if(gMain.trueName=="")gMain.trueName=gMain.loginId,account.addSender(gMain.loginId);(function(a){a.attrs.emaildomain="@"+gMain.domain;a.Allaccount=b;d=k==""?"inline":"none";e=k==""?"none":"inline";f=gMain.trueName==""?"inline":"none";g=gMain.trueName==""?"none":"inline"})(account);c=[];h=function(){var a=[];a.push("<div>");a.push('<h2 class="set_til">'+Lang.Mail.ConfigJs.accountSettings+
"<span>");a.push("( "+Lang.Mail.ConfigJs.aliasNameTip+" )</span></h2>");a.push("<div class=\"codeSet-wrap\" id='codeSetWrap'>");a.push('<ul class="setCode-name">');a.push("<li class=''><span class=\"til\">"+Lang.Mail.ConfigJs.mailAccount+"\uff1a</span>");a.push("<label id='loginAccount' ></label></li>");CC.isOA()&&(a.push('<li class="pt_20" id=\'ptAlias\'><span class="left">'),a.push(""+Lang.Mail.ConfigJs.mailAlias+"</span>"),a.push("<input type=\"text\" maxlength='20' style='display:"+d+";'"),a.push(" class=\"set-txt-b w260\" id='aliasText'  value='"+
k+"'/>"),a.push(password.getFalseTip("aliasTip","aliasTip1","")),a.push("<label id='showAlias'  style='display:"+e+";'>"),a.push("<span id='aliasName' style='margin-right:10px'>"),a.push(k+"</span>"),a.push("<a  href=\"javascript:void(0);\" style='margin-right:5px' "),a.push("onclick='account.editAlias();'>"+Lang.Mail.ConfigJs.modify+"</a>"),a.push("<a href=\"javascript:void(0);\" onclick='account.deleteAlias();'>"+Lang.Mail.ConfigJs.deleteO+"</a></label>"),a.push("</li>"));a.push("<li id='sender' style=\"margin-top:20px;\">");
a.push('<span class="left">'+Lang.Mail.ConfigJs.person_sendername+"</span>");a.push("<input id='senderText' maxlength='20' style=\"display:"+f+';"');a.push('type="text" class="set-txt-b w260" />');a.push(password.getFalseTip("senderTip","senderTip1",""));a.push("<label id='showSender'  style='display:"+g+"; '>");a.push("<span id='senderName' style='margin-right:10px'>");a.push(gMain.trueName+"</span><a href=\"javascript:void(0);\" style='margin-right:5px'");a.push(" onclick='account.editSender();'>"+
Lang.Mail.ConfigJs.modify+"</a>");a.push("</label>");a.push("</li>");a.push('<li id=\'snederNote\'  style="margin:3px 43px 20px" class="pl113">');a.push('<span class="setCode-name-tips">');a.push(""+Lang.Mail.ConfigJs.exZhangsan+"&lt;");a.push("zhangsan@"+gMain.domain+"&gt;,"+Lang.Mail.ConfigJs.senderNameZS+"</span></li>");a.push("</ul>");a.push("</div><\!--codeSet-wrap--\>");a.push("<div class=\"btm_pager fl\" style='width:100%'>");a.push("<a id='save' class=\"n_btn_on mt_5 ml_10\"><span>");a.push("<span>"+
Lang.Mail.ConfigJs.save+"</span></span></a>");a.push("<a id='cancel' class=\"n_btn mt_5\"  onclick='account.goBack();'>");a.push("<span><span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");a.push("</div>");return a.join("")}();c.push("<div class=\"bodySet bodyBwList\" style='align:text;'");c.push('><div id="container">');c.push(this.getTopHtml());c.push(this.getLeftHtml());c.push('<div class="setWrapper" id="setWrapp">');c.push(h);c.push("<div id='sign_list'></div>");c.push("</div></div></div>");
MM[gConst.setting].update(account.attrs.id,c.join(""));account.updatePosition("setWrapp");jQuery("#loginAccount").html(gMain.userNumber);jQuery("#save").unbind("click").bind("click",function(){account.saveChanges()})};
account.afterSave=function(){var a=jQuery("#aliasText").val(),a=a?a.trim():"";account.attrs.defaultVal=a;a!=""&&(jQuery("#aliasText").hide(),jQuery("#showAlias").show(),jQuery("#aliasName").html(a));CC.showMsg(Lang.Mail.ConfigJs.aliasSetSuc,!0,!1,"option");a=jQuery("#senderText").val();if(window.gMain){if(gMain.trueName)gMain.trueName=a;var b=jQuery("#app_username"),c=jQuery("#app_usertruename"),d=jQuery("#account_info .top_name");b&&b.html(a);c&&c.html(a);d&&d.find("span").html(a)}this.mode=""};
account.addSender=function(a){account.ajaxRequest("user:setUserInfo",{true_name:a},function(){},function(){})};
account.saveChanges=function(){if(this.mode&&!this.mode!="editing"){var a=account,b=account.getUrl(account.attrs.update.func),c=!1;jQuery("#senderText");if(CC.isOA())var d=jQuery("#aliasText").val().trim();jQuery("#aliasTip,#senderTip").hide();var e=function(){if(d=="")a.deleteAlias("set");else if(account.check(d)){var c={},c=(account.attrs.op=="update"?"update":"add")=="add"?{opType:"add",aliasName:d}:{opType:"update",aliasName:d,oldAliasName:account.attrs.defaultVal};account.ajaxRequest(gConst.func.alias,
c,function(){account.afterSave()},function(a){account.attrs.isSucc=!1;a.msg&&(jQuery("#aliasTip").css("display","inline"),a.msg=="null"?jQuery("#aliasTip1").html(Lang.Mail.ConfigJs.alias_exist):jQuery("#aliasTip1").html(a.msg))},b)}},f=function(){var a=jQuery("#senderText").val().trim();!a.checkSpecialChar()||/[&\.\*]/.test(a)?(jQuery("#senderTip").css("display","inline"),jQuery("#senderTip1").html(Lang.Mail.ConfigJs.senderFormatError),jQuery("#senderText").focus(),c=!0):account.doService(gConst.func.setWebUserInfo,
{trueName:a},function(){a.replace(/\s/g,"")!=""?(jQuery("#showSender").show(),jQuery("#senderName").html(jQuery("#senderText").val()),jQuery("#senderText").hide(),account.afterSave()):(jQuery("#senderText").val(""),CC.showMsg(Lang.Mail.ConfigJs.aliasSetSuc,!0,!1,"option"))},function(){account.attrs.isSucc=!1})};(function(b){if(jQuery("#aliasText").css("display")!="none"||jQuery("#senderText").css("display")!="none")if(CC.isOA()&&(d=d.replace(/\s/g,""),jQuery("#aliasTip").hide()),(d&&d==account.attrs.defaultVal||
!d)&&jQuery("#senderText").css("display")=="none"){account.afterSave();return}else{jQuery("#senderText").css("display")!="none"&&f();if(c)return;if(!CC.isOA())return;if(d==a.attrs.defaultVal||jQuery("#aliasText").css("display")=="none"){account.afterSave();return}else e()}else CC.showMsg(Lang.Mail.ConfigJs.aliasSetSuc,!0,!1,"option");parent.EV.stopEvent(b);return!1})()}};
account.check=function(a){var b=jQuery("#aliasText"),c=a.search(/[^a-zA-Z0-9-_.]/)!=-1?1:0,d=/^[a-zA-Z0-9]+\S*[a-zA-Z0-9-_.]$/;if((a.search(/--|_-|-_|__/)!=-1?1:0)==1||c==1||!d.test(a)||a.length<2||a.length>20)return b.focus(),b.select(),jQuery("#aliasTip").css("display","inline"),jQuery("#aliasTip1").html(""+Lang.Mail.ConfigJs.aliasFormatError+""),!1;return this.Allaccount.has(a)?(b.focus(),b.select(),jQuery("#aliasTip").css("display","inline"),jQuery("#aliasTip1").html(""+Lang.Mail.ConfigJs.aliasFormatError+
""),!1):!0};account.editAlias=function(){var a=jQuery("#aliasName").text().toString();jQuery("#showAlias").hide();jQuery("#aliasText").show().val(a);account.attrs.op="update"};
account.deleteAlias=function(a){var b=this,c=jQuery("#aliasName").text().trim().replace(this.attrs.emaildomain,""),d=b.getUrl(this.attrs.update.func),e={opType:"delete",aliasName:c};if(c=="")CC.showMsg(Lang.Mail.ConfigJs.aliasSetSuc,!0,!1,"option");else{var f=a=="set"?Lang.Mail.ConfigJs.aliasSetSuc:Lang.Mail.ConfigJs.aliasDeleteSuc;c==gMain.loginId?CC.alert(Lang.Mail.Config.aliaslogin_nodelete):b.ajaxRequest(gConst.func.alias,e,function(){b.Allaccount[0]="";jQuery("#showAlias").hide();jQuery("#aliasText").show().val("").focus();
CC.showMsg(f,!0,!1,"option")},function(a){typeof a=="object"&&a.msg?CC.alert(a.msg):CC.alert(Lang.Mail.ConfigJs.filter_failed)},d)}};account.editSender=function(){var a=jQuery("#senderName").text();jQuery("#showSender").hide();jQuery("#senderText").show().val(a);this.mode="editing"};
account.deleteSender=function(){var a=account;data={true_name:""};a.ajaxRequest("user:setUserInfo",data,function(){jQuery("#showSender").hide();jQuery("#senderText").show().val("").focus();gMain.trueName="";CC.showMsg(Lang.Mail.ConfigJs.delSenderSuc,!0,!1,"option")})};var defaultAccount=new OptionBase;
defaultAccount.attrs={id:"defaultAccount",authority:"MAIL_CONFIG_DEFAULTACCOUNT",free:!0,divId:"pageUserAlias",tableClass:"tblFormSet",list:{type:"url",func:gConst.func.getDefaultEmail},save:{type:"url",func:gConst.func.setDefaultEmail},data:{}};defaultAccount.init=function(){this.resultData={};this.initService(this.attrs,this.getHtml)};
defaultAccount.getHtml=function(a,b){var c=[];c.push(this.getTopHtml());c.push(this.getLeftHtml());c.push(this.getNavMenu(a.id));c.push('<p style="float:left; width:145px;padding-top:20px; text-align:right;">'+Lang.Mail.ConfigJs.setDefaultEmail+"\uff1a</p>");c.push('<div class="jpop_mail_list w444" style="border:none; box-shadow:none; overflow:hidden;zoom:1;">');c.push('<ul id="setDefaultEmamil_container">');c.push("</ul>");c.push("</div>");c.push('<div class="btm_pager">');c.push('<a class="n_btn_on mt_5 ml_10" href="javascript:fGoto();" id="submit_btn"><span><span>'+
Lang.Mail.Ok+"</span></span></a>");c.push('<a class="n_btn mt_5" onclick="defaultAccount.goBack();" ><span><span>'+Lang.Mail.Cancel+"</span></span></a>");c.push("</div>");MM[gConst.setting].update(a.id,c.join(""));defaultAccount.updatePosition("setWrapp");this.loadDefaultData(b);this.bindEvents()};defaultAccount.loadDefaultData=function(a){this.resultData=a;this.updateList()};defaultAccount.bindEvents=function(){var a=this.$("submit_btn"),b=this;EV.observe(a,"click",function(){b.save()},!1)};
defaultAccount.createListItem=function(a,b){return'<li><input type="radio" id="m_'+a.mailId+'" name="defaultAccount" '+(b||"")+" /><label "+(a.relationType==0?" class='manager'":"")+' for="m_'+a.mailId+'">'+a.mailId+"@"+gMain.domain+"\uff08"+a.mailTrueName+"\uff09</label></li>"};
defaultAccount.updateList=function(){for(var a=[],b="",c=this.resultData,d=0;d<c.length;d++)b=c[d]&&c[d].isDefault==1?'checked="checked"':"",a.push(this.createListItem(c[d],b));this.$("setDefaultEmamil_container").innerHTML=a.join("");this.bindListItemEvents()};
defaultAccount.bindListItemEvents=function(){var a=this.$("setDefaultEmamil_container").getElementsByTagName("input"),b,c=this;if(a&&a.length>0)for(var d=0,e=a.length;d<e;d++)b=a[d].id.substr(2),b=function(a){return function(){c.updateStatus(a)}}(b),EV.observe(a[d],"click",b,!1)};defaultAccount.updateStatus=function(a){for(var b=this.resultData,c=0;c<b.length;c++)b[c].isDefault=b[c].mailId==a?1:0};
defaultAccount.save=function(){var a={},b=this,c=b.resultData,d;for(d in c)c[d]&&c[d].isDefault==1&&(a=c[d]);this.doService(b.attrs.save.func,a,function(a){a.code=="S_OK"?b.ok(Lang.Mail.ConfigJs.defaultEmailSuccess):b.fail(Lang.Mail.ConfigJs.defaultEmailFail,a)},function(a){a.summary?b.fail(a.summary):b.fail(Lang.Mail.ConfigJs.defaultEmailFail,a)})};var memManager=new OptionBase;memManager.attrs={id:"memManager",authority:"MAIL_PUBLIC",divId:"pageUserAlias",noReq:!0};
memManager.init=function(){this.request(this.attrs,this.getHtml,null,!0)};
memManager.getHtml=function(a){var b=[],c=this;b.push('<div class="bodySet" style=\'align:text;\' id="pageUserAlias">');b.push('<div id="container">');b.push(this.getTopHtml());b.push(this.getLeftHtml());b.push(this.getNavMenu(a.id));b.push("<div class=\"setWrapper\" id='setWrapp' style='padding-top:0'>");b.push('<iframe id="ifm_config_memberManage" name="ifm_config_memberManage" src="../ext/extmailuserlist.do?sid='+gMain.sid+'" frameborder="0" scroll="no" width="100%" ></iframe>');b.push("</div>");
b.push("</div>");b.push("</div>");MM[gConst.setting].update(a.id,b.join(""));memManager.updatePosition("ifm_config_memberManage");a=document.getElementById("ifm_config_memberManage");a.attachEvent?a.attachEvent("onload",function(){c.setIframeWidth();jQuery(window).resize(c.setIframeWidth)}):a.onload=function(){c.correctWidthInIE6("ifm_config_memberManage")}};memManager.setIframeWidth=function(){document.getElementById("ifm_config_memberManage").style.width=memManager.getWidth()+"px"};
memManager.getWidth=function(){var a=(window.document.documentElement.clientWidth||window.document.body.clientWidth)-363,b=navigator.appName,c=navigator.appVersion.split(";");return c[1]?(c=c[1].replace(/[ ]/g,""),b=="Microsoft Internet Explorer"&&c=="MSIE6.0"?a-3:a):a};
(function(a){var b=new OptionBase;b.attrs={id:"antiGarbage",authority:"MAIL_CONFIG_ANTIVIRU",divId:"pageAntiGarbage",list:{type:"url",func:gConst.func.getAttrs},save:{func:gConst.func.setAttrs}};b.init=function(){this.request(this.attrs)};b.getHtml=function(a,b){var e=[],f=this.getInitHtml();e.push('<div class="bodySet" style=\'align:text;\' id="pageAntiGarbage">');e.push('<div id="container">');e.push(this.getTopHtml());e.push(this.getLeftHtml());e.push("<div class=\"setWrapper\" id='setWrapp'>");
e.push(f);e.push("<div class=\"btm_pager pl_10 percent100\" id=''>");e.push('<a id="g_save" class="n_btn_on mt_5" href="javascript:void(0);">');e.push("<span><span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");e.push('<a class="n_btn mt_5" id="g_cancel">');e.push("<span><span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");e.push("</div></div></div>");MM[gConst.setting].update(this.attrs.id,e.join(""));pref.updatePosition("setWrapp");this.correctWidthInIE6("setWrapp",1);this.initEvent(b)};
b.initEvent=function(b){var d=this;d.initOptions(b);a("#g_save").click(function(){d.save()});a("#g_cancel").click(function(){d.goBack()});a(":radio[name=spam_level]").click(function(){d.setGray()})};b.setGray=function(){a("#spam_level1").is(":checked")?a(":radio[name=spam_deal]").attr("disabled","disabled"):a(":radio[name=spam_deal]").attr("disabled",!1)};b.initOptions=function(b){b&&(typeof b.spam_level!=void 0&&(a("#spam_level"+b.spam_level).attr("checked","checked"),b.spam_level==1&&this.setGray()),
typeof b.spam_deal!=void 0&&a("#spam_deal"+b.spam_deal).attr("checked","checked"))};b.save=function(){var b=this,d={attrs:{spam_level:a(":radio[name=spam_level][checked]").val(),spam_deal:a(":radio[name=spam_deal][checked]").val()}};b.ajaxRequest(b.attrs.save.func,d,function(){CC.showMsg(Lang.Mail.ConfigJs.settingSuc,!0,!1,"option");b.init()},function(){pref.fail(Lang.Mail.ConfigJs.setParaFail)})};b.getInitHtml=function(){var a=[];a.push('<div class="bwSet" >');a.push('<h2 class="set_til">');a.push(Lang.Mail.ConfigJs.fanlaji);
a.push("</h2>");a.push('<div class="parameter-wrap"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.panway+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='spam_level' id='spam_level1' class=\"rm_cb\" value='1'>");a.push("<label for='spam_level1'> "+Lang.Mail.ConfigJs.loose+"</label>");a.push("<font class='tips-default-color pl10'>"+Lang.Mail.ConfigJs.spamSet+"</font>");a.push('<em class="red-commend">\uff08'+
Lang.Mail.ConfigJs.index_recommend+"\uff09</em>");a.push("</div></li>");a.push("<li class='pb_15'></li>");a.push("<li class='pb_15'></li>");a.push('<li class="pl_155 next-li">');a.push("<input type=\"radio\" class=\"rm_cb\" name='spam_level' id='spam_level2' value='2'>");a.push("<label  for='spam_level2'>  "+Lang.Mail.ConfigJs.soso+"</label>");a.push("<font class='tips-default-color pl10'>"+Lang.Mail.ConfigJs.soso_spamTip+"</font>");a.push("</li>");a.push("<li class='pb_15'></li>");a.push("<li class='pb_15'></li>");
a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='spam_level' id='spam_level3' class=\"rm_cb\" value='3'>");a.push("<label  for='spam_level3'>  "+Lang.Mail.ConfigJs.strict+"</label>");a.push("<font class='tips-default-color pl10'> "+Lang.Mail.ConfigJs.strict_spamTip+"</font>");a.push("</li>");a.push("</ul>");a.push("</div>");a.push('<div class="parameter-wrap" style="border-bottom:none;"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+
Lang.Mail.ConfigJs.cliWay+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='spam_deal' id='spam_deal1' class=\"rm_cb\" value='1'>");a.push("<label for='spam_deal1'> "+Lang.Mail.ConfigJs.jieshou+"</label>");a.push("<font class='tips-default-color pl10'>"+Lang.Mail.ConfigJs.jieshou_tip+"</font>");a.push("</div></li>");a.push("<li class='pb_15'></li>");a.push("<li class='pb_15'></li>");a.push('<li class="pl_155 next-li">');a.push("<input type=\"radio\" class=\"rm_cb\" name='spam_deal' id='spam_deal2' value='2'>");
a.push("<label  for='spam_deal2'>  "+Lang.Mail.ConfigJs.jushou+"</label>");a.push("</li>");a.push("<li class='pb_15'></li>");a.push("<li class='pb_15'></li>");a.push("</ul>");a.push("</div>");return a.join("")};window.antiGarbage=b})(jQuery);var antiSpam=new OptionBase;antiSpam.attrs={id:"antiSpam",authority:"MAIL_CONFIG_ANTIVIRU",divId:"pageAntiSpam",noReq:!0};antiSpam.init=function(){this.request(this.attrs)};
antiSpam.getHtml=function(a,b){var c=black;c.attrs.emails=b;var d=[],e=function(){var a=[];a.push('<div class="bwSet" >');a.push('<h2 class="set_til">');a.push(c.attrs.type==0?Lang.Mail.ConfigJs.setBlackList:Lang.Mail.ConfigJs.setWhiteList);a.push('<span class="">({0})</span>'.format(c.attrs.type==0?Lang.Mail.ConfigJs.Rejection:Lang.Mail.ConfigJs.sureReceive));a.push("</h2>");a.push('<fieldset class="formSet">');a.push('<div class="write_adr_wrap">');a.push("<table  cellpadding=\"0\"><tbody><tr><td width='455' >");
a.push("<div style='background: none repeat scroll 0 0 white; border: 1px solid #DBDBDB; ");a.push("box-shadow: 1px 1px 2px #DBDBDB inset;font-family: Tahoma;height: auto !important;");a.push("line-height: 28px;min-height: 28px;padding:2px 2px 2px 10px; width:440px; float:left'>");a.push("<input id=\"option_wblist\" style='width:415px;height:30px;color:#BFBFBF;border:none;height:28px; line-height:28px;' ");a.push(' class="clearfix" value=\''+Lang.Mail.ConfigJs.semicolon+"'");a.push(" type=\"text\" maxLength='146'><i title='"+
Lang.Mail.ConfigJs.chooseFromMailList+"' style='position:absolute;left:434px;top:72px' class=\" i-rush\" id='addContact'></i></div></td><td width=\"75\">");a.push('<a href="javascript:void(0);" id="AAdd" onclick="black.save(); return false;" class="add_Link" style=\'display:inline-block;zoom:1;margin-top:0px;vertical-align:middle\'>');a.push('<i class="i_addMail"></i>'+Lang.Mail.ConfigJs.filter_add+"</a></td>");a.push("</tr>");a.push("</tbody></table>");a.push("</div>");a.push("</fieldset>");a.push("</div>");
return a.join("")}();c.getTableList(function(){var a={title:"",items:[]};a.head={title:["",Lang.Mail.ConfigJs.filter_emailaddress,Lang.Mail.ConfigJs.filter_operate],className:["td1","td2","td3"]};if(typeof b=="object"&&b.length>0)for(var d=0;d<b.length;d++){if(b[d]!=""){var e=b[d].encodeHTML();try{a.items[d]=[],a.items[d][0]="<input type='checkbox' name='checkMail'/>",a.items[d][1]=e,a.items[d][2]=("<a onclick=\"black.save('{0}','delete'); return false;\"  href=\"javascript:void(0)\">"+Lang.Mail.ConfigJs.filter_delete+
"</a>").format(e)}catch(k){}}}else a.items=c.attrs.type==0?Lang.Mail.ConfigJs.NoCreateBlackList:Lang.Mail.ConfigJs.NoCreateWhiteList;return a}());d.push("<div class=\"bodySet bodyBwList\" style='align:text;position:relative'");a.divId&&d.push(' id="{0}"'.format(a.divId));d.push('><div id="container" style="position:relative">');d.push(this.getTopHtml());d.push(this.getLeftHtml());d.push('<div class="setWrapper" id=\'blackWrapper\' style="position:relative">');d.push(e);d.push("</div></div></div>");
MM[gConst.setting].update(c.attrs.id,d.join(""));c.updatePosition("blackWrapper");c.initEvent()};
(function(a){var b=new OptionBase;b.attrs={id:"antiViru",authority:"MAIL_CONFIG_ANTIVIRU",divId:"pageAntiViru",list:{type:"url",func:gConst.func.getAttrs},save:{func:gConst.func.setAttrs}};b.init=function(){this.request(this.attrs)};b.getHtml=function(a,b){var e=[],f=this.getInitHtml();e.push('<div class="bodySet" style=\'align:text;\' id="pageantiViru">');e.push('<div id="container">');e.push(this.getTopHtml());e.push(this.getLeftHtml());e.push("<div class=\"setWrapper\" id='setWrapp'>");e.push(f);
e.push("<div class=\"btm_pager pl_10 percent100\" id=''>");e.push('<a id="g_save" class="n_btn_on mt_5" href="javascript:void(0);">');e.push("<span><span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");e.push('<a class="n_btn mt_5" id="g_cancel">');e.push("<span><span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");e.push("</div></div></div>");MM[gConst.setting].update(this.attrs.id,e.join(""));pref.updatePosition("setWrapp");this.correctWidthInIE6("setWrapp",1);this.initEvent(b)};b.initEvent=
function(b){var d=this;d.initOptions(b);a("#g_save").click(function(){d.save()});a("#g_cancel").click(function(){d.goBack()});a(":radio[name=virus_status]").click(function(){d.toggleOption()})};b.toggleOption=function(){a("#virus_status0").is(":checked")?(a("#virus_notify_me,#virus_notify_send").attr("disabled","disabled"),a(":radio[name=virus_sucess],:radio[name=virus_fail],:radio[name=virus_doubt]").attr("disabled","disabled"),a("#scanDiv").css({"border-bottom":"none"}),a("#option_virus").hide()):
(a("#virus_notify_me,#virus_notify_send").attr("disabled",!1),a(":radio[name=virus_sucess],:radio[name=virus_fail],:radio[name=virus_doubt]").attr("disabled",!1),a("#scanDiv").css({"border-bottom":"1px dashed #E4E4E4"}),a("#option_virus").show())};b.initOptions=function(b){b&&(typeof b.virus_status!=void 0&&(a("#virus_status"+b.virus_status).attr("checked","checked"),b.virus_status==0&&this.toggleOption()),typeof b.virus_sucess!=void 0&&a("#virus_sucess"+b.virus_sucess).attr("checked","checked"),
typeof b.virus_fail!=void 0&&a("#virus_fail"+b.virus_fail).attr("checked","checked"),typeof b.virus_doubt!=void 0&&a("#virus_doubt"+b.virus_doubt).attr("checked","checked"),typeof b.virus_notify_me!=void 0&&b.virus_notify_me==1&&a("#virus_notify_me").attr("checked","checked"),typeof b.virus_notify_send!=void 0&&b.virus_notify_send==1&&a("#virus_notify_send").attr("checked","checked"))};b.save=function(){var b=this,d={attrs:{virus_status:a(":radio[name=virus_status][checked]").val(),virus_sucess:a(":radio[name=virus_sucess][checked]").val(),
virus_fail:a(":radio[name=virus_fail][checked]").val(),virus_doubt:a(":radio[name=virus_doubt][checked]").val(),virus_notify_me:a("#virus_notify_me").is(":checked")?1:0,virus_notify_send:a("#virus_notify_send").is(":checked")?1:0}};b.ajaxRequest(b.attrs.save.func,d,function(){CC.showMsg(Lang.Mail.ConfigJs.settingSuc,!0,!1,"option");b.init()},function(){pref.fail(Lang.Mail.ConfigJs.setParaFail)})};b.getInitHtml=function(){var a=[];a.push('<div class="bwSet" >');a.push('<h2 class="set_til">');a.push(Lang.Mail.ConfigJs.virusMail);
a.push("</h2>");a.push('<div class="parameter-wrap" id="scanDiv"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.scanVirus+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='virus_status' id='virus_status0' class=\"rm_cb\" value='0'>");a.push("<label for='virus_status0'> "+Lang.Mail.ConfigJs.set_sessionMode_off+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li">');a.push("<input type=\"radio\" class=\"rm_cb\" name='virus_status' id='virus_status1' value='1'>");
a.push("<label  for='virus_status1'>  "+Lang.Mail.ConfigJs.set_sessionMode_on+"</label>");a.push("</li>");a.push("</ul>");a.push("</div>");a.push('<div id="option_virus">');a.push('<div class="parameter-wrap"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.shaduSuc+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='virus_sucess' id='virus_sucess3' class=\"rm_cb\" value='3'>");a.push("<label for='virus_sucess3'> "+
Lang.Mail.ConfigJs.deletem+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li">');a.push("<input type=\"radio\" class=\"rm_cb\" name='virus_sucess' id='virus_sucess1' value='1'>");a.push("<label  for='virus_sucess1'>  "+Lang.Mail.ConfigJs.deletev+"</label>");a.push("</li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='virus_sucess' id='virus_sucess2' class=\"rm_cb\" value='2'>");a.push("<label  for='virus_sucess2'>  "+Lang.Mail.ConfigJs.nodo+"</label>");
a.push("</li>");a.push("</ul>");a.push("</div>");a.push('<div class="parameter-wrap"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.shaduFail+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='virus_fail' id='virus_fail1' class=\"rm_cb\" value='1'>");a.push("<label for='virus_fail1'> "+Lang.Mail.ConfigJs.emlAttach+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li">');
a.push("<input type=\"radio\" class=\"rm_cb\" name='virus_fail' id='virus_fail3' value='3'>");a.push("<label  for='virus_fail3'>  "+Lang.Mail.ConfigJs.deletem+"</label>");a.push("</li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='virus_fail' id='virus_fail2' class=\"rm_cb\" value='2'>");a.push("<label  for='virus_fail2'>  "+Lang.Mail.ConfigJs.nodo+"</label>");a.push("</li>");a.push("</ul>");a.push("</div>");a.push('<div class="parameter-wrap"><ul class="parameter-ul pt_10">');
a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.doubt+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='virus_doubt' id='virus_doubt1' class=\"rm_cb\" value='1'>");a.push("<label for='virus_doubt1'> "+Lang.Mail.ConfigJs.emlAttach+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li">');a.push("<input type=\"radio\" class=\"rm_cb\" name='virus_doubt' id='virus_doubt3' value='3'>");a.push("<label  for='virus_doubt3'>  "+
Lang.Mail.ConfigJs.deletem+"</label>");a.push("</li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='virus_doubt' id='virus_doubt2' class=\"rm_cb\" value='2'>");a.push("<label  for='virus_doubt2'>  "+Lang.Mail.ConfigJs.nodo+"</label>");a.push("</li>");a.push("</ul>");a.push("</div>");a.push('<div class="parameter-wrap" style="border-bottom:none;"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.chulijg+
"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"checkbox\" name='virus_notify_me' id='virus_notify_me' class=\"rm_cb\">");a.push("<label for='virus_notify_me'> "+Lang.Mail.ConfigJs.noMe+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li">');a.push("<input type=\"checkbox\" class=\"rm_cb\" name='virus_notify_send' id='virus_notify_send'>");a.push("<label  for='virus_notify_send'>  "+Lang.Mail.ConfigJs.nosender+"</label>");a.push("</li>");a.push("</ul>");a.push("</div>");
a.push("</div>");return a.join("")};window.antiViru=b})(jQuery);var antiVirus=new OptionBase;antiVirus.attrs={id:"folderlock",authority:"MAIL_CONFIG_ANTIVIRU",divId:"pageFolderlock",noReq:!0};antiVirus.init=function(){this.request(this.attrs)};var autoForward=new OptionBase,ToolTips=parent.ToolTips;
autoForward.attrs={id:"autoForward",authority:"MAIL_CONFIG_AUTOFORWARD",divId:"pageAutoforward",dropMailType:null,list:{type:"url",func:gConst.func.getAttrs},save:{type:"url",url:"",func:"mail:setAutoForward"},tips:Lang.Mail.ConfigJs.pref_forward_tips,data:{auto_forward_status:{text:Lang.Mail.ConfigJs.forward_lbl_IsOpen,type:"radio",attribute:{value:"",defaultValue:"0"},items:{1:Lang.Mail.ConfigJs.reply_lbl_yes,0:Lang.Mail.ConfigJs.reply_lbl_no},format:"int"},auto_forward_addr:{text:Lang.Mail.ConfigJs.forward_lbl_forwardrecuser,
type:"text",attribute:{value:"",defaultValue:"",maxLength:240},after:'<span class="">'+Lang.Mail.ConfigJs.forward_lbl_onlyone+"</span>",format:"string"},auto_forward_bakup:{text:Lang.Mail.ConfigJs.forward_lbl_savetolocal,type:"text",className:"",attribute:{value:"",defaultValue:"1"},format:"int"},validateCode:{type:"text",attribute:{value:"",maxLength:8},format:"string"}}};
autoForward.init=function(){this.attrs.dropMailType=new DropSelect({id:"dropMail_Div",data:[{text:Lang.Mail.ConfigJs.forward_localsavemail,value:"1"},{text:Lang.Mail.ConfigJs.forward_localdeletemail,value:"0"}],type:"",selectedValue:"1",width:290});this.toolTip_Forward=new ToolTips({id:"toolTip_Forward",direction:ToolTips.direction.Right,left:450,top:72});this.toolTip_Forward_ImgCode=new ToolTips({id:"toolTip_Forward_ImgCode",direction:ToolTips.direction.Right,left:310,top:160});this.request(this.attrs)};
autoForward.check=function(){document.getElementById("option_auto_forward_bakup").value=this.attrs.dropMailType.getValue();this.getFormatValue("auto_forward_status");var a=this.getEl("auto_forward_addr"),b=$("auto_forward_status1"),c=$("autoForwardCaptcha"),d=function(){a.focus()};if(b.checked){if(a.value.trim()=="")return CC.alert(Lang.Mail.ConfigJs.EmailCannotNull,null,Lang.Mail.ConfigJs.Error,d),!1;if(!Vd.checkData("email",a.value.trim()))return this.toolTip_Forward.show(a,Lang.Mail.ConfigJs.Forward_VdEmail+
gMain.domain),!1;if(!mailPOP.checkMail(a.value.trim(),"autoForward"))return gMain.forwardcorpConfigType=="1"?this.toolTip_Forward.show(a,Lang.Mail.ConfigJs.onlyForwardTo+gMain.forwardcorpConfig):gMain.forwardcorpConfigType=="2"&&this.toolTip_Forward.show(a,Lang.Mail.ConfigJs.forbidForwaordTo+gMain.forwardcorpConfig),!1}if(this.checkUserNumber(a.value.trim()))return this.toolTip_Forward.show(a,Lang.Mail.ConfigJs.CannotSendSelf),!1;b=jQuery.trim(jQuery("#option_validateCode").val());d=jQuery("#autoForwardCaptcha .tips");
if(b=="\u8bf7\u70b9\u51fb\u83b7\u53d6\u9a8c\u8bc1\u7801"||b=="")return this.toolTip_Forward_ImgCode.show(c,Lang.Mail.Config.vdImageEmpty),!1;else d.hide(),this.attrs.data.validateCode.attribute.value=b;return!0};
autoForward.getHtml=function(a){var b=[];b.push("<div class=\"bodySet\" style='align:text;'");a.divId&&b.push(' id="{0}"'.format(a.divId));b.push('><div id="container">');b.push(this.getTopHtml());this.attrs.id!="mailSearch"&&b.push(this.getLeftHtml());b.push('<div id="autoForwardWrapper" class="setWrapper">');b.push('<div id="default_id_container" class="tips write-tips" style="top: 79px; left:556px; position:absolute; display: none;"><div class="tips-text"><div id="default_id_content">'+Lang.Mail.ConfigJs.forward_input_right_mail+
'</div></div><div class="tipsLeft diamond"></div></div>');b.push("<div>");b.push('<h2 class="set_til"> '+Lang.Mail.ConfigJs.filter_auto_forward+"<span>"+Lang.Mail.ConfigJs.pref_forward_tips+"</span></h2>");b.push(' <ul class="auto-reply-layout">');b.push('<li class="pb_5"><span class="left">'+Lang.Mail.ConfigJs.forward_lbl_IsOpen+'</span><input name="option_auto_forward_status" class="set-radio" id="auto_forward_status1" '+((a.data.auto_forward_status.attribute.value||a.data.auto_forward_status.attribute.defaultValue)==
1?'checked="true"':"")+'" type="radio" value="1"/><label for="auto-transmit-on">'+Lang.Mail.ConfigJs.set_sessionMode_on+"</label> </li>");b.push('<li class="pl155 pb_20"><input name="option_auto_forward_status" class="set-radio" id="auto_forward_status0" '+((a.data.auto_forward_status.attribute.value||a.data.auto_forward_status.attribute.defaultValue)!=1?'checked="true"':"")+'" type="radio" value="0"/><label for="auto-transmit-off">'+Lang.Mail.ConfigJs.set_sessionMode_off+"</label></li>");b.push('<li class="pb_20"><span class="left">'+
Lang.Mail.ConfigJs.forward_lbl_forwardrecuser+'</span><input id="option_auto_forward_addr" maxlength="40" class="set-txt w285" onclick="" type="text" value="'+Lang.Mail.ConfigJs.forward_lbl_onlyone+'"/> </li>');b.push(' <li class="pb_20"><span class="left fl">'+Lang.Mail.ConfigJs.forward_lbl_savetolocal+"</span>");b.push('<span onclick="" style="display:inline-block;" id="dropMail_Div">');b.push(this.attrs.dropMailType.getHTML());b.push(" </span></li>");b.push('<li id="autoForwardCaptcha" class="clearfix p_relative">\t\t<span class="left fl">\u56fe\u7247\u9a8c\u8bc1\u7801\uff1a</span>\t<div class="p_relative" style=" margin-left:155px;">\t\t<input id="option_validateCode" name="validateCode" class="captcha_input com-txt w210" type="text" maxlength="8">\t\t<div style="position: absolute; display:none; top: -54px; left: 163px; z-index: 9999;" class="tips write-tips">\t\t<div class="tips-text">\u56fe\u7247\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a</div>\t\t<div class="tipsLeft diamond"></div>\t\t</div>\t\t<p class="mt_10"><img class="captcha_img" id="unbind_imgShow" src="" /></p>\t\t<a style="width:90px" href="javascript:void(0);" class="captcha_changeBtn">\u770b\u4e0d\u6e05\uff0c\u6362\u4e00\u5f20</a>\t</p>\t</p>\t</div>\t</li>');
b.push("</ul></div>");b.push('<div style="width:100%" class="btm_pager fl"><a href="javascript:fGoto();" onclick= "autoForward.save()" class="n_btn_on mt_5 ml_10"><span><span>'+Lang.Mail.ConfigJs.save+'</span></span></a><a href="javascript:fGoto();" onclick="autoForward.goBack()" class="n_btn mt_5"><span><span>'+Lang.Mail.ConfigJs.pref_cancel+"</span></span></a></div>");b.push("</div>");b.push('<input id="option_auto_forward_bakup" style="display:none" type="text" value=""/>');b.push("</div>");MM[gConst.setting].update(a.id,
b.join(""));pref.updatePosition("autoForwardWrapper");this.attrs.dropMailType.loadEvent();this.attrs.dropMailType.setValue(a.data.auto_forward_bakup.attribute.value);if(a.data.auto_forward_addr.attribute.value!=null&&a.data.auto_forward_addr.attribute.value!="")document.getElementById("option_auto_forward_addr").value=a.data.auto_forward_addr.attribute.value;this.loadEvent()};
autoForward.loadEvent=function(){var a=$("auto_forward_status0"),b=$("auto_forward_status1"),c=$("option_auto_forward_addr"),d=jQuery("#autoForwardCaptcha");jQuery("#unbind_imgShow");var e=function(){b.checked?(jQuery(c).removeAttr("disabled"),c.value!=Lang.Mail.ConfigJs.forward_lbl_onlyone?jQuery(c).attr("style","color: black;"):jQuery(c).removeAttr("style")):a.checked&&jQuery(c).attr("disabled","disabled")};e();a.onclick=function(){e()};b.onclick=function(){e()};d.captcha();c.onclick=function(){if(this.value==
Lang.Mail.ConfigJs.forward_lbl_onlyone&&(this.value="",this.createTextRange)){var a=this.createTextRange();a.moveStart("character",this.value.length);a.collapse();a.select()}jQuery(this).attr("style","color: black;")};c.onblur=function(){if(this.value.trim()=="")this.value=Lang.Mail.ConfigJs.forward_lbl_onlyone,jQuery(this).removeAttr("style")}};
autoForward.save=function(){var a=this;if(a.check()){var b=a.getSaveData(a.attrs.data);a.doServiceInXml(a.attrs.save.func,b,function(){unbind_imgShow.click();a.ok(Lang.Mail.ConfigJs.autoForwardSuc)},function(b){unbind_imgShow.click();a.fail(Lang.Mail.ConfigJs.filter_saveFail,b)})}};autoForward.checkUserNumber=function(a){for(var b=!1,c=0;c<aliasList.length;c++)if(aliasList[c].value==a){b=!0;break}return b};var autoReply=new OptionBase;
autoReply.attrs={id:"autoReply",authority:"MAIL_CONFIG_AUTOREPLY",divId:"pageAutoReply",textBox:null,list:{type:"url",func:gConst.func.getAttrs},save:{type:"url",func:gConst.func.setAttrs},tips:Lang.Mail.ConfigJs.reply_lbl_tips,data:{auto_replay_status:{text:Lang.Mail.ConfigJs.reply_lbl_isopen,type:"radio",className:"",attribute:{value:"",defaultValue:"",className:""},items:{1:Lang.Mail.ConfigJs.reply_lbl_yes,0:Lang.Mail.ConfigJs.reply_lbl_no},format:"int"},auto_replay_content_label:{text:Lang.Mail.ConfigJs.reply_lbl_respcontent1,
type:"label",className:"",row:!0,noset:!0},auto_replay_content:{text:"",type:"textarea",className:"autoReplay",row:!0,attribute:{value:"",defaultValue:"",className:"",rows:7,cols:50},format:"text"},auto_setting_time:{text:"",type:"html",className:"",row:!0,noset:!0,html:""},auto_replay_starttime:{text:"",type:"text",attribute:{value:"",defaultValue:""},display:!1,format:"text"},auto_replay_endtime:{text:"",type:"text",attribute:{value:"",defaultValue:""},display:!1,format:"text"}}};
autoReply.changeDays=function(a){var b=document.getElementById(a+"Day");b.options.length=0;var a=new Date(document.getElementById(a+"Year").value,document.getElementById(a+"Month").value,0),c="";for(i=1;i<=a.getDate();i++)c=i,i<10&&(c="0"+i),c=new Option(c,c),b.options.add(c)};autoReply.init=function(){this.request(this.attrs)};
autoReply.getHtml=function(a){var b=[],c=MM[gConst.setting].menuItem[a.id].name,d=a.tableAfter||"",e=a.tableBefore||"";b.push("<div class=\"bodySet\" style='align:text;'");a.divId&&b.push(' id="{0}"'.format(a.divId));b.push('><div id="container">');b.push(this.getTopHtml());this.attrs.id!="mailSearch"&&b.push(this.getLeftHtml());b.push('<div class="setWrapper" id="autoReplyWrapper">');var f='<h2 class="set_til"> {0}<span>({1})</span></h2>'.format(c,a.tips);b.push(this.getHead(c,"",f));b.push(e);var g=
f="",h=!1,e=a.data.auto_replay_status.attribute.value;a.data.auto_replay_starttime.attribute.value!=0&&a.data.auto_replay_endtime.attribute.value!=""&&(h=!0);var g="<input "+(h==!0?"checked='checked'":"")+' type="checkbox" id="chkSetTime" > '+Lang.Mail.ConfigJs.settime+"\uff1a&nbsp;&nbsp;",k=endTime=(new Date).format("yyyy-mm-dd");h&&e+""=="1"&&(k=Util.formatDate(new Date(parseInt(a.data.auto_replay_starttime.attribute.value)*1E3),"yyyy-mm-dd"),endTime=Util.formatDate(new Date(parseInt(a.data.auto_replay_endtime.attribute.value)*
1E3),"yyyy-mm-dd"));k=k.split("-");endTime=endTime.split("-");f+="<p id='selctTimeDiv' class='set-time-p' style='width:500px'>";f+='<select id="selYear"  class="set-select" onchange="autoReply.changeDays(\'sel\')" >'+this.getdateHtml(2012,2020,k[0])+'</select><span class="select_mod">'+Lang.Mail.Write.lb_timesend_year+'</span><select id="selMonth"  class="set-select" onchange="autoReply.changeDays(\'sel\')">'+this.getdateHtml(1,12,k[1])+'</select><span class="select_mod">'+Lang.Mail.Write.lb_timesend_month+
'</span><select id="selDay"  class="set-select">'+this.getdateHtml(1,31,k[2])+'</select><span class="select_mod">'+Lang.Mail.Write.lb_timesend_day+"</span><strong>"+Lang.Mail.ConfigJs.to+"</strong>";f+='<select id="endYear"  class="set-select" onchange="autoReply.changeDays(\'end\')" >'+this.getdateHtml(2012,2020,endTime[0])+'</select><span class="select_mod">'+Lang.Mail.Write.lb_timesend_year+'</span><select id="endMonth"  class="set-select" onchange="autoReply.changeDays(\'end\')">'+this.getdateHtml(1,
12,endTime[1])+'</select><span class="select_mod">'+Lang.Mail.Write.lb_timesend_month+'</span><select id="endDay"  class="set-select">'+this.getdateHtml(1,31,endTime[2])+'</select><span class="select_mod">'+Lang.Mail.Write.lb_timesend_day+"</span></p>";b.push('<div class="autoReply-wrap">');b.push('<table class="autoReply-table" >');b.push('<tr class="line1">');b.push("<td width=\"145\" class='ta_r'>{0}\uff1a</td>".format(c));b.push('<td><input class="set-radio" id="option_auto_replay_status1" value="1" name="option_auto_replay_status" type="radio"/><label for="option_auto_replay_status1">{0}</label></td>'.format(Lang.Mail.ConfigJs.reply_lbl_yes));
b.push("</tr>");b.push('<tr class="line2">');b.push("<td>&nbsp;</td>");b.push('<td><input class="set-radio" id="option_auto_replay_status0" value="0" checked="checked" name="option_auto_replay_status" type="radio"/><label for="option_auto_replay_status0">{0}</label></td>'.format(Lang.Mail.ConfigJs.reply_lbl_no));b.push("</tr>");b.push('<tr class="line3">');b.push("<td class='ta_r' valign=\"top\">{0}</td>".format(Lang.Mail.ConfigJs.reply_lbl_respcontent1));b.push("<td>");b.push('<textarea style="margin:0 0 7px 0;" class="w346" cols="50" rows="7" name="option_auto_replay_content" id="option_auto_replay_content" type="text"></textarea>');
b.push("</td>");b.push("</tr>");b.push('<tr class="line4">');b.push("<td>&nbsp;</td>");b.push("<td>"+Lang.Mail.ConfigJs.reply_content_maxLength.format(gConst.autoRepaly_max)+"</td>");b.push("</tr>");b.push("<tr>");b.push("<td class='ta_r'>{0}</td><td>{1}</td>".format(g,f));b.push("</tr>");b.push("</table>");b.push("</div>");b.push(d);b.push('<div style="width:100%" class="btm_pager fl">');b.push('<a href="javascript:fGoto();"  onclick="autoReply.save(\'\');" class="n_btn_on mt_5 ml_10"><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.save));
b.push('<a href="javascript:fGoto();"  onclick="autoReply.goBack(\'\');" class="n_btn mt_5"><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.pref_cancel));b.push("</div>");b.push("</div></div></div>");MM[gConst.setting].update(this.attrs.id,b.join(""));pref.updatePosition("autoReplyWrapper");a=a.data.auto_replay_content.attribute.value;if(e)$("option_auto_replay_status"+e).checked=!0;if(a)$("option_auto_replay_content").value=a;this.loadEvent()};
autoReply.getdateHtml=function(a,b,c){html=[];for(var d=0;a<=b;a++)d=a+"",d<10&&(d="0"+d),html.push("<option value='"+d+"' "+(d==c?"selected":"")+">"+d+"</option>");return html.join("")};
autoReply.save=function(){var a=this,b=document.getElementById("selYear").value+"-"+document.getElementById("selMonth").value+"-"+document.getElementById("selDay").value+" 00:00:00",c=document.getElementById("endYear").value+"-"+document.getElementById("endMonth").value+"-"+document.getElementById("endDay").value+" 23:59:59",d=a.getFormatValue("auto_replay_status"),e=a.getFormatValue("auto_replay_content");if(a.check(!0)){if(d)if(document.getElementById("chkSetTime").checked){var b=Util.str2Date(b).getTime()/
1E3,f=Util.str2Date(c),c=f.getTime()/1E3;if(b>c){CC.alert(Lang.Mail.ConfigJs.endDateEquerStartDate);return}var g=Util.DateDiffMore(f.format("yyyy/mm/dd"),(new Date).format("yyyy/mm/dd"),"d");if(g>=1){CC.alert(Lang.Mail.ConfigJs.reply_DateErrMsg);return}}else c=b=0;a.ajaxRequest(a.attrs.save.func,{auto_replay_status:d,auto_replay_content:e,auto_replay_starttime:b,auto_replay_endtime:c},function(){a.ok(Lang.Mail.ConfigJs.autoRepleySuc)},function(){a.fail(Lang.Mail.ConfigJs.filter_saveFail,g)})}};
autoReply.check=function(a){var b=this.getFormatValue("auto_replay_status"),c=this.getEl("auto_replay_content"),d=c.value.replace(/^[ \t\n\r]+/g,"").replace(/[ \t\n\r]+$/g,"");if(a&&b==1&&d=="")return CC.alert(Lang.Mail.ConfigJs.InputReplayContent),!1;return d.len()>gConst.autoRepaly_max?(CC.alert(Lang.Mail.ConfigJs.reply_length_limit),c.value=d.substring(0,gConst.autoRepaly_max),!1):!0};
autoReply.loadEvent=function(){var a=$("option_auto_replay_status0"),b=$("option_auto_replay_status1"),c=this,d=function(){jQuery("#autoReplyWrapper").find("input[type='checkbox']").each(function(){b.checked?jQuery(this).removeAttr("disabled"):a.checked&&jQuery(this).attr("disabled","disabled")});jQuery("#autoReplyWrapper").find("select").each(function(){b.checked?jQuery(this).removeAttr("disabled"):a.checked&&jQuery(this).attr("disabled","disabled")});b.checked?jQuery("#option_auto_replay_content").removeAttr("disabled"):
a.checked&&jQuery("#option_auto_replay_content").attr("disabled","disabled")};d();a.onclick=function(){d()};b.onclick=function(){d()};jQuery("#option_auto_replay_content").keyup(function(){c.check(!1)})};var black=new OptionBase;
black.attrs={id:"black",authority:"MAIL_CONFIG_ANTIVIRU",divid:"pageWhiteList",type:0,opType:{add:"add",del:"delete"},list:{type:"xml",func:gConst.func.getWBList,data:{type:0}},save:{type:"xml",func:gConst.func.setWBList,data:{opType:"add",type:0,member:""}},op:"",bSave:!0,initValue:Lang.Mail.ConfigJs.semicolon};black.init=function(a,b){this.mail=b;if(a){this.attrs.id=a;var c=0,c=a=="black"?0:1;this.attrs.type=c;this.attrs.list.data.type=c;this.attrs.save.data.type=c}this.request(this.attrs)};
black.emptyMails=function(){for(var a="",b=document.getElementsByName("checkMail"),c=0,d=b.length;c<d;c++)a+=b[c].parentNode.nextSibling.innerHTML+",";a=a.substring(0,a.length-1);black.save(a,"empty")};black.deleteBlackList=function(){for(var a="",b=!1,c=document.getElementsByName("checkMail"),d=0,e=c.length;d<e;d++)c[d].checked&&(a+=c[d].parentNode.nextSibling.innerHTML+",",b=!0);a=a.substring(0,a.length-1);b?black.save(a,"delete"):parent.CC.alert(Lang.Mail.ConfigJs.choiseMailTip)};
black.getHtml=function(a,b){var c=black;c.attrs.emails=b;var d=function(){var a=[];a.push('<p class="set_rule_box_tips">'+(black.attrs.type==0?Lang.Mail.ConfigJs.NoCreateBlackList:Lang.Mail.ConfigJs.NoCreateWhiteList)+"</p>");return a.join("")},e=[],f=function(){var a=[];a.push('<div class="bwSet" >');a.push('<h2 class="set_til">');a.push(c.attrs.type==0?Lang.Mail.ConfigJs.setBlackList:Lang.Mail.ConfigJs.setWhiteList);a.push('<span class="">({0})</span>'.format(c.attrs.type==0?Lang.Mail.ConfigJs.Rejection:
Lang.Mail.ConfigJs.sureReceive));a.push("</h2>");a.push('<fieldset class="formSet">');a.push('<div class="write_adr_wrap">');a.push("<table  cellpadding=\"0\"><tbody><tr><td width='455' >");a.push('<div class="set-txt-wrap4">');a.push("<input id=\"option_wblist\" style='width:415px;height:30px;color:#BFBFBF;border:none;height:28px; line-height:28px;' ");a.push(' class="clearfix" value=\''+Lang.Mail.ConfigJs.semicolon+"'");a.push(" type=\"text\" maxLength='146'><i title='"+Lang.Mail.ConfigJs.chooseFromMailList+
'\' class=" i-rush" id=\'addContact\'></i></div></td><td width="75">');a.push('<a href="javascript:void(0);" id="AAdd" onclick="black.save(); return false;" class="add_Link" style=\'display:inline-block;zoom:1;margin-top:0px;vertical-align:middle\'>');a.push('<i class="i_addMail"></i>'+Lang.Mail.ConfigJs.filter_add+"</a></td>");a.push("</tr>");a.push("</tbody></table>");a.push("</div>");a.push("</fieldset>");a.push("</div>");return a.join("")}(),g=c.getTableList(function(){var a={title:"",items:[]};
a.head={title:["",Lang.Mail.ConfigJs.filter_emailaddress,Lang.Mail.ConfigJs.filter_operate],className:["td1","td2","td3"]};if(typeof b=="object"&&b.length>0)for(var d=0;d<b.length;d++){if(b[d]!=""){var e=b[d].encodeHTML();try{a.items[d]=[],a.items[d][0]="<input type='checkbox' name='checkMail'/>",a.items[d][1]=e,a.items[d][2]=("<a onclick=\"black.save('{0}','delete'); return false;\"  href=\"javascript:void(0)\">"+Lang.Mail.ConfigJs.filter_delete+"</a>").format(e)}catch(f){}}}else a.items=c.attrs.type==
0?Lang.Mail.ConfigJs.NoCreateBlackList:Lang.Mail.ConfigJs.NoCreateWhiteList;return a}());e.push("<div class=\"bodySet bodyBwList\" style='align:text;position:relative'");a.divId&&e.push(' id="{0}"'.format(a.divId));e.push('><div id="container" style="position:relative">');e.push(this.getTopHtml());e.push(this.getLeftHtml());e.push('<div class="setWrapper" id=\'blackWrapper\' style="position:relative">');e.push(f);black.attrs.emails.length>0?(e.push(g),e.push("<p class=\"set_table_btm\" id='blackTabel'> "),
e.push("<a class=\"n_btn mt_5\" onclick='black.deleteBlackList(); return false;'>"),e.push("<span><span>"+Lang.Mail.ConfigJs.deleteTip+"</span>"),e.push('</span></a> <a class="n_btn mt_5" href="javascript:void(0);" style=\'margin-left:25px\'>'),e.push("<span onclick='black.emptyMails(); return false;' >"),e.push("<span>"+Lang.Mail.ConfigJs.empty+"</span></span></a></p>")):e.push(d());e.push("</div></div></div>");MM[gConst.setting].update(c.attrs.id,e.join(""));c.updatePosition("blackWrapper");c.initEvent()};
black.initEvent=function(){var a=black;a.correctWidthInIE6("blackWrapper",1);jQuery("#addContact").mouseover(function(){jQuery(this).attr("class","i-rush-on")}).mouseout(function(){jQuery(this).attr("class","i-rush")});jQuery("#addContact").click(function(){a.addWhiteDialog()});jQuery("#option_wblist").keydown(function(a){EV.getCharCode(a)==13&&black.save();a.stopPropagation()});jQuery("#option_wblist").focus(function(){if(a.attrs.initValue=="")a.attrs.initValue=jQuery("#option_wblist").val();jQuery("#option_wblist")[0].value==
a.attrs.initValue&&(jQuery("#option_wblist").val(""),jQuery("#option_wblist").css("color","black"))}).blur(function(){if(jQuery("#option_wblist")[0].value==""||jQuery("#option_wblist")[0].value==null)jQuery("#option_wblist").val(a.attrs.initValue),jQuery("#option_wblist").css("color","#BFBFBF")})};
black.deleteList=function(a,b){var c=this;c.ajaxRequest("user:setWhiteBlackList",{opType:"delete",type:a,member:b.join(",")},function(){(window.LoginType==gConst.loginType.pm||window.LoginType==gConst.loginType.mm)&&c.addExtLog("delete",b)})};
black.save=function(a,b){var c=black,d=black.attrs.save.data;c.attrs.emails.join(",");if(b!=null||b!="")c.attrs.op=b;if(a){d.opType=c.attrs.opType.del;d.member=a.trim();var e=function(){d.opType=c.attrs.opType.del;d.member=a;c.ajaxRequest(c.attrs.save.func,d,function(){(window.LoginType==gConst.loginType.pm||window.LoginType==gConst.loginType.mm)&&c.addExtLog("delete",a);c.attrs.op=="delete"?c.attrs.type==0?CC.showMsg(Lang.Mail.ConfigJs.blackDeleteSuc,!0,!1,"option"):CC.showMsg(Lang.Mail.ConfigJs.whiteDeleteSuc,
!0,!1,"option"):c.attrs.type==0?CC.showMsg(Lang.Mail.ConfigJs.blackEmpty,!0,!1,"option"):CC.showMsg(Lang.Mail.ConfigJs.whiteEmpty,!0,!1,"option");c.init(c.attrs.id)},function(){c.fail(Lang.Mail.ConfigJs.filter_saveFail)})};black.attrs.op=="empty"?CC.confirm(black.attrs.type==0?Lang.Mail.ConfigJs.emptyBlackTip:Lang.Mail.ConfigJs.emptyWhiteTip,e,Lang.Mail.ConfigJs.mailpop_sysPrompt,function(){}):e()}else{d.opType=c.attrs.opType.add;a=$("option_wblist").value.replace(/[;\uff1b\uff0c]/g,",");e=gMain.domain.trim();
eval("/"+e+"$/gi");var f=a.split(","),a=a.trim();if(a=="")CC.alert(Lang.Mail.ConfigJs.InputMail);else{a.substr(a.length-1,1)==","&&(a=a.substring(0,a.length-1));for(var g=0,h=f.length;g<h;g++)if(e&&c.attrs.type==0&&f[g].substr(f[g].indexOf("@")+1)==e){setTimeout(function(){top.CC.alert(Lang.Mail.ConfigJs.forbidAddBlackTo)},100);return}a=a.split(",");a=a.unique();a=a.join(",");c.existBlack(a)}}};
black.existBlack=function(a){var b=this;b.attrs.bSave=!0;var c=a.split(","),d=c.length,e=[],f=0,g=!1,h=[],k=b.attrs.type,l=k==0?Lang.Mail.ConfigJs.whiteRecordClear:Lang.Mail.ConfigJs.blackRecordClear,m=k==0?1:0;b.ajaxRequest("user:getWhiteBlackList",{type:m},function(k){h=k;for(f=0;f<d;f++)h.has(c[f])&&(g=!0,e.push(c[f]));g==!0?(b.attrs.bSave=!1,parent.CC.confirm(l,function(){b.deleteList(m,e);b.addMails(a)},Lang.delete_confirm,null,"delEmails")):b.addMails(a)},function(){})};
black.checkMailExist=function(a,b,c){var d=[],e={},f=[],g=b||function(){},h=c||function(){},k=!1;if(a){d=a.split(",");b=0;for(c=d.length;b<c;b++)e[d[b]]=!0;this.ajaxRequest("user:getWhiteBlackList",{type:1},function(b){if(b&&b.length){for(var c=0,d=b.length;c<d;c++)b[c]&&e.hasOwnProperty(b[c])&&(k=!0,f.push(b[c]));k?g(a,f):h(a)}else h(a)},function(){})}};
black.addMails=function(a){var b=black,c=b.attrs.emails.join(","),d=black.attrs.save.data,e=[];d.member=a;for(var f=b.attrs.type==0?Lang.Mail.ConfigJs.setBlackSuc:Lang.Mail.ConfigJs.setWhiteSuc,g=d.member.split(","),h=g.length,k=0;k<h;k++){var l=!1;if(!Vd.checkData("email",g[k])&&!Vd.checkData("blackDomain",g[k])){CC.alert(Lang.Mail.ConfigJs.rightMailAdressTip+gMain.domain);return}if(g[k]!="")for(var m=0,n=c.split(",").length;m<n;m++)if(c.split(",")[m].toLowerCase()==g[k].toLowerCase().trim()&&(l=
!0,h==1)){CC.alert(g[k]+Lang.Mail.ConfigJs.MailExist);return}l||e.push(g[k])}c=e.length;if(c>1)d.member=e.join(",");else if(c==1)d.member=e.join("");else{CC.alert(Lang.Mail.ConfigJs.mailDomainExists);return}b.ajaxRequest(b.attrs.save.func,d,function(){(window.LoginType==gConst.loginType.pm||window.LoginType==gConst.loginType.mm)&&b.addExtLog("add",a);CC.showMsg(f,!0,!1,"option");b.init(b.attrs.id)},function(){b.fail(Lang.Mail.ConfigJs.filter_saveFail)})};
black.addExtLog=function(a,b){MM.doService({url:"/log/log",func:"log:setBlackWhiteList",data:{opType:a,type:this.attrs.type,member:b},failCall:function(){},call:function(){},param:""})};black.showContactDialog=function(a,b){contact=new parent.Contact("contact");contact.groupMap=LMD.groupMap;contact.group_contactListMap=LMD.group_contactListMap_mail;contact.inItContanct(black.attrs.id+"_ContactDialog",a,b,null)};
black.addWhiteDialog=function(){var a=this;black.showContactDialog(["0","2"],function(b){for(var c="",d=jQuery("#option_wblist").val(),e=0,f=b.length;e<f;e++){var g=b[e].value,g=encodeURI(g),g=a.getClearEmail(g);c+=g+";"}d!=a.attrs.initValue?(d!=""&&d.substr(d.length-1,1)!=";"&&(d+=";"),jQuery("#option_wblist").css("color","black").val(d+c).focus()):jQuery("#option_wblist").css("color","black").val(c).focus()})};
black.addBlackDialog=function(){var a=this;black.showContactDialog(["0","2"],function(b){for(var c=0,d=b.length;c<d;c++)a.getClearEmail(b[c].value)})};black.getClearEmail=function(a){var a=decodeURI(a),b=a.indexOf("<")+1,c=a.lastIndexOf(">")-b;return a.substr(b,c)};black.getBlackWhiteList=function(a,b,c){this.ajaxRequest("user:getWhiteBlackList",{type:a},function(a){b(a)},function(a){c(a)})};
black.addBlack=function(a,b){function c(a){var c=","+a+",";black.getBlackWhiteList(0,function(a){if(a&&a.length)for(var e=0,f=a.length;e<f;e++)c=c.replace(","+a[e]+",",",");c&&c.length>2&&(c=c.substr(1),c=c.substr(0,c.length-1),d(c));b()},function(){d(a);b()})}function d(a){a?e.ajaxRequest(e.attrs.save.func,{opType:"add",type:0,member:a},function(){CC.showMsg(Lang.Mail.ConfigJs.addedSenderToBlack,!0,!1,"option")},function(){}):CC.alert(Lang.Mail.ConfigJs.filter_saveFail)}var e=this,f,a=a.replace(/\s*/g,
"");f=a.split(",");for(var g=0;g<f.length;g++)if(!Vd.checkData("email",f[g])&&!Vd.checkData("blackDomain",f[g])){CC.alert(Lang.Mail.ConfigJs.rightMailAdressTip+gMain.domain);return}b=b||function(){};f=function(a,b){parent.CC.confirm(Lang.Mail.ConfigJs.whiteRecordClear,function(){e.deleteList(1,b);c(a)},Lang.delete_confirm,null,"delEmails")};g=function(a){c(a)};a==""?b():e.checkMailExist(a,f,g)};
var white=black,ChangeSkin={init:function(){this.initEvent()},initEvent:function(){var a=this;jQuery("#skinPage li").click(function(){var b=jQuery(this).attr("rel");a.changeLink("topLinks",b);a.changeLink("iframeLinks",b)})},changeLink:function(a,b){for(var c=a=="topLinks"?top.jQuery("html link"):top.jQuery("iframe"),d=c.length,e=0;e<d;e++){var f="";if(a=="topLinks")f=c[e].href,this.checkLink(c,f,b,e);else try{for(var g=jQuery(c[e].contentWindow.document).find("link"),h=g.length,k=0;k<h;k++)f=g[k].href,
this.checkLink(g,f,b,k)}catch(l){}}},changeFont:function(a){fontCss=a=="normalfont"?"bigfont":"normalfont";for(var b=top.jQuery("html link"),c=0;c<b.length;c++){var d=b[c].href;if(d.indexOf(fontCss)>0){b[c].href=d.replace(fontCss,a);break}}b=top.jQuery("iframe");for(c=0;c<b.length;c++)try{for(var e=jQuery(b[c].contentWindow.document).find("link"),f=e.length,g=0;g<f;g++)if(d=e[g].href,d.indexOf(fontCss)>0){e[g].href=d.replace(fontCss,a);break}}catch(h){}},checkLink:function(a,b,c,d){if(b.indexOf("skin_")>
-1)b=b.replace(/skin_[\w]*_zh_CN/,c+"_zh_CN"),a[d].href=b}};ChangeSkin.init();var face=new OptionBase;face.attrs={id:"face",authority:"MAIL_CONFIG_FACE",free:!0,divId:"pageFaceset",list:{type:"url",func:gConst.func.getAttrs},tableClass:"faceWidth"};face.init=function(){this.request(this.attrs);this.initEvent()};
face.getHtml=function(){var a=[],b=function(){var a=[];a.push("<div>");a.push('<h2 class="set_til"> '+Lang.Mail.ConfigJs.faceset+"<span>");a.push("( "+Lang.Mail.ConfigJs.choiseFavoriteFace+"\uff1a )</span></h2>");a.push("<div class=\"codeSet-wrap\" id='codeSet'>");a.push('<ul class="parameter-ul pt_10">');a.push('<li class="pl113">');a.push('<input id="simpleChinese" class="rm_cb" type="radio" ');a.push('value="zh_CN" name="faceSet">');a.push('<label for="simpleChinese"> '+Lang.Mail.ConfigJs.simpleC+
"</label></li>");a.push('<li class="pl113 pb_15"></li>');a.push('<li class="pl113">');a.push('<input id="traditionalChinese" class="rm_cb" type="radio" ');a.push('value="zh_TW" name="faceSet">');a.push('<label for="traditionalChinese">  '+Lang.Mail.ConfigJs.ft+"</label></li>");a.push('<li  class="pl155 pb_15" ></li>');a.push('<li class="pl113">');a.push('<input id="english" class="rm_cb" type="radio" ');a.push('value="en_US" name="faceSet">');a.push('<label for="english"> '+Lang.Mail.ConfigJs.en+
"</label></li></ul>");a.push("</div><\!--codeSet-wrap--\>");a.push("<div class=\"btm_pager fl\" style='width:100%'>");a.push("<a id='save' class=\"n_btn_on mt_5 ml_10\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");a.push("<a id='cancel' class=\"n_btn mt_5\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");a.push("</div>");return a.join("")}();a.push("<div class=\"bodySet bodyBwList\" style='align:text;'");a.push('><div id="container">');
a.push(this.getTopHtml());a.push(this.getLeftHtml());a.push('<div class="setWrapper" id="setWrapp">');a.push(b);a.push("</div></div></div>");MM[gConst.setting].update(password.attrs.id,a.join(""));password.updatePosition();this.initEvent()};
face.initEvent=function(){var a=this,b=jQuery;b("#save").click(function(){a.ajax_faceSave()});b("#cancel").click(function(){a.goBack()});if(window.gMain&&gMain.lang)b(":radio[name='faceSet'][value='"+gMain.lang+"']").attr("checked",!0),a.beforeLang=gMain.lang;a.updatePosition()};
face.ajax_faceSave=function(){var a=this,b="",c=gConst.func.setAttrs_us,d="",e=gConst.mailUlr_us,d=d=null,b=jQuery(":radio[name=faceSet][checked]").val(),d={language:b};pref.doService(c,d,function(){CC.showMsg(Lang.Mail.ConfigJs.facesetSave,!0,!1,"option");a.lang=b;a.saveAfter()},function(){CC.showMsg(Lang.Mail.ConfigJs.facefailsave,!0,!1,"error")},e)};
face.saveAfter=function(){try{if(this.lang!=this.beforeLang&&window.gMain)gMain.lang=this.lang,GC.setCookie("lang"+gMain.sid,this.lang,"/",gMain.mainDomain),top.location.reload()}catch(a){}};var filter=new OptionBase;filter.opAttrs={0:Lang.Mail.ConfigJs.filter_op_text_Noset,1:Lang.Mail.ConfigJs.filter_op_text_contains,2:Lang.Mail.ConfigJs.filter_op_text_excludes,3:Lang.Mail.ConfigJs.reply_lbl_yes,4:Lang.Mail.ConfigJs.filter_op_text_No,5:Lang.Mail.ConfigJs.filter_op_text_startsWith,6:Lang.Mail.ConfigJs.filter_op_text_endsWith};
filter.attrs={id:"filter",authority:"MAIL_MANAGER_FILTER",free:!1,divId:"pageCreateFilter",tableClass:"",dropFolder:null,dropMailType:null,textBox:null,maxSize:100,list:{type:"url",func:gConst.func.getFilter,data:{}},save:{func:gConst.func.setFilter},del:{},data:{from:{text:"",type:"text",attribute:{value:"",defaultValue:""}},to:{text:"",type:"text",attribute:{value:"",defaultValue:""}},subject:{text:"",type:"text",attribute:{value:"",defaultValue:""}},dealHistoryMail:{text:"",type:"checkbox",attribute:{value:"",
defaultValue:"1"},items:{2:Lang.Mail.ConfigJs.hisMail},format:"int"},mailSizeType:{text:Lang.Mail.ConfigJs.mailSize,type:"select",attribute:{value:"",defaultValue:"0"},items:{0:Lang.Mail.ConfigJs.filter_op_text_Noset,1:Lang.Mail.ConfigJs.GreaterOrEqual,2:Lang.Mail.ConfigJs.Lessthan},format:"int"},mailSize:{text:"",type:"text",attribute:{value:"",defaultValue:""}},conditionsRelation:{text:"",type:"radio",attribute:{value:"",defaultValue:"1"},items:{1:Lang.Mail.ConfigJs.allConditions,2:Lang.Mail.ConfigJs.oneConditions},
format:"int"},dealType:{text:Lang.Mail.ConfigJs.filter_all_the_rules,type:"radio",attribute:{value:"",defaultValue:"0"},format:"int",items:{0:Lang.Mail.ConfigJs.deleteMail,1:Lang.Mail.ConfigJs.filter_ReeReject,2:Lang.Mail.ConfigJs.filter_Move,3:Lang.Mail.ConfigJs.pref_forward,4:Lang.Mail.ConfigJs.pref_autoresp,5:Lang.Mail.ConfigJs.filter_tag,6:Lang.Mail.ConfigJs.mark,7:Lang.Mail.ConfigJs.setHaveRead}},forwardAddr:{text:Lang.Mail.ConfigJs.filter_ForwardAddr,type:"text",attribute:{value:"",defaultValue:""},
format:"string"},forwardBakup:{text:"",type:"checkbox",attribute:{value:"",defaultValue:"1"},items:{1:Lang.Mail.ConfigJs.filter_backup},format:"int"},replayContent:{text:Lang.Mail.ConfigJs.filter_ReContent,type:"textarea",className:"replayContent",format:"text"},ignoreCase:{text:"",type:"checkbox",attribute:{value:"1",defaultValue:"1"},items:{1:Lang.Mail.ConfigJs.filter_ignorecase},format:"int"},folderId:{text:"",type:"select",attribute:{value:"",defaultValue:"1"},items:{},format:"int",noset:!0},
labelId:{text:"",type:"select",attribute:{value:"",defaultValue:"1"},items:{},format:"int",noset:!0},moveToFolder:{text:"",type:"text",attribute:{value:"",defaultValue:"1"},items:{},format:"int",noset:!0},attachLabel:{text:"",type:"text",attribute:{value:"",defaultValue:"1"},items:{},format:"int",noset:!0}}};
filter.init=function(a,b){this.attrs.data.folderId.items=CC.getFolders();this.attrs.dropFolder=new DropSelect({id:"opFolder",data:this.attrs.data.folderId.items,type:"fileTree",selectedValue:"1",width:200,height:200});if(CC.isLabelMail())this.attrs.data.labelId.items=this.getFolders([GE.folder.label]),this.attrs.dropLabel=new DropSelect({id:"opLabel",data:this.attrs.data.labelId.items,type:"fileTree",selectedValue:"1",width:200,height:200});this.attrs.dropMailType=new DropSelect({id:"opMailType",
data:[{text:Lang.Mail.ConfigJs.GreaterOrEqual,value:"1"},{text:Lang.Mail.ConfigJs.Lessthan,value:"2"}],type:"",selectedValue:"1",width:117});this.request(this.attrs,function(a,d){this.getHtml(a,d,b)})};
filter.initFolderTree=function(){var a=this.attrs.data.folderId.items,b=jQuery("#dropMailUL"),c=b.children(),d=[];d.push(c[0].outerHTML);b.empty();var e=function(a,b){for(var c=null,k="",l="",l="",m=!1,n=0;n<a.length;n++)c=a[n],m=n==a.length-1,k=b||"",l=c.parentId==0?"":m?"\u2514 ":"\u251c ",l=k+l+c.name,d.push('<li><a href="#" id="dropMail_A{0}"  onclick="Main.AdvDropOnClick(this)" >'.format(c.fid)),d.push('<span class="text">{0}</span></a>'.format(l)),d.push("</li>"),c.nodes&&c.nodes.length>0&&
(k+=m||c.parentId==0?"&nbsp;":"\u2502 ",e(c.nodes,k))};e(a);b.html(d.join(""))};
filter.getHtml=function(a,b,c){var d=[];this.dataList=b.sort(function(a,b){return a.sortId-b.sortId});a=a.id;d.push('<div class="bodySet" style=\'display:none;\' id="pageCreateFilter">');d.push("</div>");d.push('<div class="bodySet" id="pageFilter">');d.push('<div id="container">');d.push(this.getTopHtml());d.push(this.getLeftHtml());d.push(this.getNavMenu(a));d.push('<div class="setWrapper" id="filterList">');d.push(' <div class="write_adr_wrap">');d.push('   <a href="javascript:fGoto();" class="n_btn_on font-bold" onclick="filter.showAdd();"><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.newFilter_add));
d.push(" </div>");d.push(' <div class="set_rule_box">');var e=Lang.Mail.ConfigJs.newFilter_Count.format(this.attrs.maxSize,b.length);d.push("   <h3>"+Lang.Mail.ConfigJs.newFilter_ListTitle+"<span> "+e+"</span></h3>");d.push("   <h4>"+Lang.Mail.ConfigJs.newFilter_Explain+"</h4>");try{if(b.length==0)d.push('<p class="set_rule_box_tips">'+Lang.Mail.ConfigJs.newFilter_NotData+"</p>");else{d.push('<div class="set_mail_table pt_10">');d.push('<table class="addr_table_head" width="100%">');d.push("<tr>");
d.push('<td width="85" class="td1">'+Lang.Mail.ConfigJs.newFilter_Sequence+"</td>");d.push('<td class="td2">'+Lang.Mail.ConfigJs.newFilter_Rules+"</td>");d.push('<td width="210" class="td3">'+Lang.Mail.ConfigJs.newFilter_Operate+"</td>");d.push("</tr>");d.push("</table>");d.push('<table class="addr_table_body td-color" width="100%">');for(e=0;e<b.length;e++){var f=b[e];d.push("<tr>");d.push('<td width="85" class="td1">'+(e+1)+"</td>");d.push('<td class="td2">{0}</td>'.format(this.getContent(f)));
d.push('<td width="210" class="td3">');d.push('<a href="javascript:fGoto();" class="mr_15" onclick="{0}.update({1},{2});return false;">{3}</a>'.format(a,e,f.filterId,Lang.Mail.ConfigJs.newFilter_Update));d.push('<a href="javascript:fGoto();" onclick="{0}.del({1});return false;"  class="mr_15">{2}</a>'.format(a,f.filterId,Lang.Mail.ConfigJs.newFilter_Delete));b.length>1&&(e==0?d.push('<a href="javascript:fGoto();" class="move-down" onclick="{0}.listSort({1},\'down\');return false;">{2}<i title=\'{3}\'></i></a>'.format(a,
e,"",Lang.Mail.ConfigJs.newFilter_MoveDown)):(e+1!=b.length&&d.push('<a href="javascript:fGoto();" class="move-down" onclick="{0}.listSort({1},\'down\');return false;">{2}<i title=\'{3}\'></i></a>'.format(a,e,"",Lang.Mail.ConfigJs.newFilter_MoveDown)),d.push('<a class="move-up mr_15" href="javascript:fGoto();" onclick="{0}.listSort({1},\'up\');return false;">{2}<i title=\'{3}\'></i></a>'.format(a,e,"",Lang.Mail.ConfigJs.newFilter_MoveUp))));d.push("</td>");d.push("</tr>")}d.push("</table>");d.push("</div>")}d.join("")}catch(g){}d.push(" </div><\!--set_rule_box--\>");
d.push("</div><\!--set_content--\>");d.push("</div>");MM[gConst.setting].update(a,d.join(""));pref.updatePosition("filterList");CC.isLabelMail()&&c&&c.callback&&c.callback.call(this,null)};
filter.showAdd=function(a,b,c){var d=$("pageCreateFilter");d.innerHTML=this.getAddHtml(this.attrs,b,c&&c.sortId?c.sortId:0);this.attrs.dropMailType.loadEvent();this.attrs.dropFolder.loadEvent();CC.isLabelMail()&&this.attrs.dropLabel.loadEvent();pref.updatePosition("filterWrapper");var e=$("pageFilter");a?(El.show(e),El.hide(d)):(this.initDataField(),b&&this.bindUpdateData(c),El.show(d),El.hide(e));document.getElementById("option_from");a=document.getElementById("option_to");b=document.getElementById("option_subject");
c=document.getElementById("option_mailSize");a.maxLength=100;b.maxLength=100;c.maxLength=7;for(var f=function(a){var b=a.id.replace("_","_check_");if(a.value=="\u4f8b\u5982\uff1a@qq.com;test@abc.com;"){if(a.value="",a.createTextRange){var c=a.createTextRange();c.moveStart("character",a.value.length);c.collapse();c.select()}}else if(a.value==Lang.Mail.ConfigJs.filter_InputDoMain)a.value="",a.createTextRange&&(c=a.createTextRange(),c.moveStart("character",a.value.length),c.collapse(),c.select());else if(a.value==
Lang.Mail.ConfigJs.filter_SubValue)a.value="",a.createTextRange&&(c=a.createTextRange(),c.moveStart("character",a.value.length),c.collapse(),c.select());jQuery(a).attr("style","color: black;");if($(b))$(b).checked=!0;if(b=="option_check_dealType3"||b=="option_check_dealType4")if(jQuery("#"+b).attr("disabled")=="disabled"){if($(b))$(b).checked=!1}else $("option_check_dealHistoryMail").checked=!1},a=jQuery("#pageCreateFilter").find("input[type='text']"),b=0;b<a.length;b++)a[b].onclick=function(){f(this)},
a[b].onblur=function(){if(this.value.trim()==""){jQuery(this).removeAttr("style");if(this.id=="option_from"||this.id=="option_to")this.value="\u4f8b\u5982\uff1a@qq.com;test@abc.com;";else if(this.id=="option_fromDomain")this.value=Lang.Mail.ConfigJs.filter_InputDoMain;else if(this.id=="option_subject")this.value=Lang.Mail.ConfigJs.filter_SubValue;var a=this.id.replace("_","_check_");if($(a))$(a).checked=!1}},a[b].onfocus=function(){f(this)};var g=jQuery("input[name='checkDealType']");$("option_check_dealType0").onclick=
function(){this.checked?g.each(function(){this.checked=!1;jQuery(this).attr("disabled","disabled")}):g.each(function(){jQuery(this).removeAttr("disabled")})};$("option_check_dealType0").checked&&g.each(function(){jQuery(this).attr("disabled","disabled")});var h=this;jQuery("#filter_AddContact").mouseover(function(){jQuery(this).attr("class","i-rush-pe-on")}).mouseout(function(){jQuery(this).attr("class","i-rush-pe")});jQuery("#filter_AddContact").click(function(){h.showContactDialog(["0","2"],h.contactCall)})};
filter.contactCall=function(a){var b=jQuery("#option_from").val();b=="\u4f8b\u5982\uff1a@qq.com;test@abc.com;"&&(b="");for(var b=b.split(";"),c=0;c<b.length;c++){var d=Email.getValue(b[c]);d&&(b[c]=d)}for(c=0;c<a.length;c++)(d=Email.getValue(a[c].value))&&b.push(d);b&&b.length>0&&($("option_from").focus(),jQuery("#option_from").val(b.unique().join(";")),jQuery("#option_from").attr("style","color:black;"),jQuery("#option_check_from").attr("checked",!0))};
filter.showContactDialog=function(a,b){contact=new parent.Contact("contact");contact.groupMap=LMD.groupMap;contact.group_contactListMap=LMD.group_contactListMap_mail;contact.inItContanct(black.attrs.id+"_ContactDialog",a,b,null)};
filter.bindUpdateData=function(a){if(a.from)$("option_from").value=a.from.decodeHTML(),jQuery("#option_from").attr("style","color:black;"),$("option_check_from").checked=!0;if(a.to)$("option_to").value=a.to.decodeHTML(),jQuery("#option_to").attr("style","color:black;"),$("option_check_to").checked=!0,$("option_to_all").checked=a.toType-0==1;if(a.subject)$("option_subject").value=a.subject.decodeHTML(),jQuery("#option_subject").attr("style","color:black;"),$("option_check_subject").checked=!0,$("option_subject_all").checked=
a.subjectType-0==1;if(a.mailSize)this.attrs.dropMailType.setValue(a.mailSizeType),$("option_mailSize").value=a.mailSize,jQuery("#option_mailSize").attr("style","color:black;"),$("option_check_mailSize").checked=!0;$("option_conditionsRelation2").checked=a.conditionsRelation==2;for(var b=a.dealType.split(","),c=0;c<b.length;c++){var d=b[c],e=document.getElementById("option_check_dealType"+d);if(e)e.checked=!0;d==2?this.attrs.dropFolder.setValue(a.moveToFolder):d==3&&$("option_dealType3")?($("option_dealType3").value=
a.forwardAddr,jQuery("#option_dealType3").attr("style","color:black;")):d==4?$("option_dealType4").innerHTML=a.replayContent.decodeHTML():CC.isLabelMail()&&d==5&&this.attrs.dropLabel.setValue(a.attachLabel)}if(typeof a.forwardBakup!="undefined"&&$("option_check_dealType3_save"))$("option_check_dealType3_save").checked=a.forwardBakup-0==1};
filter.hisMailSel=function(a){a==2?document.getElementById("option_dealHistoryMail2").disabled=!1:(document.getElementById("option_dealHistoryMail2").disabled=!0,document.getElementById("option_dealHistoryMail2").checked=!1)};
filter.getAddHtml=function(a,b,c){try{var d=[],b=b||0,c=c||0,e=a.data.moveToFolder.attribute.value,f=a.data.attachLabel.attribute.value,g=a.data.dealType.attribute.value;if(g==2)a.data.folderId.attribute.value=e;else if(g==5)a.data.labelId.attribute.value=f;d.push('<div id="container">');d.push(this.getTopHtml());d.push(this.getLeftHtml());d.push(this.getNavMenu(a.id));d.push('<div id="filterWrapper" class="setWrapper"><div>');d.push('<input type="hidden" value="{0}" id="option_filterId" name="option_filterId">'.format(b));
d.push('<input type="hidden" value="{0}" id="option_filterSortId" name="option_filterSortId">'.format(c));d.push('<h2 class="set_til"> '+(b==0?Lang.Mail.ConfigJs.filter_AddRule:Lang.Mail.ConfigJs.filter_UpdateRule)+'<a onclick="filter.showAdd(true);return false;" href="javascript:fGoto();" class="fn bord-spa" >  &#8249;&#8249;'+Lang.Mail.ConfigJs.filter_return+"</a></h2>");d.push('<table class="filter-frame">');d.push('<tr><td class="mailPOP_tdWidth" style="vertical-align:top;text-align:right;">'+
Lang.Mail.ConfigJs.filter_MailArrived+"\uff1a</td>");d.push("<td><div>");d.push('<table width="600" class="set-layout-table" id="set_table_lab1">');d.push("<tr>");d.push('<td width="80"><input id="option_check_from" class="checkbox-com" type="checkbox"/><label for="option_check_from">'+Lang.Mail.ConfigJs.filter_From+"</label></td>");d.push('<td width="300"><span class="set-txt-wrap3 w284">');d.push('<input id="option_from" class="sendMail-txt w270" type="text" value="\u4f8b\u5982\uff1a@qq.com;test@abc.com;"/>');
d.push("<i title='"+Lang.Mail.ConfigJs.chooseFromMailList+"' style='' class=\"i-rush-pe\" id='filter_AddContact'></i>");d.push("</span></td>");d.push("</tr>");d.push('<tr style="display:none;">');d.push('<td><input class="checkbox-com" id="option_check_fromDomain"  type="checkbox"/><label for="option_check_fromDomain">'+Lang.Mail.ConfigJs.filter_FromDomain+"</label></td>");d.push("<td>");d.push('<span class="set-txt-wrap">');d.push('<input id="option_fromDomain" class="set-mand-txt w284" type="text" value="'+
Lang.Mail.ConfigJs.filter_InputDoMain+'"/>');d.push("</span>");d.push("</td>");d.push("</tr>");d.push("<tr>");d.push('<td><input class="checkbox-com" id="option_check_to" type="checkbox"/><label for="option_check_to">'+Lang.Mail.ConfigJs.filter_ToContain+"</label></td>");d.push('<td ><span class="set-txt-wrap">');d.push('<input id="option_to" class="set-mand-txt w284" type="text" value="\u4f8b\u5982\uff1a@qq.com;test@abc.com;"/>');d.push('</span><span class="ml_10">');d.push('<input class="checkbox-com" id="option_to_all" type="checkbox"/><label for="option_to_all">'+
Lang.Mail.ConfigJs.filter_ContainAll+"</label>");d.push("</span>");d.push("</td>");d.push("</tr>");d.push("<tr>");d.push('<td><input class="checkbox-com" id="option_check_subject" type="checkbox"/><label for="option_check_subject">'+Lang.Mail.ConfigJs.filter_SubjectContain+"</label></td>");d.push("<td>");d.push('<span class="set-txt-wrap">');d.push('<input id="option_subject" class="set-mand-txt w284" type="text" value="'+Lang.Mail.ConfigJs.filter_SubValue+'"/>');d.push('</span><span class="ml_10">');
d.push('<input class="checkbox-com" id="option_subject_all" type="checkbox"/><label for="option_subject_all">'+Lang.Mail.ConfigJs.filter_ContainAll+"</label>");d.push("</span></td>");d.push("</tr>");d.push('<tr class="btm-line">');d.push('<td><input class="checkbox-com" id="option_check_mailSize" type="checkbox"/><label for="option_check_mailSize">'+Lang.Mail.ConfigJs.filter_MailSize+"</label></td>");d.push("<td>");d.push('<div class="fl pr_10">');d.push(this.attrs.dropMailType.getHTML());d.push("</div>");
d.push('<span class="set-txt-wrap ie-set-txt">');d.push('<input type="text" id="option_mailSize" class="set-mand-txt w155">');d.push('</span>&nbsp;&nbsp;<span id="option_mailSize_type" class="col999">M</span>');d.push("</td>");d.push("</tr>");d.push("<tr>");d.push('<td colspan="2" class="pt_10"><input class="radio-com" id="option_conditionsRelation1" name="option_conditionsRelation" checked="checked" type="radio"/><label for="option_conditionsRelation1">'+Lang.Mail.ConfigJs.filter_MeetAllAbove+"</label>");
d.push("&nbsp;&nbsp;&nbsp;&nbsp;");d.push('<input class="radio-com" id="option_conditionsRelation2" name="option_conditionsRelation" type="radio"/><label for="option_conditionsRelation2">'+Lang.Mail.ConfigJs.filter_MeetAnyAbove+"</label>");d.push("</td>");d.push("</tr>");d.push("</table></div>");d.push("</td></tr>");d.push("</table><\!--mail-arrived--\>");d.push('<table class="filter-condition">');d.push('<tr><td style="vertical-align:top;text-align:right;" class="mailPOP_tdWidth">'+Lang.Mail.ConfigJs.filter_MeetTheAbove+
"\uff1a</td>");d.push("<td><div>");d.push('<table id="set_table_lab2" class="condition-table" width="591">');d.push("<tr>");d.push(' <td width="80"><input class="checkbox-com" id="option_check_dealType0" type="checkbox"/><label for="option_check_dealType0">'+Lang.Mail.ConfigJs.deleteMail+'</label></td><td width="300">');d.push(" </td></tr>");d.push(" <tr>");d.push(' <td><input class="checkbox-com" id="option_check_dealType2" name="checkDealType" type="checkbox"/><label for="option_check_dealType2">'+
Lang.Mail.ConfigJs.filter_InFolder+"</label></td>");d.push(" <td>");d.push(this.attrs.dropFolder.getHTML());d.push(" </td>");d.push(" </tr>");CC.isLabelMail()&&this.attrs.data.labelId.items.length&&(d.push(" <tr>"),d.push(' <td><input class="checkbox-com" id="option_check_dealType5" name="checkDealType" type="checkbox"/><label for="option_check_dealType5">'+Lang.Mail.label_MarkLabel+"</label></td>"),d.push(" <td>"),d.push(this.attrs.dropLabel.getHTML()),d.push(" </td>"),d.push(" </tr>"));"1"!=parent.gMain.hideAutoForward&&
(d.push(" <tr>"),d.push('    <td><input class="checkbox-com" id="option_check_dealType3" name="checkDealType" type="checkbox" onclick="javascript:if(this.checked) $(\'option_check_dealHistoryMail\').checked = false;"/><label for="option_check_dealType3">'+Lang.Mail.ConfigJs.filter_auto_forward+"</label></td>"),d.push('    <td><span class="set-txt-wrap">'),d.push('      <input type="text" id="option_dealType3" class="set-mand-txt w196">'),d.push("    </span>"),d.push('\t\t<span><input type="checkbox" checked="checked" id="option_check_dealType3_save" class="checkbox-com">'),
d.push('<label for="option_check_dealType3_save">'+Lang.Mail.ConfigJs.filter_SaveMail+"</label></span>"),d.push("</td>"),d.push("  </tr>"));d.push("  <tr>");d.push('    <td style="vertical-align:top;"><input class="checkbox-com" id="option_check_dealType4" onclick="javascript:if(this.checked) $(\'option_check_dealHistoryMail\').checked = false;" name="checkDealType" type="checkbox"/><label for="option_check_dealType4">'+Lang.Mail.ConfigJs.pref_autoresp+"</label></td>");d.push("   <td><div>");d.push('<textarea class="w346" cols="50" rows="7"  id="option_dealType4" type="text"></textarea>');
d.push(" </div></td>");d.push("       </tr>");d.push("     </table></div>");d.push("  </td></tr>");d.push("</table>");d.push('<div class="set-tips">');d.push(' <input type="checkbox"  class="checkbox-com" style="margin-left:10px;"  id="option_check_dealHistoryMail" onclick="javascript:if(this.checked){ $(\'option_check_dealType3\').checked = false;$(\'option_check_dealType4\').checked = false;}"/>'+Lang.Mail.ConfigJs.filter_HisMail);d.push("</div>");d.push('<div style="" class="btm_pager">');d.push('<a onclick="filter.save();return false;" href="javascript:fGoto();" class="n_btn_on mt_5 ml_10" ><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.save));
d.push('<a onclick="filter.showAdd(true);return false;" href="javascript:fGoto();" class="n_btn mt_5"><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.pref_cancel));d.push("</div>");d.push("</div>");d.push("</div>");return d.join("")}catch(h){return""}};
filter.getContent=function(a){var b=[];b.push(Lang.Mail.ConfigJs.filter_condtion_if+"\uff1a");for(var c=[a.from,a.to,a.subject,a.mailSize],d=[],e=0;e<c.length;e++)d[e]=c[e];c=d.escapeNull().length>1?Lang.Mail.ConfigJs.etc:"";a.fromType>0?(e=d[0],e.length>=30&&(e=e.substr(0,30)+"..."),b.push(Lang.Mail.ConfigJs.filter_sender+"{0}{1}".format(Lang.Mail.ConfigJs.filter_op_text_contains,'<em class="f-bolder" title="{0}">'.format(d[0])+e+c+"</em>"))):a.toType>0?(e=d[1],e.length>=30&&(e=e.substr(0,30)+"..."),
b.push(Lang.Mail.ConfigJs.filter_ToAddr+"{0}{1}".format(Lang.Mail.ConfigJs.filter_op_text_contains,'<em class="f-bolder" title="{0}">'.format(d[1])+e+c+"</em>"))):a.subjectType>0?(e=d[2].decodeHTML(),e.length>=30&&(e=e.substr(0,30)+"..."),e=e.encodeHTML(),b.push(Lang.Mail.ConfigJs.filter_Subject+"{0}{1}".format(Lang.Mail.ConfigJs.filter_op_text_contains,'<em class="f-bolder" title="{0}">'.format(d[2])+e+c+"</em>"))):a.mailSizeType>0&&b.push(Lang.Mail.ConfigJs.mailSize+"{0}{1}M".format(a.mailSizeType==
1?Lang.Mail.ConfigJs.GreaterOrEqual:Lang.Mail.ConfigJs.Lessthan,'<em class="f-bolder" title="{0}">'.format(a.mailSize)+a.mailSize+c+"</em>"));b.push(Lang.Mail.ConfigJs.filter_all_the_rules);var d=a.dealType,e=(c=MM.getFolderObject(d==5?a.attachLabel:a.moveToFolder))?c.name:"",f=d.split(","),c="";f.length>1&&(c="\u7b49",d=f[0]);switch(d){case "0":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.deleteMail)+Lang.Mail.ConfigJs.deleteMail+c+"</em>");break;case "1":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.filter_ac_reject)+
Lang.Mail.ConfigJs.filter_ac_reject+c+"</em>");break;case "2":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.filter_ac_move+":&nbsp;"+e)+Lang.Mail.ConfigJs.filter_ac_move+":&nbsp;"+e+c+"</em>");break;case "3":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.filter_autoForward+":&nbsp;"+a.forwardAddr)+Lang.Mail.ConfigJs.filter_autoForward+":&nbsp;"+a.forwardAddr+c+"</em>");break;case "4":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.filter_autoRe)+
Lang.Mail.ConfigJs.filter_autoRe+c+"</em>");break;case "5":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.filter_labe+":&nbsp; "+e)+Lang.Mail.ConfigJs.filter_labe+":&nbsp; "+e+c+"</em>");break;case "6":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.mark)+Lang.Mail.ConfigJs.mark+c+"</em>");break;case "7":b.push('<em class="f-bolder" title="{0}">'.format(Lang.Mail.ConfigJs.setHaveRead)+Lang.Mail.ConfigJs.setHaveRead+c+"</em>")}return b.join("")};
filter.getItem=function(a){var b=this.attrs.data[a],c=b.text||"";return(0,this.getFun[b.type])(a,b.attribute||{},b.items||c)};filter.getOneRadio=function(a){var b=this.attrs.data.dealType;return'<input type="radio" onclick="filter.hisMailSel('+a+')"  name="option_{0}" id="option_{1}" value="{2}" {3}/> {4}'.format("dealType","dealType"+a,a,(b.attribute.value||b.attribute.defaultValue)==a?' checked="true"':"",b.items[a])};
filter.getRuleRelation=function(a){var b=this.attrs.data.conditionsRelation;return'<input type="radio" name="option_{0}" id="option_{1}" value="{2}" {3}/ > {4}'.format("conditionsRelation","conditionsRelation"+a,a,(b.attribute.value||b.attribute.defaultValue)==a?' checked="true"':"",b.items[a])};
filter.save=function(){var a=this;if(a.dataList.length>=a.attrs.maxSize)CC.alert(Lang.Mail.ConfigJs.allow_add_count.format(a.attrs.maxSize));else{var b=a.attrs.save.func,c=$("option_filterId").value-0,d=$("option_filterSortId").value-0,e={};e.conditionsRelation=$("option_conditionsRelation1").checked?1:2;jQuery("#option_check_dealHistoryMail");e.dealHistoryMail=0;e.sortId=d;e.folderId=1;var f=0,g=$("option_from").value.trim(),f=$("option_to").value.trim(),h=$("option_subject").value.trim(),d=$("option_mailSize").value.trim(),
k=$("option_fromDomain").value.trim(),g=g=="\u4f8b\u5982\uff1a@qq.com;test@abc.com;"?"":g,k=k==Lang.Mail.ConfigJs.filter_InputDoMain?"":k,h=h==Lang.Mail.ConfigJs.filter_SubValue?"":h;if(h!=""&&$("option_check_subject").checked){h=h.replace(/\uff1b/g,";").split(";").unique();if(h.length<1)return CC.alert(Lang.Mail.ConfigJs.setFilter,function(){$("option_subject").focus();$("option_subject").value=""}),!1;e.subjectType=$("option_subject_all").checked?1:2;e.subject=h.join(";");e.subject=e.subject.replace(/\\/g,
"\\\\")}if(g!=""&&$("option_check_from").checked){var l=g.replace(/\uff1b/g,";").split(";").unique();jQuery.each(l,function(a,b){/^\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(b)&&(l[a]="*"+b)});if(l.length<1)return CC.alert(Lang.Mail.ConfigJs.setFilter,function(){$("option_from").focus();$("option_from").value=$("option_from").value}),!1;e.fromType=2;g=a.getEmailList(l,"from");if(g==!1)return!1;e.from=g.replace(/\*/g,"")}if(f!=""&&$("option_check_to").checked){var m=f.replace(/\uff1b/g,";").split(";").unique();
jQuery.each(m,function(a,b){/^\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(b)&&(m[a]="*"+b)});if(m.length<1)return CC.alert(Lang.Mail.ConfigJs.setFilter,function(){$("option_to").focus();$("option_to").value=$("option_to").value}),!1;e.toType=$("option_to_all").checked?1:2;g=a.getEmailList(m,"to");if(g==!1)return!1;e.to=g.replace(/\*/g,"")}if(k!=""&&$("option_check_fromDomain").checked)e.fromType=2,e.from+=";"+k;if(document.getElementById("option_check_mailSize").checked){f=this.attrs.dropMailType.getValue();
if(d=="0"||d==""||!/^\d+$/.test(d)){CC.alert(Lang.Mail.ConfigJs.maiSize_num);return}e.mailSize=d-0;e.mailSizeType=f}if(!e.from&&!e.to&&!e.subject&&!e.mailSize)CC.alert(Lang.Mail.ConfigJs.filter_WhereIsNull,function(){$("option_from").focus()});else{var d="",n=document.getElementById("option_dealType3"),f=function(){n.focus()};if(document.getElementById("option_check_dealType0").checked)d="0";else{if(document.getElementById("option_check_dealType2").checked)d+="2,",e.moveToFolder=this.attrs.dropFolder.getValue();
if(CC.isLabelMail()&&document.getElementById("option_check_dealType5")&&document.getElementById("option_check_dealType5").checked)d+="5,",e.attachLabel=this.attrs.dropLabel.getValue();if(document.getElementById("option_check_dealType3")&&document.getElementById("option_check_dealType3").checked){k=document.getElementById("option_dealType3").value.trim();if(k=="")return CC.alert(Lang.Mail.ConfigJs.filter_ForwardIsNull,f),!1;if(!Vd.checkData("email",k))return CC.alert(Lang.Mail.ConfigJs.Forward_VdEmail,
f),!1;if(a.checkUserNumber(k))return CC.alert(Lang.Mail.ConfigJs.filter_ForwardUserNotEqual,f),!1;if(!mailPOP.checkMail(k,"autoForward"))return gMain.forwardcorpConfigType=="1"?CC.alert("\u4ec5\u652f\u6301\u8f6c\u53d1\u5230 "+gMain.forwardcorpConfig,f):gMain.forwardcorpConfigType=="2"&&CC.alert("\u7981\u6b62\u8f6c\u53d1\u5230 "+gMain.forwardcorpConfig,f),!1;e.forwardAddr=k;d+="3,"}e.forwardBakup=$("option_check_dealType3_save")&&$("option_check_dealType3_save").checked?1:0;if(document.getElementById("option_check_dealType4").checked){f=
document.getElementById("option_dealType4").value.trim();if(f.replace(/^[ \t\n\r]+/g,"").replace(/[ \t\n\r]+$/g,"").trim()=="")return CC.alert(Lang.Mail.ConfigJs.InputReplayContent),!1;if(f.len()>gConst.autoRepaly_max)return CC.alert(Lang.Mail.ConfigJs.reply_length_limit),!1;e.replayContent=f;d+="4,"}}if(!d)return CC.alert(Lang.Mail.ConfigJs.filter_RuleIsNull),!1;e.opType="add";var o=Lang.Mail.ConfigJs.sign_btn_add;d.indexOf(",")!=-1&&(d=d.substr(0,d.length-1));e.dealType=d;c&&c!="0"?(e.opType="mod",
e.filterId=c,o=Lang.Mail.ConfigJs.sign_btn_update):e.sortId=a.dataList&&a.dataList.length>0?a.dataList[a.dataList.length-1].sortId+1:1;e.name="m123456";e.ignoreCase=1;MM.mailRequest({func:b,data:e,call:function(){CC.showMsg(Lang.Mail.ConfigJs.mailSortingSetSuc,!0,!1,"option");if($("option_check_dealHistoryMail").checked){if(e.dealType=="0")e.dealType="2",e.moveToFolder="4";if(e.dealType=="5")e.attachLabel=a.attrs.dropLabel.getValue(),e.moveToFolder=a.attrs.dropFolder.getValue();e.mailSize&&(e.mailSize*=
1024);MM.mailRequestApi({func:"user:filterHistoryMail",data:e,call:function(a){a=a["var"]||"0";a=="0"?CC.showMsg(Lang.Mail.ConfigJs.filter_NotSearchMail,!0,!1,"option"):CC.showMsg("{0}{1}".format(a,Lang.Mail.ConfigJs.filter_Success),!0,!1,"option")},fallCall:function(b){a.fail(Lang.Mail.ConfigJs.filter_Fail,b)},msg:Lang.Mail.ConfigJs.filter_Filtering})}a.init()},fallCall:function(b){a.fail(o+Lang.Mail.ConfigJs.filter_filterFail,b)}})}}};
filter.update=function(a,b){var c=this,d=c.dataList[a];typeof d=="object"&&c.initData(d,function(){c.showAdd("",b,d)})};
filter.getEmailList=function(a,b){for(var c={from:"option_from",to:"option_to"},d=[],e=function(){$(c[b]).focus();$(c[b]).value=$(c[b]).value},f=0;f<a.length;f++){var g=Email.getValue(a[f]);if(g)if(Vd.checkData("email",g))d.push(g);else return CC.alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740<br/>\u5982\uff1a@qq.com;test@abc.com",e),!1;else if(Vd.checkData("*@domain",a[f]))d.push(a[f]);else return CC.alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u4ef6\u5730\u5740<br/>\u5982\uff1a@qq.com;test@abc.com",
e),!1}return d.length>0?d.unique().join(";"):""};filter.del=function(a){var b=this;CC.confirm(Lang.Mail.ConfigJs.filter_delFilterContenNo,function(){var c={},d=b.attrs.save.func;c.opType="delete";c.filterId=a;b.ajaxRequest(d,c,function(){CC.showMsg(Lang.Mail.ConfigJs.mailSortingDelSuc,!0,!1,"option");b.init()},function(a){b.fail(Lang.Mail.ConfigJs.filter_delFilterFail+"\uff01",a)})})};filter.moveUp=function(a){var b=this.dataList[a],a=this.dataList[a-1],c=b.sortId;b.sortId=a.sortId;a.sortId=c};
filter.listSort=function(a,b){var c=this,d=0,d=this.dataList[a],e=this.dataList[b=="up"?a-1:a+1],f=d.sortId;d.sortId=e.sortId;e.sortId=f;d.opType="mod";e.opType="mod";d.to=d.to.decodeHTML();d.from=d.from.decodeHTML();d.subject=d.subject.decodeHTML();e.to=e.to.decodeHTML();e.from=e.from.decodeHTML();e.subject=e.subject.decodeHTML();d.name="m123456";e.name="m123456";e={func:c.attrs.save.func,"var":e};f=[];f.push({func:c.attrs.save.func,"var":d});f.push(e);MM.seqRequestCB(f,function(){c.init()})};
filter.checkUserNumber=function(a){for(var b=!1,c=0;c<aliasList.length;c++)if(aliasList[c].value==a){b=!0;break}return b};var folderPOP=new OptionBase;
folderPOP.attrs={id:"folderPOP",authority:"MAIL_CONFIG_FOLDERPOP",free:!0,divId:"pageFolderPOP",save:{type:"url",func:gConst.func.setAttrs},noReq:!0,tips:Lang.Mail.ConfigJs.folder_pop_custom_tip,data:{myFolderId:{text:"",type:"checkbox",attribute:{value:"",defaultValue:"",className:"",event:{onclick:"folderPOP.myFolder_OnClick"}},items:{0:Lang.Mail.ConfigJs.pref_my_mailfolder},format:"int"},folderId:{text:"",type:"checkbox",className:"",attribute:{value:"",defaultValue:"",className:"",before:"&nbsp;&nbsp;&nbsp;&nbsp;",
after:"<br><br>"},items:"",format:"int"}}};folderPOP.init=function(){this.attrs.data.folderId.items=CC.getFolders();this.request(this.attrs);this.initChecked()};folderPOP.getSecFolder=function(){for(var a=CC.getFolders(GE.folder.user),b={},c=0;c<a.length;c++)b[a[c].fid]=a[c].name;return b};
folderPOP.save=function(){for(var a=document.getElementsByName("option_folderId"),b=[],c=0;c<a.length;c++){var d=a[c],e=MM.getFolderObject(d.value);if(e)e.pop3Flag=d.checked?1:0,b.push(e)}a={item:[]};for(c=0;c<b.length;c++)e=b[c],a.item.push({func:gConst.func.updateFolder,"var":{fid:e.fid,type:4,parentId:e.parentId,name:e.name,folderPass:"",pop3Flag:e.pop3Flag}});a.item.push({func:gConst.func.listFolder,"var":{stats:0,type:0}});MM.mailRequest({func:gConst.func.seq,data:a,call:function(a){MM[gConst.folderMain].callback(a);
folderPOP.refresh();CC.alert(Lang.Mail.ConfigJs.updateFolderPOPSuc)},failCall:function(){CC.alert(Lang.Mail.ConfigJs.updateFolderPOPFailed)}})};folderPOP.refresh=function(){this.initChecked()};folderPOP.myFolder_OnClick=function(a){for(var a=this.getEl(a).checked,b=this.getElementsByName("folderId"),c=0;c<b.length;c++)b[c].checked=a};folderPOP.initChecked=function(){for(var a=CC.getFolders(GE.folder.user),b=0;b<a.length;b++){var c=a[b];this.getEl("folderId"+c.fid).checked=c.pop3Flag==1?!0:!1}};
var folderPass=new OptionBase;
folderPass.attrs={id:"",divid:"",list:{type:"xml",func:"mbox:getAllFolders"},savePass:{type:"xml",func:"mbox: setFolderPass"},saveFolders:{type:"xml",func:"mbox: updateFolderPass"},data:{folderPassFlag:{text:Lang.Mail.ConfigJs.folderPwd,type:"radio",className:"",attribute:{value:"",defaultValue:"",className:""},items:{1:Lang.Mail.ConfigJs.open,0:Lang.Mail.ConfigJs.set_sessionMode_off},format:"int"},folderPass:{text:Lang.Mail.ConfigJs.folderPwd,type:"text",className:"",attribute:{value:"",defaultValue:"",
className:""},format:"string",again:2},setFolderPass:{text:Lang.Mail.ConfigJs.setedFolderPwd,type:"custom",className:"",attribute:{value:'<span>********</span><a href="forgetsecretfolderpwd.aspx">'+Lang.Mail.ConfigJs.forgetPwd+"</a>"},noset:!0},folders:{text:Lang.Mail.ConfigJs.PleaseChoiseProtectRange,type:"checkbox",className:"",attribute:{value:"",defaultValue:"",className:""},items:{},format:"string"}}};folderPass.getHtml=function(){};folderPass.init=function(){};folderPass.checkData=function(){};
folderPass.Save=function(){};
(function(a,b,c){var a=c.gMain||{},d=a.webPath+(a.imgCodeUrl||"/common/validatecode.do");b.fn.captcha=function(a){var c=b.extend(b.fn.captcha.defaultSettings,a||{});return this.each(function(){function a(){var b=d+"?r="+(new Date).getTime();k.attr("src",b);l.focus().val("")}var e=b(this),k=b(c.img,e),l=b(c.input,e),m=b(c.changeBtn,e);k.click(function(){a(k)});m.click(function(){a(k);return!1});l.focus(function(){b(this).select()});e.on("refresh",function(){a(k)});e.trigger("refresh")})};b.fn.captcha.defaultSettings=
{input:".captcha_input",img:".captcha_img",changeBtn:".captcha_changeBtn"}})(window,jQuery,top);var folderlock=new OptionBase;folderlock.attrs={id:"folderlock",authority:"MAIL_CONFIG_LOCK",divId:"pageFolderlock",noReq:!0};folderlock.init=function(){this.request(this.attrs)};
folderlock.getHtml=function(){var a=[],b=this.getAddHtml();a.push('<div class="bodySet" style=\'align:text;\' id="pageUserAlias">');a.push('<div id="container">');a.push(this.getTopHtml());a.push(this.getLeftHtml());a.push("<div class=\"setWrapper\" id='setWrapp'>");a.push(b);a.push("</div>");a.push("</div>");a.push("</div>");MM[gConst.setting].update(this.attrs.id,a.join(""));pref.updatePosition("setWrapp");this.correctWidthInIE6("setWrapp",1);this.initEvent()};
folderlock.initEvent=function(a){var b=this;jQuery("#newPassword");jQuery("#confirmPassword");var c=jQuery("#oldPassword"),d=jQuery("#newPassword"),e=jQuery("#confirmPassword");new parent.ToolTips({id:"",win:window,left:428,top:-50,direction:parent.ToolTips.direction.Right});var f=new parent.ToolTips({id:"",win:window,left:155,top:-82,direction:parent.ToolTips.direction.Up});b.show_CapsLock_tip(f,d[0]);b.show_CapsLock_tip(f,e[0]);a&&b.show_CapsLock_tip(f,c[0]);b.vdpwd=new VdPassWord({pwdId:"newPassword",
wrapClassName:"pl155",pwdMinLen:6,pwdMaxLen:30});d[0].onblur=function(){b.showErrTip()};jQuery("#confirmPassword").keyup(function(a){if(EV.getCharCode(a)==13)return b.save(),a.stopPropagation(),!1});a?(jQuery("#li_lockRange").hide(),c.focus()):(d.focus(),this.showFoldersHtml())};
folderlock.show_CapsLock_tip=function(a,b){b.onkeypress=function(b){var d=b||window.event,b=d.target||d.srcElement,e=d.keyCode||d.which,d=d.shiftKey||e==16||!1;e>=65&&e<=90&&!d||e>=97&&e<=122&&d?(a.close(),a.show(b,Lang.Mail.ConfigJs.capsLocked)):a.close()}};
folderlock.checkAll=function(){jQuery("#range h2 input:checkbox").click(function(){var a=jQuery(this).attr("checked")=="checked"?!0:!1;jQuery(this).parent().parent().parent().next().find("input:checkbox").each(function(){jQuery(this).attr("checked",a)})})};
folderlock.showFoldersHtml=function(){var a=this;this.ajaxRequest("mbox:getAllFolders",{type:3},function(b){for(var c="",d=!1,e=[],f=c=0,g=b.length,h=CM.folderMain[gConst.dataName];c<g;c++){b[c].folderPassFlag===1&&(e.push(parseInt(b[c].fid)),d=!0);for(f=0;f<h.length;f++)if(h[f].type===6&&b[c].name===h[f].name)b[c].type=6}c=a.getAllLockListHtml(b);d?(jQuery("#range").html(c),a.initModifyEvent(e)):(b=a.getAllListHtml(),jQuery("#range").html(b));a.checkAll()},function(){})};
folderlock.getAllLockListHtml=function(a){var b=[];b.push(this.getLockListHtml(Lang.Mail.ConfigJs.wowjj,a,3));CC.checkConfig("mailPOP")&&b.push(this.getLockListHtml(Lang.Mail.ConfigJs.popMailFolder,a,6));return b.join("")};
folderlock.getLockListHtml=function(a,b,c){var d=!0,e=[],f=!0,b=this.sortFolders(b,c);e.push('<div class="jsBox" style="margin: 0 0 15px 0;">');e.push('<h2><p class="ml_15 allclick"><label for="forall">'+a+"</label></p></h2>");e.push("<div class=\"jsBox-body\" id='div_wrap' style='padding-bottom:0'>");for(a=0;a<b.length;a++)b[a].folderPassFlag===1&&(f&&(b[a].parentId===0&&d?(e.push('<div class="jsBox-cbox">'),e.push('<ul class="jsBox-cbox-ul m_clearfix">'),d=!1):b[a].parentId===0&&(e.push("</ul></div>"),
e.push('<div class="jsBox-cbox">'),e.push('<ul class="jsBox-cbox-ul m_clearfix">'))),f=!0,e.push('<li style="overflow: hidden;">'),e.push("<label for="+b[a].fid+">"+b[a].name+"</label></li>"));b.length!==0&&e.push("</ul></div>");e.push("</div></div>");return e.join("")};folderlock.sortFolders=function(a,b){function c(f){for(var g=0;g<d;g++)a[g].type==b&&a[g].parentId==f&&(e.push(a[g]),c(a[g].fid))}var d=a.length,e=[];c(0);return e};
folderlock.getAllListHtml=function(){var a=[];a.push(this.getListHtml(Lang.Mail.ConfigJs.wowjj,3));CC.checkConfig("mailPOP")&&a.push(this.getListHtml(Lang.Mail.ConfigJs.popMailFolder,6));return a.join("")};
folderlock.getListHtml=function(a,b){var c=CM.folderMain[gConst.dataName],d=!0,e=[],f,c=this.sortFolders(c,b);e.push('<div class="jsBox" style="margin: 0 0 15px 0;">');e.push('<h2><p class="ml_15 allclick"><label ><input class="checkbox-com" type="checkbox" class="mr_10 ml_15"/>'+a+"</label></p></h2>");e.push("<div class=\"jsBox-body\" id='div_wrap' style='padding-bottom:0'>");for(f=0;f<c.length;f++)c[f].parentId===0&&d?(e.push('<div class="jsBox-cbox">'),e.push('<ul class="jsBox-cbox-ul m_clearfix">'),
d=!1):c[f].parentId===0&&(e.push("</ul></div>"),e.push('<div class="jsBox-cbox">'),e.push('<ul class="jsBox-cbox-ul m_clearfix">')),e.push('<li style="overflow: hidden;"><label for='+c[f].fid+"><input id="+c[f].fid+' type="checkbox" />'),e.push('<span class="tf" style="display: inline-block;vertical-align:top;width: 170px;">'+c[f].name.encodeHTML()+"</span></label></li>");c.length!==0&&e.push("</ul></div>");e.push("</div></div>");return e.join("")};
folderlock.initModifyEvent=function(a){var b=this;jQuery("#confirmPassword").val("1234567890").attr("disabled","disabled");jQuery("#li_setPass, #li_security,#newSec").hide();jQuery("#span_confirmPassword").text(Lang.Mail.ConfigJs.securityLockPwd+"\uff1a");jQuery("#confirmPassword").val();jQuery("#span_lockRange").text(Lang.Mail.ConfigJs.lockedRange+"\uff1a");jQuery("#li_confirmPassword").append("<li style='padding-left:156px; padding-top:10px' class=\"pl113 pb_15\">[<a href='javascript:void(0);' id='modifyPassword'>"+
Lang.Mail.ConfigJs.updatePwd+"</a>]</li>");jQuery("#li_lockRange").after("<li style='padding-left:156px; padding-top:10px; clear: both;' class=\"pl113 pb_15\">[<a href='javascript:void(0);' id='modifyLockRange'>"+Lang.Mail.ConfigJs.updateLockRange+"</a>]</li>");jQuery("#btn_cancel").after('<a class="n_btn_on mt_5 ml_10" id="closeLock" href=\'javascript:void(0);\'><span><span>'+Lang.Mail.ConfigJs.closeSecurityLock+"</span></span></a>");jQuery("#modifyPassword").click(function(){b.initModPass()});jQuery("#modifyLockRange").click(function(){var c=
b.lock_pass;c==null||c==""?b.unlocked(a):b.modifyLockRange(a,{pass:c,unlocked:!0})});jQuery("#closeLock").click(function(){b.closeLock()})};folderlock.setCookie=function(a,b,c){var d=new Date;d.setTime(d.getTime()+c*864E5);document.cookie=c==""||c==null?a+"="+escape(b):a+"="+escape(b)+";expires="+d.toGMTString()};folderlock.getCookie=function(a){a=document.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)"));return a!=null?unescape(a[2]):null};
folderlock.closeLock=function(){var a=this,b="<div style='padding:30px'>";b+="<label>"+Lang.Mail.ConfigJs.securityLockPwd+"\uff1a</label><input type='password' class='set-txt-b w235' maxlength='30' id='txt_pwd'/>";b+="</div>";var c=Lang.Mail.ConfigJs.closeSecurityLock,d="",e=null,f=!0,g=new parent.ToolTips({id:"",win:window,left:108,top:97,direction:parent.ToolTips.direction.Bottom}),h=function(){f=!0;e=jQuery("#txt_pwd");d=e.val();d.trim()==""&&(g.close(),g.show(e[0],Lang.Mail.ConfigJs.secPwdCanntEmpty),
f=!1);f&&a.ajaxRequest("mbox:setFolderPass",{oldPass:d,type:3},function(){CC.showMsg(Lang.Mail.ConfigJs.secPwdClosed,!0,!1,"option");LM.getAllFolders();jQuery("#divDialogCloseconfirmbtn_1")[0].click();a.attrs.op="";a.init()},function(){g.close();g.show(e[0],Lang.Mail.ConfigJs.secPwdWrong)});return!0};CC.showDiv(b,h,c,"","");jQuery("#txt_pwd").focus();jQuery("#txt_pwd").keydown(function(a){if(EV.getCharCode()==13)return h(),a.stopPropagation(),!1})};
folderlock.getRangeHtml=function(){var a=[],b=this.getAllListHtml();a.push("<div>");a.push("<h2 class=\"set_til\" id='h2_setPass'>");a.push('<label id="addMod"> '+Lang.Mail.ConfigJs.modLockedRange+"</label>");a.push('<a id="back" class="fn bord-spa" href="javascript:void(0);">  \u2039\u2039'+Lang.Mail.ConfigJs.sign_btn_return+"</a>");a.push("</h2>");a.push("<div style='padding:45px 0 45px 0px'>");a.push('<table width="100%"><tr>');a.push('<td  style="width: 155px;vertical-align: top; text-align: right;"><span class="left" style=\'padding-right:10px;display:inline-block\'>'+
Lang.Mail.ConfigJs.choiseLockRange+"\uff1a </span>");a.push("<td><div id='range' style='border: 1px solid #ffffff;'>",b,"</div></td>");a.push("</div>");a.push("</tr></table>");a.push("<div class=\"btm_pager fl\" style='width:100%'>");a.push("<a id='btn_save' class=\"n_btn_on mt_5 ml_10\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");a.push("<a id='btn_cancel' class=\"n_btn mt_5\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");
return a.join("")};
folderlock.modifyLockRange=function(a,b){var c=this,d=a.length,e="",f=[];if(b.unlocked){jQuery("#divDialogCloseconfirmbtn_1")[0]&&jQuery("#divDialogCloseconfirmbtn_1")[0].click();e=c.getRangeHtml();jQuery("#setWrapp").html(e);for(e=0;e<d;e++)a[e]!="myFolder"&&jQuery("#"+a[e]).attr("checked",!0);c.checkAll();jQuery("#back,#btn_cancel").click(function(){c.init()});jQuery("#btn_save").click(function(){var a={type:1};a.ids=f;if(b&&b.pass)c.lock_pass=b.pass,a.newPass=b.pass;jQuery("#range > .jsBox > .jsBox-body input:checkbox:checked").each(function(){var a=jQuery(this).attr("id");
f.push(parseInt(a))});f.length==0?CC.alert(Lang.Mail.ConfigJs.pleaseChoiseLockRange):c.ajaxRequest("mbox:setFolderPass",{type:3,oldPass:b.pass},function(){c.ajaxRequest("mbox:setFolderPass",a,function(){CC.showMsg(Lang.Mail.ConfigJs.modSecLockSuc,!0,!1,"option");c.init();gMain.lock_close=!0;LM.getAllFolders()},function(){CC.alert(Lang.Mail.ConfigJs.modSecLockFail)})},function(){CC.alert(Lang.Mail.ConfigJs.modSecLockFail)})})}};
folderlock.unlocked=function(a,b){var c=this,d=Lang.Mail.ConfigJs.secLockPwdVd,e="<p style='padding:20px 0 10px 30px'> "+Lang.Mail.ConfigJs.rangeLockedTip+"</p>";e+="<p style='padding:10px 0 30px 30px; position:relative;' >"+Lang.Mail.ConfigJs.securityLockPwd+"\uff1a<input type='password' class='set-txt-b w235' maxlength = '30' id='txt_passValidate'/></p>";var f="",g={},h={},k=null,l=new parent.ToolTips({id:"",win:window,left:108,top:41,direction:parent.ToolTips.direction.Bottom}),m=function(){var d=
!0,e=e;f=k.val();var m=function(){CC.showMsg(Lang.Mail.ConfigJs.secUnlockedSuc,!0,!1,"option");gMain.lock_close=!1;folderlock.lock_pass=f;gMain.openFolderLock=!0;switch(b){case "attach":gMain.lock_close=!1;CC.goAttachList();break;case "leftLock":gMain.lock_close=!1;break;case "unRead":gMain.lock_close=!1;CC.receiveMail();break;case "search":gMain.lock_close=!1;jQuery.isEmptyObject(GE.searchFlag)?CC.searchMailByTop(jQuery("#txtAdvSearch")[0]):CC.receiveMail(GE.searchFlag);break;case "myfolder_name":gMain.lock_close=
!1;CC.goFolder(a,e);break;case "myfolder_op":gMain.lock_close=!1;break;default:return h.unlocked=!0,h.pass=f,c.modifyLockRange(a,h),LM.getAllFolders(),!1}LM.getAllFolders();jQuery("#divDialogCloseconfirmbtn_1")[0]&&jQuery("#divDialogCloseconfirmbtn_1")[0].click()},q=function(){l.show(k[0],Lang.Mail.ConfigJs.secLockPwdWrong);h.unlocked=!1};f.trim()==""&&(l.close(),l.show(k[0],Lang.Mail.ConfigJs.secPwdCanntEmpty),d=!1);g.folderPass=f;g.start=1;g.total=20;g.sessionEnable=1;if(a[0])g.fid=a[0];if(e&&e.id)g.fid=
e.id;if(gMain.first_locked_id)g.fid=gMain.first_locked_id;d&&c.ajaxRequest("mbox:listMessages",g,m,q);return!0};parent.CC.showDiv(e,m,d,"","",380);k=jQuery("#txt_passValidate");k.focus();jQuery("#txt_passValidate").keydown(function(a){if(EV.getCharCode(a)==13)return m(),a.stopPropagation(),!1})};
folderlock.initModPass=function(){var a=this,b=a.modifyLockHtml(),c=[];a.attrs.op="modifyLock";c.push("<li style='position:relative'><span class=\"left\">"+Lang.Mail.ConfigJs.pop_oldPwsd+"\uff1a</span>");c.push("<input type=\"password\" maxlength='30' class=\"set-txt-b w260\" id='oldPassword'/>");c.push(a.getFalseTip("oldTip","oldTip1",Lang.Mail.ConfigJs.currentPwd));c.push('<li id="newSec" class="pl155 pb_15"><span class="setCode-name-tips">'+Lang.Mail.ConfigJs.contactAdminIfForgetPwd+"</span></li>");
c.push('</li><li class="pl113 pb_15"></li>');c.push('<li class="pl113 pb_15"></li>');jQuery("#setWrapp").html(b);jQuery("#li_setPass").before(c.join(""));jQuery("#span_setPass").text(Lang.Mail.ConfigJs.setNewPopPwd+"\uff1a");jQuery("#span_confirmPassword").text(Lang.Mail.ConfigJs.comfirm_popNewPwd+"\uff1a");jQuery("#h2_setPass").html('<label id="addMod"> '+Lang.Mail.ConfigJs.modSecLock_pwd+'</label><a id="back" class="fn bord-spa" href="javascript:void(0);">  \u2039\u2039'+Lang.Mail.ConfigJs.pop_return+
"</a>");a.initEvent(!0);jQuery("#oldPassword").focus();jQuery("#confirmPassword").keydown(function(b){if(EV.getCharCode(b)==13)return a.save(),b.stopPropagation(),!1});jQuery("#back,#btn_cancel").click(function(){a.init()})};
folderlock.modifyLockHtml=function(){var a=[];a.push("<div>");a.push("<h2 class=\"set_til\" id='h2_setPass'> "+Lang.Mail.ConfigJs.setSecLock+"<span>");a.push("( "+Lang.Mail.ConfigJs.moreSafeInLock+" )</span></h2>");a.push("<div class=\"codeSet-wrap\" id='codeSet' style='padding-top:30px'>");a.push('<ul class="setCode-name">');a.push("<li style='position:relative' id='li_setPass'><span class=\"left\" id='span_setPass'>"+Lang.Mail.ConfigJs.setSecPwdInLock+"\uff1a</span>");a.push("<input type=\"password\" class=\"set-txt-b w260\" maxlength='30' id='newPassword'/>");
a.push(this.getFalseTip("newTip","newTip1",Lang.Mail.ConfigJs.correctPassword));a.push('</li><li class="pl155 pb_15" id=\'newSec\'><span class="setCode-name-tips">6-30'+Lang.Mail.ConfigJs.notSpecialInLock+"</span></li>");a.push('<li class="pl113 pb_15"></li>');a.push("<li  style='position:relative' id='li_confirmPassword'><span id='span_confirmPassword' class=\"left\">"+Lang.Mail.ConfigJs.confirmPwdInLock+"\uff1a</span>");a.push("<input type=\"password\" maxlength='30' class=\"set-txt-b w260\" id='confirmPassword'/>");
a.push(password.getFalseTip("confirmTip","confirmTip1",Lang.Mail.ConfigJs.correctPassword));a.push("</li>");a.push('<li class="pl113 pb_15" ></li><li class="pl113 pb_15" ></li>');a.push("<li id='li_lockRange'>");a.push('<table width="100%"><tr>');a.push('<td style="width: 155px;vertical-align: top;"><span id=\'span_lockRange\' class="left">'+Lang.Mail.ConfigJs.LockedRange+"\uff1a</span></td>");a.push("<td><div id='range' style='border: 1px solid #ffffff;margin-top: 0px;'></div></td>");a.push("</tr></table>");
a.push("</li></ul>");a.push("</div><\!--codeSet-wrap--\>");a.push("<div class=\"btm_pager fl\" style='width:100%'>");a.push("<a onclick='folderlock.save()' href='javascript:void(0);' class=\"n_btn_on mt_5 ml_10\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");a.push("<a id='btn_cancel'  href='javascript:void(0);' class=\"n_btn mt_5\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");a.push("</div>");return a.join("")};
folderlock.setSecPWD=function(){this.ajaxRequest("mbox: setFolderPass",{type:1,newPass:"",ids:[]},cb,fcb)};
folderlock.getAddHtml=function(){var a=[];a.push("<div>");a.push('<h2 class="set_til"> '+Lang.Mail.ConfigJs.setSecLock+"<span>");a.push("( "+Lang.Mail.ConfigJs.moreSafeInLock+" )</span></h2>");a.push("<div class=\"codeSet-wrap\" id='codeSet' style='padding-top:30px'>");a.push('<ul class="setCode-name">');a.push("<li style='position:relative' id='li_setPass'><span class=\"left\" id='span_setPass'>"+Lang.Mail.ConfigJs.setSecPwdInLock+"\uff1a</span>");a.push("<input type=\"password\"  maxlength='30' class=\"set-txt-b w260\" id='newPassword'/>");
a.push(this.getFalseTip("newTip","newTip1",Lang.Mail.ConfigJs.correctPassword));a.push("</li><li class=\"pl155 pb_15\" id='newSec'>");a.push('<span class="setCode-name-tips">6-30'+Lang.Mail.ConfigJs.notSpecialInLock+"</span></li>");a.push('<li class="pl113 pb_15"></li>');a.push("<li  style='position:relative' id='li_confirmPassword'><span id='span_confirmPassword' class=\"left\">"+Lang.Mail.ConfigJs.confirmPwdInLock+"\uff1a</span>");a.push("<input type=\"password\"  maxlength='30' class=\"set-txt-b w260\" id='confirmPassword'/>");
a.push(password.getFalseTip("confirmTip","confirmTip1",Lang.Mail.ConfigJs.correctPassword));a.push("</li>");a.push('<li class="pl113 pb_15" ></li><li class="pl113 pb_15" ></li>');a.push("<li id='li_lockRange'>");a.push('<table width="100%"><tr>');a.push('<td style="width: 155px;vertical-align: top;"><span id=\'span_lockRange\' class="left">'+Lang.Mail.ConfigJs.LockedRange+"\uff1a</span></td>");a.push("<td><div id='range' style='border: 1px solid #ffffff;margin-top: 0px;'></div></td>");a.push("</tr></table>");
a.push("</li></ul>");a.push("</div><\!--codeSet-wrap--\>");a.push("<div class=\"btm_pager fl\" style='width:100%'>");a.push("<a onclick='folderlock.save(); return false;' href='javascript:void(0);' class=\"n_btn_on mt_5 ml_10\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");a.push("<a id='btn_cancel' class=\"n_btn mt_5\" onclick='folderlock.goBack()'><span>");a.push("<span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");a.push("</div>");return a.join("")};
folderlock.save=function(){var a=jQuery("#oldPassword").val(),b=jQuery("#newPassword").val(),c=jQuery("#confirmPassword").val();jQuery("#oldTip,#newTip,#confirmTip").hide();jQuery("#security,#security1").hide();var d=!0,e="";a&&(e=a);var f=[],a=this.attrs.op=="modifyLock"?1:0;this.vdpwd.NotifyCode!=0?(d=!1,jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(this.vdpwd.msg)):e==""&&a?(d=!1,jQuery("#oldfolderlock").focus(),jQuery("#oldTip").css("display",
"inline"),jQuery("#oldTip1").html(Lang.Mail.ConfigJs.currentPwd)):b==""?(d=!1,jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(Lang.Mail.ConfigJs.inputNewPwd)):c==""?(d=!1,jQuery("#confirmfolderlock").val("").focus(),jQuery("#confirmTip").css("display","inline"),jQuery("#confirmTip1").html(Lang.Mail.ConfigJs.inputConfirmPwd)):b!=c?(d=!1,jQuery("#confirmfolderlock").focus(),jQuery("#confirmTip").css("display","inline"),jQuery("#confirmTip1").html(Lang.Mail.ConfigJs.towPwdMatch)):
a?(b={type:2,oldPass:e,newPass:b},d&&this.setOrModRequest("mbox:setFolderPass",b,!0)):(jQuery("#range > .jsBox > .jsBox-body input:checkbox:checked").each(function(){var a=parseInt(jQuery(this).attr("id"));isNaN(a)||f.push(a)}),f.length==0?CC.alert(Lang.Mail.ConfigJs.pleaseChoiseLockRange):(b={type:1,newPass:b,ids:f},d&&this.setOrModRequest("mbox:setFolderPass",b)))};
folderlock.setOrModRequest=function(a,b,c){var d=this;this.ajaxRequest(a,b,function(){var a=Lang.Mail.ConfigJs.secLockPwdSuc;if(c)a=Lang.Mail.ConfigJs.secLockPwdModSuc;CC.showMsg(a,!0,!1,"option");d.init();gMain.lock_close=!0;LM.getAllFolders()},function(a){if(c){var b="";a.code=="VALUE_NOT_NULL"?(b=Lang.Mail.ConfigJs.pwdNotNull,jQuery("#oldPassword").focus(),jQuery("#oldTip").css("display","inline"),jQuery("#oldTip1").html(b)):a.code=="WEAK_PWD"?(b=Lang.Mail.ConfigJs.weakPwd,jQuery("#oldPassword").focus(),
jQuery("#oldTip").css("display","inline"),jQuery("#oldTip1").html(b)):a.code!="UNKNOW_EXCEPTION"?(b=Lang.Mail.ConfigJs.lockPwdInCorrect,jQuery("#oldPassword").focus(),jQuery("#oldTip").css("display","inline"),jQuery("#oldTip1").html(b)):(jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(Lang.Mail.ConfigJs.ModifyPwdErr))}else jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(Lang.Mail.ConfigJs.setSucLockFail)},
gMain.webPath+"/service/mail/conf.do?func=mail:SetFolderPass&sid="+gMain.sid)};folderlock.showErrTip=function(a){jQuery("#newPassword").val();var b=this.vdpwd.NotifyCode,c=this.vdpwd.msg;jQuery("#newTip").hide();if(c.trim()!=""&&b!=0&&(b!=1||a))jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(c)};var mailPOP=new OptionBase;mailPOP.getUrl=function(a){return gConst.apiPostPath+"?func={0}&sid={1}".format(a,gMain.sid)};
mailPOP.attrs={id:"mailPOP",authority:"MAIL_MANAGER_MAILPOP",divId:"pageCreateFilter",tableClass:"",ajaxType:2,dropselect:null,failCounts:0,list:{type:"url",func:gConst.func.getPOP,data:{}},save:{func:gConst.func.setPOP},data:{id:{display:!1,type:"int",attribute:{value:0,defaultValue:0}},username:{text:Lang.Mail.ConfigJs.pop_mailaddress,type:"text",className:"",attribute:{value:"",defaultValue:"",className:"",maxLength:255,ext:' onchange="mailPOP.autoSetPOPServer(this);"'},format:"string",check:{type:"email",
tips:Lang.Mail.ConfigJs.pop_failed_email}},password:{text:Lang.Mail.ConfigJs.pop_password,type:"password",className:"",attribute:{value:"",defaultValue:"",className:""},format:"string",check:{type:"empty"}},fid:{text:Lang.Mail.ConfigJs.pop_folder,type:"select",className:"",attribute:{value:"1",defaultValue:"1",className:""},format:"int",items:{}},server:{text:Lang.Mail.ConfigJs.pop_servername,type:"text",className:"",attribute:{value:"",defaultValue:"",className:""},format:"string",check:{type:"domain",
tips:Lang.Mail.ConfigJs.mailpop_rlPop}},port:{id:"port",text:Lang.Mail.ConfigJs.pop_port,type:"text",className:"",attribute:{value:"",defaultValue:110,className:"",maxLength:5},format:"int",ext:' id="option_mailPOP_portId" style="display:none"',check:{type:"port",tips:Lang.Mail.ConfigJs.mailpop_porterr}},timeout:{id:"timeout",text:Lang.Mail.ConfigJs.pop_timeout,type:"text",className:"",attribute:{value:"",defaultValue:90,className:"",maxLength:4},format:"string",ext:' id="option_mailPOP_timeoutId" style="display:none"',
check:{type:"reg",tips:Lang.Mail.ConfigJs.pop_serverat_end,reg:/[0-9]{1,4}/}},leaveOnServer:{text:Lang.Mail.ConfigJs.pop_checkOptions,type:"checkbox",className:"",attribute:{value:"",defaultValue:"1",className:""},items:{1:Lang.Mail.ConfigJs.pop_holddesc},format:"int"},showDetial:{text:"<a href=\"javascript:fGoto();\" onclick=\"mailPOP.showDetail(this,'portId','timeoutId');\"><span >"+Lang.Mail.ConfigJs.pop_showSeniorOpt+'&gt;&gt;</span><span style="display:none">&lt;&lt;'+Lang.Mail.ConfigJs.pop_hideSeniorOpt+
"</span></a>",type:"label"}},buttons:[{text:Lang.Mail.Ok,clickEvent:"mailPOP.add"},{text:Lang.Mail.Cancel,clickEvent:"mailPOP.returnList"}]};mailPOP.dataList=[];mailPOP.init=function(a,b){b?mailPOP.initDom():(this.attrs.url=this.getUrl(gConst.func.getPOP),this.attrs.data.fid.items=CC.getFolders(),this.request(this.attrs,mailPOP.getHtml,null,!0))};
mailPOP.initDom=function(){var a=[],b=this.attrs.id;a.push('<div class="bodySet" id="pageSetReceiveOther">');a.push('<div id="container">');a.push(this.getTopHtml());a.push(this.getLeftHtml());a.push("<div class=\"setWrapper\" id='pmailPOPWrapper'>");a.push("</div>");MM[gConst.setting].update(b,a.join(""))};mailPOP.initAuto=function(){this.attrs.url=this.getUrl(gConst.func.getPOP);(this.attrs.free||GC.check(this.attrs.authority))&&this.request(this.attrs,mailPOP.autoSync,null,!0)};
mailPOP.autoSync=function(a,b){var c;if(typeof b!=="undefined"&&b!==null&&Object.prototype.toString.call(b)==="[object Array]"&&b.length>0){mailPOP.dataList=b;for(c=b.length;c--;)+b[c].isAutoPOP===1&&mailPOP.syncPOP(b[c].id,!1,!1,void 0,!0)}};
mailPOP.getHtml=function(a,b){var c=[];mailPOP.dataList=b;var d=this,e=this.attrs.id;c.push('<div class="bodySet" id="pageSetReceiveOther">');c.push('<div id="container">');LM.loadFolderMain();d.modPOPList(b);var f=function(){var a=[];a.push("<div class=\"setWrapper\" id='pmailPOPWrapper'>");a.push('<div id="rm_main">');a.push('<div class="write_adr_wrap">');a.push("<a class=\"n_btn_on font-bold\" onclick='mailPOP.showAdd(0)'><span>");a.push("<span>"+Lang.Mail.ConfigJs.addPOPmailbox+"</span></span></a>");
a.push("</div>");a.push('<div class="set_rule_box">');a.push("<h3>"+Lang.Mail.ConfigJs.POPmailbox+"&nbsp;&nbsp; ");a.push('<a href="javascript:void(0);" onclick="mailPOP.syncPOP(0,\'isAll\');mailPOP.init();">'+Lang.Mail.ConfigJs.pop_syncAll+"</a>");a.push('&nbsp;&nbsp;<a href="javascript:;" onclick="CC.goLogLink(\''+Lang.Mail.ConfigJs.LogQuery+"', 'agent');\">"+Lang.Mail.ConfigJs.viewColltectionRecord+"</a>");a.push("</h3>");a.push("<h4>"+parent.corpMailCollINMsg+"</h4>");var c="",c=b.length>0?d.getList(b,
"option_mailPOP_",e):d.noList();a.push(c);a.push("</div><\!--set_rule_box--\>");a.push("</div></div><\!--set_content--\>");return a.join("")}();c.push(this.getTopHtml());c.push(this.getLeftHtml());c.push(f);MM[gConst.setting].update(e,c.join(""));this.updatePosition("pmailPOPWrapper");d.correctWidthInIE6("pmailPOPWrapper",1);jQuery("#addNow").bind("click",function(){d.showAdd(0)});jQuery(".set_rule_box > table").on("mouseenter",".editControls",function(){jQuery(this).find("input").length<1&&jQuery(this).addClass("hoverFakeIpt")});
jQuery(".set_rule_box > table").on("mouseleave",".editControls",function(){jQuery(this).removeClass("hoverFakeIpt")});jQuery(".set_rule_box > table").on("dblclick",".editControls",function(){var a=jQuery(this).html().encodeHTML();jQuery(this).removeClass("hoverFakeIpt");if(jQuery(this).find("input").length>0)return!1;jQuery(this).html("<input maxlength='32' style='height: 18px; line-height: 18px; width: 180px;' oldVal = \""+a+'" class="inputImmediateEdit" type="text" value="'+a+'" >');jQuery(this).find("input").eq(0)[0].focus()}).on("blur",
"input.inputImmediateEdit",function(){for(var a=jQuery(this),b=a.val().trimAll(),c=a.attr("oldVal"),d=a.parent().parent().parent().find("td").eq(0).html(),e=!0,f=CM.folderMain[gConst.dataName],o=f.length;o--;)if(f[o].popMailId===+a.parent().attr("popid")&&f[o].folderPassFlag===1){CC.showMsg(Lang.Mail.ConfigJs.folderEncrypted,!0,!1,"error");e=!1;break}if(e&&(b===c||b.length===0))e=!1;e&&b!==c&&mailPOP.checkFolderName(c,b)&&(CC.showMsg(Lang.Mail.ConfigJs.folderNameNotWithOther,!0,!1,"error"),e=!1);
e?mailPOP.ImmediateMod(d,b,a.parent(),c):a.parent().html(c)}).on("keypress","input.inputImmediateEdit",function(a){a.keyCode===13&&jQuery(this)[0].blur()})};mailPOP.getAllFolders=function(a,b){var c=[],d=a.length;if(d>0)for(var e=0;e<d;e++)c=[],c.push(a[e].name),c.push(a[e].fid),b.push(c),a[e].nodes.length>0&&this.getAllFolders(a[e].nodes,b)};
mailPOP.getDropSelect=function(a){var b=[];CC.getFolders();for(var c=CM.folderMain[gConst.dataName],d=this.getFolders([GE.folder.sys,GE.folder.user]),e=0;e<c.length;e++)c[e].fid!=6&&c[e].fid!=10&&b.push({text:c[e].name,value:c[e].fid});this.attrs.dropselect=new DropSelect({id:"input_contact_drop_select",data:d,type:"fileTree",selectedValue:"-1",width:289,height:200});jQuery("#"+a).append(this.attrs.dropselect.getHTML());this.attrs.dropselect.loadEvent()};
mailPOP.noList=function(){var a=[];a.push('<p class="set_rule_box_tips">'+Lang.Mail.ConfigJs.notPOPmailbox+"\uff0c&nbsp;&nbsp;");a.push("<a id='addNow' href='javascript:void(0);' class=\"fw_n\"> "+Lang.Mail.ConfigJs.settingNow+">> </a></p>");return a.join("")};
mailPOP.getList=function(a){var b=[];b.push('<table class="addr_table_head rm_table_head mt_10" width="100%">');b.push("<tr>");b.push('<td width="30%">'+Lang.Mail.ConfigJs.mailAccount+"</td>");b.push('<td width="30%" class="td2">'+Lang.Mail.ConfigJs.mailFolderName+"</td>");b.push('<td width="110">'+Lang.Mail.ConfigJs.unreadMail+"</td>");b.push('<td width="95">'+Lang.Mail.ConfigJs.allMails+"</td>");b.push('<td width="160" class="td5">'+Lang.Mail.ConfigJs.operation+"</td>");b.push("</tr>");b.push("</table>");
b.push('<table class="addr_table_body td-color" width="100%">');try{for(var c=0;c<a.length;c++){var d=a[c];MM.getFolderObject(d.fid)||MM.getFolderObject(1);for(var e=0,f=0,g=CM.folderMain[gConst.dataName],h=0;h<g.length;h++)if(d.fid==g[h].fid)e=g[h].stats.messageCount,f=g[h].stats.unreadMessageCount;b.push("<tr>");b.push('<td width="30%">'+d.username+"</td>");b.push('<td width="30%"><span popid="'+d.id+'" title="'+Lang.Mail.ConfigJs.dbClickModFolderName+'" style="cursor: pointer;" class="editControls">'+
d.folderName.encodeHTML()+"</span></td>");b.push('<td width="110">','<a href="javascript:;" onclick="mailPOP.gotoFolder('+d.fid+', true)">'+f+"</a></td>");b.push('<td width="95">','<a href="javascript:;" onclick="mailPOP.gotoFolder('+d.fid+')">',e,"</a>","</td>");b.push('<td width="160"><a href="javascript:void(0);" class="mr_15" ');b.push("onclick=\"mailPOP.syncPOP('"+d.id+"');mailPOP.init();return false;\">"+Lang.Mail.ConfigJs.receive+"</a>");b.push('<a href="javascript:void(0);" class="mr_15" ');
b.push('onclick="mailPOP.update('+d.id+');return false;" >'+Lang.Mail.ConfigJs.modifySettings+"</a>");b.push('<a href="javascript:void(0);" class="mr_15"');b.push("onclick=\"mailPOP.del('"+d.id+"','"+d.username+"');return false;\">"+Lang.Mail.ConfigJs.Delete+"</a>");b.push("</td></tr>")}b.join("")}catch(k){}b.push("</table>");return b.join("")};
mailPOP.getAddHtml=function(a){var b=[];b.push('<div id="rm_main">');b.push('<h2 class="set_til"><label id="addMod"> '+Lang.Mail.ConfigJs.addPOPmailbox);b.push('</label><a id=\'back\' class="fn bord-spa" href="javascript:void(0);">  &#8249;&#8249;'+Lang.Mail.ConfigJs.filter_return+"</a></h2>");b.push('<div class="rm_top_wrap">');b.push('<p class=""style="color:#A2A2A2; padding-left:25px; margin-bottom:10px; font-size:15px;">\u6700\u591a\u53ef\u6dfb\u52a05\u4e2a\u4ee3\u6536\u90ae\u7bb1</p>');b.push("<table width='100%' class=\"rm_box_layout\">");
b.push("<tr>");b.push('<td class="ta_r mailPOP_tdWidth"  >'+Lang.Mail.ConfigJs.POPmailboxAccount+"</td>");b.push('<td><div class="p_relative">');b.push('<input id=\'username\' maxlength=\'200\' class="rm_txt w284" type="text" value=""/>');b.push(this.getFalseTip("usernameTip","usernameTipText"));b.push("</div></td>");b.push("</tr>");b.push("<tr>");b.push('<td class="ta_r">'+Lang.Mail.ConfigJs.pop_password+"</td>");b.push("<td><input id='password' maxlength='30' class=\"rm_txt w284\" type=\"password\"/>");
b.push(this.getFalseTip("pwdTip","pwdTipText"));b.push("</td></tr>");b.push("<tr>");b.push("<td class=\"ta_r\" id='folderName'>"+Lang.Mail.ConfigJs.receivedMailFolder+"</td>");b.push('<td><input type="hidden" id="textFid" ><input type="text" maxlength=\'32\' id="textFolderName" class="rm_txt w284">');b.push(this.getFalseTip("folderNameTip","folderNameTipText"));b.push("</td>");b.push("</tr>");b.push("</table>");b.push("</div><\!--rm_top_wrap--\>");b.push('<div class="senior_box">');b.push("<h3 id='showPopDetail' style='cursor:pointer;border-bottom:none'>");
b.push("<i id='triangle' class=\"i_senior_sli_on\">");b.push('</i><label id="wzbh" style="cursor:pointer;margin-left:5px">'+Lang.Mail.ConfigJs.advancedSettings);b.push('<span  style="margin-right:5px;cursor:pointer;">('+Lang.Mail.ConfigJs.rulesSettings+")</span></label></h3>");b.push("<div id='popDetail' class=\"rm_top_wrap\">");b.push('<table  class="rm_box_layout">');b.push("<tr>");b.push('<td class="ta_r mailPOP_tdWidth"  >'+Lang.Mail.ConfigJs.mailSeverPOP+"</td>");b.push('<td><input class="rm_txt w284" maxlength=\'40\' id=\'server\' type="text" value=""/>');
b.push(this.getFalseTip("serverTip","serverTipText"));b.push("</td></tr>");b.push("<tr>");b.push('<td class="ta_r"  width="120">'+Lang.Mail.ConfigJs.severTimeoutSeconds+"</td>");b.push('<td><input class="rm_txt w284" maxlength=\'4\' id=\'timeout\' type="text" value=""/>');b.push(this.getFalseTip("timeoutTip","timeoutTipText"));b.push("</td></tr>");b.push("<tr>");b.push('<td class="ta_r" width="120">'+Lang.Mail.ConfigJs.port+"</td>");b.push('<td><input  id=\'port\' maxlength=\'5\' class="rm_txt w284" type="text" value=""/>');
b.push("<span>&nbsp&nbsp&nbsp&nbsp\uff08"+Lang.Mail.ConfigJs.pop_defaultport+"\uff09<span>");b.push(this.getFalseTip("portTip","portTipText"));b.push("</td></tr>");b.push("<tr>");b.push('<td width="120" class="ta_r">'+Lang.Mail.ConfigJs.popSet+"</td>");b.push('<td><input class="rm_cb" type="checkbox" checked="checked" id="isAutoPOP"> <label for="isAutoPOP">\u81ea\u52a8\u6536\u53d6</label></td>');b.push("</tr>");b.push("<tr>");b.push("<td>&nbsp;</td>");b.push('<td><input class="rm_cb" checked=\'checked\' type="checkbox" id="leaveOnServer">');
b.push('<label for="leaveOnServer">'+Lang.Mail.ConfigJs.tetentionMailBackup+"</label></td>");b.push("</tr>");b.push("<tr>");b.push("<td>&nbsp;</td>");b.push('<td><input class="rm_cb" type="checkbox" id="isSSL"> ');b.push('<label for="isSSL">'+Lang.Mail.ConfigJs.encrytionLink+"</label></td>");b.push("</tr>");b.push("<tr>");b.push('<td class="ta_r">'+Lang.Mail.ConfigJs.receiveMails+"</td>");b.push("<td>");b.push('<label for="rm_all"><input name=\'recent\' checked=\'checked\' value=\'0\' id="rm_all" class="rm_radio" type="radio"/>');
b.push(Lang.Mail.ConfigJs.all+"</label>");b.push('<label style="margin-left: 15px;" for="rm_month"><input name=\'recent\'  value=\'2\' id="rm_month" class="rm_radio" type="radio"/>');b.push(Lang.Mail.ConfigJs.last30days+"</label>");b.push('<label style="margin-left: 15px;" for="rm_week"><input name=\'recent\' id="rm_week" value=\'1\' class="rm_radio" type="radio"/>');b.push(Lang.Mail.ConfigJs.last7days+"</label>");b.push("</td>");b.push("</tr>");b.push("</table>");b.push("</div>");b.push("</div><\!--senior_box--\>");
b.push('<div class="btm_pager pl_10">');b.push("<a id='save' onclick='mailPOP.add("+a+')\' class="n_btn_on mt_5"><span><span>'+Lang.Mail.ConfigJs.pref_confirm+"</span></span></a>");b.push("<a id='cancel' class=\"n_btn mt_5\"><span><span>"+Lang.Mail.ConfigJs.pref_cancel+"</span></span></a>");b.push("</div>");b.push("</div><\!--rm_main--\>");return b.join("")};mailPOP.showAdd=function(a){var b=$("pmailPOPWrapper");this.opType=a==0?"add":"mod";b.innerHTML=this.getAddHtml(a);this.initEvent(a)};
mailPOP.showHidePOPDetail=function(a){a?(jQuery("#triangle").attr("class","i_senior_sli"),jQuery("#popDetail").show(),jQuery("#showPopDetail").css("border-bottom",""),jQuery("#wzbh").css("margin-left","0px")):(jQuery("#triangle").attr("class","i_senior_sli_on"),jQuery("#popDetail").hide(),jQuery("#showPopDetail").css("border-bottom","none"),jQuery("#wzbh").css("margin-left","4px"))};
mailPOP.initEvent=function(a){var b=this,c=CM.folderMain[gConst.dataName],d=c.length;jQuery("#showPopDetail").css("border-bottom","none");jQuery("#wzbh").css("margin-left","4px");b.setInputDefaultValue("username","("+Lang.Mail.ConfigJs.as+"\uff1azhangsan@example.com)",1);b.setInputDefaultValue("textFolderName",Lang.Mail.ConfigJs.defaultFolderName,1);b.setInputDefaultValue("server","("+Lang.Mail.ConfigJs.as+"\uff1apop.example.com)",1);b.setInputDefaultValue("port","110",0);for(b.setInputDefaultValue("timeout",
"90",0);d--;)if(c[d].popMailId===+a&&c[d].folderPassFlag===1){jQuery("#textFolderName").prop("disabled",!0);break}jQuery("#username, #textFolderName, #server,#timeout,#port").bind("blur",function(){b.vdFormat(1)});jQuery("#isSSL").click(function(){jQuery(this).attr("checked")=="checked"?jQuery("#port").val(995):jQuery("#port").val(110)});jQuery("#username").bind("blur",function(){b.autoSetPOPServer()});b.opType=="mod"&&b.initEditHtml(a);jQuery("#back,#cancel").bind("click",function(){b.init()});jQuery("#password").bind("keydown",
function(a){a.keyCode==13&&jQuery("#save")[0].click()});jQuery("#username").blur(function(){var a=jQuery("#textFolderName");a.val()===Lang.Mail.ConfigJs.defaultFolderName&&jQuery(this).val()!=="("+Lang.Mail.ConfigJs.as+"\uff1azhangsan@example.com)"&&(a.val(jQuery(this).val()),a.css("color","#000000"))});jQuery("#showPopDetail").click(function(){jQuery("#popDetail").is(":hidden")?mailPOP.showHidePOPDetail(1):mailPOP.showHidePOPDetail(0)})};
mailPOP.initEditHtml=function(a){this.setEditValue(a);jQuery("#addMod").html(Lang.Mail.ConfigJs.updatePOPMail);jQuery("#triangle").attr("class","i_senior_sli");jQuery("#popDetail").show();jQuery("#wzbh").css("margin-left","0");jQuery("#showPopDetail").css("border-bottom","");jQuery("#username").attr("disabled","disabled")};
mailPOP.setEditValue=function(a){var b=this.getUrl(gConst.func.getPOP);this.ajaxRequest("user:getPOPAccounts",{id:a,status:0},function(a){var b=a[0].leaveOnServer==1?!0:!1,e=a[0].isSSL==1?!0:!1,f=a[0].isAutoPOP==1?!0:!1;jQuery("#username").val(a[0].username);jQuery("#password").val(a[0].password);jQuery("#server").val(a[0].server);jQuery("#timeout").val(a[0].timeout);jQuery("#port").val(a[0].port);jQuery("#leaveOnServer").attr("checked",b);jQuery("#isSSL").attr("checked",e);jQuery("#username,#server,#textFolderName").css("color",
"black");jQuery("#textFolderName").val(a[0].folderName.decodeHTML());jQuery("#textFolderName").attr("oldName",a[0].folderName);jQuery("#textFid").val(a[0].fid);jQuery("#isAutoPOP").attr("checked",f);jQuery("input:radio[name=recent]").each(function(b,d){jQuery(d).val()==a[0].flag&&jQuery(d).prop("checked",!0)})},function(){},b,this.attrs.ajaxType)};
mailPOP.setInputDefaultValue=function(a,b,c){c?jQuery("#"+a).val(b).css("color","#BFBFBF"):jQuery("#"+a).val(b);jQuery("#"+a).focus(function(){var c=jQuery("#"+a)[0].value.trim();b==""&&(b=jQuery("#"+a).val());c==b&&(jQuery("#"+a).val(""),jQuery("#"+a).css("color","black"))}).blur(function(){var d=jQuery("#"+a)[0].value.trim();if(d==""||d==null)jQuery("#"+a).val(b),c&&jQuery("#"+a).css("color","#BFBFBF")})};mailPOP.returnList=function(){this.showAdd(!0)};
mailPOP.showDetail=function(a,b){if(a&&a.childNodes){for(var c=a.childNodes[0],d=a.childNodes[1],e=c.style.display=="none"?"none":"",f=1,g=arguments.length;f<g;f++){var h=arguments[f];if(typeof h=="string")h=$("option_mailPOP_"+h),h.style.display=e}c.style.display=="none"?(c.style.display="",d.style.display="none"):(c.style.display="none",d.style.display="")}};mailPOP.checkFolderName=function(a,b){var c=!1,d=LM.folders.length;if(a!==b)for(;d--;)if(b===LM.folders[d].name){c=!0;break}return c};
mailPOP.autoSetPOPServer=function(){var a=jQuery("#username").val().trim();if(a!=""&&Vd.checkData("email",a)){var b=a.indexOf("@"),c="",c=/yahoo.com.cn$/.test(a)?"pop.mail."+a.substr(b+1):"pop."+a.substr(b+1);jQuery("#server").val(c).css("color","black")}};mailPOP.update=function(a){this.opType="mod";this.showAdd(a)};
mailPOP.checkMail=function(a,b,c){jQuery("#nameTip");var d="",e="",f=[],g="",h="",k=0,l=!1,m=!1,b=b||"mailPOP";if(!Vd.checkData("email",a)&&!c)return jQuery("#usernameTip").css("display","inline"),jQuery("#usernameTipText").html(Lang.Mail.ConfigJs.errorMailFormat),0;if(b=="mailPOP")d=gMain.collectioncorpConfigType,e=gMain.collectioncorpConfig.trim(),g=Lang.Mail.ConfigJs.onlySupportPop+"\u201c"+e+"\u201d"+Lang.Mail.ConfigJs.is_Mail,h=Lang.Mail.ConfigJs.forbit_pop+"\u201c"+e+"\u201d"+Lang.Mail.ConfigJs.is_Mail;
else if(b=="autoForward")d=gMain.forwardcorpConfigType,e=gMain.forwardcorpConfig.trim();e!=""&&e!="undefined"&&(f=e.split(/[;,]/));k=f.length;jQuery("#usernameTip").hide();if(d===""||typeof d=="undefined")return 1;if(d==0)return 1;if(k<1)return 1;for(c=0;c<k;c++)e=f[c],e.substr(0,1)=="*"?a.search(eval("/"+e.substring(1)+"$/i"))!=-1&&(d==1?l=!0:d==2&&(m=!0)):a==e&&(d==1?l=!0:d==2&&(m=!0));if(!l&&d==1)return b=="mailPOP"&&(jQuery("#usernameTip").css("display","inline"),jQuery("#usernameTipText").html(g)),
0;return m&&d==2?(b=="mailPOP"&&(jQuery("#usernameTip").css("display","inline"),jQuery("#usernameTipText").html(h)),0):1};mailPOP.checkPwd=function(a){var b=jQuery("#pwdTip");b.hide();return a==""||a==null?(b.css("display","inline"),jQuery("#pwdTipText").html(Lang.Mail.ConfigJs.pswNotEmpty),0):1};
mailPOP.vdEmpty=function(){var a=1,b=!1,c=jQuery("#username").val().trim();jQuery("#usernameTip,#pwdTip, #folderNameTip, #serverTip,#timeoutTip,#portTip").hide();if(!Vd.checkData("empty",c)||c=="("+Lang.Mail.ConfigJs.as+"\uff1azhangsan@example.com)")jQuery("#usernameTip").css("display","inline"),jQuery("#usernameTipText").html(Lang.Mail.ConfigJs.POPMailnotEmpty),a=0;Vd.checkData("empty",jQuery("#password").val().trim())||(jQuery("#pwdTip").css("display","inline"),jQuery("#pwdTipText").html(Lang.Mail.ConfigJs.pswNotEmpty),
a=0);if(jQuery("#textFolderName").val().trimAll().encodeHTML().length===0||jQuery("#textFolderName").val()===Lang.Mail.ConfigJs.defaultFolderName)jQuery("#folderNameTip").css("display","inline"),jQuery("#folderNameTipText").html(Lang.Mail.ConfigJs.folderNameNotEmpty),a=0;Vd.checkData("empty",jQuery("#server").val().trim())||(jQuery("#serverTip").css("display","inline"),jQuery("#serverTipText").html(Lang.Mail.ConfigJs.POPnotEmpty),b=!0,a=0);Vd.checkData("empty",jQuery("#timeout").val().trim())||(jQuery("#timeoutTip").css("display",
"inline"),jQuery("#timeoutTipText").html(Lang.Mail.ConfigJs.timeoutNotEmpty),b=!0,a=0);Vd.checkData("empty",jQuery("#port").val().trim())||(jQuery("#portTip").css("display","inline"),jQuery("#portTipText").html(Lang.Mail.ConfigJs.portInteger),b=!0,a=0);b&&(jQuery("#popDetail").show(),jQuery("#wzbh").css("margin-left","0"),jQuery("#showPopDetail").css("border-bottom",""));return a};
mailPOP.vdFormat=function(a){var b=1,c=jQuery("#username").val().trim(),d=jQuery("#server").val().trim(),e=jQuery("#textFolderName").val().trim().encodeHTML(),f=jQuery("#textFolderName").attr("oldName"),g=!1,h;jQuery("#usernameTip,#serverTip,#timeoutTip,#portTip").hide();var k=function(){Vd.checkData("domain",d)||(jQuery("#serverTip").css("display","inline"),jQuery("#serverTipText").html(Lang.Mail.ConfigJs.validPOP),b=0)};for(h=0;h<aliasList.length;h++)if(c===aliasList[h].value){jQuery("#usernameTip").css("display",
"inline");jQuery("#usernameTipText").html(Lang.Mail.ConfigJs.notUseAlias);b=0;break}a!=1?(b!==0&&(b=this.checkMail(c)),k(),this.checkFolderName(f,e)&&(jQuery("#folderNameTip").css("display","inline"),jQuery("#folderNameTipText").html(Lang.Mail.ConfigJs.folderNameNotWithOther),b=0)):(c!="("+Lang.Mail.ConfigJs.as+"\uff1azhangsan@example.com)"&&b!==0&&(b=this.checkMail(c)),d!="("+Lang.Mail.ConfigJs.as+"\uff1apop.example.com)"&&k());/[% '"\/;|&\*]/g.test(e)&&(jQuery("#folderNameTip").css("display","inline"),
jQuery("#folderNameTipText").html(Lang.Mail.ConfigJs.folderNameRegMsg),b=0);/^[0-9]{1,4}$/.test(jQuery("#timeout").val().trim())||(jQuery("#timeoutTip").css("display","inline"),jQuery("#timeoutTipText").html(Lang.Mail.ConfigJs.timeoutOnlyDigital),b=0,g=!0);Vd.checkData("port",jQuery("#port").val().trim())||(jQuery("#portTip").css("display","inline"),jQuery("#portTipText").html(Lang.Mail.ConfigJs.PortIncorrect),b=0,g=!0);g&&(jQuery("#popDetail").show(),jQuery("#wzbh").css("margin-left","0"),jQuery("#showPopDetail").css("border-bottom",
""));return b};mailPOP.validateAll=function(){return this.vdEmpty()&&this.vdFormat()};
mailPOP.add=function(a){console.log(mailPOP.dataList.length);var b=a==0?0:1,a=a==0?0:a,c=jQuery("#username").val().trim(),d=jQuery("#server").val().trim(),e=jQuery("#password").val().trim(),f=jQuery("#isSSL").attr("checked")=="checked"?1:0,g=jQuery("#textFolderName").val().trim(),h=0,k,h=jQuery("input:radio[name=recent]:checked").val();k=mailPOP.opType==="add"?0:+jQuery("#textFid").val().trim();jQuery("#nameTip").hide();jQuery("#pwdTip").hide();if(!mailPOP.validateAll())return jQuery("#popDetail").show(),
!1;console.log(mailPOP.dataList.length);console.log(b);if(b||mailPOP.dataList.length<5){setMaxDigits(131);var b=new RSAKeyPair("10001","","822b6785d4a32d968617425db2a20392127ec20a9dbfb63217d6d22084cf2bda2627380e3eea6567fd4fddd62146dc2bab2a69c574910ce285e58cce2f2b2dd7b079e80c7fb51bfbe4d7ad02b484c59ecc751811620890ce19ceeda020d1425107b3624a34da10d422ef13e6afdb9f6f9b47b5984554c7bfae0f3805f3fea83b"),e=encryptedString(b,e),l={id:a,username:c,password:e,server:d,port:parseInt(jQuery("#port").val().trim()),
timeout:parseInt(jQuery("#timeout").val().trim()),fid:k,folderName:g,opType:mailPOP.opType,isSSL:f,isAutoPOP:jQuery("#isAutoPOP").attr("checked")=="checked"?1:0,leaveOnServer:jQuery("#leaveOnServer").attr("checked")=="checked"?1:0,flag:h};mailPOP.attrs.url=mailPOP.getUrl(gConst.func.setPOP);b=mailPOP.attrs.url;a=l.username;c=[];for(d=0;d<aliasList.length;d++)c.push(aliasList[d].name);if(a.trim()==gMain.userNumber||c.has(a.trim())||a.trim()==gMain.mobileNumber+"@"+gMain.domain)return CC.alert(Lang.Mail.ConfigJs.popAccountDiff),
!1;CC.showMsg(Lang.Mail.ConfigJs.checkingPOP,!1,!1,"loading");this.ajaxRequest("user:setPOPAccount",l,function(a){jQuery("#tipsfinish div").hide().show();mailPOP.opType==="add"?CC.showMsg(Lang.Mail.ConfigJs.collectionSuc,!0,!1,"option"):CC.showMsg(Lang.Mail.ConfigJs.POPmodifySuc,!0,!1,"option");l.isAutoPOP&&mailPOP.syncPOP(+a.popId);mailPOP.init()},function(a){mailPOP.requestFail(a)},b,mailPOP.attrs.ajaxType)}else CC.alert(Lang.Mail.ConfigJs.pop_overflow+"5\u4e2a")};
mailPOP.ImmediateMod=function(a,b,c,d){for(var e=null,e=null,f=0,g=this.dataList.length;f<g;f++)a===this.dataList[f].username&&(e=this.dataList[f]);if(e===null||e.folderName===b)return!1;e={id:e.id,username:a,server:e.server,port:e.port,timeout:e.timeout,fid:e.fid,folderName:b,opType:"mod",isAutoPOP:e.isAutoPOP,leaveOnServer:e.leaveOnServer,isSSL:e.isSSL};this.attrs.url=this.getUrl(gConst.func.setPOP);a=this.attrs.url;CC.showMsg(Lang.Mail.ConfigJs.checkingPOP,!1,!1,"loadding");this.ajaxRequest("user:setPOPAccount",
e,function(){c.html(b);LM.loadFolderMain();jQuery("#tipsfinish div").hide().show();CC.showMsg(Lang.Mail.ConfigJs.folderNameModSuc,!0,!1,"option")},function(a){c.html(d);a.errorCode===2327014?CC.showMsg(Lang.Mail.ConfigJs.folderNameLong,!0,!1,"error"):CC.showMsg(Lang.Mail.ConfigJs.folderNameModFailed,!0,!1,"error")},a,this.attrs.ajaxType)};
mailPOP.requestFail=function(a){var b=jQuery("#usernameTipText"),c=jQuery("#serverTipText");a.code=="FA_BAD_PASSWORD"||a.code=="FA_BAD_USER"?(jQuery("#usernameTip").css("display","inline"),b.html(this.getSubmitFailTipHtml(1))):a.code=="FA_XXXX_EXISTS"||a.code=="FA_ACCOUNT_EXISTS"?(jQuery("#usernameTip").css("display","inline"),b.html(this.getSubmitFailTipHtml(4))):a.code=="FA_BAD_SERVER"||a.code=="FA_FORBIDDEN"?(jQuery("#popDetail").show(),jQuery("#wzbh").css("margin-left","0"),jQuery("#showPopDetail").css("border-bottom",
""),jQuery("#serverTip").css("display","inline"),c.html(this.getSubmitFailTipHtml(2))):a.code=="FA_FORBIDDEN_1"||a.code=="FA_FORBIDDEN_2"?(jQuery("#usernameTip").css("display","inline"),b.html(this.getSubmitFailTipHtml(5))):a.code=="FA_FORBIDDEN_3"?(jQuery("#usernameTip").css("display","inline"),b.html(this.getSubmitFailTipHtml(7))):a.errorCode===2327014||a.errorCode===2322015?(jQuery("#folderNameTip").css("display","inline"),jQuery("#folderNameTipText").html(Lang.Mail.ConfigJs.folderNameLong),result=
0):a.code=="FS_UNKNOWN"?(jQuery("#popDetail").show(),jQuery("#wzbh").css("margin-left","0"),jQuery("#showPopDetail").css("border-bottom",""),jQuery("#serverTip").css("display","inline"),c.html(this.getSubmitFailTipHtml(6))):(jQuery("#usernameTip").css("display","inline"),b.html(this.getSubmitFailTipHtml(3)))};
mailPOP.getSubmitFailTipHtml=function(a){var b=[];switch(a){case 1:b.push("<h3 style='border-bottom:0'>"+Lang.Mail.ConfigJs.autenticationFailed+"</h3>");b.push("<p>"+Lang.Mail.ConfigJs.reasonMaybe+"\uff1a</p>");b.push("<ol>");b.push("<li>"+Lang.Mail.ConfigJs.addressNotMatch+"\uff1b</li>");b.push("<li>"+Lang.Mail.ConfigJs.manuPOP+"\u3002</li>");b.push("</ol>");break;case 2:b.push("<h3 style='border-bottom:0'>"+Lang.Mail.ConfigJs.autenticationFailed+"</h3>");b.push("<p>"+Lang.Mail.ConfigJs.reasonMaybe+
"\uff1a</p>");b.push("<ol>");b.push("<li>"+Lang.Mail.ConfigJs.popFailed+"\uff1b</li>");b.push("<li>"+Lang.Mail.ConfigJs.manuPOP+"\u3002</li>");b.push("</ol>");break;case 3:b.push("<h3 style='border-bottom:0'>"+Lang.Mail.ConfigJs.autenticationFailed+"</h3>");b.push(Lang.Mail.ConfigJs.reCommendPOP+'"'+Lang.Mail.ConfigJs.filter_auto_forward+'"<br/>');b.push(Lang.Mail.ConfigJs.forwarMailTo);break;case 4:b.push(Lang.Mail.ConfigJs.pop_repeat);break;case 5:b.push(Lang.Mail.ConfigJs.errorLimitTip);break;
case 6:b.push(Lang.Mail.ConfigJs.temporaryConnect);break;case 7:b.push(Lang.Mail.ConfigJs.reachTheTopSoStop)}return b.join("")};
mailPOP.syncPOP=function(a,b,c,d,e){var f=this,g=b?gConst.func.syncPOPALL:gConst.func.syncPOP,h=f.getUrl(g);this.opType="pop";a={id:a};b&&this.dataList.length===0?CC.alert(Lang.Mail.ConfigJs.pop_noPop):(b&&(a={id:""}),CC.showMsg(Lang.Mail.ConfigJs.receivingMail,!0,!1,"option"),f.ajaxRequest(g,a,function(){LM.loadFolderMain();c&&MM.goTo("user"+d,"refresh",0)},function(a){e||f.fail(Lang.Mail.ConfigJs.PopFail,a)},h,f.attrs.ajaxType))};
mailPOP.JudgeIfColCom=function(){var a=this,b=this.getUrl(gConst.func.getPOP),c={},d=setInterval(function(){a.ajaxRequest("user:getPOPAccounts",c,function(a){for(var b=!0,c=a.length,h=0;h<c;h++)a[h].status||(b=!1);b&&(clearInterval(d),CC.showMsg(Lang.Mail.ConfigJs.reCom,!0,!1,"option"))},function(b){clearInterval(d);a.fail(Lang.Mail.ConfigJs.PopFail,b)},b,a.attrs.ajaxType)},2500);d()};
mailPOP.del=function(a,b){for(var c=mailPOP,d=CM.folderMain[gConst.dataName],e=d.length;e--;)if(d[e].popMailId===+a&&d[e].folderPassFlag===1)return CC.showMsg(Lang.Mail.ConfigJs.folderEncryptedNoDel,!0,!1,"error"),!1;CC.confirm(Lang.Mail.ConfigJs.ifDelete+'"'+b+'"'+Lang.Mail.ConfigJs.POPmail+'<p class="msgDialog"><label><input id="radioNoDelMail" checked="checked" name="radioDelType" type= "radio"/> \u5c06\u90ae\u4ef6\u5939\u4e2d\u90ae\u4ef6\u79fb\u52a8\u5230\u201c\u6536\u4fe1\u7bb1\u201d\u4e2d</label><br /><label><input id="radioDelMail" name="radioDelType" type= "radio"/> \u90ae\u4ef6\u4e00\u8d77\u5220\u9664</label></p>',
function(){var b=c.getUrl(gConst.func.setPOP);c.opType=jQuery("#radioNoDelMail").prop("checked")===!0?"deleteFolder":"delete";var d={opType:c.opType,id:parseInt(a)};c.ajaxRequest(c.attrs.save.func,d,function(){jQuery("#tipsfinish").hide().show();CC.showMsg(Lang.Mail.ConfigJs.filter_delSuccess,!0,!1,"option");c.init()},function(){CC.alert(Lang.Mail.ConfigJs.mailpop_delFl)},b,c.attrs.ajaxType)},Lang.Mail.ConfigJs.mailpop_sysPrompt)};
mailPOP.modPOPList=function(a){if(popList!=void 0){var b=a.length;popList=[];if(b>0)for(var c=0;c<b;c++)popList.push({email:a[c].username,fid:a[c].fid,popId:a[c].id})}};mailPOP.saveAfter=function(){switch(this.opType){case "add":this.ok(Lang.Mail.ConfigJs.pop_successAdd);break;case "mod":this.ok(Lang.Mail.ConfigJs.pop_successMod);break;case "deleteWithoutFolder":jQuery("#tipsfinish div").hide().show();CC.showMsg(Lang.Mail.ConfigJs.filter_delSuccess,!0,!1,"option");break;case "pop":this.ok(Lang.Mail.ConfigJs.pop_laterLook)}};
mailPOP.errorMsg={FA_BAD_PASSWORD:Lang.Mail.ConfigJs.pop_vFail,FA_XXXX_EXISTS:Lang.Mail.ConfigJs.pop_repeat,FA_BAD_SERVER:Lang.Mail.ConfigJs.pop_TEST_FS_UNKNOWN};mailPOP.fail=function(a,b){var c=this.errorMsg[b.code];c?CC.alert(c):CC.alert(a)};mailPOP.ok=function(a){var b=this;CC.alert(a,function(){b.opType=="pop"?b.returnList():b.init()})};
mailPOP.showDisplayArea=function(a){var b=$("option_mailPOP__showDisplayArea"+a),a="option_mailPOP_i_"+a;if(b)b.style.display==""?(b.style.display="none",$(a).className="off"):(b.style.display="",$(a).className="")};
mailPOP.gotoFolder=function(a,b){function c(){id==0?CC.receiveMail():CC.goFolder(id,d)}for(var d={},e=CM.folderMain[gConst.dataName],f=e.length,g=!1;f--;)if(e[f].fid===a){g=e[f].folderPassFlag;break}g&&gMain.lock_close?(d.obj=jQuery("#"+a),d.p=this,d.id=a,d.url=c,folderlock.unlocked(0,"leftLock",d)):b?CC.searchNewMail(a,!1):CC.goFolder(a,"user"+a)};mailPOP.setHeight=function(){var a=jQuery("#leftContainer").css("height");jQuery("#leftWrap").css("height",parseInt(a)-54)};var mailSearch=new OptionBase;
mailSearch.attrs={id:"mailSearch",authority:"MAIL_CONFIG_MAILSEARCH",free:!0,divId:"pageSearch",noReq:!0,tableClass:"searcForm",tableBefore:'<div class="formArea"><form id="option_searchForm" name="option_searchForm">',tableAfter:"</form></div>",buttons:[{text:Lang.Mail.ConfigJs.mail_search,clickEvent:"mailSearch.save"},{text:Lang.Mail.ConfigJs.sign_btn_cancel2,clickEvent:"mailSearch.goBack"}],data:{keyword:{text:Lang.Mail.ConfigJs.mailSearch_keywords,type:"text",className:"",attribute:{value:"",
defaultValue:"",maxLength:34,ext:' onkeydown="mailSearch.doKeyDown();"'},format:"string",after:"<span>"+Lang.Mail.ConfigJs.mailSearch_PromptMsg+"</span>"},fid:{text:Lang.Mail.ConfigJs.mailSearch_inFolder,type:"select",attribute:{value:"",defaultValue:"0"},items:[function(){var a={fid:0,parentId:0};a.name=Lang.Mail.ConfigJs.mailSearch_allFolder;return a}()]},read:{text:Lang.Mail.ConfigJs.mailSearch_ReadNo,type:"select",attribute:{value:"",defaultValue:""},items:{"":Lang.Mail.ConfigJs.mailSearch_noLimit,
1:Lang.Mail.ConfigJs.mailSearch_noRead,0:Lang.Mail.ConfigJs.mailSearch_read},format:"int"},attached:{text:Lang.Mail.ConfigJs.mailSearch_attachmentNo,type:"select",attribute:{value:"",defaultValue:""},items:{"":Lang.Mail.ConfigJs.mailSearch_noLimit,0:Lang.Mail.ConfigJs.mailSearch_NoAttachment,1:Lang.Mail.ConfigJs.mailSearch_attachment},format:"int"},priority:{text:Lang.Mail.ConfigJs.mailSearch_mailpriority,type:"select",attribute:{value:"",defaultValue:""},items:{0:Lang.Mail.ConfigJs.mailSearch_noLimit,
1:Lang.Mail.ConfigJs.mailSearch_urgency,3:Lang.Mail.ConfigJs.mailSearch_NoUrgency},format:"int"}}};mailSearch.init=function(){var a=[{fid:0,parentId:0,name:Lang.Mail.ConfigJs.mailSearch_allFolder}],b=this.getFolders([GE.folder.sys,GE.folder.user]);this.attrs.data.fid.items=a.concat(b);this.request(this.attrs)};mailSearch.doKeyDown=function(){var a=EV.getEvent()||window.event;EV.getCharCode(a)==13&&(CC.searchMailByTop(this.getEl("keyword")),EV.stopEvent(a));return!0};
mailSearch.save=function(){try{var a=["subject","from","to"],b=this.getTextValue("keyword").trim(),c=Util.str2Num(this.getValue("fid","select")),d=this.getValue("priority","select"),e={},f=0,g={read:this.getValue("read","select"),attached:this.getValue("attached","select")},h;for(h in g)g[h]!=void 0&&g[h]!=""&&(e[h]=Util.str2Num(g[h]));g=[];for(f=0;f<a.length;f++)b&&g.push({field:a[f],operator:"contains",value:b});d!="0"&&g.push({field:"priority",operator:"",value:d});CC.searchMailByParm(b,c,g,e,
{ignoreCase:1,recursive:0})}catch(k){}};var notify=new OptionBase,contact=null;
notify.attrs={id:"notify",authority:"MAIL_CONFIG_NOTIFY",divId:"pageNotify",list:{func:"mail:getNotify"},save:{func:"mail:setNotify"},tips:Lang.Mail.Config.notify_msg1,data:{notifyType:{text:Lang.Mail.Config.note_mode,type:"radio",className:"",attribute:{value:"",defaultValue:"1"},items:{0:Lang.Mail.Config.disable,1:Lang.Mail.Config.common_smsmode,2:Lang.Mail.Config.mms_mode,3:Lang.Mail.ConfigJs.wapPush,4:Lang.Mail.ConfigJs.reply_lbl_yes},format:"int"},beginTime:{text:Lang.Mail.Config.beginTime+"\uff1a",
type:"select",attribute:{value:"",defaultValue:"8"},items:{0:"0",1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",20:"20",21:"21",22:"22",23:"23"},format:"int"},endTime:{text:Lang.Mail.Config.endTime+"\uff1a",type:"select",attribute:{value:"",defaultValue:"22"},items:{1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09",10:"10",11:"11",12:"12",13:"13",14:"14",15:"15",16:"16",17:"17",18:"18",19:"19",
20:"20",21:"21",22:"22",23:"23",24:"24"},format:"int"}}};
notify.init=function(){if(!parent.CC.isMobileBind(parent.gMain.flags)&&IsOA!=1){var a="";aTag="";wo=null;window.gMain&&gMain.webPath&&gMain.sid&&(a=gMain.webPath+"/se/account/accountindex.do?sid="+gMain.sid+"&mode=Mobile");a&&(wo=function(){window.location.href=a});CC.alert(Lang.Mail.ConfigJs.phoneBindTip,wo);a&&jQuery("#divDialogClosealertbtn_0").find("span").find("span").html("\u7acb\u5373\u7ed1\u5b9a")}else this.toolTip_Black=new ToolTips({id:"toolTip_Black",direction:ToolTips.direction.Right,
left:511,top:-44}),this.whiteListData={},this.blackListData={},this.resultData={},this.initService(this.attrs,this.getHtml)};
notify.getHtml=function(a,b){var c=[],d=this.attrs,e=!0;if(b.beginTime||b.endTime||b.week!="")e=!1;this.Allalias=b;var f=MM[gConst.setting].menuItem[d.id].name;c.push(this.getNavMenu(d.id));c.push('<div class="notify">');c.push(this.getTopHtml());c.push(this.getLeftHtml());c.push('<div id="notifyWrapper" class="setWrapper">');c.push('<h2 class="set_til"> '+f+"<span>( "+a.tips+" )</span></h2>");c.push('<div class="codeSet-wrap dotBtm"><ul class="setCode-name">');c.push('<li><span class="left">'+a.data.notifyType.text+
"</span>");d=ntr1=ntr2=ntr3=ntr4=slt=kq="";switch(b.notifyType){case 0:d='checked="checked"';slt="disable";kq='disabled="disabled"';break;case 1:ntr1='checked="checked"';break;case 2:ntr2='checked="checked"';break;case 3:ntr3='checked="checked"';case 4:ntr4='checked="checked"'}c.push('<input onclick="notify.changNotifyType(this)" class="set-radio" type="radio"  '+d+' id="option_notifyType0" value="0" name="option_notifyType">');c.push('<label for="option_notifyType0">'+a.data.notifyType.items["0"]+
"</label></li>");c.push('<li class="pl155 pt_5" style="_padding-left:158px;"><div>');c.push('<input onclick="notify.changNotifyType(this)" class="set-radio" type="radio"  '+ntr4+' id="option_notifyType4" value="4" name="option_notifyType">');c.push('<label for="option_notifyType4">'+a.data.notifyType.items["4"]+'</label><em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></div></li>");c.push("</ul>  </div>");c.push('<div class="codeSet-wrap dotBtm" {0} id="notifyTime"> <ul class="setCode-name"> <li>'.format(b.notifyType==
0?"style='display:none;'":""));c.push('<span class="left">'+Lang.Mail.ConfigJs.receiveMessageTime+"\uff1a</span>");b.week=b.week||"0,1,2,3,4,5,6";c.push('<span id="receiveMessageInfo">'+this.getTimeRangeTips(b.beginTime,b.endTime,b.week));c.push('</span><a class="configA {0}" id="receiveMessageSetting" href="javascript:fGoto();" >'.format(slt)+(e==!0?Lang.Mail.ConfigJs.addTimeRange:Lang.Mail.ConfigJs.modify)+"</a>");c.push("</li> </ul> </div>");c.push('<div class="codeSet-wrap">');c.push('<ul class="setCode-name" style="display:none;"><li>');
c.push('<span class="left">'+Lang.Mail.ConfigJs.receiveMessageFilter+"\uff1a</span>");var g=f=kqChk2="",d=e="";b.limitFlag?f='checked="checked"':(kqChk2='checked="checked"',g='style="display:none"');c.push('<input id="openFilter" type="radio" name="receiveFilter" onclick="notify.kaiqi(this)" value="1" '+f+" "+kq+" />");c.push('<label for="openFilter">'+Lang.Mail.ConfigJs.openFilter+"</label></li>");c.push('<li class="pl155 pt_5"><div>');c.push('<input id="closeFilter" type="radio" name="receiveFilter" onclick="notify.kaiqi(this)" value="0" '+
kqChk2+" />");c.push('<label for="fliterNote-off">'+Lang.Mail.ConfigJs.closeFilter+"</label>");c.push("</div></li></ul>");c.push('<ul class="setCode-name" id="notify_list1" '+g+">");c.push("<li>");c.push('<span class="left">'+Lang.Mail.ConfigJs.receiveMessageFilter+"\uff1a</span>");var h=wcls=d=e=g=f="";if(b.item1&&b.limitType==1)f="checked=checked",h="disable",d="disabled='disabled'";else if(b.limitType==2||b.limitType==0)g="checked=checked",wcls="disable",e="disabled='disabled'";c.push('<input class="set-radio" type="radio" name="filterList" '+
f+' id="white" onclick="notify.listKaiqi(\'w\')"/>');c.push('<label for="white">'+Lang.Mail.Config.whiteList+"</label>");c.push('<span class="setCode-name-tips">('+Lang.Mail.ConfigJs.mailWhiteListDesc+")</span></li>");c.push("<li class=\"pl155 pt_5\" style='position: relative;zoom:1;'>");c.push('<span class="fake-txt w285">');c.push('<input type="text" id="addWhiteInput" class="configAddInput" style="width:260px;" '+e+" />");c.push("<i title='"+Lang.Mail.ConfigJs.chooseFromMailList+"' style='position:absolute;left:267px;top:7px;"+
(f?"":"display:none;")+"' class=\"i-rush\" id='notify_WhiteAddContact'></i>");c.push("</span>");c.push('<a class="add_Link" class="configA '+wcls+'" id="addWhite" href="javascript:fGoto();">');c.push('<i class="i_addMail"></i>'+Lang.Mail.ConfigJs.add+"</a></li>");c.push('<li class="pl155 pt_5">');c.push('<div class="fake-txt-pop">');c.push('<ul id="whiteList" class="fake-txt-popList '+wcls+'"></ul>');c.push("</div>");c.push("</li>");c.push('<li class="pl155 pt_15">');c.push('<input type="radio" '+
g+' name="filterList" class="set-radio" id="black" onclick="notify.listKaiqi(\'b\')">');c.push('<label for="black">'+Lang.Mail.Config.blackList+"</label>");c.push('<span class="setCode-name-tips">\uff08'+Lang.Mail.ConfigJs.mailBlackListDesc+"\uff09</span></li>");c.push("<li class=\"pl155 pt_5\" style='position: relative;zoom:1;'>");c.push('<span class="fake-txt w285">');c.push('<input type="text" id="addBlackInput" class="configAddInput" style="width:260px;"  '+d+" />");c.push("<i title='"+Lang.Mail.ConfigJs.chooseFromMailList+
"' style='position:absolute;left:267px;top:7px;"+(g?"":"display:none;")+"' class=\"i-rush\" id='notify_BlackAddContact'></i>");c.push("</span>");c.push('<a id="addBlack" class="add_Link '+h+'" href="javascript:fGoto();"><i class="i_addMail"></i>'+Lang.Mail.ConfigJs.add+"</a>");c.push("</li>");c.push('<li class="pl155 pt_5">');c.push('<div class="fake-txt-pop">');c.push('<ul id="blackList" class="fake-txt-popList '+h+'"></ul>');c.push("</div>");c.push("</li>");c.push("</ul></div>");c.push('<div style="" class="btm_pager">');
c.push('<a href="javascript:fGoto();"  onclick="notify.save(\'\');" class="n_btn_on mt_5 ml_10"><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.save));c.push('<a href="javascript:fGoto();"  onclick="notify.goBack(\'\');" class="n_btn mt_5"><span><span>{0}</span></span></a>'.format(Lang.Mail.ConfigJs.pref_cancel));c.push("</div>");c.push("</div>");MM[gConst.setting].update(this.attrs.id,c.join(""));pref.updatePosition("notifyWrapper");this.bindEvents(b);this.initDefaultData(b)};
notify.weeks=[Lang.Mail.ConfigJs.Sunday,Lang.Mail.ConfigJs.Monday,Lang.Mail.ConfigJs.Tuesday,Lang.Mail.ConfigJs.Wednesday,Lang.Mail.ConfigJs.Thursday,Lang.Mail.ConfigJs.Friday,Lang.Mail.ConfigJs.Saturday];
notify.getTimeRangeHtml=function(a){function b(a,b,c){var d=[],e=0,f=24,a=a||0;for(b==0?f=23:b==1&&(e=1);e<=f;e++)s=a==e?'selected="selected"':"",b==1&&e<=c&&(s+=' disabled="" class="disable"'),d.push('<option value="'+e+'" '+s+">"+e+"</option>");return d.join("")}var c=[],d=workday=weekday=selfDefine=!1,e=str2=str3=str4="",f="display:none",g="";a.week=="0,1,2,3,4,5,6"?d=!0:a.week=="1,2,3,4,5"?workday=!0:a.week=="0,6"?weekday=!0:a.week!=""&&(selfDefine=!0,f="");d&&(e='checked="checked"');workday&&
(str2='checked="checked"');weekday&&(str3='checked="checked"');selfDefine&&(str4='checked="checked"');a.week==""&&e==""&&str2==""&&str3==""&&str4==""&&(e='checked="checked"');c.push('<div class="boxIframeText mailFile-pad" id="selectTimeRangeDiv">');c.push('<ul class="timeSet-pop" id="timeRangeGroup">');c.push("<li>");c.push('<span class="left">'+Lang.Mail.ConfigJs.date+"\uff1a</span>");c.push('<select id="option_beginTime" class="set-select" onchange="notify.changeOption(this)">'+b(a.beginTime,0)+
"</select>");c.push('<span class="select_mod">'+Lang.Mail.Config.clock+"</span>&nbsp;&nbsp;&mdash;&nbsp;&nbsp;");c.push('<select class="set-select" id="option_endTime">'+b(a.endTime,1,a.beginTime)+"</select>");c.push('<span class="select_mod">'+Lang.Mail.Config.clock+"</span>");c.push("</li>");c.push('<li class="pt_15">');c.push('<span class="left">'+Lang.Mail.list_Date+"\uff1a</span>");c.push('<input id="TR_everyday" name="timeRangeGroup" class="set-radio" type="radio" value="0" '+e+" />");c.push('<label for="q1">'+
Lang.Mail.ConfigJs.everyday+"</label>");c.push("</li>");c.push('<li class="pt_5 pl_50">');c.push('<input id="TR_workday" name="timeRangeGroup" class="set-radio" type="radio" value="1" '+str2+" />");c.push('<label for="q1">'+Lang.Mail.ConfigJs.workday+"</label>");c.push("</li>");c.push('<li class="pt_5 pl_50">');c.push('<input id="TR_weekday" name="timeRangeGroup" class="set-radio" type="radio" value="2" '+str3+" />");c.push('<label for="q1">'+Lang.Mail.ConfigJs.weekday+"</label>");c.push("</li>");
c.push('<li class="pt_5 pl_50">');c.push('<input id="TR_define" name="timeRangeGroup" class="set-radio" type="radio" value="3" '+str4+" />");c.push('<label for="q1">'+Lang.Mail.ConfigJs.yourselfDefine+"</label>");c.push("</li>");c.push('<li class="pl_50">');c.push('<div class="daySelect-box" id="autoDefine"  style="'+f+'">');c.push('<ul class="dayList" id="autoDefineItems">');for(d=1;d<notify.weeks.length;d++)g=(d+"").inStr(a.week)?'checked="checked"':"",c.push("<li>"),c.push('<input type="checkbox" name="selfDefine" class="set-check" value="'+
d+'"'+g+">"),c.push('<label for="mon">'+notify.weeks[d]+"</label>"),c.push("</li>");g="0".inStr(a.week)?'checked="checked"':"";c.push("<li>");c.push('<input type="checkbox" name="selfDefine" class="set-check" value="0"'+g+">");c.push('<label for="mon">'+notify.weeks[0]+"</label>");c.push("</li>");c.push("</ul></div></li>");c.push('<li class="pl_50"><span class="error" id="errorSelfDefine"></span></li>');c.push("</ul></div>");return c.join("")};
notify.bindEvents=function(a){var b=this,c=b.$("receiveMessageSetting"),d=b.$("addWhite"),e=b.$("addBlack"),f=b.addWhite(b),g=b.addBlack(b);b.showTimeRange(b);c.onclick=function(){"disable".inStr(this.className)||b.showTimeRangeDialog()};a.item1&&EV.observe(d,"click",f,!1);a.item2&&EV.observe(e,"click",g,!1);EV.observe(b.$("addWhiteInput"),"keydown",function(a){EV.getCharCode(a)==13&&b.addWhite(b)()},!1);EV.observe(b.$("addBlackInput"),"keydown",function(a){EV.getCharCode(a)==13&&b.addBlack(b)()},
!1);a=jQuery("#notify_WhiteAddContact");a.mouseover(function(){jQuery(this).attr("class","i-rush-on")}).mouseout(function(){jQuery(this).attr("class","i-rush")});a.click(function(){b.addWhiteDialog()});a=jQuery("#notify_BlackAddContact");a.mouseover(function(){jQuery(this).attr("class","i-rush-on")}).mouseout(function(){jQuery(this).attr("class","i-rush")});a.click(function(){b.addBlackDialog()})};
notify.addWhite=function(a){return function(){if(!"disable".inStr(this.className)){var b=a.$("addWhiteInput"),c=a.$("addWhite"),d=Vd.getRmDomain(b.value);d.trim()!=""?Vd.checkData("email",d)||Vd.checkData("*@domain",d)?notify.check_exist(d,"whiteList")?(a.whiteListData[d]=d,a.updateListItem("w"),b.value=""):a.toolTip_Black.show(c,Lang.Mail.ConfigJs.addressExist):jQuery("#white").attr("checked")=="checked"&&a.toolTip_Black.show(c,Lang.Mail.ConfigJs.errorEmailFormat):jQuery("#white").attr("checked")==
"checked"&&a.toolTip_Black.show(c,Lang.Mail.ConfigJs.errorEmailFormat)}}};notify.check_exist=function(a,b){var c=!1;jQuery("#"+b+" li span").each(function(){jQuery(this).text()==a&&(c=!0)});return c?!1:!0};
notify.addBlack=function(a){return function(){if(!"disable".inStr(this.className)){var b=a.$("addBlackInput"),c=a.$("addBlack"),d=Vd.getRmDomain(b.value);d.trim()!=""?Vd.checkData("email",d)||Vd.checkData("*@domain",d)?notify.check_exist(d,"blackList")?(a.blackListData[d]=d,a.updateListItem("b"),b.value=""):a.toolTip_Black.show(c,Lang.Mail.ConfigJs.addressExist):jQuery("#black").attr("checked")=="checked"&&a.toolTip_Black.show(c,Lang.Mail.ConfigJs.errorEmailFormat):jQuery("#black").attr("checked")==
"checked"&&a.toolTip_Black.show(c,Lang.Mail.ConfigJs.errorEmailFormat)}}};notify.showTimeRange=function(a){return function(){"disable".inStr(this.className)||a.showTimeRangeDialog()}};
notify.initDefaultData=function(a){if(a.item1&&a.item1.length>0)for(var b=0,c=a.item1.length;b<c;b++)this.whiteListData[a.item1[b]]=a.item1[b];if(a.item2&&a.item2.length>0){b=0;for(c=a.item2.length;b<c;b++)this.blackListData[a.item2[b]]=a.item2[b]}a.limitType==1&&this.updateListItem("w");a.limitType==2&&this.updateListItem("b");if(!a.limitType||a.limitType==0)a.limitType=2;this.resultData=a};
notify.updateListItemEvent=function(){var a=this,b=jQuery("li[name='listItem']"),c=b.length,d,e,f;if(b&&c>0){d=b[0].parentNode;d.id=="blackList"&&(f="b");d.id=="whiteList"&&(f="w");for(var g=0;g<c;g++){d=b[g];e=d.id.substr(2);var h=function(b){return function(){a.removeItem(b,f)}}(e);d.childNodes&&d.childNodes[1]&&e&&EV.observe(d.childNodes[1],"click",h,!1)}}};notify.removeItem=function(a,b){b&&(delete (b=="b"?this.blackListData:this.whiteListData)[a],this.updateListItem(b))};
notify.changeOption=function(a){var a=parseInt(a.options[a.selectedIndex].value),b=document.getElementById("option_endTime"),c=parseInt(b.options[b.selectedIndex].value),d="";c<=a&&(c=a+1);b.options.length=0;for(var e=1;e<=24;e++){d=e;d=new Option(d,e);if(e<=a)d.disabled=!0,d.className="disable";if(c==e)d.selected=!0;b.options.add(d)}};
notify.kaiqi=function(a){if(a.value!="1")this.$("white").disabled=!0,this.$("black").disabled=!0,this.$("whiteList").disabled=!0,this.$("blackList").disabled=!0,this.$("notify_list1").style.display="none",this.$("notifyTime").style.display="none";else{this.$("white").disabled=!1;this.$("black").disabled=!1;if(this.$("white").checked)this.$("whiteList").disabled=!1;if(this.$("black").checked)this.$("blackList").disabled=!1;this.$("notify_list1").style.display="";this.$("notifyTime").style.display=
""}this.resultData.limitFlag=a.value};
notify.changNotifyType=function(a){var b={};a.value=="0"&&a.checked?(El.addClass(this.$("receiveMessageSetting"),"disable"),this.$("openFilter").disabled=!0,this.$("openFilter").checked=!1,this.$("closeFilter").disabled=!1,this.$("closeFilter").checked=!0,b.value="0"):(El.removeClass(this.$("receiveMessageSetting"),"disable"),this.$("openFilter").disabled=!1,this.$("openFilter").checked=!0,this.$("closeFilter").disabled=!1,this.$("closeFilter").checked=!1,b.value="1");notify.kaiqi(b);this.resultData.notifyType=
a.value};
notify.save=function(){var a=this,b=a.resultData;b.item1=a.whiteListData;b.item2=a.blackListData;var c=b.beginTime,d=b.endTime,e=b.notifyType,f=b.limitFlag,g=b.limitType,h=b.week,k=[],l=[],m;for(m in b.item1)m&&b.item1[m]&&k.push(b.item1[m]);for(m in b.item2)m&&b.item2[m]&&l.push(b.item2[m]);this.doService(a.attrs.save.func,{beginTime:c,endTime:d,notifyType:e,limitFlag:f,limitType:g,item1:k,item2:l,week:h},function(b){b.code=="S_OK"?a.ok(Lang.Mail.Config.notify_sucess):a.fail(Lang.Mail.Config.notify_fail,b)},
function(b){b.summary?a.fail(b.summary):a.fail(Lang.Mail.Config.notify_fail,b)})};
notify.listKaiqi=function(a){var b=this.$("addWhite"),c=this.$("addBlack"),d=this.$("whiteList"),e=this.$("blackList");a=="w"?(El.addClass(c,"disable"),El.removeClass(b,"disable"),El.removeClass(d,"disable"),El.addClass(e,"disable"),this.$("blackList").innerHTML="",this.updateListItem("w"),this.$("addWhiteInput").disabled=!1,this.$("addBlackInput").disabled=!0,this.resultData.limitType=1,jQuery("#notify_WhiteAddContact").show(),jQuery("#notify_BlackAddContact").hide()):(El.addClass(b,"disable"),El.removeClass(c,
"disable"),El.removeClass(e,"disable"),El.addClass(d,"disable"),this.$("whiteList").innerHTML="",this.updateListItem("b"),this.$("addWhiteInput").disabled=!0,this.$("addBlackInput").disabled=!1,this.resultData.limitType=2,jQuery("#notify_WhiteAddContact").hide(),jQuery("#notify_BlackAddContact").show())};
notify.getTimeRangeTips=function(a,b,c){var d="";if(c=="0,1,2,3,4,5,6")d=Lang.Mail.ConfigJs.everyday;else if(c=="1,2,3,4,5")d=Lang.Mail.ConfigJs.workday;else if(c=="0,6")d=Lang.Mail.ConfigJs.weekday;else if(c!=""){for(var c=c.split(","),e=0;e<c.length;e++)d+=" / "+notify.weeks[c[e]];d!=""&&(d=d.substr(3))}return a+Lang.Mail.Config.clock+" - "+b+Lang.Mail.Config.clock+" &nbsp;&nbsp; "+d+"&nbsp;&nbsp;"};
notify.createListItem=function(a){return'<li id="m_'+a+'" class="listItem" name="listItem" title="'+a+'"><span class="text">'+a+'</span><i class="i-fakeTxt-close"></i></li>'};
notify.showTimeRangeDialog=function(){var a=this,b=notify.getTimeRangeHtml(this.resultData);CC.msgBox({id:"confirm_time_range_dialog",title:Lang.Mail.ConfigJs.messageNotifySetting,type:"div",text:b,changeStyle:!1,zindex:1090,dragStyle:1,width:380,buttons:[{text:Lang.Mail.Ok,clickEvent:function(){var b=a.$("option_beginTime"),d=a.$("option_endTime"),e=a.$("receiveMessageInfo"),b=b.options[b.selectedIndex].value,d=d.options[d.selectedIndex].value;if(b-0>=d-0)return $("errorSelfDefine").innerHTML=Lang.Mail.ConfigJs.timeW,
!0;var f="";a.$("TR_everyday").checked&&(f="0,1,2,3,4,5,6");a.$("TR_workday").checked&&(f="1,2,3,4,5");a.$("TR_weekday").checked&&(f="0,6");if(a.$("TR_define").checked){for(var g=a.$("autoDefineItems").getElementsByTagName("input"),h=g.length,k=0;k<h;k++)g[k]&&g[k].tagName=="INPUT"&&g[k].checked&&(f+=","+g[k].value);f!=""&&(f=f.substr(1))}if(f=="")return $("errorSelfDefine").innerHTML=Lang.Mail.ConfigJs.choiseCtime+".",!0;a.resultData.beginTime=b;a.resultData.endTime=d;a.resultData.week=f;e.innerHTML=
a.getTimeRangeTips(b,d,f)}},{text:Lang.Mail.Cancel,clickEvent:function(){},isCancelBtn:!0}]});notify.bindTimeRangeEvents()};
notify.bindTimeRangeEvents=function(){var a=jQuery("input[name='timeRangeGroup']");if(a&&a.length>0)for(var b=0;b<a.length;b++)a[b].onclick=function(){var a=this.value,b=document.getElementById("autoDefine");b&&(a&&a=="3"?(jQuery("input[name='selfDefine']").attr("checked",!1),El.show(b)):El.hide(b))};EV.observe($("autoDefineItems"),"click",function(a){if((a=EV.getTarget(a))&&a.tagName.toLowerCase()=="input")$("errorSelfDefine").innerHTML=""},!1)};
notify.showContactDialog=function(a,b){contact=new parent.Contact("contact");contact.groupMap=LMD.groupMap;contact.group_contactListMap=LMD.group_contactListMap_mail;contact.inItContanct(notify.attrs.id+"_ContactDialog",a,b,null)};notify.addWhiteDialog=function(){if($("white").checked!=!1){var a=this;notify.showContactDialog(["0","2"],function(b){for(var c,d=0,e=b.length;d<e;d++)c=a.getClearEmail(b[d].value),a.whiteListData[c]=c;a.updateListItem("w")})}};
notify.addBlackDialog=function(){if($("black").checked!=!1){var a=this;notify.showContactDialog(["0","2"],function(b){for(var c,d=0,e=b.length;d<e;d++)c=a.getClearEmail(b[d].value),a.blackListData[c]=c;a.updateListItem("b")})}};notify.getClearEmail=function(a){var a=a.decodeHTML(),b=a.indexOf("<")+1,c=a.lastIndexOf(">")-b;return a.substr(b,c)};
notify.updateListItem=function(a){var b=[];if(a=="w"){for(var c in this.whiteListData)b.push(this.createListItem(this.whiteListData[c]));this.$("whiteList").innerHTML=b.reverse().join("")}else if(a=="b"){for(c in this.blackListData)b.push(this.createListItem(this.blackListData[c]));this.$("blackList").innerHTML=b.reverse().join("")}notify.updateListItemEvent()};var loginNotify=new OptionBase;
loginNotify.attrs={id:"loginNotify",authority:"MAIL_CONFIG_LOGIN",divId:"pageNotify",list:{type:"url",func:gConst.func.getLoginNotify},save:{type:"url",func:gConst.func.setLoginNotify},data:{}};
loginNotify.init=function(){if(!parent.CC.isMobileBind(parent.gMain.flags)&&IsOA!=1){var a="";aTag="";wo=null;window.gMain&&gMain.webPath&&gMain.sid&&(a=gMain.webPath+"/se/account/accountindex.do?sid="+gMain.sid+"&mode=Mobile");a&&(wo=function(){window.location.href=a});CC.alert(Lang.Mail.ConfigJs.phoneBindTip,wo);a&&jQuery("#divDialogClosealertbtn_0").find("span").find("span").html("\u7acb\u5373\u7ed1\u5b9a")}else this.resultData={},this.resultData.userList={},this.initService(this.attrs,this.getHtml)};
loginNotify.getHtml=function(a,b){var c=[],d=cStatus=iStatus="";b.limitFlag==1?d="checked='checked'":b.limitFlag==0?cStatus="checked='checked'":iStatus="checked='checked'";c.push(this.getNavMenu(this.attrs.id));c.push('<div class="notify">');c.push(this.getTopHtml());c.push(this.getLeftHtml());c.push('<div class="setWrapper" id="loginsetWrapper">');c.push('<h2 class="set_til"> '+Lang.Mail.ConfigJs.loginNotify+"<span>"+Lang.Mail.ConfigJs.loginNotifyTip+"</span></h2>");c.push('<div class="codeSet-wrap dotBtm">');
c.push('<ul class="setCode-name">');c.push('<li class="pt_5"><span class="left">'+Lang.Mail.ConfigJs.setLonginNotify+"</span>");c.push("<div>");c.push('<input id="ln_exception" name="ln_gate" type="radio" class="set-radio" value="0" '+iStatus+' onclick="loginNotify.setStatus(2)">');c.push('<label for="">\u5f02\u5e38\u65f6\u53d1\u9001</label>');c.push('<span style="display: inline-block;  color: #828282;  font-weight: normal;  padding-left: 10px;">\u5728\u5176\u4ed6\u57ce\u5e02(\u4e0d\u662f\u60a8\u7ecf\u5e38\u767b\u5f55\u7684\u57ce\u5e02\uff0c\u5305\u62ec\u6d77\u5916)\u767b\u5f55\u65f6\uff0c\u4f1a\u53d1\u9001\u767b\u5f55\u63d0\u9192\u77ed\u4fe1\u7ed9\u60a8\u3002</span>');
c.push("</div>");c.push("</li>");c.push('<li class="pl155 pt_15">');c.push('<input id="ln_open" name="ln_gate" type="radio" class="set-radio" value="1" '+d+' onclick="loginNotify.setStatus(1)">');c.push('<label for="">\u6bcf\u6b21\u90fd\u53d1\u9001</label>');c.push('<span style="display: inline-block;  color: #828282;  font-weight: normal;  padding-left: 10px;"></span>');c.push("</li>");c.push('<li class="pl155 pt_15">');c.push("<div>");c.push('<input id="ln_close" name="ln_gate" type="radio" class="set-radio" value="0" '+
cStatus+' onclick="loginNotify.setStatus(0)">');c.push('<label for="">\u4e0d\u53d1\u9001</label>');c.push("</div>");c.push("</li>");lastLoginTime!=""&&(d="\u661f\u671f\u65e5,\u661f\u671f\u4e00,\u661f\u671f\u4e8c,\u661f\u671f\u4e09,\u661f\u671f\u56db,\u661f\u671f\u4e94,\u661f\u671f\u516d".split(",")[(new Date(lastLoginTime.replace(/-/g,"/"))).getDay()],c.push("</li>"),c.push('<li class="pt_15" style="padding-left: 60px;">'),c.push("<div>"),lastLoginTime!=""&&lastLoginTime!=""&&c.push('\u4e0a\u6b21\u767b\u5f55\u65f6\u95f4\uff1a<label style="padding-right: 200px;">'+
lastLoginTime+" ("+d+")</label>"),lastLoginIp!=""&&lastLoginCity!=""&&c.push('\u4e0a\u6b21\u767b\u5f55IP\uff1a<label style="padding-right: 20px;">'+lastLoginIp+"("+lastLoginCity+")</label>"),c.push('<a onclick="loginNotify.goLoginLog();" href="javascript:;">\u767b\u5f55\u8bb0\u5f55\u67e5\u8be2</a>'),c.push("</div>"),c.push("</li>"));c.push("</ul>");c.push("</div>");c.push('<div class="btm_pager"><a class="n_btn_on mt_5 ml_10" onclick="loginNotify.save(\'\');" href="javascript:fGoto();"><span><span>'+
Lang.Mail.ConfigJs.save+'</span></span></a><a class="n_btn mt_5" onclick="loginNotify.goBack(\'\');" href="javascript:fGoto();"><span><span>'+Lang.Mail.Config.cancel+"</span></span></a></div>");c.push("<div>");c.push("</div>");MM[gConst.setting].update(this.attrs.id,c.join(""));pref.updatePosition("loginsetWrapper");this.loadDefaultData(b);this.initEvents()};loginNotify.loadDefaultData=function(a){this.resultData=a};loginNotify.goLoginLog=function(){CC.goLogLink("\u53d1\u4fe1\u65e5\u5fd7","login")};
loginNotify.initEvents=function(){};loginNotify.userDialog=function(a){return function(){a.showUserDialog()}};loginNotify.showUserDialog=function(){var a=this;contact=new parent.Contact("contact");contact.inItUser(notify.attrs.id+"_UserDialog",function(b){for(var c=0,d=b.length;c<d;c++)a.resultData.userList[b[c].value]=1;a.updateList()},null)};
loginNotify.updateList=function(){var a=[],b=this.resultData.userList,c;for(c in b)c&&b[c]&&a.push(this.createListItem(c));this.$("userListContainer").innerHTML=a.reverse().join("");this.bindListItemEvents()};loginNotify.createListItem=function(a){return'<li id="u_'+a+'" class="ln_item" title="'+a+'"><span class="ln_note">'+a+'</span><span class="ln_close">\u00d7</span></li>'};loginNotify.removeListItem=function(a){delete this.resultData.userList[a];this.updateList()};
loginNotify.bindListItemEvents=function(){for(var a=this,b=this.$("userListContainer").getElementsByTagName("li"),c,d,e,f=0,g=b.length;f<g;f++)c=b[f].id,c=c.substr(2),d=b[f].getElementsByTagName("span")[1],e=function(b){return function(){a.removeListItem(b)}}(c),d&&c!=""&&EV.observe(d,"click",e,!1)};loginNotify.setStatus=function(a){this.resultData.limitFlag=a};
loginNotify.save=function(){var a=this;this.doService(a.attrs.save.func,this.resultData,function(b){b.code=="S_OK"?a.ok(Lang.Mail.ConfigJs.loginNotifySuccess):a.fail(Lang.Mail.ConfigJs.loginNotifyFail,b)},function(b){b.summary?a.fail(b.summary):a.fail(Lang.Mail.ConfigJs.loginNotifyFail,b)})};loginNotify.getClearEmail=function(a){return notify.getClearEmail(a)};var password=new OptionBase;
password.attrs={id:"password",authority:"MAIL_CONFIG_PASSWORD",free:!0,divId:"pagePassword",noReq:!0,url:gMain.webPath+"/se/mail/config/password.do?func={0}&sid={1}".format(gConst.func.updatePwd,gMain.sid)};password.init=function(){var a=this;this.request(this.attrs,this.getHtml,null,!0);this.newSecGradeTip();jQuery("#newPassword").blur(function(){password.showNewPwdErr()});jQuery("#oldPassword").focus();jQuery("#confirmPassword").unbind().bind("keydown",function(b){EV.getCharCode(b)==13&&a.save()})};
password.newSecGradeTip=function(){if(!document.getElementById("secGrade")){var a={pwdId:"newPassword",NotContains:{Account:gMain.userNumber,Mobile:"",Alias:""},sLevel:parseInt(gMain.pwdCheckType)};this.vdpwd=new VdPassWord(a)}};
password.getHtml=function(){var a=[],b=function(){var a=[];a.push("<div>");a.push('<h2 class="set_til"> '+Lang.Mail.ConfigJs.ModifyPassword+"<span>");a.push("( "+Lang.Mail.ConfigJs.forgetPassword+" )</span></h2>");a.push("<div class=\"codeSet-wrap\" id='codeSet'>");a.push('<ul class="setCode-name">');a.push('<li><span class="left">'+Lang.Mail.ConfigJs.oldPwd+"\uff1a</span>");a.push('<input type="password" class="set-txt-b w260" id=\'oldPassword\'/>');a.push(password.getFalseTip("oldTip","oldTip1",
Lang.Mail.ConfigJs.currentPwd));a.push('</li><li class="pl113 pb_15"></li>');a.push('<li  class="pl155 pb_15" >');a.push('<li><span class="left">'+Lang.Mail.ConfigJs.enterNewPassword+"\uff1a</span>");a.push('<input type="password" class="set-txt-b w260" id=\'newPassword\'/>');a.push(password.getFalseTip("newTip","newTip1",Lang.Mail.ConfigJs.correctPassword));a.push("</li><li class=\"pl155 pb_15\" id='newSec'>");a.push('<span class="setCode-name-tips">'+gMain.pwdMinLen+"-"+gMain.pwdMaxLen+Lang.Mail.ConfigJs.notSpecialInLock+
"</span></li>");a.push('<li class="pl155 pb_15">');a.push('<div class="pw-security">');a.push("<p style='display:none' id='securityTip'>"+Lang.Mail.ConfigJs.PasswordSecurity);a.push("\uff1a<em id='emText'>"+Lang.Mail.ConfigJs.ordinary+"</em></p>");a.push("<p class='security-line' id='securityTip1' style='display:none' >");a.push("<span id='password_sp1' class=\"orange-bg\">1</span>");a.push("<span class=\"orange-bg\" id='password_sp2'>2</span>");a.push("<span class=\"grey-bg\" id='password_sp3'>3</span></p>");
a.push("</div></li><\!--pw-security--\>");a.push('<li><span class="left">'+Lang.Mail.ConfigJs.ConfirmNewPassword);a.push('\uff1a</span><input type="password" class="set-txt-b w260" id=\'confirmPassword\'/>');a.push(password.getFalseTip("confirmTip","confirmTip1",Lang.Mail.ConfigJs.correctPassword));a.push("</li></ul>");a.push("</div><\!--codeSet-wrap--\>");a.push("<div class=\"btm_pager fl\" style='width:100%'>");a.push("<a onclick='password.save()' class=\"n_btn_on mt_5 ml_10\"><span>");a.push("<span>"+
Lang.Mail.ConfigJs.save+"</span></span></a>");a.push("<a onclick='password.goBack()' class=\"n_btn mt_5\"><span>");a.push("<span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");a.push("</div>");return a.join("")}();a.push("<div class=\"bodySet bodyBwList\" style='align:text;'");a.push('><div id="container">');a.push(this.getTopHtml());a.push(this.getLeftHtml());a.push('<div class="setWrapper" id="setWrapp">');a.push(b);a.push("<div id='sign_list'></div>");a.push("</div></div></div>");
MM[gConst.setting].update(password.attrs.id,a.join(""));password.updatePosition()};password.showNewPwdErr=function(){return this.vdpwd.NotifyCode!=0?(jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(this.vdpwd.msg),!0):!1};
password.save=function(){var a=this,b=jQuery("#oldPassword").val(),c=jQuery("#newPassword").val(),d=jQuery("#confirmPassword").val();jQuery("#oldTip,#newTip,#confirmTip").hide();jQuery("#security,#security1").hide();password.securityTips();a=this;b=b.trim()||"";a.showNewPwdErr()||(b==""?(jQuery("#oldPassword").focus(),jQuery("#oldTip").css("display","inline"),jQuery("#oldTip1").html(Lang.Mail.ConfigJs.currentPwd)):c==""?(jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(Lang.Mail.ConfigJs.inputNewPwd)):
d==""?(jQuery("#confirmPassword").val("").focus(),jQuery("#confirmTip").css("display","inline"),jQuery("#confirmTip1").html(Lang.Mail.ConfigJs.inputConfirmPwd)):c!=d?(jQuery("#confirmPassword").focus(),jQuery("#confirmTip").css("display","inline"),jQuery("#confirmTip1").html(Lang.Mail.ConfigJs.towPwdMatch)):this.ajaxRequest(gConst.func.updatePwd,{authType:0,password:b,newPassword:c},function(){CC.showMsg(Lang.Mail.ConfigJs.pwdChangeSuc,!0,!1,"option");a.init(a.attrs.id)},function(a){a.code.toLowerCase()==
"invalid_pwd_new"?(jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(a.msg)):a.code!="UNKNOW_EXCEPTION"?(jQuery("#oldPassword").focus(),jQuery("#oldTip").css("display","inline"),jQuery("#oldTip1").html(a.msg)):(jQuery("#oldPassword").focus(),jQuery("#oldTip").css("display","inline"),jQuery("#oldTip1").html(Lang.Mail.ConfigJs.ModifyPwdErr))},this.attrs.url))};
password.securityTips=function(){jQuery("#newPassword").val();var a=this.vdpwd.NotifyCode,b="";switch(a){case 1:b=Lang.Mail.Config.PwdNew01;break;case 2:b=Lang.Mail.ConfigJs.simpleTip;break;case 3:b=Lang.Mail.Config.PwdNew03;break;case 4:b=Lang.Mail.ConfigJs.simpleTip;break;case 5:b=Lang.Mail.Config.PwdNew05;break;case 6:b=Lang.Mail.Config.PwdNew06;break;case 7:b=Lang.Mail.ConfigJs.simpleTip;break;case 8:b=Lang.Mail.ConfigJs.simpleTip;break;case 9:b=Lang.Mail.ConfigJs.pwdLimit.format(gMain.pwdMinLen,
gMain.pwdMaxLen)}jQuery("#newTip").hide();a!=0&&(jQuery("#newPassword").focus(),jQuery("#newTip").css("display","inline"),jQuery("#newTip1").html(b))};var person=new OptionBase;person.getUrl=function(a){return gMain.webApiServer+"/userconfig/NewModifyUserInfo.aspx?func={0}&rmsid={1}&sid={2}".format(a,gMain.sid,GC.sid)};
person.attrs={id:"person",divId:"pageModifyUserInfo",list:{type:"url",func:gConst.func.getUserInfo},save:{func:gConst.func.setUserInfo},del:{},data:{true_name:{text:"\u771f\u5b9e\u59d3\u540d",type:"text",className:"",attribute:{value:"",defaultValue:"",className:""},format:"string"},mobileNumber:{text:"\u7528\u6237\u624b\u673a\u53f7\u7801",type:"text",className:"",attribute:{value:"",defaultValue:"",className:"",regexStr:""},format:"string"}}};
person.init=function(){this.attrs.url=this.getUrl(this.attrs.list.func);this.request(this.attrs,this.getHtml,null,!0)};person.saveBefore=function(){this.attrs.url=this.getUrl(gConst.func.setUserInfo);return!0};var phoneBind=new OptionBase;phoneBind.attrs={id:"phoneBind",authority:"MAIL_CONFIG_PHONEBIND",free:!0,divId:"pagePhoneBind",noReq:!0};phoneBind.init=function(){this.request(this.attrs);this.timer=null};
phoneBind.getHtml=function(){var a=[],b=this.getInitHtml();a.push('<div class="bodySet" style=\'align:text;\' id="pageUserAlias">');a.push('<div id="container">');a.push(this.getTopHtml());a.push(this.getLeftHtml());a.push("<div class=\"setWrapper\" id='setWrapp'>");a.push(b);a.push("</div>");a.push("</div>");a.push("</div>");MM[gConst.setting].update(this.attrs.id,a.join(""));this.updatePosition("setWrapp");this.correctWidthInIE6("setWrapp",1);this.initEvent()};
phoneBind.getInitHtml=function(){var a=[];p=this;a.push('<div id="phoneBind_container">');a.push('<div class="msg-set">');a.push('<h2 class="set_til">'+Lang.Mail.ConfigJs.bPhone+"</h2>");a.push(p.getInitContentHtml());a.push('<div class="btm_pager mt_20">');a.push('<a id="saveBind" href="javascript:fGoto();"  class="n_btn_on mt_5 ml_10" tabindex="23" ><span><span>'+Lang.Mail.ConfigJs.save+"</span></span></a>");a.push('<a id="cancelBind" href="javascript:fGoto();"  class="n_btn mt_5 ml_10" tabindex="24" ><span><span>'+
Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");a.push("</div>");a.push("</div>");a.push("</div>");return a.join("")};phoneBind.hideTip=function(){this.phoneErrorTip.close();this.codeErrorTip.close()};
phoneBind.getInitContentHtml=function(){var a=[],b="";if(window.gMain&&gMain.hasPhone)this.phone=b=gMain.hasPhone;if(b=="fail")CC.showMsg(Lang.Mail.ConfigJs.getPhoneFail);else return b?(a.push('<div class="setphonewrap" id="setphonewrap">'),a.push('<ul class="setCode-name">'),a.push("<li>"),a.push('<span class="left">'+Lang.Mail.ConfigJs.binded+"</span>"),a.push('<span id="bindedPhone">'+this.phone+"</span>"),a.push('<a id="changePhone" href="javascript:void(0);" class="ml_5">'+Lang.Mail.ConfigJs.hh+
"</a>"),a.push("</li>"),a.push('<li class="mt_10">'),a.push('<span class="left">&nbsp;</span>'),a.push('<p style=" color:#999;">'+Lang.Mail.ConfigJs.tsfw),a.push("</p>"),a.push("</li>"),a.push("</ul>")):(a.push('<div id="j_setPhoneContent" class="setphonewrap">'),a.push('<div class="bd_div">'),a.push("<p>"+Lang.Mail.ConfigJs.noBinded),a.push('<a id="bindNow" href="javascript:void(0);">'+Lang.Mail.ConfigJs.bindNow+"</a>"),a.push("</p>"),a.push('<span id="bingTopTip">'+Lang.Mail.ConfigJs.tsfw),a.push("</span>"),
a.push("</div>")),a.push("</div>"),a.join("")};phoneBind.initEvent=function(){var a=jQuery,b=this;b.newErrorTip();a("#cancelBind").unbind().bind("click",function(){b.goBack();b.hideTip()});a("#bindNow").unbind().bind("click",function(){b.bindNewPhone()});a("#saveBind").unbind().bind("click",function(){});a("#changePhone").unbind().bind("click",function(){b.modPhone()})};
phoneBind.newErrorTip=function(){this.phoneErrorTip=new parent.ToolTips({id:"phoneTip",direction:parent.ToolTips.direction.Right,type:1,inputId:"phoneCode",afterInput:!0});this.codeErrorTip=new parent.ToolTips({id:"codeTip",direction:parent.ToolTips.direction.Right,inputId:"vdCode",afterInput:!0,type:1})};phoneBind.modPhone=function(){var a=jQuery,b=this.modPhoneHtml();contentDiv=a("#setphonewrap");contentDiv[0].innerHTML=b;this.initModPhoneEvent(this.phone)};
phoneBind.initModPhoneEvent=function(){var a=this,b=jQuery;a.hideTip();a.codeClick();a.blurCheck();a.phoneFocus();b("#saveBind").unbind().bind("click",function(){a.modSave()});b("#cancelBind").unbind().bind("click",function(){a.init();a.codeClick();a.hideTip()})};phoneBind.phoneFocus=function(){jQuery("#phoneCode").focus()};phoneBind.check=function(){return this.checkPhone()&&this.checkMsg()?!0:!1};
phoneBind.checkPhone=function(a){var b=jQuery("#phoneCode"),c=b.val().trim();if(!a&&c=="")return this.phoneErrorTip.show(b,Lang.Mail.ConfigJs.phoneEmpty),!1;if(c&&!Vd.checkData("mobile",c))return this.phoneErrorTip.show(b,Lang.Mail.ConfigJs.rightPhoneTip),!1;return c&&!Vd.checkMobile(c)?(a=gMain.mobileType||"1",this.phoneErrorTip.show(b,a=="0"?Lang.Mail.ConfigJs.rightPhoneTip:a=="1"?Lang.Mail.ConfigJs.onlyMobile:a=="2"?Lang.Mail.ConfigJs.chinaTelcom:a=="4"?Lang.Mail.ConfigJs.chinaUnion:Lang.Mail.ConfigJs.onlyMobile),
!1):!0};phoneBind.checkMsg=function(a){var b=jQuery("#vdCode"),c=b.val().trim();return!a&&c==""?(this.codeErrorTip.show(b,Lang.Mail.ConfigJs.smsEmpty),!1):!0};phoneBind.clearTimer=function(){clearInterval(p.timer);p.timer=null;jQuery("#getVdCode").html(p.codeHtml)};phoneBind.modSave=function(){var a=jQuery;jQuery("#phoneCode").val().trim();a=a("#vdCode").val().trim();this.vdCode="";if(this.checkMsg())this.msgCode=a,this.hideTip(),this.setMobileAjax("mod")};
phoneBind.modPhoneHtml=function(){var a=[];a.push('<ul class="setCode-name" style="padding-top:8px;">');a.push('<li class="mt_15 clearfix" style="position:relative">');a.push('<span  class="left">'+Lang.Mail.ConfigJs.newNum+"</span>");a.push('<input type="text" id="phoneCode" style="position:relative" class="set-txt-b w260">');a.push("</li>");a.push('<li class="mt5">');a.push('<span class="left">&nbsp;</span>');a.push('<a href="javascript:void(0);" class="n_btn">');a.push('<span id="getVdCode"><span>'+
Lang.Mail.ConfigJs.getSms+"</span></span></a>");a.push("</li>");a.push('<li style="position:relative" class="mt_15 clearfix">');a.push('<span class="left">'+Lang.Mail.ConfigJs.smsVd+'</span><div class="p_relative">');a.push('<input style="position:relative" id="vdCode" type="text" class="set-txt-b w260">');a.push("</li>");a.push('<li class="mt5">');a.push('<span class="left">&nbsp;</span>');a.push('<span class="setCode-name-tips">'+Lang.Mail.ConfigJs.vdDo+"</span>");a.push("</li>");a.push("</ul>");
a.push("</div>");a.push('<div class="changNum">');a.push("<h2>"+Lang.Mail.ConfigJs.hhtip+"</h2>");a.push('<ol class="changNum_ol">');a.push("<li>"+Lang.Mail.ConfigJs.hhtip1+"</li>");a.push("<li>"+Lang.Mail.ConfigJs.hhtip2+"</li>");a.push("</ol>");return a.join("")};phoneBind.bindNewPhone=function(){var a=jQuery,b=this.bindNewPhoneHtml();contentDiv=a("#j_setPhoneContent");contentDiv[0].innerHTML=b;this.initBindNewPhoneEvent()};
phoneBind.initBindNewPhoneEvent=function(){var a=this,b=jQuery;b("#getVdCode");a.hideTip();a.codeClick();a.blurCheck();a.phoneFocus();b("#cancelBind").unbind().bind("click",function(){a.init();a.hideTip()});b("#saveBind").unbind().bind("click",function(){a.createSave()})};phoneBind.blurCheck=function(){var a=this;jQuery("#phoneCode").blur(function(){a.checkPhone(!0)})};phoneBind.codeClick=function(){var a=this;jQuery("#getVdCode").unbind().bind("click",function(){a.getCode();return!1})};
phoneBind.getCodeAjax=function(a,b){var c=this,d=jQuery,e=d("#phoneCode").val(),f={mobilePhone:e},b=a=null,g=d("#getVdCode");c.doService("mail:getValidateCode",f,function(){c.curPhone=e;c.msgCode="";g.html(c.codeHtml);c.setBackground(!0)},function(){CC.showMsg(Lang.Mail.ConfigJs.getSmsFail,!0,!1,"error");c.clearTimer()})};
phoneBind.getCode=function(){var a=this,b=jQuery,c=b("#getVdCode");a.codeHtml='<span><var id="codeSec">59</var>'+Lang.Mail.ConfigJs.getSmsAgain+"</span>";i=59;if(a.checkPhone())a.getCodeAjax(),a.timer=setInterval(function(){if(i)b("#codeSec").html(i--),c.unbind("click").bind("click",function(a){a.stopPropagation();return!1});else{var d="",d='<span id="">'+Lang.Mail.ConfigJs.getSmsAgain+"</span>";a.setBackground(!1);a.codeClick();c.html(d);clearInterval(a.timer);a.timer=null}},1E3)};
phoneBind.setBackground=function(a){var b=jQuery("#getVdCode");a?(b[0].style.cssText="background:#ccc",b.find("span")[0].style.cssText="background:#ccc",b.parent()[0].style.cssText="background:#ccc"):(b[0].style.cssText="",b.find("span")[0].style.cssText="",b.parent()[0].style.cssText="")};
phoneBind.bindNewPhoneHtml=function(){var a=[];a.push('<div class="setphonewrap" id="setphonewrap">');a.push('<ul class="setCode-name">');a.push('<li style="position:relative">');a.push('<span class="left">'+Lang.Mail.ConfigJs.bindPhone+"</span>");a.push('<input style="position:relative" id="phoneCode" type="text" class="set-txt-b w260">');a.push("</li>");a.push('<li  class="mt5">');a.push('<span class="left">&nbsp;</span><a href="" class="n_btn">');a.push('<span id="getVdCode"><span>'+Lang.Mail.ConfigJs.getSms+
"</span></span></a>");a.push("</li>");a.push('<li style="position:relative" class="mt_15">');a.push('<span class="left">'+Lang.Mail.ConfigJs.smsVd+'</span><div class="p_relative">');a.push('<input style="position:relative" id="vdCode" type="text" class="set-txt-b w260">');a.push("</li>");a.push('<li class="mt5">');a.push('<span class="left">&nbsp;</span>');a.push('<span id="vdTip" class="setCode-name-tips">'+Lang.Mail.ConfigJs.vdDo+"</span>");a.push("</li>");a.push("</ul>");a.push("</div>");return a.join("")};
phoneBind.createSave=function(){var a=jQuery;jQuery("#phoneCode").val().trim();a=a("#vdCode").val().trim();this.msgCode="";if(this.checkMsg())this.msgCode=a,this.hideTip(),this.setMobileAjax()};
phoneBind.checkHasPhone=function(){var a=this,b=null,b=null;phoneBind.doService("mail:getUserInfo",{},function(b){if(b&&b["var"]&&b["var"].mobilePhone){if(window.gMain)a.phone=gMain.hasPhone=b["var"].mobilePhone}else if(window.gMain)gMain.hasPhone="";a.init()},function(){if(window.gMain)gMain.hasPhone="fail";a.init()})};
phoneBind.setMobileAjax=function(a){var b=this,c={validateCode:b.msgCode},d=null,d=null,e="",e=a&&a=="mod"?Lang.Mail.ConfigJs.hhSuc:Lang.Mail.ConfigJs.bindPhoneSuc;b.doService("mail:setUserMobileInfo",c,function(){if(window.gMain&&gMain.mobileNumber)gMain.mobileNumber=b.curPhone;b.clearTimer();CC.showMsg(e,!0,!1,"option");b.checkHasPhone()},function(a){if(a&&a.code){var a=a.code,c="",d=jQuery("#vdCode");if(a=="validateCodeisExpired")c=Lang.Mail.ConfigJs.vdExpired;else if(a=="validateCodeisInvalid")c=
Lang.Mail.ConfigJs.noVdNum;b.codeErrorTip.show(d,c)}})};var pref=new OptionBase;pref.attrs={id:"pref",authority:"MAIL_CONFIG_COMMON",divId:"pageSetBasic",list:{type:"url",func:gConst.func.getAttrs},save:{func:gConst.func.setAttrs}};
pref.getHtml=function(a,b){var c=pref,d=[],e=function(){var a=[];a.push('<div class="parameter-wrap"><ul class="parameter-ul pt_10">');a.push(' <li class="m_clearfix">');a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.index_maxlist_text+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='manyLetter' id='letter_10' class=\"rm_cb\" value='10'>");a.push("<label for='letter_10'> 10"+Lang.Mail.ConfigJs.email+"</label></div></li>");a.push('<li class="pl_155 next-li">');
a.push("<input type=\"radio\" class=\"rm_cb\" name='manyLetter' id='letter_20' value='20'>");a.push("<label  for='letter_20'>  20"+Lang.Mail.ConfigJs.email+"</label>");a.push('<em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='manyLetter' id='letter_50' class=\"rm_cb\" value='50'>");a.push("<label  for='letter_50'>  50"+Lang.Mail.ConfigJs.email+"</label></li>");a.push('<li class="pl_155 next-li" >');
a.push("<input type=\"radio\" class=\"rm_cb\"name='manyLetter' id='letter_100' value='100'>");a.push("<label  for='letter_100'>  100"+Lang.Mail.ConfigJs.email+"</label></li></ul>");GC.check("MAIL_CONFIG_FONTSIZE")&&(a.push('<ul class="parameter-ul pt_10">'),a.push(' <li class="m_clearfix">'),a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.setFontSize+"\uff1a</span>"),a.push('<div class="parameter-conBox">'),a.push("<input type=\"radio\" name='set_fontSize' id='big_fontSize' class=\"rm_cb\" value='bigfont'>"),
a.push("<label for='big_fontSize'> "+Lang.Mail.ConfigJs.bigFontSize+"</label></div></li>"),a.push('<li class="pl_155 next-li">'),a.push("<input type=\"radio\" class=\"rm_cb\" name='set_fontSize' id='st_fontSize' value='normalfont'>"),a.push("<label  for='st_fontSize'>  "+Lang.Mail.ConfigJs.stFontSize+"</label>"),a.push('<em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></li>"),a.push("</ul>"));a.push('<ul class="parameter-ul pt_10">');a.push('<li class="m_clearfix">');
a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.messageAbstract+"</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" class=\"rm_cb\" name='showSummary' id='showSummary1' value='1'>");a.push("<label for='showSummary1'>  "+Lang.Mail.ConfigJs.showtip+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" class=\"rm_cb\" name='showSummary' id='showSummary2' value='0'>");a.push("<label for='showSummary2'>  "+Lang.Mail.ConfigJs.NotDisplay+
"</label></li></ul>");GC.check("MAIL_CONFIG_READMODE")&&(a.push("<ul class=\"parameter-ul pt_10\" id='mailReadMode'>"),a.push('<li class="m_clearfix">'),a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.index_newwindowtoreadletter_text+"</span>"),a.push("<input type=\"radio\" class=\"rm_cb\" name='readMode' id='readMode1' value='0'>"),a.push("<label for='readMode1'><i class=\"i-read-mark\"></i>  "),a.push(""+Lang.Mail.ConfigJs.index_newwindowtoreadletter_v_0+"</label></li>"),a.push('<li class="pl_155 next-li" >'),
a.push("<input type=\"radio\" class=\"rm_cb\" name='readMode' id='readMode2' value='1'>"),a.push("<label for='readMode2'><i class=\"i-read-column\"></i>  "),a.push(""+Lang.Mail.ConfigJs.index_newwindowtoreadletter_v_1+"</label></li></ul>"));a.push("</div>");a.push('<div class="parameter-wrap">');a.push('<ul class="parameter-ul pt_10"><li class="m_clearfix">');a.push('<span class="parameter-til">  '+Lang.Mail.ConfigJs.replayMail+"\uff1a</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='joinLetter' id='joinLetter1' class=\"rm_cb\" value='1'>");
a.push("<label for='joinLetter1'>  "+Lang.Mail.ConfigJs.joinOriginalLetter+"</label>");a.push('<em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></div></li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='joinLetter' id='joinLetter2' class=\"rm_cb\" value='2'>");a.push("<label for='joinLetter2'>  "+Lang.Mail.ConfigJs.noJoinOriginalLetter+"</label>");a.push("</li></ul>");a.push('<ul class="parameter-ul pt_10">');a.push('<li class="m_clearfix">');
a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.thematicDisplay+"\uff1a</span>");a.push(' <div class="parameter-conBox">');a.push("<input type=\"radio\" name='reply' id='reply1' class=\"rm_cb\" value='1'>");a.push("<label for='reply1'>  "+Lang.Mail.ConfigJs.useEnglish+" <font class='tips-default-color'>(Re\uff1a/Fw\uff1a)</font></label>");a.push('<em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></div></li>");a.push(' <li class="pl_155 next-li">');a.push("<input type=\"radio\" name='reply' id='reply2' class=\"rm_cb\" value='4'>");
a.push("<label for='reply2'>  "+Lang.Mail.ConfigJs.useChinese+" <font class='tips-default-color'>("+Lang.Mail.ConfigJs.reply+"\uff1a/"+Lang.Mail.ConfigJs.forward1+"\uff1a)</font> </label></li></ul>");a.push('<ul class="parameter-ul pt_10"><li class="m_clearfix">');a.push('<span class="parameter-til">  '+Lang.Mail.ConfigJs.webMailSave+"\uff1a</span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='webMailSave' id='webMailSave1' class=\"rm_cb\" value='1'>");a.push("<label for='webMailSave1'>  "+
Lang.Mail.ConfigJs.enable+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='webMailSave' id='webMailSave0' class=\"rm_cb\" value='0'>");a.push("<label for='webMailSave0'>  "+Lang.Mail.ConfigJs.noEnable+"</label>");a.push("</li></ul>");a.push('</div><div class="parameter-wrap">');window.LoginType!=gConst.loginType.pm&&window.LoginType!=gConst.loginType.mm&&(a.push('<ul class="parameter-ul pt_10"><li class="m_clearfix">'),a.push('<span class="parameter-til">'+
Lang.Mail.ConfigJs.senddingMail+"\uff1a</span>"),a.push('<div class="parameter-conBox">'),a.push("<input type=\"radio\" name='autoSave' id='autoSave1' class=\"rm_cb\" value='1'>"),a.push("<label for='autoSave1'>  "+Lang.Mail.ConfigJs.autoSaved+"</label>"),a.push("</div></li>"),a.push('<li class="pl_155 next-li" >'),a.push("<input type=\"radio\" name='autoSave' id='autoSave2' class=\"rm_cb\" value='0'>"),a.push("<label for='autoSave2'>  "+Lang.Mail.ConfigJs.index_save_sent_v_0+"</label>"),a.push("</li></ul>"));
a.push('<ul class="parameter-ul pt_10"><li class="m_clearfix">');a.push('<span class="parameter-til" style="position:relative;">  '+Lang.Mail.ConfigJs.khkRec+"\uff1a");a.push('<span class="tips-default-color" style="position:absolute;left:35px;top:17px;">');a.push("("+Lang.Mail.ConfigJs.popvd+")</span></span>");a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='markReaded' id='statusChange' class=\"rm_cb\" value='0'>");a.push("<label for='statusChange'>  "+Lang.Mail.ConfigJs.zdReaded+
"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='markReaded' id='statusNoChange' class=\"rm_cb\" value='1'>");a.push("<label for='statusNoChange'>  "+Lang.Mail.ConfigJs.wdNochange+"</label>");a.push('<em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></li></ul>");a.push('<ul class="parameter-ul pt_10"><li class="m_clearfix">');a.push('<span class="parameter-til">  '+Lang.Mail.ConfigJs.khddeleteMail+"\uff1a</span>");
a.push('<div class="parameter-conBox">');a.push("<input type=\"radio\" name='forbidDel' id='forbid' class=\"rm_cb\" value='1'>");a.push("<label for='forbid'>  "+Lang.Mail.ConfigJs.forbid+"</label>");a.push('<em class="red-commend">\uff08'+Lang.Mail.ConfigJs.index_recommend+"\uff09</em></div></li>");a.push('<li class="pl_155 next-li" >');a.push("<input type=\"radio\" name='forbidDel' id='no_forbid' class=\"rm_cb\" value='0'>");a.push("<label for='no_forbid'>  "+Lang.Mail.ConfigJs.bforbid+"</label>");
a.push("</li></ul>");a.push('<ul class="parameter-ul pt_10">');a.push('<li class="m_clearfix">');a.push('<span class="parameter-til">  '+Lang.Mail.ConfigJs.khdrec+"\uff1a</span>");a.push('<div class="parameter-conBox">');a.push("<span style='width:95px;' id=\"dropMailDate\">");a.push('<span style="display:inline-block;" > ');a.push("</span>");a.push("</span>");a.push("<label>  "+Lang.Mail.ConfigJs.demail+"</label>");a.push("</div></li>");a.push('<li class="pl_155 next-li" id="popFolderList">');a.push("<input type=\"checkbox\" name='folderList' checked='checked' disabled='disabled' id='folderList_inbox' class=\"rm_cb\" value='2'>");
a.push("<label for='folderList_inbox'>"+Lang.Mail.ConfigJs.sjx+"</label></li>");a.push("<li class=\"pl_155 next-li\"><input type=\"checkbox\" name='folderList'   id='folderList_spam' class=\"rm_cb\" value='2'>");a.push("<label for='folderList_spam'>"+Lang.Mail.ConfigJs.ljMail+"</label></li>");a.push("<li class=\"pl_155 next-li\"><input type=\"checkbox\" name='folderList'  id='folderList_myFolder' class=\"rm_cb\" value='2'>");a.push("<label for='folderList_myFolder'>"+Lang.Mail.ConfigJs.wodeyj+"</label><br>");
a.push("</li>");a.push("</ul>");a.push("</div>");GC.check("MAIL_MANAGER_SESSIONMODE")&&(a.push('<div class="parameter-wrap" style="border-bottom:none">'),a.push("<ul class=\"parameter-ul pt_10\" id='modeChoise'>"),a.push('<li class="m_clearfix">'),a.push('<span class="parameter-til">'+Lang.Mail.ConfigJs.listView+"</span>"),a.push('<div class="parameter-conBox">'),a.push("<input type=\"radio\" class=\"rm_cb\" name='twoMode' id='twoMode1' value='0'>"),a.push("<label for='twoMode1'>  "+Lang.Mail.ConfigJs.standartMode+
"</label></div></li>"),a.push('<li class="pl_155 next-li" >'),a.push("<input type=\"radio\" class=\"rm_cb\" name='twoMode' id='twoMode2' value='1'>"),a.push("<label for='twoMode2'>  "+Lang.Mail.ConfigJs.conversationMode+"</label>"),a.push("</li> </ul>"),a.push("</div>"));return a.join("")}();d.push("<div class=\"bodySet bodyBwList\" style='align:text;'>");d.push('<div id="container">');d.push(this.getTopHtml());d.push(this.getLeftHtml());d.push("<div class=\"setWrapper\" id='prefWrapper'>");d.push(e);
d.push("</div>");d.push("<div class=\"btm_pager pl_10 percent100\" id='btm_page'>");d.push('<a class="n_btn_on mt_5" href="javascript:void(0);" onclick="pref.saveChanges(); return false;">');d.push("<span><span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");d.push('<a class="n_btn mt_5" onclick="CC.exit();">');d.push("<span><span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");d.push('<a class="n_btn mt_5"  onclick="pref.restoreDefaults(); return false;">');d.push("<span><span>"+Lang.Mail.ConfigJs.restoreDefaults+
"</span></span></a></div>");d.push("</div></div>");MM[gConst.setting].update(c.attrs.id,d.join(""));c.initEvent(b)};pref.init=function(){this.request(this.attrs)};pref.initEvent=function(a){pref.updatePosition("prefWrapper",79);this.correctWidthInIE6("prefWrapper",1);pref.initPreference(a);document.getElementById("dropMailDate")&&this.initDrop();this.initCustomParam();CC.isBigFont()&&this.initStyle()};
pref.initStyle=function(){var a=jQuery;a(".parameter-til").css("width","205px");a(".next-li").css("paddingLeft","216px")};
pref.initCustomParam=function(){var a=this,b=jQuery,c=0,d=0,e=0,f=0,g=0,h="",k=null,k=null;a.ajaxRequest("user:getInitData",{},function(k){if(k){if(k.folderList&&k.folderList.length){h=k.folderList;for(d=c=h.length;d--;)h[d].type==3&&(h[d].pop3Flag==1?b("#folderList_myFolder").attr("checked","checked"):b("#folderList_myFolder").attr("checked",!1)),h[d].fid==5&&(h[d].pop3Flag==1?b("#folderList_spam").attr("checked","checked"):b("#folderList_spam").attr("checked",!1))}if(k.userAttrs&&k.userAttrs.popLimit)e=
k.userAttrs.popLimit,a.dropAllContact.setValue(e);if(k.userAttrs&&typeof k.userAttrs.unallow_pop3_delete_mail!="undefined")f=k.userAttrs.unallow_pop3_delete_mail,b(":radio[name='forbidDel'][value="+f+"]").attr("checked","checked");if(k.userAttrs&&typeof k.userAttrs.unallow_pop3_change_mail_state!="undefined")g=k.userAttrs.unallow_pop3_change_mail_state,b(":radio[name='markReaded'][value="+g+"]").attr("checked","checked")}},function(){CC.showMsg(Lang.Mail.ConfigJs.getParamFail)})};
pref.initDrop=function(){var a=pref,b=new DropSelect({id:"dropMailDate",data:[{text:Lang.Mail.ConfigJs.all,value:"0"},{text:Lang.Mail.ConfigJs.zj100day,value:"1"}],type:"",selectedValue:"0",width:95});a.dropAllContact=b;jQuery("#dropMailDate").append(b.getHTML());b.loadEvent(document.getElementById("drop_select_dropMailDate"))};
pref.restoreDefaults=function(){var a=jQuery;parent.CC.confirm(Lang.Mail.ConfigJs.defaultState,function(){a("input[name=autoSave]:eq(1),input[name=readMode]:eq(0),input[name=joinLetter]:eq(0),input[name=reply]:eq(0),input[name=webMailSave]:eq(1),input[name=twoMode]:eq(0),input[name=manyLetter]:eq(1),input[name=showSummary]:eq(1)").attr("checked","checked");GC.check("MAIL_CONFIG_FONTSIZE")&&a("input[name=set_fontSize]:eq(1)").attr("checked","checked");pref.saveChanges()},Lang.Mail.ConfigJs.mailpop_sysPrompt,
null,"restoreDefaults");a(":radio[name=markReaded][value=1],:radio[name=forbidDel][value=1]").attr("checked","checked");this.dropAllContact&&this.dropAllContact.setValue(1)};
pref.initPreference=function(a){var b=pref,c=a.smtpsavesend,d=a.preference_reply,e=a.preference_reply_title,f=a.preference_letters,g=a.mailcontentdisplay,h=a.readmailmode,a=a._custom_sendsave,k=gMain.defaultFontSize;if(typeof a=="undefined"||a=="")a=CC.getSentSaveDefault();b.old_fontSize=gMain.defaultFontSize;b=parseInt(gMain.sessionMode);jQuery("input[name=autoSave][value="+c+"]").attr("checked",!0);jQuery("input[name=joinLetter][value="+d+"]").attr("checked",!0);jQuery("input[name=reply][value="+
e+"]").attr("checked",!0);jQuery("input[name=manyLetter][value="+f+"]").attr("checked",!0);jQuery("input[name=showSummary][value="+g+"]").attr("checked",!0);jQuery("input[name=readMode][value="+h+"]").attr("checked",!0);jQuery("input[name=twoMode][value="+b+"]").attr("checked",!0);jQuery("input[name=webMailSave][value="+a+"]").attr("checked",!0);GC.check("MAIL_CONFIG_FONTSIZE")&&jQuery("input[name=set_fontSize][value="+k+"]").attr("checked",!0)};
pref.getMyFolderData=function(a,b,c){var d=this,e=0,f="",e=b.length,g=0;for(c&&(g=1);e--;)(function(e){var k={func:"mbox:updateFolders","var":{fid:"",type:4,pop3Flag:g}};if(b[e].type==3)b[e].nodes&&b[e].nodes&&d.getMyFolderData(a,b[e].nodes,c),f=b[e].fid,k["var"].fid=f,a.push(k)})(e);return a};
pref.saveChanges=function(){var a=pref,b=jQuery,c=parseInt(b(":radio[name=twoMode][checked]").val()),d={smtpsavesend:parseInt(b(":radio[name=autoSave][checked]").val()),preference_reply:parseInt(b(":radio[name=joinLetter][checked]").val()),preference_reply_title:parseInt(b(":radio[name=reply][checked]").val()),preference_letters:parseInt(b(":radio[name=manyLetter][checked]").val()),mailcontentdisplay:parseInt(b(":radio[name=showSummary][checked]").val()),_custom_sendsave:parseInt(b(":radio[name=webMailSave][checked]").val())},
e=[],f=a.getFolders([GE.folder.sys,GE.folder.user]),g={type:2,value:b(":radio[name=markReaded][checked]").val()},h={type:1,value:b(":radio[name=forbidDel][checked]").val()},k="",l={fid:1,type:4,pop3Flag:1},m=null,n=null,k={type:0,value:a.dropAllContact.getValue()},m=b("#folderList_spam").attr("checked")=="checked"?{fid:5,type:4,pop3Flag:1}:{fid:5,type:4,pop3Flag:0},n=b("#folderList_myFolder").attr("checked")=="checked"?a.getMyFolderData(e,f,1):a.getMyFolderData(e,f);if(GC.check("MAIL_CONFIG_READMODE"))d.readmailmode=
parseInt(b(":radio[name=readMode][checked]").val());parseInt(b(":radio[name=twoMode][checked]").val());b=[];g={func:"mbox:setUserFlag","var":g};h={func:"mbox:setUserFlag","var":h};k={func:"mbox:setUserFlag","var":k};e={func:"mbox:updateFolders","var":l};f={func:"mbox:updateFolders","var":m};b.push({func:"user:setAttrs","var":{attrs:d}});l&&b.push(e);m&&b.push(f);n&&(b=b.concat(n));b.push(g);b.push(h);b.push(k);b={items:b};a.ajaxRequest("global:sequential",b,function(){a.changeSet(d,c);GC.check("MAIL_MANAGER_SESSIONMODE")?
a.ajaxSession():GC.check("MAIL_CONFIG_FONTSIZE")?a.ajaxFontSize():(CC.showMsg(Lang.Mail.ConfigJs.settingSuc,!0,!1,"option"),a.init(a.attrs.id))},function(){a.fail(Lang.Mail.ConfigJs.setParaFail)})};pref.ajaxSession=function(){var a=this,b=parseInt(jQuery(":radio[name=twoMode][checked]").val());a.ajaxRequest("mbox:setSessionMode",{flag:b},function(){gMain.sessionMode=b;GC.check("MAIL_CONFIG_FONTSIZE")?a.ajaxFontSize():(CC.showMsg(Lang.Mail.ConfigJs.settingSuc,!0,!1,"option"),a.init(a.attrs.id))},function(){a.fail(Lang.Mail.ConfigJs.setSessionFail)})};
pref.ajaxFontSize=function(){var a=this,b=a.data_fontSize={defaultFontSize:jQuery(":radio[name=set_fontSize][checked]").val()},c=b.defaultFontSize;GC.check("MAIL_CONFIG_FONTSIZE")&&a.old_fontSize!=c&&ChangeSkin.changeFont(c);a.Ajax("mail:setAttrs",b,function(){CC.showMsg(Lang.Mail.ConfigJs.settingSuc,!0,!1,"option");gMain.defaultFontSize=b.defaultFontSize.toString();CC.showMsg(Lang.Mail.ConfigJs.settingSuc,!0,!1,"option");Main.initAllSearchDivWidth();a.init(a.attrs.id)},function(){a.fail(Lang.Mail.ConfigJs.setFontSizeFail)},
"/mail/data.do")};pref.fail=function(a){CC.showMsg(a,!0,!1,"error")};pref.Ajax=function(a,b,c,d,e){parent.MM.doService({url:e||"/addr/user",func:a,data:b,failCall:d,call:c,param:""})};
pref.changeSet=function(a,b){if(typeof a.preference_letters!="undefined"&&a.preference_letters!=="")gMain.pageSize=a.preference_letters.toString();if(b!=="")gMain.sessionMode=b.toString();if(typeof a.mailcontentdisplay!="undefined"&&a.mailcontentdisplay!=="")gMain.showSummary=a.mailcontentdisplay.toString();if(typeof a._custom_sendsave!="undefined"&&a._custom_sendsave!=="")gMain.sendSave=a._custom_sendsave.toString();if(typeof a.readmailmode!="undefined"&&a.readmailmode!=="")gMain.readMailMode=a.readmailmode.toString();
if(typeof a.preference_reply_title!="undefined"&&a.preference_reply_title!=="")gMain.replyPrefix=a.preference_reply_title.toString();if(typeof a.preference_reply!="undefined"&&a.preference_reply!=="")gMain.addo=a.preference_reply.toString()};var biRadixBase=2,biRadixBits=16,bitsPerDigit=biRadixBits,biRadix=65536,biHalfRadix=biRadix>>>1,biRadixSquared=biRadix*biRadix,maxDigitVal=biRadix-1,maxInteger=9999999999999998,maxDigits,ZERO_ARRAY,bigZero,bigOne;
function setMaxDigits(a){maxDigits=a;ZERO_ARRAY=Array(maxDigits);for(a=0;a<ZERO_ARRAY.length;a++)ZERO_ARRAY[a]=0;bigZero=new BigInt;bigOne=new BigInt;bigOne.digits[0]=1}setMaxDigits(20);var dpl10=15,lr10=biFromNumber(1E15);function BigInt(a){this.digits=typeof a=="boolean"&&a==!0?null:ZERO_ARRAY.slice(0);this.isNeg=!1}
function biFromDecimal(a){for(var b=a.charAt(0)=="-",c=b?1:0,d;c<a.length&&a.charAt(c)=="0";)++c;if(c==a.length)d=new BigInt;else{var e=(a.length-c)%dpl10;e==0&&(e=dpl10);d=biFromNumber(Number(a.substr(c,e)));for(c+=e;c<a.length;)d=biAdd(biMultiply(d,lr10),biFromNumber(Number(a.substr(c,dpl10)))),c+=dpl10;d.isNeg=b}return d}function biCopy(a){var b=new BigInt(!0);b.digits=a.digits.slice(0);b.isNeg=a.isNeg;return b}
function biFromNumber(a){var b=new BigInt;b.isNeg=a<0;for(var a=Math.abs(a),c=0;a>0;)b.digits[c++]=a&maxDigitVal,a>>=biRadixBits;return b}function reverseStr(a){for(var b="",c=a.length-1;c>-1;--c)b+=a.charAt(c);return b}var hexatrigesimalToChar="0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z".split(",");
function biToString(a,b){var c=new BigInt;c.digits[0]=b;for(var d=biDivideModulo(a,c),e=hexatrigesimalToChar[d[1].digits[0]];biCompare(d[0],bigZero)==1;)d=biDivideModulo(d[0],c),digit=d[1].digits[0],e+=hexatrigesimalToChar[d[1].digits[0]];return(a.isNeg?"-":"")+reverseStr(e)}
function biToDecimal(a){var b=new BigInt;b.digits[0]=10;for(var c=biDivideModulo(a,b),d=String(c[1].digits[0]);biCompare(c[0],bigZero)==1;)c=biDivideModulo(c[0],b),d+=String(c[1].digits[0]);return(a.isNeg?"-":"")+reverseStr(d)}var hexToChar="0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f".split(",");function digitToHex(a){var b="";for(i=0;i<4;++i)b+=hexToChar[a&15],a>>>=4;return reverseStr(b)}function biToHex(a){var b="";biHighIndex(a);for(var c=biHighIndex(a);c>-1;--c)b+=digitToHex(a.digits[c]);return b}
function charToHex(a){return a>=48&&a<=57?a-48:a>=65&&a<=90?10+a-65:a>=97&&a<=122?10+a-97:0}function hexToDigit(a){for(var b=0,c=Math.min(a.length,4),d=0;d<c;++d)b<<=4,b|=charToHex(a.charCodeAt(d));return b}function biFromHex(a){for(var b=new BigInt,c=a.length,d=0;c>0;c-=4,++d)b.digits[d]=hexToDigit(a.substr(Math.max(c-4,0),Math.min(c,4)));return b}
function biFromString(a,b){var c=a.charAt(0)=="-",d=c?1:0,e=new BigInt,f=new BigInt;f.digits[0]=1;for(var g=a.length-1;g>=d;g--)var h=a.charCodeAt(g),h=charToHex(h),h=biMultiplyDigit(f,h),e=biAdd(e,h),f=biMultiplyDigit(f,b);e.isNeg=c;return e}function biDump(a){return(a.isNeg?"-":"")+a.digits.join(" ")}
function biAdd(a,b){var c;if(a.isNeg!=b.isNeg)b.isNeg=!b.isNeg,c=biSubtract(a,b),b.isNeg=!b.isNeg;else{c=new BigInt;for(var d=0,e=0;e<a.digits.length;++e)d=a.digits[e]+b.digits[e]+d,c.digits[e]=d&65535,d=Number(d>=biRadix);c.isNeg=a.isNeg}return c}
function biSubtract(a,b){var c;if(a.isNeg!=b.isNeg)b.isNeg=!b.isNeg,c=biAdd(a,b),b.isNeg=!b.isNeg;else{c=new BigInt;for(var d,e=d=0;e<a.digits.length;++e)d=a.digits[e]-b.digits[e]+d,c.digits[e]=d&65535,c.digits[e]<0&&(c.digits[e]+=biRadix),d=0-Number(d<0);if(d==-1){for(e=d=0;e<a.digits.length;++e)d=0-c.digits[e]+d,c.digits[e]=d&65535,c.digits[e]<0&&(c.digits[e]+=biRadix),d=0-Number(d<0);c.isNeg=!a.isNeg}else c.isNeg=a.isNeg}return c}
function biHighIndex(a){for(var b=a.digits.length-1;b>0&&a.digits[b]==0;)--b;return b}function biNumBits(a){var b=biHighIndex(a),a=a.digits[b],b=(b+1)*bitsPerDigit,c;for(c=b;c>b-bitsPerDigit;--c){if((a&32768)!=0)break;a<<=1}return c}function biMultiply(a,b){for(var c=new BigInt,d,e=biHighIndex(a),f=biHighIndex(b),g,h=0;h<=f;++h){d=0;g=h;for(j=0;j<=e;++j,++g)d=c.digits[g]+a.digits[j]*b.digits[h]+d,c.digits[g]=d&maxDigitVal,d>>>=biRadixBits;c.digits[h+e+1]=d}c.isNeg=a.isNeg!=b.isNeg;return c}
function biMultiplyDigit(a,b){var c,d;result=new BigInt;c=biHighIndex(a);for(var e=d=0;e<=c;++e)d=result.digits[e]+a.digits[e]*b+d,result.digits[e]=d&maxDigitVal,d>>>=biRadixBits;result.digits[1+c]=d;return result}function arrayCopy(a,b,c,d,e){for(e=Math.min(b+e,a.length);b<e;++b,++d)c[d]=a[b]}var highBitMasks=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];
function biShiftLeft(a,b){var c=Math.floor(b/bitsPerDigit),d=new BigInt;arrayCopy(a.digits,0,d.digits,c,d.digits.length-c);for(var c=b%bitsPerDigit,e=bitsPerDigit-c,f=d.digits.length-1,g=f-1;f>0;--f,--g)d.digits[f]=d.digits[f]<<c&maxDigitVal|(d.digits[g]&highBitMasks[c])>>>e;d.digits[0]=d.digits[f]<<c&maxDigitVal;d.isNeg=a.isNeg;return d}var lowBitMasks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];
function biShiftRight(a,b){var c=Math.floor(b/bitsPerDigit),d=new BigInt;arrayCopy(a.digits,c,d.digits,0,a.digits.length-c);for(var c=b%bitsPerDigit,e=bitsPerDigit-c,f=0,g=f+1;f<d.digits.length-1;++f,++g)d.digits[f]=d.digits[f]>>>c|(d.digits[g]&lowBitMasks[c])<<e;d.digits[d.digits.length-1]>>>=c;d.isNeg=a.isNeg;return d}function biMultiplyByRadixPower(a,b){var c=new BigInt;arrayCopy(a.digits,0,c.digits,b,c.digits.length-b);return c}
function biDivideByRadixPower(a,b){var c=new BigInt;arrayCopy(a.digits,b,c.digits,0,c.digits.length-b);return c}function biModuloByRadixPower(a,b){var c=new BigInt;arrayCopy(a.digits,0,c.digits,0,b);return c}function biCompare(a,b){if(a.isNeg!=b.isNeg)return 1-2*Number(a.isNeg);for(var c=a.digits.length-1;c>=0;--c)if(a.digits[c]!=b.digits[c])return a.isNeg?1-2*Number(a.digits[c]>b.digits[c]):1-2*Number(a.digits[c]<b.digits[c]);return 0}
function biDivideModulo(a,b){var c=biNumBits(a),d=biNumBits(b),e=b.isNeg,f,g;if(c<d)return a.isNeg?(f=biCopy(bigOne),f.isNeg=!b.isNeg,a.isNeg=!1,b.isNeg=!1,g=biSubtract(b,a),a.isNeg=!0,b.isNeg=e):(f=new BigInt,g=biCopy(a)),[f,g];f=new BigInt;g=a;for(var h=Math.ceil(d/bitsPerDigit)-1,k=0;b.digits[h]<biHalfRadix;)b=biShiftLeft(b,1),++k,++d,h=Math.ceil(d/bitsPerDigit)-1;g=biShiftLeft(g,k);c+=k;c=Math.ceil(c/bitsPerDigit)-1;for(d=biMultiplyByRadixPower(b,c-h);biCompare(g,d)!=-1;)++f.digits[c-h],g=biSubtract(g,
d);for(;c>h;--c){var d=c>=g.digits.length?0:g.digits[c],l=c-1>=g.digits.length?0:g.digits[c-1],m=c-2>=g.digits.length?0:g.digits[c-2],n=h>=b.digits.length?0:b.digits[h],o=h-1>=b.digits.length?0:b.digits[h-1];f.digits[c-h-1]=d==n?maxDigitVal:Math.floor((d*biRadix+l)/n);for(var r=f.digits[c-h-1]*(n*biRadix+o),q=d*biRadixSquared+(l*biRadix+m);r>q;)--f.digits[c-h-1],r=f.digits[c-h-1]*(n*biRadix|o),q=d*biRadix*biRadix+(l*biRadix+m);d=biMultiplyByRadixPower(b,c-h-1);g=biSubtract(g,biMultiplyDigit(d,f.digits[c-
h-1]));g.isNeg&&(g=biAdd(g,d),--f.digits[c-h-1])}g=biShiftRight(g,k);f.isNeg=a.isNeg!=e;a.isNeg&&(f=e?biAdd(f,bigOne):biSubtract(f,bigOne),b=biShiftRight(b,k),g=biSubtract(b,g));if(g.digits[0]==0&&biHighIndex(g)==0)g.isNeg=!1;return[f,g]}function biDivide(a,b){return biDivideModulo(a,b)[0]}function biModulo(a,b){return biDivideModulo(a,b)[1]}function biMultiplyMod(a,b,c){return biModulo(biMultiply(a,b),c)}
function biPow(a,b){for(var c=bigOne,d=a;;){(b&1)!=0&&(c=biMultiply(c,d));b>>=1;if(b==0)break;d=biMultiply(d,d)}return c}function biPowMod(a,b,c){for(var d=bigOne;;){(b.digits[0]&1)!=0&&(d=biMultiplyMod(d,a,c));b=biShiftRight(b,1);if(b.digits[0]==0&&biHighIndex(b)==0)break;a=biMultiplyMod(a,a,c)}return d}
function BarrettMu(a){this.modulus=biCopy(a);this.k=biHighIndex(this.modulus)+1;a=new BigInt;a.digits[2*this.k]=1;this.mu=biDivide(a,this.modulus);this.bkplus1=new BigInt;this.bkplus1.digits[this.k+1]=1;this.modulo=BarrettMu_modulo;this.multiplyMod=BarrettMu_multiplyMod;this.powMod=BarrettMu_powMod}
function BarrettMu_modulo(a){var b=biDivideByRadixPower(a,this.k-1),b=biMultiply(b,this.mu),b=biDivideByRadixPower(b,this.k+1),a=biModuloByRadixPower(a,this.k+1),b=biMultiply(b,this.modulus),b=biModuloByRadixPower(b,this.k+1),a=biSubtract(a,b);a.isNeg&&(a=biAdd(a,this.bkplus1));for(b=biCompare(a,this.modulus)>=0;b;)a=biSubtract(a,this.modulus),b=biCompare(a,this.modulus)>=0;return a}function BarrettMu_multiplyMod(a,b){return this.modulo(biMultiply(a,b))}
function BarrettMu_powMod(a,b){var c=new BigInt;c.digits[0]=1;for(var d=a,e=b;;){(e.digits[0]&1)!=0&&(c=this.multiplyMod(c,d));e=biShiftRight(e,1);if(e.digits[0]==0&&biHighIndex(e)==0)break;d=this.multiplyMod(d,d)}return c}function RSAKeyPair(a,b,c){this.e=biFromHex(a);this.d=biFromHex(b);this.m=biFromHex(c);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.barrett=new BarrettMu(this.m)}function twoDigit(a){return(a<10?"0":"")+String(a)}
function encryptedString(a,b){for(var c=[],d=0,e=b.length-1;e>=0;)c[d]=b.charCodeAt(e),e--,d++;for(;c.length%a.chunkSize!=0;)c[d++]=0;for(var e=c.length,f="",g,h,k,d=0;d<e;d+=a.chunkSize){k=new BigInt;g=0;for(h=d;h<d+a.chunkSize;++g)k.digits[g]=c[h++],k.digits[g]+=c[h++]<<8;g=a.barrett.powMod(k,a.e);g=a.radix==16?biToHex(g):biToString(g,a.radix);f+=g+" "}return f.substring(0,f.length-1)}
function decryptedString(a,b){var c=b.split(" "),d="",e,f,g;for(e=0;e<c.length;++e){f=a.radix==16?biFromHex(c[e]):biFromString(c[e],a.radix);g=a.barrett.powMod(f,a.d);for(f=biHighIndex(g);f>=0;--f)d+=String.fromCharCode(g.digits[f]>>8,g.digits[f]&255)}d.charCodeAt(d.length-1)==0&&(d=d.substring(0,d.length-1));return d}var sender=new OptionBase;
sender.attrs={id:"sender",authority:"MAIL_CONFIG_SENDER",free:!0,divId:"pageSetSenderName",list:{type:"url",func:gConst.func.getUserInfo},tips:Lang.Mail.ConfigJs.person_sendername_tips,save:{type:"url",func:gConst.func.setUserInfo},data:{true_name:{text:Lang.Mail.ConfigJs.person_sendername,type:"text",className:"",attribute:{value:"",defaultValue:"",className:"",maxLength:20},format:"string",check:{type:"empty"}}}};sender.init=function(){this.request(this.attrs)};
sender.saveBefore=function(){var a=this.getEl("true_name"),b=this.getFormatValue("true_name");return!b.checkSpecialChar()||/[\ &\.\*]/.test(b)?(CC.alert(Lang.Mail.folder_NotInputChar,function(){a.focus();return!1}),!1):!0};sender.saveAfter=function(){try{var a=this.getFormatValue("true_name");gMain.trueName=a;this.ok(Lang.Mail.ConfigJs.person_successMod+"\uff01")}catch(b){}};var sign=new OptionBase;
sign.attrs={id:"sign",authority:"MAIL_CONFIG_MAILSIGN",divId:"pageSetSignature",list:{func:gConst.func.getSign,type:"url",data:{},count:0},save:{func:gConst.func.setSign,type:"xml",opType:{add:1,del:2,update:3}},data:{},bSend:!0,values:""};sign.list={};sign.init=function(){this.request(this.attrs,this.getHtml)};
sign.checkTitle=function(a,b){for(var c=p.attrs.values,d=c.length,e=0,e=0;e<d;e++)if(c[e].id!=b&&a==c[e].title.decodeHTML())jQuery("#editWrip"+b).css("display","inline"),jQuery("#emTip"+b).html(Lang.Mail.ConfigJs.signTitleExitsts),jQuery("#title"+b).focus(),p.attrs.bSend=!1};sign.checkContent=function(a){if(a.len()>4E3)CC.alert(Lang.Mail.ConfigJs.signCharacters),p.attrs.bSend=!1};
sign.save=function(a){jQuery("#emTip"+a).html(Lang.Mail.ConfigJs.titleRequired);jQuery("#editWrip"+a).css("display","none");p=sign;p.attrs.bSend=!0;var b="",b=sign["edit_"+a].getContent();if(jQuery("#title"+a).val().trim()=="")jQuery("#editWrip"+a).css("display","inline");else if(p.checkTitle(jQuery("#title"+a).val().trim(),a),p.checkContent(sign["edit_"+a].getContentTxt()),p.attrs.bSend!=!1){if(a==0){if(p.attrs.list.count>=5)return CC.showMsg(Lang.Mail.ConfigJs.signatureLimit,!0,!1,"error"),!1;b=
{opType:1,title:jQuery("#title0").val().trim(),content:b,isDefault:jQuery("#default0").is(":checked")?1:0,isAutoDate:jQuery("#autoDate0").is(":checked")?1:0,isHtml:1}}else b={opType:3,title:jQuery("#title"+a).val().trim(),content:b,isDefault:jQuery("#default"+a).is(":checked")?1:0,isAutoDate:jQuery("#autoDate"+a).is(":checked")?1:0,id:a,isHtml:1};p.ajaxRequest("user:signatures",b,function(){a==0&&p.attrs.list.count++;CC.showMsg(Lang.Mail.ConfigJs.signSuc,!0,!1,"option");p.init(p.attrs.id)},function(){p.fail(Lang.Mail.ConfigJs.setParaFail)},
"/RmWeb/mail?func=user:signatures&sid="+gMain.sid)}};sign.setSignList=function(a){var b=a.length,c={},d=0;signList.splice(0,signList.length);for(d=0;d<b;d++)c={content:a[d].content,id:a[d].id,isAutoDate:a[d].isAutoDate,isDefault:a[d].isDefault,isHtml:0,isSMTP:0,title:a[d].title,type:0},signList.push(c)};sign.edit=function(a,b,c,d,e,f){return sign.getEditHtml(a,b,c,d,e,f)};
sign.setDefaultSign=function(a,b,c,d,e){p=sign;for(var f=jQuery("#defaultBtn"+a).text()==Lang.Mail.ConfigJs.sign_btn_fault?1:0,g=document.getElementsByName("defaultBtn"),h=g.length,k=0;k<h;k++)g[k].innerHTML=Lang.Mail.ConfigJs.sign_btn_fault;jQuery(":checkbox[name=defaultCheckbox]").attr("checked",!1);f?(jQuery("#defaultBtn"+a).html(Lang.Mail.ConfigJs.sign_btn_not_fault),d=1,jQuery("#default"+a).attr("checked",!0)):d=0;b={opType:3,id:a,title:decodeURI(b).decodeHTML(),content:decodeURI(c).decodeHTML(),
isDefault:d,isAutoDate:e};p.ajaxRequest(p.attrs.save.func,b,function(){top.CC.showMsg(Lang.Mail.ConfigJs.signSuc,!0,!1,"option");sign.setSignListDefault(a,d)})};sign.setSignListDefault=function(a,b){for(var c=signList.length,d=0,d=0;d<c;d++)signList[d].isDefault=signList[d].id==a?b:0};sign.moveto=function(a){jQuery("#setWrapp").scrollTop(a)};
sign.getSignList=function(a){for(var b=[],c=2,d=a.length,d=d>5?5:d,e=0;e<d;e++){var f=a[e].id,g=a[e].title.encodeHTML(),h=a[e].content,k=a[e].isDefault,l=a[e].isAutoDate;sign.list[f]=a[e];c+=2;b+=sign.edit(f,g,h,k,l,c)}return b};
sign.getEditHtml=function(a,b,c,d,e){var f=[],g="";f.push("<div style='position:relative;' class='set-edit-wrap'>");a==0?(f.push('<table width="100%" class="set-edit-table" id=\''+a+"'><tbody><tr>"),g="<td class='titlePadding singtitleWidth' style='padding-top:5px'>",g+="<label>"+Lang.Mail.ConfigJs.title+"</label></td>"):(f.push('<table width="100%" id=\''+a+"'><tbody><tr>"),g="<td class='title_hide_w' style='height:31px; padding-bottom:0'>",g+='<a class="setSign-box-til" href="javascript:void(0);"  onclick=\'sign.showEdit(this); return false;\'>',
g+='<i class="i-sli" ></i></a>',g+="<em id='emText"+a+"'><font style='font-weight:bold'>"+b+"</font></em></td>");f.push(g);f.push(" <td  style='height:31px; padding-bottom:0' class='titleOper'>");f.push('<input type="text" value="'+b+"\" maxLength='15' name='titleText' ");f.push('class="rm_txt w284 hideText" id=\'title'+a+"'>");f.push(sign.getFalseTip("editWrip"+a,"emTip"+a,Lang.Mail.ConfigJs.titleRequired));f.push("</td>");g="";g=Lang.Mail.ConfigJs.sign_btn_fault;if(d)g=Lang.Mail.ConfigJs.sign_btn_not_fault;
a!=0?(f.push("<td id='signOp"+a+"' class='signOp ta_r' >"),f.push("<a href=\"javascript:void(0);\" name='defaultBtn' id='defaultBtn"+a+"' "),f.push('onclick="sign.setDefaultSign('+a+",'"+encodeURI(b).encodeHTML()+"','"+encodeURI(c).encodeHTML()+"',"+d+","+e+')">'+g+"</a>"),f.push("<a href=\"javascript:void(0);\" onclick='sign.showEdit(this)'>"+Lang.Mail.ConfigJs.modify+"</a>"),f.push('<a  href="javascript:void(0);" onclick=\'sign.delSign('+a+")'>"+Lang.Mail.ConfigJs.deleteO+"</a></td>"),g="style ='display:none'"):
(f.push("<td ></td>"),g="style = ''");f.push("</tr>");f.push("<tr "+g+">");f.push("<td valign=\"top\" class='titlePadding'>"+Lang.Mail.ConfigJs.content+"</td>");f.push('<td colspan="2">');f.push('<div id="edit_'+a+'" >');f.push("</div>");f.push("</td></tr>");f.push("<tr "+g+" class='signContent'>");f.push("<td>&nbsp;</td>");f.push("<td>");f.push('<a class="n_btn_on font-bold mr_10" onclick=sign.save(\''+a+"') id='save"+a+"'><span>");f.push("<span>"+Lang.Mail.ConfigJs.save+"</span></span></a>");f.push("<a class=\"n_btn font-bold mr_10\" id='cancel' ");
f.push(" onclick=\"sign.goBack('');\" ><span>");f.push("<span>"+Lang.Mail.ConfigJs.cancelTip+"</span></span></a>");f.push('<input type="checkbox" '+(d==1?"checked":"")+' class="rm_cb" id="default'+a+'" ');f.push("name='defaultCheckbox' >");f.push('<label class="mr_10"');f.push('for="default'+a+'">'+Lang.Mail.ConfigJs.sign_isdefault+"</label>");f.push('<input type="checkbox" class="rm_cb"  '+(e==1?"checked":"")+'  id="autoDate'+a+'" >');f.push('<label for="autoDate'+a+'">'+Lang.Mail.ConfigJs.automaticJoin+
"</label>");f.push("</td>");f.push('<td class="ta_r">&nbsp;</td>');f.push("</tr>");f.push("</tbody></table>");f.push("</div><\!--set-edit-wrap--\>");return f.join("")};
sign.getHtml=function(a,b){var c=sign,d=sign.getSignList(b);c.attrs.values=b;sign.setSignList(b);var e=[],f=function(){var a=[];a.push("<div class=\"set_rule_box\" id='sign_list' style='position:relative'>");a.push('<h2 class="set_til">'+Lang.Mail.ConfigJs.pref_signature+"<span>");a.push("("+Lang.Mail.ConfigJs.bottomTip+")</span></h2>");a.push("<h3 id='otherSet'>"+Lang.Mail.ConfigJs.otherSet+"<var id='num'> ");a.push("</var>"+Lang.Mail.ConfigJs.signtures+"</h3>");a.push('<div style="position:relative;">');
a.push(sign.getEditHtml(0,"","",0,0,2));return a.join("")}();e.push('<div class="bodySet bodyBwList"> ');e.push('<div id="container">');e.push(this.getTopHtml());e.push(this.getLeftHtml());e.push('<div class="setWrapper"  id="setWrapp">');e.push(f);e.push(d);e.push("</div></div></div></div></div>");MM[gConst.setting].update(c.attrs.id,e.join(""));pref.updatePosition("setWrapp");c.correctWidthInIE6("prefWrapper",1);jQuery("#title0").removeClass("hideText").focus();var g=b.length;sign.edit_0=UE.getEditor("edit_0",
{toolbars:["bold,fontfamily,fontsize,forecolor,backcolor,italic,underline,justifyleft,justifycenter,justifyright".split(",")],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",autoHeightEnabled:!1,initialFrameHeight:"160",sourceEditor:"textarea",isReload:!0});sign.edit_0.ready(function(){jQuery("#edit_0").html().length==0&&sign.edit_0.render("edit_0");jQuery("#num").html(5-(g>5?5:g))});sign.attrs.list.count=g};
sign.getRequest=function(a){var b=this,c=function(c){var e=b.getValue(c.id+a,c.type);c.type=="checkbox"&&(e=e=="1"?1:0);return e};return{opType:"",title:c({id:"title",type:"text",format:""}),content:c({id:"content",type:"textarea",format:"html"}),isDefault:c({id:"isDefault",type:"checkbox",format:"int"}),isAutoDate:c({id:"isAutoDate",type:"checkbox",format:"int"})}};
sign.delSign=function(a){var b=this;CC.confirm(Lang.Mail.ConfigJs.DeleteSign,function(){var c=b.getRequest(a);c.id=a-0;c.opType=b.attrs.save.opType.del;b.ajaxRequest(b.attrs.save.func,c,function(){CC.showMsg(Lang.Mail.ConfigJs.sign_info_del_success,!0,!1,"option");sign.init("",!0)})},Lang.Mail.ConfigJs.mailpop_sysPrompt)};
sign.setValues=function(a){var b=a.length;jQuery("#default0").attr("checked",!0);sign.attrs.list.count=b;for(var c=0;c<b;c++){var d=a[c].id,e=a[c].title,f=a[c].content,g=a[c].isDefault,h=a[c].isAutoDate;jQuery("#title"+d).val(e.decodeHTML());jQuery("#emText"+d).html("<font style='font-weight:bold'>"+jQuery("#title"+d).val().encodeHTML()+"</font>");f=f.decodeHTML();RTB_items[d].setEditorValue(f);RTB_items[d].active();g?jQuery("#default"+d).attr("checked",!0):jQuery("#default"+d).attr("checked",!1);
h?jQuery("#autoDate"+d).attr("checked",!0):jQuery("#autoDate"+d).attr("checked",!1);jQuery("cancel").click(function(){sign.goBack("")});var k=document.getElementById("save"+d);(function(a){k.onclick=function(){sign.save(a);return!1}})(d);jQuery("#title"+d).css("display","none")}var l=1;jQuery("input[name='titleText']").each(function(){jQuery(this).attr("tabindex",l);l+=2});sign.setSignList(a)};sign.switchFoc=function(a){window.event.keyCode==9&&document.getElementById("htmlEditor"+a).focus()};
sign.showEdit=function(a){function b(){a.text()==Lang.Mail.ConfigJs.modify?(c.find("tbody tr").slice(1).show(),jQuery(a).html(Lang.Mail.ConfigJs.fold),c.find("input").show(),c.find("em").html(Lang.Mail.ConfigJs.title),c.find("i").removeClass().addClass("i-sli-show"),c.find("td").eq(0).removeClass().addClass("title_show_w"),c.addClass("set-edit-table"),sign["edit_"+d].setContent(e.content.decodeHTML())):a.text()==Lang.Mail.ConfigJs.fold?(c.find("tbody tr").slice(1).hide(),jQuery(a).html(Lang.Mail.ConfigJs.modify),
c.find("em").html("<font style='font-weight:bold'>"+f+"</font>"),c.find("input").hide(),c.find("i").removeClass().addClass("i-sli"),c.find("td").eq(0).removeClass().addClass("title_hide_w"),c.removeClass("set-edit-table")):a.find("i").attr("class")=="i-sli"?(sign["edit_"+d].setContent(e.content.decodeHTML()),c.find("tbody tr").slice(1).show(),a.children().eq(0).removeClass(),a.children().eq(0).addClass("i-sli-show"),c.find("input").show(),c.find("em").html(Lang.Mail.ConfigJs.title),c.find("a").eq(2).html(Lang.Mail.ConfigJs.fold),
c.find("td").eq(0).removeClass().addClass("title_show_w"),c.addClass("set-edit-table")):(c.find("tbody tr").slice(1).hide(),a.children().eq(0).removeClass(),a.children().eq(0).addClass("i-sli"),c.find("em").html("<font style='font-weight:bold'>"+f+"</font>"),c.find("input").hide(),c.find("a").eq(2).html(Lang.Mail.ConfigJs.modify),c.find("td").eq(0).removeClass().addClass("title_hide_w"),c.removeClass("set-edit-table"))}var a=jQuery(a),c=a.closest("table"),d=c.attr("id"),e=sign.list[d],f=e.title.encodeHTML();
jQuery("#edit_"+d).html().length==0?(sign["edit_"+d]=UE.getEditor("edit_"+d,{toolbars:["bold,fontfamily,fontsize,forecolor,backcolor,italic,underline,justifyleft,justifycenter,justifyright".split(",")],autoClearinitialContent:!0,wordCount:!1,elementPathEnabled:!1,initialFrameWidth:"100%",autoHeightEnabled:!1,initialFrameHeight:"160",sourceEditor:"textarea",isReload:!0}),sign["edit_"+d].ready(function(){b()})):b()};var skin=new OptionBase;
skin.attrs={id:"skin",authority:"MAIL_CONFIG_SKIN",free:!0,listData:null,divId:"changeSkin",list:{type:"url",func:gConst.func.getSkinList,data:{}},save:{func:gConst.func.setUserSkin,type:"url",data:{}}};skin.init=function(){this.initService(this.attrs,this.getHtml)};
skin.getHtml=function(a,b){var c=[],d=this.listData=b;c.push(this.getNavMenu(a.id));c.push(this.getTopHtml());c.push(this.getLeftHtml());c.push('<div class="setWrapper" id="skinWrapper">');c.push('<div class="skin-page">');c.push('<p class="skin-topNote">\u70b9\u51fb\u56fe\u7247\u540e\u5373\u53ef\u76f4\u63a5\u66f4\u6362\u76ae\u80a4\uff0c\u5207\u6362\u540e\uff0c\u7cfb\u7edf\u81ea\u52a8\u4e3a\u60a8\u4fdd\u5b58\u3002</p>');for(var e=function(a){for(var b={},c=0;c<d.length;c++)if(d[c].skinTypeId==a){b=
d[c];break}return b},f=[],g=0;g<d.length;g++)f.push(d[g].skinTypeId);f=f.unique();for(g=0;g<f.length;g++){var h=f[g],k=e(h);c.push('<div class="skin-list">');c.push("<fieldset><legend>{0}</legend></fieldset>".format(k.skinTypeName));c.push('<ul class="skin-items m_clearfix">');for(k=0;k<d.length;k++){var l=d[k];if(h==l.skinTypeId){c.push('<li onclick="skin.save('+l.skinId+');" id="li_skin'+l.skinId+'">');var m="";l.isDefault==1&&(c.push('<em class="selected-skin"></em>'),m="skin-img-on");c.push('<a href="javascript:fGoto();" class="skin-img {0}">'.format(m));
c.push('<img src="{1}/images/{0}.jpg" width="90" height="90" alt="{2}"/>'.format(l.cssName,gMain.resourceRoot,l.skinName));c.push("</a>");c.push('<a href="javascript:fGoto();" class="skin-name">{0}</a>'.format(l.skinName));c.push("</li>")}}c.push("</ul>");c.push("</div>")}c.push("</div><\!--skin-page--\>");c.push("</div>");MM[gConst.setting].update(this.attrs.id,c.join(""));skin.updatePosition("skinWrapper")};
skin.save=function(a){var b=this;b.doService(b.attrs.save.func,{skinId:a},function(c){if(c.code=="S_OK")c=b.getRowData(a),gMain.userSkinConfig=c.cssName,b.setDefaultSkin(c),ChangeSkin.changeLink("topLinks",c.cssName),ChangeSkin.changeLink("iframeLinks",c.cssName)},function(a){a.summary?b.fail(a.summary):b.fail(Lang.Mail.ConfigJs.loginNotifyFail,a)})};skin.getRowData=function(a){for(var b,c=0;c<this.listData.length;c++)if(this.listData[c].skinId==a){b=this.listData[c];break}return b};
skin.setDefaultSkin=function(a){var b=jQuery("#imgLogo"),c=b.attr("src"),d=parent.gMain.skinPath||"/se/images/skin",e=a.cssName.replace("skin_",""),e=parent.gMain.resourceServer+d+"/"+e+"/logo.png";c?b.attr("src",e):jQuery.browser.msie&&jQuery.browser.version=="6.0"&&!jQuery.support.style&&b.attr("style","DISPLAY: inline-block; FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='{0}{1}/{2}/logo.png', sizingMethod='scale'); WIDTH: 170px; HEIGHT: 60px".format(parent.gMain.resourceServer,
d,a.cssName.replace("skin_","")));b=jQuery("#skinWrapper").find("li");for(c=0;c<b.length;c++)d=jQuery(b[c]),(e=d.find("em"))&&e.remove(),jQuery(d.find("a").get(0)).attr("class","skin-img");a=jQuery("#li_skin"+a.skinId);a.prepend('<em class="selected-skin"></em>');jQuery(a.find("a").get(0)).attr("class","skin-img skin-img-on")};
