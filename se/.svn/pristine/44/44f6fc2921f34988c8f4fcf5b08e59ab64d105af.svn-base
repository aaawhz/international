var Ajax={_objPool:[],_createObject:function(){var a=null;if(window.ActiveXObject)for(var b="MSXML2.XMLHttp.6.0,MSXML2.XMLHTTP.5.0,MSXML2.XMLHTTP.4.0,MSXML2.XMLHTTP.3.0,MSXML2.XMLHTTP,Microsoft.XMLHTTP".split(","),c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break}catch(d){}else a=new XMLHttpRequest;return a},getXMLHttp:function(){return this._createObject()},response:function(a,b,c,d){c=a.getResponseHeader("Content-Type");b||(b=c.indexOf("text/html")>-1||c.indexOf("application/html")>-1?"html":
c.indexOf("text/xml")>-1||c.indexOf("application/xml")>-1?"xml":c&&c.trim().match(/^(text|application)\/(x-)?(java|ecma)script(;.*)?$/i)?"script":"none");a=b=="xml"?a.responseXML:a.responseText;try{switch(b){case "script":a=eval(a);break;case "mailjson":a=eval("ajaxResponseJsonData="+a);break;case "json":a=JSON.parse(a)}}catch(e){Ajax.error(d,"Ajax.response",e)}return a},mailResponse:function(a){a=a.trimAll();return eval("ajaxResponseJsonData="+a)},request:function(a){function b(){var a=s.status;
a>=200&&a<300||a==304?g(Ajax.response(s,k,u,j),j):(typeof h=="function"&&h({code:gConst.statusNo,"var":"http response error t="+a},j),Ajax.error(j,"Ajax.requst.ajaxResponseCallBack","http response error t="+a),CC.hideMsg(!0));Ajax.log(gConst.logFunc.resp,j,"resp="+(IsWriteLog==2?s.responseText:a))}function c(a){a.lefts(4)=="http"||a.lefts(1)=="/"||location.href.lefts(location.href.lastIndexOf("/")+1);return a}CC.checkNetwork(!0);var d,e,f=typeof a.async=="boolean"?a.async:!0,g=a.callback||Util.emptyFunction,
h=a.failCall||null,j=a.url||"",n=(a.method||"get").toLowerCase(),k=(a.resType||"").toLowerCase(),q=a.param||"",t=(a.data||q).replace(/[\x00-\x08\x0b\x0e-\x1f]/g,"");d=a.head||[];var u=a.encode||"utf-8";e=a.noSetCT||!1;if(j){j=c(j);n=="get"&&q.length>0&&(j+=(j.match(/\?/)?"&":"?")+q);var j=GC.rfUrl(j),s=a.xmlHttp||this.getXMLHttp(),q={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"text/javascript",mailjson:"text/javascript",_default:"*/*"},a=
[];e||(a[a.length]="Content-Type",a[a.length]="application/x-www-form-urlencoded; charset="+u);a[a.length]="Cache-Control";a[a.length]="no-cache";a[a.length]="Accept";a[a.length]=q[k]?q[k]:q._default;if(n=="post")a[a.length]=t.length,s.overrideMimeType&&(a[a.length]="close");a=a.concat(d);s.open(n,j,f);for(d=0,e=a.length;d<e;d+=2)try{s.setRequestHeader(a[d],a[d+1])}catch(r){window.console&&console.error(r)}if(f)s.onreadystatechange=function(){if(s.readyState==4)try{typeof b=="function"&&(b(),s=null)}catch(a){s=
null,Ajax.error(j,"Ajax.requst.ajaxResponseCallBack",a)}};(new Date).getTime();try{Ajax.log(gConst.logFunc.req,j,IsWriteLog==2?t:""),s.send(n=="post"?t:null)}catch(w){Ajax.error(j,"Ajax.send",w)}f||callBack();return s}},mailRequest:function(a){var b=a.mailCall,c=[],d=a.data;c.push("Content-Type");d?c.push("application/xml; charset=utf-8"):c.push("application/x-www-form-urlencoded; charset=utf-8");a.callback=function(a,c){try{var d=Util.getVarType(a);d=="string"&&(a=Ajax.mailResponse(a),d=Util.getVarType(a));
if(d=="object")b(a);else return Ajax.error(c,"Ajax.mailRequest.mailRequestCall","Data type error.")}catch(h){return Ajax.error(c,"Ajax.mailRequest.mailRequestCall"+h)}};a.resType="mailjson";a.encode="utf-8";a.head=c;a.method=a.method||"post";a.noSetCT=!0;Ajax.request(a)},post:function(a,b,c,d){d=d||{};Ajax.request({url:a,method:"post",callback:c,data:b,async:d.async,resType:d.resType,encode:d.encode})},get:function(a,b,c){c=c||{};a={url:a,method:"get",callback:b,param:c.param,async:c.async,resType:c.resType,
encode:c.encode};if(typeof c.xmlHttp=="object")a.xmlHttp=c.xmlHttp;Ajax.request(a)},submit:function(a,b,c){function d(){var a=window.frames[gConst.ifrmForSubmit];try{g(a)}catch(b){}}function e(){try{var b=document.getElementById(gConst.ifrmForSubmit),c=b.contentWindow.document;c.body.innerHTML=a;var f=c.forms[0];f.method="post";if(h)f.action=h;f.submit();typeof g=="function"&&GC.fireDocReady(d,b)}catch(e){}}function f(a){for(var b=[],c=0;c<a.elements.length;c++){var d=a.elements[c].name,f="";a.elements[c].type==
"checkbox"||a.elements[c].type=="radio"?a.elements[c].checked?(d+="=",f=a.elements[c].value):f=d="":(d+="=",f=a.elements[c].value);d!=""&&(d+=f,b.push(d))}return b.join("&")}var b=b||{},g=b.call,h=b.url,j=b.method;b.resType&&b.resType!=""&&b.resType.toLowerCase();var n=b.resType=="maildata"?Ajax.mailRequest:Ajax.request;c?(b=document.getElementById(gConst.ifrmForSubmit),j=="get"?(h=h||a,b.src=GC.rfUrl(h),typeof g=="function"&&GC.fireDocReady(d,b)):(b.src=GC.rfUrl("/cmail2009/blank.htm"),GC.fireDocReady(e,
b))):(j=="get"?(h=h||a,b.url=GC.rfUrl(h)):(j=document.getElementById(gConst.divForSubmit),j.innerHTML=a,j=j.getElementsByTagName("form")[0],b.data=f(j),j.innerHTML="",b.method="post",b.url=b.url||j.action),n(b))},error:function(a,b,c){b="method="+b+" | summary="+c;IsDebug&&CC.alert(Lang.Mail.fail+","+b);Util.writeLogError(gConst.logFunc.js,a,b+" | stack="+Util.getStack());CC.hideMsg();return!1},logError:function(a,b){try{IsWriteLog&&GC.getUrlParamValue(a,"func").inStr(gMain.webLogFunc)&&Util.writeLogError(gConst.logFunc.js,
a,b)}catch(c){}},log:function(a,b,c){try{IsWriteLog&&GC.getUrlParamValue(b,"func").inStr(gMain.webLogFunc)&&Util.writeLog(a,b,c)}catch(d){}}};
function Class(){this.emptyFunction=function(){return function(){}};this.createClass=function(){return function(){this.initialize&&this.initialize.apply(this,arguments)}};this.event={"var":{},method:[],target:[]};this.initMethod=function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];typeof a.prototype[e]!="undefined"&&(a.prototype["_"+e]=function(a){return function(){cmail.event.target.push(this.name);cmail.event.method.push(a);var b=this.name+"__"+a;cmail.event["var"][b]={};if(this["onbefore"+
a])try{this["onbefore"+a].apply(this,arguments)}catch(c){ch(b+":onbefore("+arguments[0]+")",c)}try{var d=this[a].apply(this,arguments)}catch(e){ch(b+"("+arguments[0]+")",e)}if(this["onafter"+a])try{var k=this["onafter"+a].apply(this,arguments)}catch(q){ch(b+":onafter("+arguments[0]+")",q)}cmail.event["var"][b]=null;cmail.event.target.pop();cmail.event.method.pop();return d||k}}(e))}};this.Delegate=function(a){this.hash=new Hashtable([]);this.add=function(a){this.hash.add(a)};this.remove=function(a){this.hash.removeByObj(a)};
this.run=function(){var a=arguments;this.hash.each(function(c,d){d.apply(this,a)})};a&&this.add(a)};this.getVar=function(a){try{return this.event["var"][this.event.target[this.event.target.length-1]+"__"+this.event.method[this.event.method.length-1]][a]}catch(b){ch("fGetVar",b)}};this.setVar=function(a,b){var c=this.event.target[this.event.target.length-1]+"__"+this.event.method[this.event.method.length-1];this.event["var"][c]||(this.event["var"][c]={});this.event["var"][c][a]=b};this.setReturn=function(a){var b=
this.event.target[this.event.target.length-1]+"__"+this.event.method[this.event.method.length-1];this.event["var"][b]||(this.event["var"][b]={});this.event["var"][b]["return"]=a};this.getReturn=function(a){if(cmail.event["var"][a]){var b=cmail.event["var"][a]["return"];if(typeof b!="undefined")return cmail.event["var"][a]=null,b}}}var cmail=new Class,El=cmail.createClass(),EV=cmail.createClass(),Email=cmail.createClass(),Hashtable=cmail.createClass(),$continue={},$break={};
(function(){var a=cmail.createClass(),b=cmail.createClass(),c=cmail.createClass(),d=cmail.createClass(),e=cmail.createClass();Object.extend=function(a,b){for(var c in b)a[c]=b[c];return a};Object.clone=function(a){var b;b=a.constructor==Object?new a.constructor:new a.constructor(a.valueOf());for(var c in a)b[c]!=a[c]&&(b[c]=typeof a[c]=="object"?Object.clone(a[c]):a[c]);return b};a.prototype={add:function(a){var b=0,c=b=0,d=a.toString(),e=this.toString();try{if(d.indexOf(".")>-1)b=d.split(".")[1].length}catch(k){b=
0}try{if(e.indexOf(".")>-1)c=e.split(".")[1].length}catch(q){c=0}b=Math.pow(10,Math.max(b,c));return(a*b+this*b)/b},mul:function(a){var b=0,a=a.toString(),c=this.toString();try{a.indexOf(".")>-1&&(b+=a.split(".")[1].length)}catch(d){}try{c.indexOf(".")>-1&&(b+=c.split(".")[1].length)}catch(e){}return Number(a.replace(".",""))*Number(c.replace(".",""))/Math.pow(10,b)},div:function(a){var b=0,c=0,d;d=this.toString();a=a.toString();try{if(d.indexOf(".")>-1)b=d.split(".")[1].length}catch(e){}try{if(a.indexOf(".")>
-1)c=a.split(".")[1].length}catch(k){}d=Number(d.replace(".",""));a=Number(a.replace(".",""));return d/a*Math.pow(10,c-b)}};Object.extend(Number.prototype,new a);b.prototype={stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},escapeHTML:function(){var a=document.createElement("div"),b=document.createTextNode(this);a.appendChild(b);return a.innerHTML},unescapeHTML:function(){var a=document.createElement("div"),b=this.stripTags();return b?(a.innerHTML=b,a.childNodes[0].nodeValue):b},decodeHTML:function(){var a;
a=this.replace(/&lt;/gi,"<");a=a.replace(/&gt;/gi,">");a=a.replace(/&quot;/gi,'"');a=a.replace(/&nbsp;/gi," ");a=a.replace(/&apos;/gi,"'");a=a.replace(/&#39;/gi,"'");return a=a.replace(/&amp;/gi,"&")},encodeHTML:function(){var a;a=this.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\"/g,"&quot;");a=a.replace(/ /g,"&nbsp;");return a=a.replace(/\'/g,"&#39;")},encodeXML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;").replace(/'/g,"&apos;")},decodeXML:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")},toCData:function(){return"<![CDATA[ "+this+" ]]\>"},toDate:function(){return new Date(this.replace(/-/g,"/"))},toInt:function(){var a=parseInt(this,10);return isNaN(a)?0:a},trim:function(){return this.replace(/(^\s*)|(\s*$)/g,"")},trimAll:function(){return this.replace(/[\s\t]*/g,"")},checkSpecialChar:function(){return this.search(/[,%\'\"\/\\;|\<\>\^]/)!=
-1?!1:!0},len:function(){for(var a=0,b=0,c=this.length;b<c;b++)this.charCodeAt(b)>255?a+=2:a++;return a},lefts:function(a,b){var c=this;this.length>a&&(c=this.substring(0,a),b&&(c+="..."));return c},rights:function(a){return this.substring(this.length-a,this.length)},left:function(a,b){var c=0,d=0,e=this;if(this.len()<=a)return e;for(;d<a;)this.charCodeAt(c)>255?d+=2:d++,c++;e=this.substring(0,c);e.len()>a&&(e=e.substring(0,e.length-1));b&&(e+="...");return e},right:function(a){var b=this.len(),c=
0,d=0;if(b<=a)return this;for(;d<a;)this.charCodeAt(b-1-c)>255?d+=2:d++,c++;b=this.length;c=this.substring(b-c,b);c.len()>a&&(c=c.substring(1,c.length));return c},isNumber:function(){return this.search(/^\d+$/g)==0},posIndexOf:function(a,b){var c=this.split(a);if(c.length-1<b)return-1;else{for(var d=0,e=0,k=a.length;e<b;e++)d+=c[e].length,d+=k;return d-a.length}},parseJson:function(){try{var a=this,b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+a+")")}catch(c){return ch("fStringParseJson",c),!1}},stripScripts:function(){return this.replace(RegExp("<script[^>]*>([\u0001-\uffff]*?)<\/script>","img"),"")},inStr:function(a,
b){return RegExp("\\b"+this+"\\b",b?"":"i").test(a)},format:function(){if(arguments.length>0){var a=this;if(arguments.length==1&&typeof args=="object")for(var b in args)var c=RegExp("({"+b+"})","g"),a=a.replace(c,args[b]);else for(b=0;b<arguments.length;b++)if(arguments[b]==void 0)return"";else c=RegExp("({["+b+"]})","g"),a=a.replace(c,arguments[b]);return a}else return this}};Object.extend(String.prototype,new b);c.prototype={exchange:function(a,b){if(!(Math.max(0,a,b)<0||Math.min(this.length-1,
a,b)>this.length-1)){var c=this[a];this[a]=this[b];this[b]=c}},remove:function(a,b){for(var b=Math.max(b||0,0),c=a.length-1;c>=0;c--)this.splice(a[c]+b,1)},escapeNull:function(){for(var a=[],b=0,c=this.length;b<c;b++)this[b]&&(a[a.length]=this[b]);return a},clone:function(a){var b=[];if(a){for(a=0;a<this.length;a++)b.push(Object.clone(this[a]));return b}else return this.slice(0)},subtract:function(a){for(var b=[],c=0;c<this.length;c++){var d=this[c];d!=a&&(b[b.length]=d)}return b},filter:function(a){for(var b=
0,c=this[b];b<this.length;b++)this[b]=c.replace(a,"")},each:function(a){for(var b=0,c=this.length;b<c;b++)try{a(b,this[b])}catch(d){if(d==$break)break;else if(d!=$continue)throw d;}},has:function(a){var b=!1;this.each(function(c,d){d==a&&(b=!0)});return b},toString:function(a){return this.join(a||"")},unique:function(a){var b={};if(typeof a=="function"){this.each(function(c,d){var e=a(d);typeof b[e]=="undefined"&&e!=""&&(b[e]=d)});this.length=0;for(var c in b)this[this.length]=b[c]}else{this.each(function(a,
c){if(typeof b[c]=="undefined"&&(typeof c=="number"||c!=""))b[c]=typeof c=="number"?1:2});this.length=0;for(var d in b)this[this.length]=b[d]==1?parseInt(d,10):d}return this},strip:function(){if(this.length<2)return[];for(var a=[],b=[],c=0;c<this.length;c++){a.push(this.splice(c--,1).toString());for(var d=0;d<this.length;d++)this[d]==a[a.length-1]&&b.push(this.splice(d--,1).toString())}return b}};Object.extend(Array.prototype,new c);d.prototype={dateAdd:function(a){return new Date(this.valueOf()+
a*864E5)},addMonth:function(a){this.setMonth(this.getMonth()+a);return this},addMilliseconds:function(a){return new Date(this.valueOf()+a)},format:function(a){return Util.formatDate(this,a)},dateDiff:function(a){try{return a=a instanceof Date?a:new Date(a),this.getTime()-a.getTime()}catch(b){return 0}}};Object.extend(Date.prototype,new d);e.prototype={apply:function(a,b){var c;a?(a._caller=this,c=" obj._caller "):c=" this ";for(var d=[],e=0,k=b.length;e<k;e++)d[e]=" argu[ "+e+" ] ";return eval(c+
" ( "+d.join(" , ")+" ); ")},call:function(a){for(var b=[],c=1,d=arguments.length;c<d;c++)b[c-1]=arguments[c];return this.apply(a,b)},bind:function(){var a=this,b=(new Hashtable(arguments)).toArray(),c=b.shift();return function(){return a.apply(c,b.concat((new Hashtable(arguments)).toArray()))}}};typeof Function.prototype.apply!="function"&&Object.extend(Function.prototype,new e);Function.prototype.bind=function(){var a=this,b=(new Hashtable(arguments)).toArray(),c=b.shift();return function(){return a.apply(c,
b.concat((new Hashtable(arguments)).toArray()))}};Hashtable.prototype={initialize:function(){this.ks={};this.type="object";this.isHash=!0;if(arguments.length>0){var a=arguments[0];if(typeof a=="object")if(this.isArray(a)){this.type="array";this.ks=[];for(var b=0,c=a.length;b<c;b++)this.add(b,a[b])}else for(b in a)this.add(b,a[b])}},add:function(a,b){b&&b.nodeType&&b.nodeType==1&&(b=$(b));a&&a.nodeType&&a.nodeType==1&&(a=$(a));return this.type=="object"?typeof a!="undefined"?this.contains(a)==!1?(this.ks[a]=
typeof b=="undefined"?null:b,!0):!1:!1:typeof b!="undefined"&&typeof a!="undefined"?(this.ks[a]=b,!0):typeof a!="undefined"?(this.ks[this.ks.length]=a,!0):!1},remove:function(a){delete this.ks[a]},removeByObj:function(a){for(var b in this.ks)if(this.ks[b]==a)this.Asf=="array"?this.ks=this.ks.splice(b):delete this.ks[b]},count:function(){if(this.type=="array")return this.ks.length;var a=0,b;for(b in this.ks)a++;return a},items:function(a){return this.ks[a]},contains:function(a){return typeof this.ks[a]!=
"undefined"},has:function(a){for(var b in this.ks)if(this.ks[b]==a)return!0;return!1},clear:function(){for(var a in this.ks)delete this.ks[a]},join:function(a){var b=[],c;for(c in this.ks)b[b.length]=this.ks[c]+"";return b.join(a)},each:function(a){try{if(this.type=="object")for(var b in this.ks)try{a(b,this.ks[b])}catch(c){if(c!=$continue)throw c;}else for(b=0;b<this.ks.length;b++)try{a(b,this.ks[b])}catch(d){if(d!=$continue)throw d;}}catch(e){if(e!=$break)throw e;}},toArray:function(){var a=[];
this.each(function(b,c){a[a.length]=c});return a},isArray:function(a){return a&&a instanceof Array}};Email.Value=cmail.createClass();Email.Value.prototype={name:"",value:"",email:"",toString:function(a){return a?this.value:'"'+this.name+'" <'+this.value+">"},initialize:function(a,b){this.name=a;this.value=b;this.email='"'+a+'" <'+b+">"}};Email.match=function(a){var b="",c="",a=(a||"").trim(),a=a.replace(/\r\n|\n|\t/g,""),d=[];d[d.length]=/^(([A-Z0-9._%-]{1,255})@[A-Z0-9._%-]+\.[A-Z0-9]{1,10})$/i;
d[d.length]=/^["'](.*?)["']\s*<([A-Z0-9._%-]{1,255}@[A-Z0-9._%-]+\.[A-Z0-9]{1,10})>$/i;d[d.length]=/^["'](.*?)\s*<([A-Z0-9._%-]{1,255}@[A-Z0-9._%-]+\.[A-Z0-9]{1,10})>["']$/i;d[d.length]=/^(.*?)\s*<([A-Z0-9._%-]{1,255}@[A-Z0-9._%-]+\.[A-Z0-9]{1,10})>$/i;if(!a)return!1;var e=null;try{for(var k=0;k<d.length;k++)if(e=d[k].exec(a),e!=null)return k==0?(c=e[1],b=e[2]):(c=e[2],b=e[1]),new Email.Value(b.trim(),c.trim());return!1}catch(q){return!1}};Email.get=function(a,b){var c=new Email,d=[];if(typeof a==
"string"&&a.trim()!=""){var e=a.replace(/\r\n|\n/g,""),e=e.replace(/[,;\uff0c\uff1b]+/g,","),e=e.replace(/^,|,$/g,"");e.split(",").each(function(a,b){var e=Email.match(b);e?c.add(e):d.push(b.encodeHTML())})}else typeof a=="object"&&a instanceof Array&&a.each(function(a,b){var e=Email.match(b);e?c.add(e):d.push(b.encodeHTML())});b&&(c.unique(),d=d.unique());return{success:c,fail:d}};Email.getEmailString=function(a,b,c){return Email.get(a,!0).success.toString(c,b)};Email.getName=function(a){var b=Email.match(a);
return b?b.name.trim()==""&&a.indexOf(">")&&(a=Email.match(a.substr(a.indexOf("<")+1,a.indexOf(">")-a.indexOf("<")-1)))?a.name:b.name:a};Email.getValue=function(a){return(a=Email.match(a))?a.value:a};Email.format=function(a){try{return(a+"").replace(/(\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)/g,'<a href="mailto:$1">$1</a>')}catch(b){return ch("Email.Format",b),a}};Email.prototype={add:function(a){if(typeof a=="string")return(a=Email.match(a))&&this.list.push(a),a;else if(a instanceof Object)return this.list.push(a),
a;return null},unique:function(){this.list=this.list.unique(function(a){return a.value})},remove:function(a){this.each(function(b,c){c.value==a&&this.list.splice(b,1)})},has:function(a){var b=!1;this.each(function(c,d){d.value==a&&(b=!0)});return b},each:function(a){for(var b=0;b<this.list.length;b++)a(b,this.list[b])},toString:function(a,b){var c;return this.toArray(b).join(a||";")},toArray:function(a){var b=[];this.each(function(c,d){b.push(d.toString(a))});return b},initialize:function(){this.list=
[]}};El.visible=function(a){if(arguments.length==0)throw"\u8bf7\u4f7f\u7528El.visible\uff0c\u5e76\u4e14\u9700\u8981\u53c2\u6570";return a==void 0||a.style.display=="none"?!1:!0};El.toggle=function(){if(arguments.length!=0)for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);b&&(El.visible($(b))?El.hide(b):El.show(b))}};El.hide=function(){if(arguments.length!=0)for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);if(b)b.style.display="none"}};El.show=function(){if(arguments.length!=0)for(var a=
0;a<arguments.length;a++){var b=$(arguments[a]);if(b)b.style.display="block"}};El.remove=function(){if(arguments.length!=0)for(var a,b=0;b<arguments.length;b++)if(a=$(arguments[b]))a.innerHTML="",a.parentNode&&a.parentNode.removeChild(a),Browser.isIE&&a.removeNode()};El.removeChildNodes=function(a){if(a){var b=a.childNodes;if(b)for(var c=b.length-1;c>-1;c--)a.removeChild(b[c])}};El.insertElement=function(a,b,c){try{if(arguments.length!=2){var d=a.parentNode;if(d){for(var e=d.childNodes.length,k=-1,
q=0;q<e;q++)d.childNodes[q]==a&&(k=q);c=="beforeEnd"?a.appendChild(b):c=="afterEnd"?k==e-1?d.appendChild(b):d.insertBefore(b,d.childNodes[k+1]):c=="beforeBegin"?d.insertBefore(b,a):c=="afterBegin"&&(a.childNodes.length==0?a.appendChild(b):a.insertBefore(b,a.childNodes[0]))}}}catch(t){ch("fInsertElement",t.description)}};El.prev=function(a){try{if(a){var b=a.parentNode;El.cleanWhitespace(b);for(var c=b.childNodes,b=0,d=c.length;b<d;b++)if(c[b]==a)return b==0?null:c[b-1]}}catch(e){ch("El.prev()",e.description)}};
El.next=function(a){try{if(a){var b=a.parentNode;El.cleanWhitespace(b);for(var c=b.childNodes,b=0,d=c.length;b<d;b++)if(c[b]==a)return b==d-1?null:c[b+1]}}catch(e){ch("El.next()",e.description)}};El.createElement=function(a,b,c,d,e){d=d||document;if(b){var k=d.getElementById(b);k&&El.remove(k)}e=e||{};try{var q=d.createElement(a);if(b)q.id=b;if(c)q.className=c;for(var t in e)q.setAttribute(t,e[t]);return q}catch(u){return null}};El.setAttr=function(a,b){if(arguments.length!=1)for(var c in b)a[c]=
b[c]};El.setAttribute=function(a,b){if(arguments.length!=1)for(var c in b)a.setAttribute(c,b[c])};El.removeAttr=function(a,b){for(var c=0;c<b.length;c++)a.removeAttribute(b[c])};El.setStyle=function(a,b){if(arguments.length>=2)for(var c in b)a.style[c]=b[c]};El.addClass=function(a,b){if(arguments.length>=2){var c=a.className.trim();if(c){if((" "+c+" ").indexOf(" "+b+" ")==-1)a.className=c+" "+b}else a.className=b}};El.removeClass=function(a,b){if(arguments.length>=2)if(b){for(var c=a.className.split(" "),
d=[],e=!1,k=0;k<c.length;k++)c[k].trim()!=b?d[d.length]=c[k]:e=!0;if(e)c=d.join(" ").trim(),a.className=c?d.join(" ").trim():""}else a.className=""};El.setClass=function(a,b){if(arguments.length==2&&a)a.className=b};El.delClass=function(a,b){if(arguments.length>=2)a.className=a.className.replace(b,"")};El.getX=function(a){if(a){for(var b=a.offsetLeft,a=a.offsetParent;a;)b+=a.offsetLeft,a=a.offsetParent;return b}};El.getY=function(a){if(a){for(var b=a.offsetTop,a=a.offsetParent;a;)b+=a.offsetTop,a=
a.offsetParent;return b}};El.getParentNodeIsTag=function(a,b){for(var b=b.toLowerCase(),a=$(a),c=0,d=null;a&&c<20;){var e=El.getNodeType(a);if(e==b){d=a;break}else if(e=="body")break;else a=a.parentNode,c++}return d};El.getParentNodeIsId=function(a){id=id.toLowerCase();for(var a=$(a),b=0,c=null;a&&b<20;){var d=El.getNodeType(a);if(d==tag){c=a;break}else if(d=="body")break;else a=a.parentNode,b++}return c};El.pos=function(a,b){if(a)if(b){if(typeof b.left!="undefined")a.style.left=(b.left>0?b.left:
0)+"px";if(typeof b.top!="undefined")a.style.top=(b.top>0?b.top:0)+"px"}else{var c=0,d=0;do c+=a.offsetTop||0,d+=a.offsetLeft||0,a=a.offsetParent;while(a);return[d,c]}};El.replace=function(a,b){if(b){a=$(a);if(a.outerHTML)a.outerHTML=b;else{var c=a.ownerDocument.createRange();c.selectNodeContents(a);a.parentNode.replaceChild(c.createContextualFragment(b),a)}return a}};El.getSize=function(a){if(!a||!$(a).style)return{width:0,height:0};var a=$(a),b=$(a).style.display;if(b!="none"&&b!=null)return{width:a.offsetWidth,
height:a.offsetHeight};var b=a.style,c=b.visibility,d=b.position,e=b.display;b.visibility="hidden";b.position="absolute";b.display="block";var k=a.clientWidth,a=a.clientHeight;b.display=e;b.position=d;b.visibility=c;return{width:k,height:a}};El.getDimensions=function(a){return El.getSize(a)};El.height=function(a,b){if(b)El.setSize(a,{height:b});else return El.getSize(a).height};El.width=function(a,b){if(b)El.setSize(a,{width:b});else return El.getSize(a).width};El.cleanWhitespace=function(a){if(a){for(var a=
$(a),b=a.childNodes,c=b.length-1;c>-1;c--){var d=b[c];d.nodeType==3&&!/\S/.test(d.nodeValue)&&a.removeChild(d)}return a}};El.descendantOf=function(a,b){if(b){for(var c=$(a),b=$(b);c;){if(c==b)return!0;c=c.parentNode}return!1}};El.setSize=function(a,b){if(arguments.length!=1&&a){if(typeof b.width!="undefined")a.style.width=(b.width>0?b.width:0)+"px";if(typeof b.height!="undefined")a.style.height=(b.height>0?b.height:0)+"px"}};El.docHeight=function(a,b){try{var c=window.document,d=window;if(a)d=a,c=
a.document;return b?d.innerHeight||c.body.offsetHeight:Browser.isIE?d.innerHeight||c.documentElement.clientHeight:d.innerHeight}catch(e){}};El.docWidth=function(a){try{var b=document,c=self;if(a)c=a,b=a.document;return Browser.isIE?b.documentElement.offsetWidth||b.body.offsetWidth:c.innerWidth}catch(d){}};El.getNodeType=function(a,b){var c=a.tagName;if(c)return c=c.toLowerCase(),(c=="input"&&b?a.type:c).toLowerCase()};El.getCursorPos=function(a){if(document.selection)a.focus(),document.selection.createRange().moveStart("character",
-a.value.length);else if(a.selectionStart||a.selectionStart=="0")CaretPos=a.selectionStart;return CaretPos};El.setCursorPos=function(a,b){if(a){var c=b,c=this.getNodeType(a),c=c=="text"||c=="textarea"?a.value.length:a.innerHTML.length;b&&b>0&&(c=b);if(a.setSelectionRange)a.focus(),a.setSelectionRange(c,c);else if(a.createTextRange){var d=a.createTextRange();d.collapse(!0);d.moveEnd("character",c);d.moveStart("character",c);d.select()}}};El.ready=function(a,b){function c(){e||(e=!0,a())}b=b||{};this.conf=
{enableMozDOMReady:!0};if(b)for(var d in b)this.conf[d]=b[d];var e=!1;Browser.isIE?(function(){if(!e){try{document.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}c()}}(),window.attachEvent("onload",c)):(Browser.value=="webkit"&&Browser.version<525?function(){e||(/loaded|complete/.test(document.readyState)?c():setTimeout(arguments.callee,0))}():(!Browser.value=="firefox"||Browser.version!=2||this.conf.enableMozDOMReady)&&document.addEventListener("DOMContentLoaded",
function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1);c()},!1),window.addEventListener("load",c,!1))};El.getParentWin=function(a,b){var c="";if(a&&b)for(var d=a;d!=b;)d=a.parent,c+="parent.";return c};El.getSelect=function(a){a=a||window;a.document.selection?a.document.selection.createRange():window.getSelection()&&window.getSelection()};El.gc=function(a){if(a)try{for(var b="onmouseover,onmouseout,onmousedown,onmouseup,onmousemove,ondblclick,onclick,onselectstart,oncontextmenu,onkeyup,onkeydown,onkeypress,onload".split(","),
c=0;c<b.length;c++)a[b[c]]=null;if(a.childNodes)for(c=0,l=a.childNodes.length;c<l;c++)El.gc(a.childNodes[c])}catch(d){}};EV.getTarget=function(a,b){a||(a=this.getEvent());var c=a.target||a.srcElement;return b&&c&&"#text"==c.nodeName?c.parentNode:c};EV.getEvent=function(a){a=window.event||a;if(!a&&!Browser.isIE)for(var b=[],c=this.getEvent.caller;c;){if((a=c.arguments[0])&&(a.constructor==Event||a.constructor==MouseEvent))break;for(var d=!1,e=0;e<b.length;e++)if(c==b[e]){d=!0;break}if(d)break;else b.push(c);
c=c.caller}return a};EV.getCharCode=function(a){a||(a=this.getEvent());return a.charCode||a.keyCode};EV.stopEvent=function(a){a||(a=this.getEvent());this.stopPropagation(a);this.preventDefault(a)};EV.stopPropagation=function(a){a||(a=this.getEvent());if(a)a.stopPropagation?a.stopPropagation():a.cancelBubble=!0};EV.preventDefault=function(a){a||(a=this.getEvent());if(a)a.preventDefault?a.preventDefault():a.returnValue=!1};EV.pointerX=function(a){a||(a=this.getEvent());var b=document;return a.pageX||
a.clientX+(b.documentElement.scrollLeft||b.body.scrollLeft)};EV.pointerY=function(a){a||(a=this.getEvent());var b=document;return a.pageY||a.clientY+(b.documentElement.scrollTop||b.body.scrollTop)};EV.observers=!1;EV.observeAndCache=function(a,b,c,d){if(!this.observers)this.observers=[];a.addEventListener?(this.observers.push([a,b,c,d]),a.addEventListener(b,c,d)):a.attachEvent&&(this.observers.push([a,b,c,d]),a.attachEvent("on"+b,c))};EV.unloadCache=function(){if(this.observers){for(var a=0;a<this.observers.length;a++)this.stopObserving(this.observers[a][0],
this.observers[a][1],this.observers[a][2],this.observers[a][3]),this.observers[a][0]=null;this.observers=!1}};EV.stopObserving=function(a,b,c,d){d=d||!1;if(b=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent))b="keydown";a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)};EV.observe=function(a,b,c,d){d=d||!1;if(b=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent))b="keydown";this.observeAndCache(a,
b,c,d)};EV.addEvent=function(a,b,c,d){EV.observe(a,b,c,d)};EV.stopSelect=function(a){window.Browser.value!="ie"?window.onmousedown=function(){return!a}:a?document.attachEvent("onselectstart",EV.stopSelectEvent):EV.stopObserving(document,"selectstart",EV.stopSelectEvent)};EV.stopSelectEvent=function(){return!1}})();var CC=function(){};CC.isSetTimeOut=!1;
CC.showMsg=function(a,b,c,d){objMsg=$("tipsfinish");d=="option"?a='<div class="tips-box tips-green">'+a+"</div>":d=="error"?a='<div class="tips-box tips-red">'+a+"</div>":d=="caution"?a='<div class="tips-box tips-yellow">'+a+"</div>":(a=(a||Lang.Mail.sys_LoadingData)+Lang.Mail.sys_Waiting,a="<div class=\"tips-box tips-green\"><img id='loading_ajax' src='"+gMain.resourceRoot+"/images/loading16x16.gif' border=0 />"+a+"</div>");if(objMsg&&(c&&CC.showOpactity(),objMsg.innerHTML=a,El.show(objMsg),b))window.setTimeout(function(){CC.isSetTimeOut=
!1;if(!CC.isSetTimeOut)objMsg.innerHTML=""},5E3),CC.isSetTimeOut=!0};CC.hideMsg=function(){if($("loading_ajax"))$("tipsfinish").innerHTML=""};CC.alertTips=function(a,b,c){CC.msgBox({id:"alertTips",title:c,type:"div",text:a,zindex:9999,buttons:[{text:Lang.Mail.Ok,clickEvent:b}],dragStyle:1})};
CC.error=function(a,b,c){window.top.ERROR=!0;CC.showMsg("\u52a0\u8f7d\u5931\u8d25",!0,!1,"error");CC.goOutLink("/error.html",a,b);var d=setInterval(function(){var b=jQuery("#ifrm_outLink_"+a),f,g,h;if(h=b[0])b.ready(function(){var a=+new Date;(f=h.contentDocument||h.contentWindow)&&(g=jQuery("a.b-btn",f))[0]&&g.attr("data-timer",a).click(function(){CC.showMsg();c&&c();b=h=g=f=null;delete window.top.ERROR;return!1})}),clearInterval(d),d=null},300)};
CC.showOpactity=function(a,b){var c=$(gConst.divOpactity);c.style.zIndex=a||999;El.show(c);b&&setTimeout(function(){CC.hideOpactity()},b*1E3)};CC.hideOpactity=function(){var a=$(gConst.divOpactity);El.hide(a)};CC.showTransparent=function(a,b){var c=$(gConst.shareLayer);c&&(El.show(c),b&&setTimeout(function(){CC.hideTransparent()},b*1E3))};CC.hideTransparent=function(){var a=$(gConst.shareLayer);El.hide(a)};
CC.getIframe=function(a,b,c,d){b=b||"about:blank";a='<iframe id="'+gConst.ifrm+a+'" name="'+gConst.ifrm+a+'" style="width:100%;height:100%;'+(d||"")+'" frameborder="0" scrolling="'+(c||"no")+'"';b&&(a+=' src="'+b+'"');a+="></iframe>";return a};
CC.getFlash=function(){return('<object class="{0}" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase='+window.location.protocol+'"://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"  width="{1}" height="{2}" id="{3}" align="middle"><param name="allowScriptAccess" value="sameDomain" /><param name="movie" value="{4}" />'+(obj.transparent?'<param name="wmode" value="transparent" />':"")+'<param name="quality" value="high" /><param name="FlashVars" value="{5}" /><embed '+
(obj.transparent?' wmode="transparent" ':"")+"width='{1}' height='{2}' name='{3}'  src='{4}' FlashVars='{5}' quality='high' bgcolor='#F4FBFF' align=\"middle\" allowScriptAccess=\"sameDomain\" type=\"application/x-shockwave-flash\" pluginspage="+window.location.protocol+'"://www.macromedia.com/go/getflashplayer" /></object>').format(obj.className||"",obj.width||"",obj.height||"",obj.id||"",obj.url||"",obj.flashVar||"")};
CC.createOpactity=function(a,b){var c=El.createElement("div");c.innerHTML='<img alt="" src="'+gMain.resourceRoot+'/images/place.gif"  width="100%" height="100%"/>';c.id="shareLayer_"+(a||"");c.style.zIndex=b||999;c.className="shareLayer";document.body.appendChild(c);El.hide(c);return c};CC.docHeight=function(){return El.docHeight()};CC.DocHeight=function(){return CC.docHeight()};CC.docWidth=function(){var a=El.docWidth();return a<600?600:a};CC.DocWidth=function(){return CC.docWidth()};
CC.alert=function(a,b,c){CC.msgBox({id:"alert",title:c,type:"text",text:a,zindex:9999,buttons:[{text:Lang.Mail.Ok,clickEvent:b}],dragStyle:1})};CC.alertNoSysClose=function(a,b,c){CC.msgBox({id:"alertNoSystemClose",title:c,type:"text",text:a,zindex:9999,buttons:[{text:Lang.Mail.Ok,clickEvent:b}],noSysClose:!0,dragStyle:1})};
CC.confirm=function(a,b,c,d,e){CC.msgBox({id:"confirm"+(e||""),width:360,title:c,type:"text",text:a,zindex:1090,dragStyle:1,buttonType:"confirm",buttons:[{text:Lang.Mail.Ok,clickEvent:b},{text:Lang.Mail.Cancel,clickEvent:d,isCancelBtn:!0}]})};CC.showDiv=function(a,b,c,d,e,f,g){a={id:"confirm"+(e||""),title:c,type:"div",text:a,changeStyle:!1,dragStyle:1,width:f,buttons:[{text:Lang.Mail.Ok,clickEvent:b},{text:Lang.Mail.Cancel,clickEvent:d,isCancelBtn:!0}].concat(g||[])};CC.msgBox(a)};
CC.prompt=function(a,b,c,d){var a=a||{},e="prompt_"+(a.id||"defaultText"),f=e+"_input",g=e+"_msgError",h=a.html||"$TEXT$",j=a.okText||Lang.Mail.Ok,n=a.cancelText||Lang.Mail.Cancel,h=h.replace("$TEXT$",':&nbsp;<input type="text" id="'+f+'" maxlength="'+(a.maxlength||20)+'" size="'+(a.seize||20)+'" value="'+(a.value||"")+'" '+(a.attr||"")+'/><br><p id="'+g+'" class="msgSet"></p>');CC.msgBox({id:e,title:c,type:"text",text:h,zindex:1090,dragStyle:1,buttons:[{text:j,clickEvent:function(){var a=!1;typeof b==
"function"&&(a=b($(f),function(a){if(a)$(g).innerHTML=a}));return a}},{text:n,clickEvent:function(){var a=!1;typeof cancelCallbak=="function"&&(a=d($(f)));return a},isCancelBtn:!0}]});window.setTimeout(function(){var a=$(f);a.focus();El.setCursorPos(a)},100)};CC.showSysMsg=function(a,b,c,d,e,f,g){if(typeof a=="object")a=a.html;f=[];g||(f=d?[{text:Lang.Mail.Ok,clickEvent:b},{text:Lang.Mail.Cancel,clickEvent:e,isCancelBtn:!0}]:[{text:Lang.Mail.Ok,clickEvent:b}]);CC.msgBox({id:"",title:c,text:a,buttons:f})};
CC.showHtml=function(a){var b=a.id||"",c=a.title,d=a.width,e=a.buttons||[],f=a.zindex||1080,g=a.noSysClose||!1,h='<div id="divDialogHtml_'+b+'" style="height:'+(a.height?a.height+"px":"100%")+'">';h+=CC.getIframe("DialogHtml_"+b,a.url,a.scoll||"no")+"</div>";CC.msgBox({id:b,width:d,title:c,type:"div",text:h,buttons:e,zindex:f,noSysClose:g,sysCloseEvent:a.sysCloseEvent})};
CC.msgBox=function(a){function b(){var a=$(this.id).btnIndex,b;if(a&&n&&n.length>0)b=n[a-1].clickEvent;a=null;typeof b=="function"&&(a=b());if(!a)return b=$(f),b.parentNode.removeChild(b),CC.hideTransparent(),!1}function c(a){a=EV.getEvent(a);EV.getTarget(a);a=EV.getCharCode(a)+"";if(a==13){var b=$(g+"btn_0");if(b){b.onclick();return}}if(a==27)$(g).onclick();else return!0}function d(a){EV.observe(a,"focus",function(){El.addClass(a,"focus")},!1);EV.observe(a,"blur",function(){El.removeClass(a,"focus")},
!1)}var a=a||{},e=a.id||"",f="divDialog"+e,g="divDialogClose"+e,h=(a.title||Lang.Mail.sys_SystemInfo).encodeHTML(),j=a.text,n=a.buttons,k=a.type||"div",q=a.noSysClose||!1,t=a.dragStyle||0,e=a.changeStyle||!1,u=$(f);u?El.hide(u):(u=El.createElement("div",f,"dialog"),document.body.appendChild(u));var s=[];s[s.length]='<div class="boxIframeTitle">';s[s.length]="<h2><span>"+h+"</span></h2>";s[s.length]='<a class="i_t_close" href="javascript:fGoto();" id="'+g+'" '+(q?'style="display:none;"':"")+">&nbsp;&nbsp;&nbsp;&nbsp;</a>";
s[s.length]="</div>";s[s.length]='<div class="boxIframeMain">';s[s.length]='<div class="boxIframeText">';k=="text"?(s[s.length]='<div class="pop-wrap">',s[s.length]='<p class="msgDialog">'+j+"</p>",s[s.length]="</div>"):s[s.length]=j;if(n&&n.length>0){s[s.length]='<div class="boxIframeBtn">';s[s.length]='<div class="topborder">';for(h=0;h<n.length;h++)j=n[h].text,k="",k=n[h]["class"]?n[h]["class"]:h==1?"n_btn mt_8":"n_btn_on mt_8",s[s.length]=' <a href="#" id="'+g+"btn_"+h+'"  class="'+k+'"><span><span>'+
j+"</span></span></a>";s[s.length]="</div>";s[s.length]="</div></div>"}s[s.length]="</div>";u.innerHTML=s.join("");s=u.firstChild.firstChild;CC.showTransparent();El.show(u);k=u.offsetHeight;h=a.width||(CC.isBigFont()?450:352);j=(CC.docWidth()-h)/2;k=(CC.docHeight()-k)/2;El.width(u,h);u.style.left=j+"px";u.style.top=k+"px";new Splitter(u,function(a){if(t==0)u.style.left=parseInt(u.style.left,10)+(a[2]-a[0])+"px",u.style.top=parseInt(u.style.top,10)+(a[3]-a[1])+"px"},"wh",s,t);n&&n.length>0&&$(g+"btn_0").focus();
Browser.isIE&&(e&&(new Hashtable(u.childNodes[1].getElementsByTagName("input"))).each(function(a,b){if(b.type=="text"||b.type=="password")b.className="text",d(b)}),gMain.skinControlTypeId==1&&Browser.version<9&&jQuery("#shareLayer").attr("class",""));e=$(g);s=function(){var b=a.sysCloseEvent();if(b)b=$(f),b.parentNode.removeChild(b),CC.hideTransparent();else return b};if(e)typeof a.sysCloseEvent=="function"?(e.onclick=s,e.onmousedown=s):(e.onclick=b,e.onmousedown=b);if(n&&n.length>0){(n.length==1||
a.buttonType)&&EV.observe(document,"keypress",c);for(s=n.length-1;s>=0;s--)h=$(g+"btn_"+s),El.setAttr(h,{btnIndex:s+1}),h.onclick=b,n[s].isCancelBtn&&El.setAttr(e,{btnIndex:s+1})}};CC.closeMsgBox=function(a){$("divDialogClose"+(a||"")).onclick()};CC.getRnd=function(){return(new Date).valueOf()};CC.scrollBottom=function(){document.body.scrollTop=CC.docHeight()};CC.scrollTop=function(){document.body.scrollTop=0};
CC.toJsonString=function(a,b){var c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},d={array:function(a){var b=["["],c,h,j,n=a.length;for(j=0;j<n;j+=1)if(o=a[j],h=d[typeof o])o=h(o),typeof o=="string"&&(c&&(b[b.length]=","),b[b.length]=o,c=!0);b[b.length]="]";return b.join("")},"boolean":function(a){return String(a)},"null":function(){return"null"},number:function(a){return isFinite(a)?String(a):"null"},object:function(a){if(a){if(a instanceof Array)return d.array(a);
var b=["{"],c,h,j;for(j in a)if(oTmp=a[j],h=d[typeof oTmp])oTmp=h(oTmp),typeof oTmp=="string"&&(c&&(b[b.length]=","),b.push(d.string(j),":",oTmp),c=!0);b[b.length]="}";return b.join("")}return"null"},string:function(a){/["\\\x00-\x1f]/.test(a)&&(a=a.replace(/([\x00-\x1f\\"])/g,function(a,b){var d=c[b];if(d)return d;d=b.charCodeAt();return"\\u00"+Math.floor(d/16).toString(16)+(d%16).toString(16)}));return'"'+a+'"'}};return b=="object"?d.object(a):b=="array"?d.array(a):""};
CC.getMenu=function(a,b,c,d,e,f){f||(f=document);if(!e)var g=EV.getEvent(d),e=EV.getTarget(g).parentNode;var a=a||{},c=c||{},d="SubMenu_"+(a.id||"default"),h=a.div||e,a=new Toolbar(d);a.init();if(e=$(d))El.show(e),GE.cToolbar=e,EV.stopEvent(g);else if(e=El.createElement("div",d,"menu"),h.mouseEvent={onmouseover:function(){c.overClass&&El.addClass(this,c.overClass)},onmouseout:function(){c.overClass&&El.removeClass(this,c.overClass)},onmousedown:function(){c.clickClass&&El.addClass(this,c.clickClass)},
onmouseup:function(){c.clickClass&&El.removeClass(this,c.clickClass)}},(new Hashtable(h.mouseEvent)).each(function(a,b){h[a]=b}),b=a.getToolbarSubMenu(b,f))h.appendChild(b),EV.stopEvent(g),GE.cToolbar=b};CC.changeCss=function(a){$("cssStyle").href=CC.getCssByStyle(a);top.gCurrentCss=CC.getCssByStyle(a)};CC.IsEnableContexMenu=function(){return GC.check("MAIL_MANAGER_RIGHT")==!0?!0:!1};CC.IsEnableNoviceWizard=function(){return!0};
var gConst={home:"home",address:"address",sms:"sms",mms:"mms",fax:"fax",searchMail:"searchMail",setting:"setting",readMail:"readMail",weather:"weather",folderMain:"folderMain",folder:"folder",compose:"compose",attachList:"attachList",deliver:"deliver",sysFolderList:"\u6536\u4ef6\u7bb1,\u8349\u7a3f\u7bb1,\u5df2\u53d1\u9001,\u5df2\u5220\u9664,\u5783\u573e\u90ae\u4ef6,\u75c5\u6bd2\u6587\u4ef6\u5939".split(","),unlimitedId:"UNLIMITED",folderLimit:5,dragLimit:20,langKey:"lang",divOpactity:"opactity",shareLayer:"shareLayer",
divMsg:"tipsLoading",divContainer:"container",divTopTab:"accountbar",divTop:"header",divLeft:"sidebar",divBox:"leftContainer",divMain:"content",divTab:"divTabls",divToolbar:"divToolbar_",ifrm:"ifrm_",ifrmSSOLoad:"ifrmSSOLoad",ifrmForSubmit:"ifrmForSubmit",ifrmHistory:"ifrmHistory",ifrmRes:"ifrmRes",sysFrames:"ifrmHistory,ifrmSSOLoad,freshWeb,ifrmApi,ifrmWebApi,freshRM,ifrmRmSvr",ifrmRmSvr:"ifrmRmSvr",txtSearch:"txtSearch",txtAdvSearch:"txtAdvSearch",searchBrightKeyLeft:/&amp;&lt;{/g,searchBrightKeyRight:/}&gt;&amp;/g,
mainToolbar:"main_Toolbar_",mainBody:"main_Body_",mainSetting:"main_Setting",mainReadmail:"main_Readmail",ifrmReadmail:"ifrmReadmail_Content_",sfzmenu:"sfzMenu",menuT:{mail:"lm_mail",sms:"lm_sms",mms:"lm_mms",fax:"lm_fax"},addrApiUrl:gMain.rmSvrAppPath!=""?gMain.rmSvrAppPath:"/s",menuC:{mail:"ulMailFunc",sms:"ulSmsFunc",mms:"ulMmsFunc",fax:"ulFaxFunc",service:"ulService"},toolBarPosition:{fixTop:0,afterTitle:1},menuSize:{minWidth:80,maxHeight:322},treeLength:2,statusOk:"S_OK",statusNo:"S_NO",logoff:"S_logoff",
checkBoxName:"checkBox_mid",listMailId:"listMain_",listLeftId:"mailListLeft_",listHeaderId:"listHeader_",listTitleId:"listTitle_",listBodyId:"listBody_",listTopPageId:"topPage_",listFootPageId:"footPage_",listCheckBoxId:"checkbox_",listReadMailId:"listReadMail_",listMailSortIcon:"listMailSortIcon_",listFolderMainId:"listFolderMainId",listFolderMainTableId:"listForderMainTable_",listFolderMainTrId:"listFolderMainTrId_",mailSubjectLength:60,mailSubjectTipLength:60,topNum:5,signLen:1E3,autoRepaly_max:2E3,
folderLength:7,webLogLength:2048,ulServiceMinHeight:10,tab_ShowCloseAll:5,tab_CloseAllId:"closeAllTabs",loadAddr_Timeout:1E3,encode_utf8:"utf-8",encode_gbk:"GBK",encode_gb2312:"gb2312",dataName:"var",composeFile:"compose.do",composeUrl:gMain.webPath+"/se/mail/compose.do?sid="+gMain.sid,composeOkUrl:gMain.webPath+"/se/mail/composeok.do?sid="+gMain.sid,composeSetupUrl:gMain.webPath+"/se/mail/setup.do?sid="+gMain.sid,composeReviewUrl:gMain.webPath+"/se/mail/composeview.do?sid="+gMain.sid,composeUploadImgUrl:gMain.webPath+
"/se/mail/uploadimg.do?sid="+gMain.sid,mailHomeUrl:gMain.webPath+"/se/mail/home.do?sid="+gMain.sid,logoutUrl:gMain.webPath+"/login/logout.do?sid="+gMain.sid,sessionoutUrl:gMain.returnUrl+"?from=iframe",mainUrl:gMain.webPath+"/main.do?sid="+gMain.sid,historyUrl:gMain.webPath+"/static/se/mail/history.htm",readMailUrl:gMain.webPath+"/static/se/mail/viewmail.htm",readMailSessionUrl:gMain.webPath+"/se/mail/viewmail.do",mailPrintUrl:gMain.webPath+"/se/mail/mailprint.do?sid="+gMain.sid,portraitUrl:gMain.webPath+
"/se/mail/face.do?sid="+gMain.sid,personalAddrUrl:gMain.webPath+"/se/addr/index.do?sid="+gMain.sid,corpAddrUrl:gMain.webPath+"/se/addr/corpaddr.do?sid="+gMain.sid,searchMailMax:1E3,reqPath:gMain.rmSvr||"/",reqUrl:gMain.rmSvr+gMain.rmSvrAppPath,appPostPath:gMain.rmSvr+gMain.rmSvrAppPath,apiGetPath:gMain.rmSvr+gMain.rmSvrWebAppViewPath,apiPostPath:gMain.rmSvr+gMain.rmSvrWebAppMailPath,uploadUrl:gMain.rmSvr+gMain.rmSvrWebAppMailPath,downloadUrl:gMain.rmSvr+gMain.rmSvrWebAppViewPath,packDownUrl:gMain.rmSvr+
gMain.rmSvrWebAppMailPath,mailUlr_us:"/mail/data.do",netDiskUrl_fileSearch:"/service/disk/search.do",netDiskUrl_addFile:"/service/common/file.do",subjectColor:[{name:"\u9ed1\u8272",value:"#333333",val:0},{name:"\u7ea2\u8272",value:"#ff0000",val:5},{name:"\u6a59\u8272",value:"#FF9a00",val:1},{name:"\u7eff\u8272",value:"#008000",val:2},{name:"\u84dd\u8272",value:"#2757ec",val:3},{name:"\u7d2b\u8272",value:"#7e1a86",val:4}],func:{seq:"global:sequential",ver:"global:version",execTemp:"global:execTemp",
emptyFolder:"mbox:emptyFolder",listFolder:"mbox:getAllFolders",createFolder:"mbox:createUserFolder",updateFolder:"mbox:updateFolders",delFolder:"mbox:deleteFolders",updateFolderPass:"mbox:updateFolderPass",setFolderPass:"mbox:setFolderPass",checkFolder:"mbox:checkFolder",listMail:"mbox:listMessages",getMail:"mbox:getMessageInfos",delMail:"mbox:deleteMessages",updateMsg:"mbox:updateMsgAttrs",searchMail:"mbox:searchMessages",deliverStatus:"mbox:getDeliverStatus",moveMessages:"mbox:moveMessages",markLabel:"mbox:updateMessagesLabel",
updateMail:"mbox:updateMessagesStatus",updateMailAll:"mbox:updateMessagesAll",downloadMail:"mbox:downloadMessages",readMail:"mbox:readMessage",readSessionMail:"mbox:readSessionMessage",autopack:"mbox:autoPack",deleteSessionMail:"mbox:deleteSessionMessages",forwardAttachs:"mbox:forwardAttachs",mailFile:"mbox:mailFile",attachList:"attach:listAttachments",upload:"attach:upload",deleteAttach:"upload:deleteTasks",pack:"attach:pack",refreshAttach:"attach:refresh",queryPack:"attach:queryPack",downloadPack:"attach:downloadPack",
download:"attach:download",getAttach:"attach:getAttach",alias:"user:alias",setAttrs:"user:setAttrs",getAttrs:"user:getAttrs",setUserInfo:"user:setUserInfo",getUserInfo:"user:getUserInfo",getSign:"user:getSignatures",setSign:"user:signatures",getWBList:"user:getWhiteBlackList",setWBList:"user:setWhiteBlackList",setFilter:"user:setFilter_New",getFilter:"user:getFilter_New",setPOP:"user:setPOPAccount",syncPOP:"user:syncPOPAccount",syncPOPALL:"user:syncPOPAccountAll",getPOP:"user:getPOPAccounts",updatePwd:"user:updatePassword",
session:"user:updateSession",getLoginNotify:"mail:getLoginNotify",setLoginNotify:"mail:setLoginNotify",getDefaultEmail:"mail:getLoginDefault",setDefaultEmail:"mail:setLoginDefault",getSSOList:"mail:getGrantList",cancelSSO:"mail:cancelGrant",getComposeId:"mbox:getComposeId",compose:"mbox:compose",forward:"mbox:forwardMessages",reply:"mbox:replyMessage",replyAll:"mbox:replyAll",restore:"mbox:restoreDraft",viewSource:"mbox:getMessageData",sendMDN:"mbox:sendMDN",setAttrs_us:"mail:setAttrs",getCommonAddr:"addr:getCommon",
getSkinList:"mail:getSkinList",setUserSkin:"mail:setUserSkin",setWebUserInfo:"mail:setUserInfo",test:"",diskSearch:"disk:search",netDisk_attachUpload:"common:attachUpload",spellCheck:"mail:SetSpellCheck"},logFunc:{req:"RQ",resp:"RS",js:"JS"},logLevel:{debug:"DEBUG",info:"INFO",error:"ERROR"},labelColor:"c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20,c21,c22,c23,c24,c25,c26,c27,c28,c29,c30,c31,c32,c33,c34,c35".split(","),menu:{mail:"MAIL",addr:"ADDR",write:"WRITE",inbox:"INBOX",
config:"CONFIG",readmail:"READ",compose:"WRITE"},sysMenus:{1:1,2:1,3:1,4:1,5:1,12:1,13:1,14:1},extMailMenus:{MAIL_CONFIG_DEFAULTACCOUNT:1,MAIL_CONFIG_LOGINNOTIFY:gMain.loginNotifyType,MAIL_CONFIG_MEMMANAGER:1},loginType:{web:"WEB",pm:"PM",mm:"MM"},folderEnum:{unreadmail:0,inbox:1,draft:2,sent:3,del:4,junk:5,monitor:13,audit:14}};function $(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];typeof d=="string"&&(d=document.getElementById(d));if(c==1)return d;a.push(d)}return a}
function $G(a,b){var c=[];c.push("");var d,e;for(d=2,e=arguments.length;d<e;d++)c.push(arguments[d]);for(d=0,e=a.length;d<e;d++){var f=$(a[d]);f&&(c[0]=f,El[b].apply(f,c))}}function $A(a){var b=[];if(a&&(a.length||a.length==0)&&typeof a!="string"&&!a.tagName&&!a.alert)for(var c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function fGoto(){}
function ch(a,b){b instanceof SyntaxError?handleErrors("Syntax Error: "+a+"<br>ErrorName:"+b.name+"<br>ErrorMessage:"+b.message):b instanceof Error?handleErrors(""+a+"<br>ErrorName:"+b.name+"<br>ErrorMessage:"+b.message):handleErrors(a)}var Browser={};
function WindowInit(){try{var a=window.navigator.userAgent.toUpperCase(),b="",c=0,d=!1;switch(!0){case /MSIE/.test(a)&&!/OPERA/.test(a):b="ie";c=a.match(/MSIE\s([0-9]+\.?[0-9]*)/)[1]-0;Browser.ie=c;d=!0;break;case /FIREFOX/.test(a):b="firefox";c=a.match(/FIREFOX\/([0-9]+\.?[0-9]*)/)[1]-0;Browser.firefox=c;break;case /OPERA/.test(a)&&!/MSIE/.test(a):b="opera";c=a.match(/VERSION\/([0-9]+\.?[0-9]*)/)[1];Browser.opera=c;break;case /SAFARI/.test(a)&&!/CHROME/.test(a):b="safari";c=a.match(/VERSION|SAFARI\/([0-9]+\.?[0-9]*)/)[1];
Browser.safari=c;break;case /CHROME/.test(a):b="chrome";c=a.match(/CHROME\/([0-9]+\.?[0-9]*)/)[1];Browser.chrome=c;break;case /WEBKIT/.test(a):b="webkit";c=a.match(/WEBKIT\/([0-9]{1,}\.[0-9]{1,})/)[1];Browser.webkit=c;break;case /MOZILLA/.test(a)&&!/(COMPATIBLE|WEBKIT)/.test(a):b="mozilla";c=a.match(/MOZILLA\/([0-9]+)/)[1];Browser.mozilla=c;break;case /NETSCAPE/.test(a):b="netscape",c=a.match(/NETSCAPE[0-9]*\/([0-9]+)/)[1],Browser.netscape=c}Browser.value=b;Browser.version=parseFloat(c,10);Browser.isIE=
d;Browser.isIE5=!1;if(b=="ie"&&c>=5&&c<5.5)Browser.isIE5=!0}catch(e){}window.attachEvent&&window.attachEvent("onunload",function(){window.GC=null});if(Browser.isIE&&Browser.version<7){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(f){}if($(gConst.divOpactity))$(gConst.divOpactity).innerHTML=CC.getIframe("Opactity","about:blank");if($(gConst.shareLayer))a='<div class="shareLayer" style="position:absolute; width:100%; height:100%; z-index:1;"></div>',a+=CC.getIframe("shareLayer","about:blank"),
$(gConst.shareLayer).innerHTML=a}}function handleErrors(a,b,c,d){IsWriteLog&&Util.writeLogError(gConst.logFunc.js,"Common.handleErrors",(!b?a:"Error:"+a+"<br>Line:"+c+"<br>Url:"+b)+" | stack="+Util.getStack());IsDebug&&CC.alert(!b?a:"Error:"+a+"<br>Line:"+c+"<br>Url:"+b,d,"Sytstem Error");return!0}if(!IsDebug)window.onerror=handleErrors;WindowInit();var Drag=cmail.createClass();
Drag.prototype={initialize:function(a,b){this.type=a;this.div=b;this.dragItem=null;this.isDrag=this.isOn=!1;this.folderMoveTo="";this.doDragOver=function(){};this.doDragUp=function(){}},init:function(){EV.stopSelect(!0);EV.observe(document,"mousemove",this.mouseMove,!1);EV.observe(document,"mouseup",this.mouseUp,!1);EV.observe(document,"mouseover",this.doDragOver,!1);this.isDrag=!0;GE.Drag.moveType=this.type},mouseMove:function(){var a=EV.getEvent();try{if(GE.Drag.moveType){var b=MM[GE.Drag.moveType].drag,
c=b.div,d=b.type,e=EV.pointerX(a)-c.mouseDownX,f=EV.pointerY(a)-c.mouseDownY,g=EV.pointerX(a),h=EV.pointerY(a),j=b.dragItem||$(d+"DragItem"),n;if(Math.abs(f)>10||Math.abs(e)>10){if(j.style.display=="none"&&(El.show(j),d=="folder")){var k=c.getElementsByTagName("INPUT")[0];k.checked=!0;var q=c.id.split("_")[1];n=MM[q];n.setTrClass(k,!0)}j.style.left=g+6+"px";j.style.top=h+16+"px";b.isOn?El.addClass(j,"mailDragOn"):El.removeClass(j,"mailDragOn")}}}catch(t){}},mouseUp:function(){if(GE.Drag.moveType){var a=
MM[GE.Drag.moveType].drag,b=a.type;EV.stopSelect(!1);EV.stopObserving(document,"mousemove",a.mouseMove,!1);EV.stopObserving(document,"mouseup",a.mouseUp,!1);EV.stopObserving(document,"mouseover",a.doDragOver,!1);a.isDrag=!1;GE.Drag.moveType=null;var c=a.dragItem||$(b+"DragItem");El.hide(c);a[b+"MoveTo"]&&(a.doDragUp(a[b+"MoveTo"],a.div),a[b+"MoveTo"]=null)}},getDragItem:function(a){var b=this.type,c=$(b+"DragItem");c?c.childNodes[1].innerHTML=a:(c=El.createElement("div",b+"DragItem","mailDrag"),c.style.zIndex=
99999,c.innerHTML="<i></i><p>"+a+"</p>",document.body.appendChild(c));El.hide(c);return this.dragItem=c}};var JSON;JSON||(JSON={});
(function(){function a(a){return a<10?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,u,s,r=f,w,x=d[a];x&&typeof x==="object"&&typeof x.toJSON==="function"&&(x=x.toJSON(a));typeof j==="function"&&(x=j.call(d,a,x));switch(typeof x){case "string":return b(x);case "number":return isFinite(x)?String(x):"null";case "boolean":case "null":return String(x);
case "object":if(!x)return"null";f+=g;w=[];if(Object.prototype.toString.apply(x)==="[object Array]"){s=x.length;for(e=0;e<s;e+=1)w[e]=c(e,x)||"null";u=w.length===0?"[]":f?"[\n"+f+w.join(",\n"+f)+"\n"+r+"]":"["+w.join(",")+"]";f=r;return u}if(j&&typeof j==="object"){s=j.length;for(e=0;e<s;e+=1)typeof j[e]==="string"&&(h=j[e],(u=c(h,x))&&w.push(b(h)+(f?": ":":")+u))}else for(h in x)Object.prototype.hasOwnProperty.call(x,h)&&(u=c(h,x))&&w.push(b(h)+(f?": ":":")+u);u=w.length===0?"{}":f?"{\n"+f+w.join(",\n"+
f)+"\n"+r+"}":"{"+w.join(",")+"}";f=r;return u}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof JSON.stringify!=="function"||navigator.userAgent.indexOf("MSIE 8.0")>0)JSON.stringify=function(a,b,d){var e;g=f="";if(typeof d==="number")for(e=0;e<d;e+=1)g+=" ";else typeof d==="string"&&(g=d);if((j=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");
return c("",{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function c(a,d){var e,f,h=a[d];if(h&&typeof h==="object")for(e in h)Object.prototype.hasOwnProperty.call(h,e)&&(f=c(h,e),f!==void 0?h[e]=f:delete h[e]);return b.call(a,d,h)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),typeof b==="function"?c({"":e},""):e;throw new SyntaxError("JSON.parse");}})();var Splitter=cmail.createClass();
(function(){Splitter.prototype={onMouseDown:function(a){a=EV.getEvent(a);this.downX=EV.pointerX(a);this.downY=EV.pointerY(a);this.createSub();this.showMask();this.pos=El.pos(this.splitter);this.start=!0;EV.observe(document,"mousemove",this.mouseMove,!0);EV.observe(document,"mouseup",this.mouseUp,!0);this.dragSytle==0&&EV.stopSelect(!0);EV.preventDefault(a);EV.stopEvent(a)},onMouseMoveV:function(a){if(this.start)a=EV.getEvent(a),a=EV.pointerX(a),this.dragSytle==0?this.subSplitter.style.left=a+"px":
this.splitter.style.left=this.pos[0]+(a-this.downX)+"px"},onMouseMoveH:function(a){if(this.start)a=EV.getEvent(a),a=EV.pointerY(a),this.dragSytle==0?this.subSplitter.style.top=a+"px":this.splitter.style.top=this.pos[1]+(a-this.downY)+"px"},onMouseMove:function(a){if(this.start){var b=EV.getEvent(a),a=EV.pointerX(b),b=EV.pointerY(b);this.dragSytle==0?(this.subSplitter.style.left=this.subDownX+(a-this.downX)+"px",this.subSplitter.style.top=this.subDownY+(b-this.downY)+"px"):(this.splitter.style.left=
this.pos[0]+(a-this.downX)+"px",this.splitter.style.top=this.pos[1]+(b-this.downY)+"px")}},onMouseUp:function(a){if(this.start)a=EV.getEvent(a),this.upX=EV.pointerX(a),this.upY=EV.pointerY(a),this.hideMask(),this.callback&&this.callback([this.downX,this.downY,this.upX,this.upY]),EV.stopObserving(document,"mousemove",this.mouseMove,!0),EV.stopObserving(document,"mouseup",this.mouseUp,!0),this.start=!1,this.dragSytle==0&&EV.stopSelect(!1)},createSub:function(){if(this.dragSytle!=1){this.subSplitter=
El.createElement("div");var a=El.pos(this.splitter),b=El.getSize(this.splitter),c=this.zindex,d,e;this.type=="v"?(d="5px",b=b.height+"px",e="1px",this.subSplitter.style.backgroundColor="#ccc"):this.type=="h"?(d=b.width+"px",b="5px",e="1px",this.subSplitter.style.backgroundColor="#ccc"):(d=b.width+"px",b=b.height+"px",e="12px",El.setStyle(this.subSplitter,{border:"4px solid #ccc"}));El.setStyle(this.subSplitter,{position:"absolute",zIndex:c+2,left:a[0]+"px",top:a[1]+"px",width:d,height:b,fontSize:e});
this.subDownX=a[0];this.subDownY=a[1];document.body.appendChild(this.subSplitter)}},showMask:function(){var a=this.zindex;this.dragSytle==1?this.showOpactity(a-1):this.showOpactity(a+1)},hideMask:function(){var a=this.zindex;this.dragSytle==1?this.showOpactity(a-1):(this.hideOpactity(a-1),this.subSplitter&&El.remove(this.subSplitter))},showOpactity:function(a){this.isOpactity?CC.showTransparent(a):(this.opactity.style.zIndex=a,El.show(this.opactity))},hideOpactity:function(a){a&&a>0?this.isOpactity?
CC.showTransparent(a):(this.opactity.style.zIndex=a,El.hide(this.opactity)):CC.hideTransparent()},initialize:function(a,b,c,d,e){this.splitter=$(a);this.zindex=this.splitter.style.zIndex-0;this.mask=this.subSplitter=null;this.callback=b;this.type=c;this.upY=this.upX=this.downY=this.downX=0;this.dragSytle=e||0;this.start=!1;this.dragType=c;this.isOpactity=c=="wh"?!0:!1;d=$(d);d.style.cursor="default";if(this.dragType!="wh")this.opactity=CC.createOpactity(this.dragType,this.zindex);var f=this;this.mouseDown=
function(a){f.onMouseDown(a)};this.mouseUp=function(a){f.onMouseUp(a)};this.type=="h"?(this.splitter.style.cursor="n-resize",this.mouseMove=function(a){f.onMouseMoveH(a)}):this.type=="v"?(this.splitter.style.cursor="e-resize",this.mouseMove=function(a){f.onMouseMoveV(a)}):this.mouseMove=function(a){f.onMouseMove(a)};EV.observe(d,"mousedown",this.mouseDown,!0)}}})();var RmStatus={},Tips=cmail.createClass();
(function(){Tips.prototype={initialize:function(a,b){try{this.W=180,this.H=120,this.dir="up",this.id="",this.tipDiv=this.getDiv(a,b),this.time=10,this.pix=1,this.docW=document.body.scrollLeft+document.body.clientWidth-1,this.docH=document.body.scrollTop+document.body.clientHeight-1,this.X=this.docW-this.W,this.Y=this.docH}catch(c){}},getDiv:function(a,b){var c=this;typeof a!="object"&&(a={});typeof b!="object"&&(b={});var d=a.id||"divTips",e=a.title||Lang.Mail.sys_SystemInfo,f=a.text||"",g=a.dir||
c.dir,h=b.w||c.W,j=b.h||c.H;c.id=d;c.W=h;c.H=j;c.dir=g;var n=$(d);n?n.style.display="":(n=El.createElement("DIV",d),document.body.appendChild(n));h='<div id="'+d+'divTipsTitle" class="select_letter" style="position:absolute;z-index:999;width:'+h+"px;height:"+j+'px" id="'+d+'divTipsMsg"><div class="window_toptitle" style="margin:0px;padding:0px;height:29px"><div class="left"></div>';h+='<div class="mid"><strong id="'+d+'spanTipsMsgTitle">'+e+'</strong></div><div class="right"></div><div class="floatright"><a href="javascript:fGoto();" title="'+
Lang.Mail.Close+'" class="window_close" id="'+d+'btnTipsClose"></a></div></div>';h+='<div id="'+d+'divTipsContent" class="content" style="margin:0px;padding:0px;height:'+(j-29)+'px"><div id="'+d+'divTipsText" style="margin:0px;text-align:center;padding-top:10px">'+f+"</div></div></div>";n.innerHTML=h;n.setStyle({position:"absolute",overflow:"hidden",zIndex:999,margin:"0px",padding:"0px",display:""});g=="up"||g=="down"?n.setStyle({width:this.W+"px",height:"0px"}):n.setStyle({width:"0px",height:this.H+
1+"px"});$(d+"btnTipsClose").onclick=function(){c.close()};return $(d)},init:function(a){this.tipDiv.setStyle({right:"1px",bottom:"1px",display:""+a+""})},setMsg:function(a,b){var c=$(this.id+"spanTipsMsgTitle"),d=$(this.id+"divTipsText");if(b&&b!="")c.innerHTML=b;if(a&&a!="")d.innerHTML=a},startMove:function(a){var b=this;this.init.call(b,"");var c=a||b.dir,d=b.tipDiv;try{var e=function(){var a=parseInt(d.style.height,10);if(c=="up"&&a<=b.H||c=="down"&&a>0){switch(c){case "up":d.style.height=a+b.pix+
"px";break;case "down":d.style.height=a-b.pix+"px"}window.setTimeout(e,b.time)}},f=function(){var a=parseInt(d.style.width,10);if(c=="left"&&a<=b.W||c=="right"&&a>0){switch(c){case "left":d.style.width=a+b.pix+"px";break;case "right":d.style.width=a-b.pix+"px"}window.setTimeout(f,b.time)}};c=="up"||c=="down"?e():f()}catch(g){}},close:function(){var a="down";this.dir=="left"&&(a="right");this.startMove(a)}}})();
function Toolbar(a,b,c,d,e){this.name=a;this.mn=a.indexOf("_")>-1?a.substr(0,a.indexOf("_")):a;this.getTbData=b;this.getTbSubMenuData=c;this.menuId=e||"";this.div=$(d)}
Toolbar.prototype={init:function(){function a(c){for(var d=0,e=c.frames.length;d<e;d++)try{var f=c.frames[d]||{};(f.id||f.name||"").inStr(gConst.sysFrames)||(EV.observe(f.document,"click",b.doHideSubMenu),a(f.window))}catch(g){}EV.observe(c.document,"click",b.doHideSubMenu)}var b=this;a(window)},doHideSubMenu:function(){if(GE.cToolbar)El.remove(GE.cToolbar),GE.cToolbar=null},getMenuFunc:function(a){if(!a)return!1;if(typeof a=="function")return a;for(var b=window,a=a.split("."),c=0,c=0;c<a.length;c++)if(b)b=
b[a[c]];else break;if(typeof b=="function")return b},getToolbar:function(){function a(a){function c(e){e=EV.getEvent(e);EV.getTarget(e);b.doHideSubMenu();var g=[],g=d.getsub?b.getTbSubMenuData(d.mid,a.children):a.children,j=b.getToolbarSubMenu(g);k.appendChild(j);El.show(j);var n=origialh=El.height(j),q=El.width(j),t=!1,t=n>gConst.menuSize.maxHeight+2?!0:!1,q=q<gConst.menuSize.minWidth?gConst.menuSize.minWidth:q;b.name!="sys"+gConst.folderEnum.audit&&g[0].name.search(/MAIL_INBOX_FILTER/)==-1&&t&&
(q+=30);El.width(j,q);b.init(!0);GE.cToolbar=j;EV.stopEvent(e)}var d=b.getMenuItem(a),e=d.clickEvent,n=El.createElement("li","",""),k=El.createElement("a","",d.hasMenu?"n_btn_slide mr_5":"n_btn mr_5");El.setAttr(k,{href:"javascript:fGoto();"});var q=El.createElement("span","",d.className),t=El.createElement("span","","");t.innerHTML=d.text;if(d.hasMenu){var u=El.createElement("i","","");t.appendChild(u);n.onclick=c}q.appendChild(t);k.appendChild(q);if(!d.hasMenu)n.onclick=function(n){var k=EV.getEvent(n),
q=EV.getTarget();b.doHideSubMenu();b.init();if(e)typeof e=="function"?e(b.name,d.mid,a):e=="menu"&&MM[b.mn].doMenu(b.name,d.mid,a),EV.stopEvent(k);else if(d.hasMenu)(k=q.parentNode)&&d.hasMenu&&k.className=="button"&&c(n)};n.appendChild(k);return n}var b=this,c=El.createElement("div",gConst.divToolbar+b.name,"toolbar"),d=El.createElement("ul","","toolBut");c.appendChild(d);var e=b.getTbData()||[];if(e.length!=0&&(e.each(function(b,e){e&&e.isShow&&(e.isNode?c.appendChild(e):e&&typeof e=="object"&&
d.appendChild(a(e)))}),El.insertElement(b.div,c,"afterBegin"),typeof MM[b.mn].getToolbarRightPart=="function"&&(El.insertElement(c,MM[b.mn].getToolbarRightPart(),"beforeEnd"),b.picker)))b.picker.onSelectBack()},getDatePick:function(){var a=this.name;(new Folder).getDatePick(a)},getToolbarSubMenu:function(a,b){var c=this,d="";b||(b=document);var a=a||[],e=function(){for(var b=0,c=a.length;b<c;b++){var d=a[b].children;if(d&&d.length)return!0}return!1}(),d=a.notNeedCss?"":"toolBut_drop shadow",f=El.createElement("ul",
"",d,b);if(e)f.style.overflow="visible";if(a.length==0)return f;f.onmousedown=function(){return!1};a.each(function(a,d){if(d&&typeof d=="object"){var j=c.getMenuItem(d),n=j.attrs,k=j.clickEvent,q=GC.getUrlParamValue(n,"width"),t=GC.getUrlParamValue(n,"isBold")?!0:!1,u=GC.getUrlParamValue(n,"checked");GC.getUrlParamValue(n,"param");var s=GC.getUrlParamValue(n,"sep"),n=GC.getUrlParamValue(n,"clsName")||"",n=El.createElement("li","",n,b),r="",w=decodeURI(j.className||""),r=j.text,x="",z="",y=j.children;
u&&(x+=u=="true"?"<em>\u221a&nbsp;</em>":"<em>&nbsp;&nbsp;&nbsp;</em>");w?(x+="<i "+(/c\d+$/.test(w)?'style="left:3px" class="i-colorsquare mr_5 ':"")+w+'"></i>',z=" class='layoutmenu'"):z="";if(q)f.style.width=q+"px";if(t)n.style.fontWeight="bold";n.innerHTML='<a href="javascript:fGoto();"'+z+">"+x+r+"</a>";if(e&&d.id=="-201")n.style.overflow="visible";n.onmouseover=function(){El.addClass(this,"hover")};n.onmouseout=function(){El.removeClass(this,"hover")};if(k)n.onclick=function(a){var a=EV.getEvent(a),
b=!1;typeof k=="function"?b=k(c.name,j.mid,d):k=="menu"&&(b=MM[c.mn].doMenu(c.name,j.mid,d));b||c.doHideSubMenu();EV.stopEvent(a)};if(typeof y=="object"&&y instanceof Array&&y.length>0){q=El.createElement("div","","three_level_li");q.innerHTML=r+'<i class="i-trangle-hw"></i>';n.innerHTML="";n.appendChild(q);var v=c.getToolbarSubMenu(y);v.style.left="100%";v.style.top="0px";v.style.display="none";n.appendChild(v);if(jQuery(v).find("li").length>8)v.style.height="200px",v.style.overflowY="auto";var G=
null;q.onmouseover=v.onmouseover=function(){v.style.display="block";clearTimeout(G)};q.onmouseout=v.onmouseout=function(){G=setTimeout(function(){v.style.display="none"},100)}}f.appendChild(n);if(s=="true")r=El.createElement("li","","",b),r.className="line",f.appendChild(r)}});return f},getMenuItem:function(a){var b=a.url||"",c=(a.attrs||"").decodeHTML(),d=GC.getUrlParamValue(c,"className"),e=a.name,e=e.substring(e.lastIndexOf("_")+1,e.length),f=GC.getUrlParamValue(c,"getsub"),g=a.children;f&&(b=
"");return{text:a.text||"",nmae:a.name,mid:e,hasMenu:a.children&&a.children.length>0||f,clickEvent:b,attrs:c,getsub:f,className:d,children:g}}};var Util=cmail.createClass();
(function(){Util.tryThese=function(){var a,b,c;for(a=0;a<arguments.length;a++){b=arguments[a];try{c=b();break}catch(d){}}return c};Util.getXMLDom=function(){return Util.tryThese(function(){return new ActiveXObject("MSXML.DOMDocument")},function(){return new ActiveXObject("Msxml2.DOMDocument")},function(){return new ActiveXObject("Msxml2.DOMDocument.4.0")},function(){return new ActiveXObject("Msxml2.DOMDocument.5.0")},function(){return document.implementation.createDocument("","",null)},function(){return new ActiveXObject("Msxml2.DOMDocument.3.0")},
function(){return new ActiveXObject("Msxml2.DOMDocument.6.0")},function(){return new ActiveXObject("Microsoft.XMLDOM")})||!1};Util.getXMLValue=function(a){var b="";if(a&&a.firstChild)if(document.all)b=a.firstChild.nodeValue;else try{if(b=a.textContent,!b)throw"XML node content is null";}catch(c){b=a.firstChild.nodeValue}b&&(b=b.trim(),b=b.replace(/^&nbsp;|&?nbsp;$/gi,""));return b};Util.str2Num=function(a,b,c){var d=0,e=0,f="1",d="",e=0,d=parseFloat(isNaN(parseFloat(a))?0:a);switch(!0){case b==0:d=
Math.round(d);break;case b>0:for(a=0;a<b;a++)f+="0";e=parseInt(f,10);d=Math.round(d*e)/e;c=="str"&&(d=d.toString(),d+=(d.indexOf(".")!=-1?"":".")+f.substr(1),e=d.indexOf(".")+1+b,d=d.substr(0,e))}if(isNaN(d)||!isFinite(d))d=0;c=="str"&&(d+="");return d};Util.formatStr=function(a){return String.format(arguments.slice(1))};Util.str2Date=function(a){return a.indexOf("-")>0?Util.parseDate(a):new Date(Date.parse(a))};Util.date2Str=function(a){return Util.formatDate(a)};Util.appendZero=function(a){return(a<
0||a>9?"":"0")+a};Util.Date={MONTH_NAMES:"\u4e00\u6708,\u4e8c\u6708,\u4e09\u6708,\u56db\u6708,\u4e94\u6708,\u516d\u6708,\u4e03\u6708,\u516b\u6708,\u4e5d\u6708,\u5341\u6708,\u5341\u4e00\u6708,\u5341\u4e8c\u6708,January,February,March,April,May,June,July,August,September,October,November,December,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY_NAMES:"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")};
Util.DateDiff=function(a,b){var c=typeof b;typeof a=="string"?a=Util.parseDate(a):a.getTime&&(a=a.getTime());c=="string"?b=Util.parseDate(b):b.getTime&&(b=b.getTime());return(a-b)/1E3/3600};Util.DateDiffMore=function(a,b,c){var d=typeof b;typeof a=="string"?a=Util.parseDate(a):a.getTime&&(a=a.getTime());d=="string"?b=Util.parseDate(b):b.getTime&&(b=b.getTime());d=0;switch(c){case "s":d=parseInt((b-a)/1E3);break;case "n":d=parseInt((b-a)/6E4);break;case "h":d=parseInt((b-a)/36E5);break;case "d":d=
parseInt((b-a)/864E5);break;case "w":d=parseInt((b-a)/6048E5)}return d};Util.DateAdd=function(a,b,c){switch(a){case "s":return new Date(c.getTime()+1E3*b);case "n":return new Date(c.getTime()+6E4*b);case "h":return new Date(c.getTime()+36E5*b);case "d":return new Date(c.getTime()+864E5*b);case "w":return new Date(c.getTime()+6048E5*b);case "q":return new Date(c.getFullYear(),c.getMonth()+b*3,c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds());case "m":return new Date(c.getFullYear(),c.getMonth()+
b,c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds());case "y":return new Date(c.getFullYear()+b,c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds())}};Util.formatDate=function(a,b){var c=b||"yyyy-mm-dd HH:nn:ss",d=Util.parseDate(a)||new Date;c+="";var e="",f=0,g="",h="",g=d.getFullYear(),h=d.getMonth()+1,j=d.getDate(),n=d.getDay(),k=d.getHours(),q=d.getMinutes(),t=d.getSeconds(),u=d.getMilliseconds(),d=[];d.y=g<2E3?g-1900:g;d.yyyy=g;d.yy=g.toString().substring(2,4);d.m=h;d.mm=
Util.appendZero(h);d.mmm=Util.Date.MONTH_NAMES[h-1];d.MM=Util.Date.MONTH_NAMES[h+11];d.M=Util.Date.MONTH_NAMES[h+23];d.d=j;d.dd=Util.appendZero(j);d.w=n;d.ww=Util.Date.DAY_NAMES[n];d.W=Util.Date.DAY_NAMES[n+14];d.WW=Util.Date.DAY_NAMES[n+7];d.H=k;d.HH=Util.appendZero(k);d.h=k==0?12:k>12?k-12:k;d.hh=Util.appendZero(d.h);d.K=k>11?k-12:k;d.k=k+1;d.KK=Util.appendZero(d.K);d.kk=Util.appendZero(d.k);d.a=k>11?"PM":"AM";d.n=q;d.nn=Util.appendZero(q);d.s=t;d.ss=Util.appendZero(t);for(d.sss=u;f<c.length;){g=
c.charAt(f);for(h="";c.charAt(f)==g&&f<c.length;)h+=c.charAt(f++);e+=d[h]!=null?d[h]:h}return e};Util.parseDate=function(a,b){function c(a,b,c,d){for(;d>=c;d--){var e=a.substring(b,b+d);if(e.length<c)break;if(/^[\d]{1,4}$/.test(e))return e}return null}if(typeof a=="object"&&a instanceof Date)return a;if(!b){var d=Date.parse(a);if(d>0)return new Date(d)}for(var d=a+"",e=b||"yyyy-mm-dd HH:nn:ss",f=0,g=0,h=0,j=f="",n,k,q=new Date,t=q.getFullYear(),u=q.getMonth()+1,s=1,r=q.getHours(),w=q.getMinutes(),
q=q.getSeconds(),x="";h<e.length;){f=e.charAt(h);for(j="";e.charAt(h)==f&&h<e.length;)j+=e.charAt(h++);switch(j){case "yyyy":case "yy":case "y":j=="yyyy"&&(k=n=4);j=="yy"&&(k=n=2);j=="y"&&(n=2,k=4);t=c(d,g,n,k);if(t==null)return 0;g+=t.length;t.length==2&&(t=t>70?1900+(t-0):2E3+(t-0));break;case "MM":case "M":case "mmm":for(f=u=0;f<Util.Date.MONTH_NAMES.length;f++){var z=Util.Date.MONTH_NAMES[f];if(d.substring(g,g+z.length).toLowerCase()==z.toLowerCase()&&(j=="mmm"||j=="MM"||j=="M"&&f>23)){u=f+1;
u>12&&(u%=12);g+=z.length;break}}if(u<1||u>12)return 0;break;case "WW":case "W":case "ww":case "w":if(j!="w")for(f=0;f<Util.Date.DAY_NAMES.length;f++){if(j=Util.Date.DAY_NAMES[f],d.substring(g,g+j.length).toLowerCase()==j.toLowerCase()){g+=j.length;break}}else g+=1;break;case "mm":case "m":u=c(d,g,j.length,2);if(u==null||u<1||u>12)return 0;g+=u.length;break;case "dd":case "d":s=c(d,g,j.length,2);if(s==null||s<1||s>31)return 0;g+=s.length;break;case "hh":case "h":r=c(d,g,j.length,2);if(r==null||r<
1||r>12)return 0;g+=r.length;break;case "HH":case "H":r=c(d,g,j.length,2);if(r==null||r<0||r>23)return 0;g+=r.length;break;case "KK":case "K":r=c(d,g,j.length,2);if(r==null||r<0||r>11)return 0;g+=r.length;break;case "kk":case "k":r=c(d,g,j.length,2);if(r==null||r<1||r>24)return 0;g+=r.length;r--;break;case "nn":case "n":w=c(d,g,j.length,2);if(w==null||w<0||w>59)return 0;g+=w.length;break;case "ss":case "s":q=c(d,g,j.length,2);if(q==null||q<0||q>59)return 0;g+=q.length;break;case "a":if(d.substring(g,
g+2).toLowerCase()=="am")x="AM";else if(d.substring(g,g+2).toLowerCase()=="pm")x="PM";else return 0;_val+=2;break;default:if(d.substring(g,g+j.length)!=j)return 0;else g+=j.length}}if(g!=d.length)return 0;if(u==2)if(t%4==0&&t%100!=0||t%400==0){if(s>29)return 0}else if(s>28)return 0;if((u==4||u==6||u==9||u==11)&&s>30)return 0;r<12&&x=="PM"?r=r-0+12:r>11&&x=="AM"&&(r-=12);return new Date(t,u-1,s,r,w,q)};Util.getWeekDay=function(a,b){return Util.Date.DAY_NAMES[((b||1)-1)*7+a]};Util.getDateByTimezone=
function(a,b){var c=a.getTime()+-288E5;return new Date(c+36E5*b)};Util.convertTimezoneDate=function(a,b,c){a=a.getTime()+-b*36E5;return new Date(a+36E5*c)};Util.dom2Obj=function(a){var b=null;if(a){var c,d,e,f;if(a.nodeType==9)for(c=0,d=a.childNodes,a=d.length;c<a&&(e=d[c]);c++){if(e.nodeType==1){b=this.dom2Obj(e);break}}else switch(a.nodeName){case "object":b={};for(c=0,d=a.childNodes,a=d.length;c<a&&(e=d[c]);c++)if(e.nodeType==1){f="";if(e.attributes)f=e.attributes.getNamedItem("name").value;f&&
(b[f]=this.dom2Obj(e))}break;case "array":b=[];for(c=0,d=a.childNodes,a=d.length;c<a&&(e=d[c]);c++)e.nodeType==1&&b.push(this.dom2Obj(e));break;case "int":case "long":case "number":b=this.getXMLValue(a);b=b.trim()==""?"0":b;b=parseInt(b,10);break;case "boolean":b=this.getXMLValue(a)=="true"?!0:!1;break;case "date":b=this.str2Date(this.getXMLValue(a));break;case "base64":b=this.getXMLValue(a);break;case "null":b=null;break;default:b=this.getXMLValue(a)}}return b};Util.dom2Obj2=function(a){var b=null;
if(a){var c,d,e,f;if(a.nodeType==9)for(c=0,d=a.childNodes,a=d.length;c<a&&(e=d[c]);c++){if(e.nodeType==1){b=this.dom2Obj2(e);break}}else switch(a.nodeName){case "object":b={};for(c=0,d=a.childNodes,a=d.length;c<a&&(e=d[c]);c++)if(e.nodeType==1)(f=e.nodeName)&&(b[f]=this.dom2Obj2(e));break;case "array":b=[];for(c=0,d=a.childNodes,a=d.length;c<a&&(e=d[c]);c++)e.nodeType==1&&b.push(this.dom2Obj2(e));break;case "int":case "long":case "number":b=this.getXMLValue(a);b=b.trim()==""?"0":b;b=parseInt(b,10);
break;case "boolean":b=this.getXMLValue(a)=="true"?!0:!1;break;case "date":b=this.str2Date(this.getXMLValue(a));break;case "base64":b=this.getXMLValue(a);break;case "null":b=null;break;default:b=this.getXMLValue(a)}}return b};Util.obj2Dom=function(a){function b(a){var e,f,g;if(a!=null)switch(a.constructor){case Boolean:e=c.createElement("boolean");e.appendChild(c.createTextNode(a?"true":"false"));break;case String:e=c.createElement("string");e.appendChild(c.createTextNode(a.toString()));break;case Number:e=
a.toString().indexOf(".")>=0?c.createElement("number"):a<-1073741824||a>=1073741824?c.createElement("long"):c.createElement("int");e.appendChild(c.createTextNode(a.toString()));break;case Date:e=c.createElement("date");a=Util.date2Str(a);e.appendChild(c.createTextNode(a));break;case Array:e=c.createElement("array");for(f=0,g=a.length;f<g;++f){var h=b(a[f]);e.appendChild(h)}break;default:for(f in e=c.createElement("object"),a)g=a[f],typeof g!="undefined"&&typeof g!="function"&&(g=b(g),e.appendChild(g),
e.lastChild.setAttribute("name",f))}else e=c.createElement("null");return e}var c=Util.getXMLDom();return!c?this.error("Create DOM error."):b(a)};Util.obj2Dom2=function(a){function b(a){var e,f,g;if(a!=null)switch(a.constructor){case Boolean:e=c.createElement("boolean");e.appendChild(c.createTextNode(a?"true":"false"));break;case String:e=c.createElement("string");e.appendChild(c.createTextNode(a.toString()));break;case Number:e=a.toString().indexOf(".")>=0?c.createElement("number"):a<-1073741824||
a>=1073741824?c.createElement("long"):c.createElement("int");e.appendChild(c.createTextNode(a.toString()));break;case Date:e=c.createElement("date");a=Util.date2Str(a);e.appendChild(c.createTextNode(a));break;case Array:e=c.createElement("array");for(f=0,g=a.length;f<g;++f){var h=b(a[f]);e.appendChild(h)}break;default:for(f in e=c.createElement("object"),a)g=a[f],typeof g!="undefined"&&typeof g!="function"&&(h=c.createElement(f),h.appendChild(c.createTextNode(g)),e.appendChild(h))}else e=c.createElement("null");
return e}var c=Util.getXMLDom();return!c?this.error("Create DOM error."):b(a)};Util.dom2Str=function(a){return window.XMLSerializer?(new XMLSerializer).serializeToString(a):a.xml};Util.str2Dom=function(a){Browser.value=="opera"&&(a=a.replace(/&lt;/gi,"<").replace(/&gt;/gi,">"));var b;if(window.ActiveXObject){if(b=Util.getXMLDom(),b.loadXML(a),b.parseError!=0)return null}else if(window.DOMParser){if(b=(new DOMParser).parseFromString(a,"text/xml"),!b.documentElement||b.documentElement.tagName=="parsererror")return null}else b=
document.createElement("div"),b.innerHTML=a;return b};Util.obj2Str=function(a){return this.dom2Str(this.obj2Dom(a))};Util.obj2Str2=function(a){return this.dom2Str(this.obj2Dom2(a))};Util.str2Obj=function(a){return this.dom2Obj(this.str2Dom(a))};Util.formatSize=function(a,b,c,d){var e="K",a=Util.str2Num(a,2),c=isNaN(parseInt(c,10))?"":c,f=a,d=typeof d=="string"?d:" ";if(typeof b=="string")switch(b=b.toUpperCase(),b){case "B":f=a;e="B";break;case "K":e="K";f=a.div(1024);break;case "M":e="M";f=a.div(1048576);
break;case "G":e="G",f=a.div(1073741824)}else 1024<=a&&a<1048576?(e="K",f=a.div(1024)):1048576<=a&&a<1073741824?(e="M",f=a.div(1048576)):a>=1073741824?(e="G",f=a.div(1073741824)):e="B";return typeof c=="number"?Util.str2Num(f,c)+d+e:Util.str2Num(f)+d+e};Util.getSizeByByte=function(a,b){var c;c=((a||"")+"").replace(/\s/g,"");c=/(\d+\.?\d*)([BKMG]?)/i.exec(c);var d=0,e="";c!=null&&(d=c[1],e=c[2]);d=Util.str2Num(d);typeof b=="string"&&b!=""&&(e=b);e=e.toUpperCase();switch(e){case "K":d=d.mul(1024);break;
case "M":d=d.mul(1048576);break;case "G":d=d.mul(1073741824)}return d};Util.getFileClasssName=function(a){var a=a.toLowerCase(),b="other";if(a.lastIndexOf(".")>0)if(a=a.substr(a.lastIndexOf(".")+1),a=="7z")b="rar";else for(var c="other,tif,txt,psd,rar,zip,xml,html,java,fon,ico,jfif,jpg,jpe,gif,png,jpeg,bmp,tif,tiff,mpeg,avi,wmv,mov,mpg,vob,rmvb,mp3,wma,wav,asf,mp4,sis,sisx,cab,doc,docx,pdf,xls,xlsx,ppt,pptx,swf,fla,share,folder,mp3-hover,upload,i-hand,flv,folder-m,folder-p,exe,css,rm,midi,chm,iso,vsd,no-load".split(","),
d=0;d<c.length;d++)if(a.indexOf(c[d])>=0){b=c[d];break}return b};Util.emptyFunction=function(){};Util.error=function(a,b){b?CC.showMsg(this.obj2Str(b),!0):CC.showMsg(a,!0);return!1};Util.writeLogError=function(a,b,c){Util.writeLog(a,b,c,gConst.logLevel.error)};Util.writeLog=function(a,b,c,d){if(IsWriteLog!="0"){var e=gMain.webLogServer+"/service/weblog.ashx",a={func:a,level:d||gConst.logLevel.info,sid:gMain.sid,uid:gMain.userNumber,reqUrl:encodeURIComponent(b),msg:encodeURIComponent(c)},a=Util.getUrlData(a);
e+="?"+a;e.length>gConst.webLogLength&&(e=e.lefts(gConst.webLogLength,!0));(a=$("weblog_img"+d))?a.src=e:(a=new Image,a.id="weblog_img"+d,a.src=e,a.style.display="none",document.body.appendChild(a))}};Util.getStack=function(){for(var a=arguments.callee,b="";a;)b+=a.toString().match(/function\s*(\w*\([^(]*\))/)[1]+"\n",a=a.caller;return b};Util.subFunc={};Util.getUrlData=function(a){var a=a||[],b=[],c=0;Util.eachObj(a,function(a,e){b[c]=a+"="+e;c++});return b.join("&")};Util.each=function(a,b){a&&
b&&(a instanceof Array?a.each(b):typeof a=="object"&&Util.eachObj(a,b))};Util.eachObj=function(a,b){if(typeof a=="object")for(var c in a)b(c,a[c])};Util.getFileShortName=function(a,b){b=b||20;if(a){if(a.length<=b)return a;if(a.lastIndexOf(".")==-1)return a.substring(0,b-3)+"...";var c=parseInt((b-10)/2,10);return a.replace(RegExp("^(.{"+c+"}).*(.{"+c+"}.[^.]+)$"),"$1......$2")}else return""};Util.getFileNameByPath=function(a){return a.replace(/^.+?\\([^\\]+)$/,"$1")};Util.jsonToXml=function(a){return Util.varToXml(null,
a,"\n").substr(1)};Util.varToXml=function(a,b,c){function d(a){return a?(a=a.replace(/[\x00-\x08\x0b\x0e-\x1f]/g,""),a.substr(0,9)=="<![CDATA["?a:a.encodeXML()):""}function e(a,b,c){var e="<"+a;b&&(e+=' name="'+d(b)+'"');return c?(e+=">"+c,c.charAt(c.length-1)==">"&&(e+="\n"),e+"</"+a+">"):e+"></"+a+">"}if(b==null)return c+e("null",a);var f="",g="",h=Util.getVarType(b);switch(h){case "object":if(b.nodeType)return"";for(var j in b)f+=Util.varToXml(j,b[j],c+"  ");g=c;break;case "array":for(g=0;g<b.length;g++)f+=
Util.varToXml(null,b[g],c+"  ");g=c;break;case "date":f=Util.formatDate(b,"yyyy-mm-dd");if(b.getHours()>0||b.getMinutes()>0||b.getSeconds()>0)f=Util.formatDate(b,"yyyy-mm-dd HH:nn:ss");break;case "boolean":f=b.toString();break;case "string":f=d(b);break;case "number":f=b.toString();h=Util.getNumberType(b);break;default:return""}return c+e(h,a,f+g)};Util.getNumberType=function(a){var b="number";a.toString().indexOf(".")==-1&&(a>=-2147483648&a<2147483648?b="int":isNaN(a)||(b="long"));return b};Util.getVarType=
function(a){var b=Object.prototype.toString,c={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"};return c[typeof a]||c[b.call(a)]||(a?"object":"null")};Util.unique=function(a,b){if(a){var c={},d=0,e="";if(typeof b=="function"){for(d=0;d<a.length;d++){var e=a[d],f=b(e);typeof c[f]=="undefined"&&f!=""&&(c[f]=e)}a.length=0;for(d in c)a[a.length]=
c[d]}else{for(d=0;d<a.length;d++)e=a[d],typeof c[e]=="undefined"&&e!=""&&(c[e]=1);a.length=0;for(f in c)a[a.length]=f}return a}};Util.binarySearch=function(a,b,c){var d=0,e=a.length-1,f=Math.floor((d+e)/2);if(typeof c=="function"){for(;c(f)!=b&&d<e;)b<a[f]?e=f-1:d=f+1,f=Math.floor((e+d)/2);return c(f)!=b?-1:f}else{for(;a[f]!=b&&d<e;)b<a[f]?e=f-1:d=f+1,f=Math.floor((e+d)/2);return a[f]!=b?-1:f}};Util.getRmCode=function(a){return typeof a=="object"&&(a=a.match(/(\w+)\s+[\s\S]+=(\d+)/i))?(a[1]||"").toUpperCase()+
(a[2]||""):""};Util.formToObject=function(a){if(!a)return null;for(var b={},c=[],d=0;d<a.elements.length;d++){var e=a.elements[d],f=e.type,g=e.getAttribute("format")||"string",h=e.name;if(h){var j="";if(f.substring(0,6)=="select")j=e.options[e.selectedIndex].value;else if(f=="text"||f=="textarea"||f=="password"||f=="hidden")j=e.value;else if(f=="radio"){var n=a[h];if(c.has(h))continue;else c.push(h);for(e=0;e<n.length;e++)if(n[e].checked){j=n[e].value;break}}else if(f=="checkbox"){if(c.has(h))continue;
else c.push(h);j=[];for(e=0;e<n.length;e++)n[e].checked&&j.push(n[e].value)}j=g=="int"?Util.str2Num(j,0,"num"):g=="boolean"?j?!0:!1:j||"";b[h]=j}}return b};Util.jsonToForm=function(a,b){if(!b)return null;for(var c=0;c<b.elements.length;c++){var d=b.elements[c],e=d.type,f=d.name;if(e=="text"||e=="textarea"||e=="password"){if(a[f])d.value=a[f].decodeHTML()}else if(e.substring(0,6)=="select")for(e=0;e<d.options.length;e++){if(d.options[e].value==a[f])d.options[e].selected=!0}else if((e=="checkbox"||
e=="radio")&&d.value==a[f])d.checked=!0}};Util.formToJson=function(a){return JSON.stringify(Util.formToObject(a))};Util.setAttrsValue=function(a,b,c){var d="";a?(a=a.decodeHTML(),d=RegExp("(^|&|\\?|\\s)"+b+"\\s*=\\s*([^&]*?)(\\s|&|$)","i"),d=d.exec(a)?a.replace(d,"$1"+b+"="+c+"$3"):a+"&"+name+"="+c):d=name+"="+c;return d.encodeHTML()};Util.getFileExtensionCss=function(a){for(var a=a.toLowerCase(),b="other",c=[{eName:"tif",cName:"tif"},{eName:"txt",cName:"txt"},{eName:"no-load",cName:"no-load"},{eName:"psd",
cName:"psd"},{eName:"rar",cName:"rar"},{eName:"zip",cName:"zip"},{eName:"xml",cName:"xml"},{eName:"html",cName:"html"},{eName:"java",cName:"java"},{eName:"fon",cName:"fon"},{eName:"jpg",cName:"jpg"},{eName:"gif",cName:"gif"},{eName:"png",cName:"png"},{eName:"bmp",cName:"bmp"},{eName:"tiff",cName:"tiff"},{eName:"mpeg",cName:"mpeg"},{eName:"avi",cName:"avi"},{eName:"wmv",cName:"wmv"},{eName:"mov",cName:"mov"},{eName:"mpg",cName:"mpg"},{eName:"vob",cName:"vob"},{eName:"rmvb",cName:"rmvb"},{eName:"mp3",
cName:"mp3"},{eName:"wma",cName:"wma"},{eName:"wav",cName:"wav"},{eName:"asf",cName:"asf"},{eName:"mp4",cName:"mp4"},{eName:"sis",cName:"sis"},{eName:"sisx",cName:"sisx"},{eName:"cab",cName:"cab"},{eName:"doc",cName:"doc"},{eName:"docx",cName:"docx"},{eName:"pdf",cName:"pdf"},{eName:"xls",cName:"xls"},{eName:"xlsx",cName:"xlsx"},{eName:"ppt",cName:"ppt"},{eName:"pptx",cName:"pptx"},{eName:"swf",cName:"swf"},{eName:"fla",cName:"fla"},{eName:"share",cName:"share"},{eName:"folder",cName:"folder"},{eName:"mp3-hover",
cName:"mp3-hover"},{eName:"upload",cName:"upload"},{eName:"i-hand",cName:"i-hand"},{eName:"flv",cName:"flv"},{eName:"folder-m",cName:"folder-m"},{eName:"folder-p",cName:"folder-p"},{eName:"exe",cName:"exe"},{eName:"css",cName:"css"},{eName:"rm",cName:"rm"},{eName:"midi",cName:"midi"},{eName:"chm",cName:"chm"},{eName:"iso",cName:"iso"},{eName:"vsd",cName:"vsd"},{eName:"htm",cName:"html"}],d=0;d<c.length;d++)if(a.indexOf(c[d].eName)>=0){b=c[d].cName;break}return b};Util.ajaxForm=function(a){function b(a){var b;
try{b=document.createElement('<iframe name="'+a+'"></iframe>')}catch(c){b=document.createElement("iframe"),b.name=a}b.id=a;b.style.display="none";return b}var c=document,d=c.body,c=c.createElement("form"),e=function(a,b){var c=document.createElement("input");c.value=b;c.name=a;c.type="hidden";return c}(a.inputName,a.data);c.name=a.formName;c.method="post";c.action=a.url;c.encoding&&c.setAttribute("encoding","multipart/form-data");c.setAttribute("enctype","multipart/form-data");document.getElementById(a.iframeName)||
d.appendChild(b(a.iframeName));c.target=a.iframeName;c.appendChild(e);d.appendChild(c);c.submit();d.removeChild(c)};Util.keyHighLight=function(a,b,c,d,e){d=(d||"<span style='background-color:Gold;padding-left:2px;padding-right:2px;'>")+a+(e||"</span>");regTrim=function(a){var b={"^":"\\^",".":"\\.","\\":"\\\\","|":"\\|","(":"\\(",")":"\\)","*":"\\*","+":"\\+","-":"\\-",$:"$","[":"\\[","]":"\\]","?":"\\?"};return a=a.replace(/[\^\.\\\|\(\)\*\+\-\$\[\]\?]/g,function(a){return b[a]})};a=RegExp(regTrim(a),
"g");c?(b=b.decodeHTML(),b=b.replace(a,"{keyHighLight}").encodeHTML(),b=b.replace(RegExp("{keyHighLight}","g"),d)):b=b.replace(a,d);return b}})();var Vd=function(){};
Vd.limitMaxInput=function(a,b,c,d,e){function f(){var f=a.value,h=!d?f.length:f.len(),k=0;Browser.value=="firefox"&&(h=f.replace(/\n/gi,"**"),h=!d?h.length:h.len());g=h==b-1?!0:!1;h>b?(h="",h=b,Browser.value=="firefox"&&(k=f.match(/\n[^$]/g))&&(h=b-k.length),h=d?f.left(h):f.lefts(h),a.value=h,k=0):(k=b-h,k<0&&(k=0));c&&typeof c=="object"?(c.innerHTML=k,typeof e=="function"&&e()):typeof c=="function"&&c(k)}if(a&&typeof a=="object"){var g=!1;f();window.Browser.value=="ie"&&window.Browser.version!=9?
EV.observe(a,"propertychange",f):(EV.observe(a,"input",f),EV.observe(a,"blur",f));EV.observe(a,"keypress",function(a){g&&EV.getCharCode(a)==13&&EV.stopEvent(a);return!0});var h=El.getParentNodeIsTag(a,"form");h&&EV.observe(h,"reset",function(){window.setTimeout(f,100)})}};
Vd.CheckEmail=function(a,b,c,d){if(a&&typeof a=="object"){var e=a.value.trim(),f=[],g=[],h=[],j=function(){a.focus()},e=e.replace(/[\r\n\t]/gi,""),e=e.replace(/[,;\uff0c\uff1b]{2,}/gi,",");e.substr(e.length-1)==","&&(e=e.substr(0,e.length-1));if(!e||e=="")return a.value=e,!0;for(var e=e.split(/[,;\uff0c\uff1b]/),h=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})$/i,n=0;n<e.length;n++)e[n].trim().match(h)===null?g.push(e[n]):f.push(e[n]);if(g.length===
0){if(h=e.strip().unique(),h.length>0){b&&(msg=Lang.Mail.other_InputMailRepeat+"<br>"+h.join(",").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/,/g,"<br>"),CC.alert(msg,null,Lang.Mail.sys_SystemInfo,j));if(c)a.value=f.unique().join(",");d&&typeof d!="function"&&d();return!1}}else{b&&(msg=Lang.Mail.other_InputMailError+"<br>"+g.join(",").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/,/g,"<br>"),CC.alert(msg,null,Lang.Mail.sys_SystemInfo,j));if(c)a.value=f.unique().join(",");d&&typeof d!=
"function"&&d();return!1}return!0}};
Vd.checkData=function(a,b,c){var b=b.trim(),d="";switch(a){case "email":d=/^([A-Z0-9._%-]{1,255})@[A-Z0-9._%-]+\.[A-Z0-9]{1,4}$/i;break;case "mobile":d=/^(0?86)?1[\d]{10}$/i;break;case "phone":d=/^0[\d]{2,3}[\d]{7,8}$/i;break;case "empty":d=/^.+/i;break;case "number":case "int":d=/^[0-9]+$/i;break;case "domain":d=/^[A-Z0-9._%-]+\.[A-Z0-9]{1,4}$/i;break;case "blackDomain":d=/^(\*@)[A-Z0-9._%-]+\.[A-Z0-9]{1,4}$/i;break;case "*@domain":d=/^(\*@)[A-Z0-9._%-]+\.[A-Z0-9]{1,4}$/i;break;case "@domain":d=
/^(@)[A-Z0-9._%-]+\.[A-Z0-9]{1,4}$/i;break;case "port":return b>0&&b<65535?!0:!1;case "reg":d=c;break;case "custom":d=RegExp(c,"gi")}try{return d?d.test(b):!1}catch(e){return!1}};Vd.replaceEmail=function(a){if(!a)return"";var b=[],a=a.replace(/\r\n|\n|\s/g,""),a=a.replace(/".*?"|[<>]/gi,""),a=a.replace(/[;,]{2,}]|[\uff1b\uff0c]/g,","),a=a.replace(/^,|,$/g,""),a=a.split(","),a=a.unique();a.each(function(a,d){Vd.checkData("email",d)&&(b[a]=d)});return b.join(",")};
Vd.getMailList=function(a){var b=[];if(!a)return b;m=Vd.replaceEmail(a);a=m.split(",");a=a.unique();a.each(function(a,d){Vd.checkData("email",d)&&(b[a]=d)});return b};Vd.checkMobile=function(a){var b=gMain.mobileTypec||"1";return(b=="0"?/^(86)?((13[0-9])|(15[0-9])|(18[0-9])|(14[0-9]))+\d{8}$/:b=="1"?/^(86)?((13[4-9]{1})|(15[0-2 7-9]{1})|(18[2 7-8]{1}))+\d{8}$/:b=="2"?/^(86)?((13[3]{1})|(15[3]{1})|(18[9]{1}))+\d{8}$/:b=="4"?/^(86)?((13[0-2]{1})|(15[5-6]{1})|(18[6]{1}))+\d{8}$/:/^(86)?((13[4-9]{1})|(15[0-2 7-9]{1})|(18[2 7-8]{1}))+\d{8}$/).test(a)};
Vd.getMobileList=function(){};Vd.checkUrl=function(a){return/^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]':+!]*([^<>\"\"])*$/.test(a||"")?!0:!1};Vd.getRmDomain=function(a){return this.checkData("*@domain",a)?a:this.checkData("@domain",a)?"*"+a:this.checkData("domain",a)?"*@"+a:a};
function GEInit(){cmail.GlobeEngine=cmail.createClass();cmail.GlobeEngine.prototype={initialize:function(){cmail.initMethod(cmail.GlobeEngine,["init"])},init:function(){this.isLoaded=!0},name:"GlobeEngine"};var a=cmail.createClass();a.prototype={editContent:"",oLinks:null,currentTab:0,currentNav:null,dragNav:null,pref_quota:2048,tempFrame:top.frames.template,timeS:new Date,timeC:new Date,titles:[],network:1,tab:null,pos:function(){return El.pos($(gConst.divMain))},subMenu:[],cSubmenu:null,cRelSubmenu:[],
cRelItem:[],urls:{},folder:{search:0,inbox:1,draft:2,sent:3,del:4,junk:5,virus:6,limit:gMain.maxFolders-0||15,labelLimit:50,sys:"sys",admin:"admin",user:"user",pop:"pop",label:"label",inner:"inner"},folderType:{sys:1,user:3,label:5,pop:6},folderObj:{search:"sys0",inbox:"sys1",draft:"sys2",sent:"sys3",del:"sys4",junk:"sys5",virus:"sys6"},priority:{hight:1,common:3,low:5},list:{order:"receiveDate",orderField:"receiveDate,from,to,size,subject,sendDate,status".split(","),orderCount:5,pageSize:20,topmid:""},
signLimit:5,diskFiles:[],newMail:0,maxComposeId:0,maxFolder:1E4,sysLocation:1,adminLocation:5E3,userLocation:1E4,labelLocation:3E4,allLocation:5E4,locationAdd:100,lastComposeId:"",secondSearch:{fid:"0",name:"sys0"},isSecondSearch:!1,topNum:0,topMids:[],addrList:{}};Object.extend(cmail.GlobeEngine.prototype,new a)}
var gMenu=[{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MARK_READ",text:"\u5df2\u8bfb",sortId:0,url:"menu",urlType:2},{attrs:"sep=true",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MARK_UNREAD",text:"\u672a\u8bfb",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MARK_URGENT",text:"\u7d27\u6025",sortId:0,url:"menu",urlType:2},{attrs:"sep=true",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MARK_COMMON",text:"\u666e\u901a",sortId:0,url:"menu",
urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MARK_TOP",text:"\u7f6e\u9876",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MARK_NOTOP",text:"\u53d6\u6d88\u7f6e\u9876",sortId:0,url:"menu",urlType:2},{attrs:"getsub=true",checked:!1,children:[{}],isShow:!0,name:"MAIL_INBOX_MARK",text:"\u6807\u8bb0",sortId:0,url:"menu",urlType:2,sort:4},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_ALL",text:"\u5168\u90e8",sortId:0,
url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_READ",text:"\u5df2\u8bfb",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_NOREAD",text:"\u672a\u8bfb",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_COMMENTS",text:"\u5df2\u56de\u590d",sortId:0,url:"menu",urlType:2},{attrs:"sep=true",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_FORWARD",text:"\u5df2\u8f6c\u53d1",
sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_STARRED",text:"\u5df2\u52a0\u661f\u6807",sortId:0,url:"menu",urlType:2},{attrs:"sep=true",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_UNSTARRED",text:"\u672a\u52a0\u661f\u6807",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_ATTACHMENT",text:"\u542b\u9644\u4ef6",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_NOATTACHMENT",
text:"\u65e0\u9644\u4ef6",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_FILTER_URGENT",text:"\u7d27\u6025",sortId:0,url:"menu",urlType:2},{attrs:"getsub=true",checked:!1,children:[{}],isShow:!0,name:"MAIL_INBOX_FILTER",text:"\u7b5b\u9009",sortId:0,url:"menu",urlType:2,sort:6},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_MORE_MAILEXPORT",text:"\u5bfc\u51fa\u9009\u4e2d\u90ae\u4ef6",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],
isShow:1,name:"MAIL_INBOX_MORE_MAILIMPORT",text:"eml\u90ae\u4ef6\u5bfc\u5165",sortId:0,url:"menu",urlType:2},{attrs:"getsub=true",checked:!1,children:[{}],isShow:!0,name:"MAIL_INBOX_MORE",text:"\u66f4\u591a",sortId:0,url:"menu",urlType:2,sort:8},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_LABELMAIL",text:"menu.web.mail_inbox_labelmail",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:!0,name:"MAIL_INBOX_INFORM",text:"\u52a0\u5165\u9ed1\u540d\u5355",sortId:0,url:"menu",
urlType:2,sort:7},{attrs:"className=edit",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_EDIT",text:"\u7f16\u8f91",sortId:0,url:"menu",urlType:2},{attrs:"className=forward",checked:!1,children:[],isShow:!0,name:"MAIL_INBOX_FORWARD",text:"\u8f6c\u53d1",sortId:0,url:"menu",urlType:2,sort:3},{attrs:"className=refresh",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_REFRESH",text:"\u5237\u65b0",sortId:0,url:"menu",urlType:2},{attrs:"className=delete",checked:!1,children:[],isShow:!0,name:"MAIL_INBOX_DELETE",
text:"\u5220\u9664",sortId:0,url:"menu",urlType:2,sort:1},{attrs:"className=delete",checked:!1,children:[],isShow:!0,name:"MAIL_INBOX_REALDELETE",text:"\u5f7b\u5e95\u5220\u9664",sortId:0,url:"menu",urlType:2,sort:2},{attrs:"className=deleteAll",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_EMPTY",text:"\u6e05\u7a7a",sortId:0,url:"menu",urlType:2},{attrs:"className=move&amp;getsub=true",checked:!1,children:[],isShow:!0,name:"MAIL_INBOX_MOVE",text:"\u79fb\u52a8\u5230",sortId:0,url:"menu",urlType:2,
sort:5},{attrs:"className=search",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_SEARCH",text:"\u641c\u7d22\u90ae\u4ef6",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_REFUSE",text:"\u62d2\u6536",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_NOTJUNK",text:"\u8fd9\u4e0d\u662f\u5783\u573e\u90ae\u4ef6",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_ISMONITOR",text:"menu.web.mail_inbox_ismonitor",
sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_INBOX_ISAUDIT",text:"menu.web.mail_inbox_isaudit",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL_INBOX",text:"\u6536\u4ef6\u7bb1",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_ACCOUNT",text:"menu.web.mail_config_account",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_PASSWORD",text:"\u4fee\u6539\u5bc6\u7801",
sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_AUTOREPLY",text:"\u81ea\u52a8\u56de\u590d&nbsp;",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_AUTOFORWARD",text:"\u81ea\u52a8\u8f6c\u53d1",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_FOLDERPOP",text:"\u4ee3\u6536\u6587\u4ef6\u5939&nbsp;",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_BLACK",
text:"\u9ed1\u540d\u5355",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_WHITE",text:"\u767d\u540d\u5355",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_FILTER",text:"\u90ae\u4ef6\u5206\u62e3",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_ATTACHMANAGER",text:"\u9644\u4ef6\u7ba1\u7406",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_FTR",
text:"menu.web.mail_config_ftr",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_SKIN",text:"menu.web.mail_config_skin",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_MAILMOVE",text:"menu.web.mail_config_mailmove",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_CLIENTSET",text:"menu.web.mail_config_clientset",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_PHONEBIND",
text:"menu.web.mail_config_phonebind",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_FONTSIZE",text:"menu.web.mail_config_fontsize",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_FACE",text:"\u754c\u9762\u8bbe\u7f6e&nbsp;",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_PREF",text:"\u57fa\u672c\u53c2\u6570",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,
name:"MAIL_CONFIG_SESSIONMODE",text:"menu.web.mail_config_sessionmode",sortId:0,url:"menu",urlType:1},{attrs:"className=setSignature",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_SIGN",text:"\u90ae\u4ef6\u7b7e\u540d",sortId:0,url:"menu",urlType:2},{attrs:"className=setPop",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_MAILPOP",text:"\u90ae\u4ef6\u4ee3\u6536",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_MAILSEARCH",text:"menu.web.mail_config_mailsearch",
sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_NOTIFY",text:"menu.web.mail_config_notify",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_LOGINNOTIFY",text:"menu.web.mail_config_loginnotify",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_CONFIG_FOLDERLOCK",text:"\u5b89\u5168\u9501",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL_CONFIG",text:"\u8bbe\u7f6e",
sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_RESEND",text:"\u518d\u6b21\u53d1\u9001",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_COLORTHEME",text:"menu.web.mail_write_colortheme",sortId:0,url:"",urlType:1},{attrs:"className=send",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_SEND",text:"\u53d1\u9001",sortId:0,url:"menu",urlType:2},{attrs:"className=save",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_SAVE",
text:"\u5b58\u8349\u7a3f",sortId:0,url:"menu",urlType:2},{attrs:"className=print",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_PRINT",text:"\u6253\u5370\u9884\u89c8",sortId:0,url:"menu",urlType:2},{attrs:"className=cancel",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_CANCEL",text:"\u53d6\u6d88",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_WRITE_ATTACH",text:"\u9644\u4ef6\u4e0a\u4f20",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,
name:"MAIL_WRITE_FLASH",text:"Flash\u9644\u4ef6\u4e0a\u4f20",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_WRITE_DISK",text:"\u6587\u4ef6\u67dc\u9644\u4ef6\u4e0a\u4f20",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_WRITE_LP",text:"\u4fe1\u7eb8\u6a21\u5757",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_WRITE_ADDR",text:"\u53f3\u8fb9\u901a\u8baf\u5f55\u6a21\u5757",sortId:0,url:"",urlType:2},{attrs:"",
checked:!1,children:[],isShow:0,name:"MAIL_WRITE_FILL",text:"\u8054\u7cfb\u4eba\u81ea\u52a8\u5b8c\u6210",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_WRITE_CAPTURE",text:"\u622a\u5c4f\u529f\u80fd",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_WRITE_TEMPLATE",text:"\u5199\u4fe1\u6a21\u677f",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_WRITE_DENYFORWARD",text:"menu.web.mail_write_denyforward",sortId:0,
url:"",urlType:2},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL_WRITE",text:"\u5199\u4fe1\u6a21\u5757",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_DOWNLOAD",text:"\u4e0b\u8f7d\u539f\u6587",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_REPLYATTACH",text:"\u5e26\u4e0a\u539f\u90ae\u4ef6\u7684\u9644\u4ef6",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_REPLYNOATTACH",
text:"\u4e0d\u5e26\u539f\u90ae\u4ef6\u7684\u9644\u4ef6",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_REPLYALLNOATTACH",text:"\u4e0d\u5e26\u539f\u90ae\u4ef6\u7684\u9644\u4ef6",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_REPLYALLATTACH",text:"\u5e26\u4e0a\u539f\u90ae\u4ef6\u7684\u9644\u4ef6",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_ATTACHPREVIEW",text:"menu.web.mail_read_attachpreview",
sortId:0,url:"",urlType:3},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_BATCHADDADDR",text:"menu.web.mail_read_batchaddaddr",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_REPLY",text:"\u56de\u590d",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_REPLYALL",text:"\u56de\u590d\u6240\u6709",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_PRINT",text:"\u6253\u5370",sortId:0,
url:"menu",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_READ_VIEW",text:"\u67e5\u770b\u539f\u6587",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL_READ",text:"menu.web.mail_read",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_FOLDER_ADD",text:"\u65b0\u5efa",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_FOLDER_DEL",text:"\u5220\u9664",sortId:0,url:"",urlType:2},{attrs:"",
checked:!1,children:[],isShow:0,name:"MAIL_FOLDER_EMPTY",text:"\u6e05\u7a7a",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_FOLDER_UPDATE",text:"\u4fee\u6539",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"MAIL_FOLDER_SORT",text:"\u6392\u5e8f",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL_FOLDER",text:"menu.web.mail_folder",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_WELCOME",
text:"menu.web.mail_welcome",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_SECURITY_MAIL",text:"menu.web.mail_security_mail",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_SECURITY_KWF",text:"menu.web.mail_security_kwf",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"MAIL_SECURITY_SM",text:"menu.web.mail_security_sm",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL_SECURITY",
text:"menu.web.mail_security",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"MAIL",text:"\u90ae\u7bb1",sortId:0,url:"",urlType:2},{attrs:"isBold=true&amp;param=2",checked:!1,children:[],isShow:1,name:"ADDR_LIST_PERSON",text:"\u4e2a\u4eba\u901a\u8baf\u5f55",sortId:0,url:"menu",urlType:2},{attrs:"param=0",checked:!1,children:[],isShow:1,name:"ADDR_LIST_EP",text:"\u4f01\u4e1a\u901a\u8baf\u5f55",sortId:0,url:"menu",urlType:2},{attrs:"className=conect&amp;param=0",checked:!1,
children:[{}],isShow:1,name:"ADDR_LIST",text:"\u901a\u8baf\u5f55",sortId:0,url:"menu",urlType:2},{attrs:"isBold=true",checked:!1,children:[],isShow:1,name:"ADDR_ADD_USER",text:"\u8054\u7cfb\u4eba",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"ADDR_ADD_GROUP",text:"\u5206\u7ec4",sortId:0,url:"menu",urlType:2},{attrs:"className=add",checked:!1,children:[{}],isShow:1,name:"ADDR_ADD",text:"\u65b0\u5efa",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,
name:"ADDR_IMPORT_FILE",text:"\u6587\u4ef6",sortId:0,url:"menu",urlType:2},{attrs:"className=import",checked:!1,children:[{}],isShow:1,name:"ADDR_IMPORT",text:"\u5bfc\u5165",sortId:0,url:"menu",urlType:2},{attrs:"className=export",checked:!1,children:[],isShow:1,name:"ADDR_EXPORT",text:"\u5bfc\u51fa",sortId:0,url:"menu",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_DELETEGROUP",text:"\u5220\u9664\u8054\u7cfb\u7ec4",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,
name:"ADDR_DELETEUSER",text:"\u5220\u9664\u8054\u7cfb\u4eba",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_UPDATEGROUP",text:"\u4fee\u6539\u8054\u7cfb\u7ec4",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_UPDATEUSER",text:"\u4fee\u6539\u8054\u7cfb\u4eba",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_COPY",text:"\u590d\u5236",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_MOVE",
text:"\u79fb\u52a8",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_MAILGROUP",text:"\u90ae\u4ef6\u7ec4\u5217\u8868",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDR_RECENT",text:"\u6700\u8fd1\u8054\u7cfb\u4eba",sortId:0,url:"menu",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"ADDR",text:"\u901a\u8baf\u5f55",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"SMS",text:"\u77ed\u4fe1",sortId:0,url:"",
urlType:2},{attrs:"",checked:!1,children:[],isShow:0,name:"DISK_TEMP_UPLOAD",text:"\u4e0a\u4f20",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"DISK_TEMP_DOWNLOAD",text:"\u4e0b\u8f7d",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"DISK_TEMP_SEND",text:"\u53d1\u9001",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"DISK_TEMP_DELETE",text:"\u5220\u9664",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,
name:"DISK_TEMP_RENAME",text:"\u91cd\u547d\u540d",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"DISK_TEMP_RENEWAL",text:"\u7eed\u671f",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"DISK_TEMP",text:"menu.web.disk_temp",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"DISK",text:"\u6587\u4ef6\u4e2d\u8f6c\u7ad9",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"CAL_ADD",text:"\u65b0\u589e\u65e5\u7a0b\u63d0\u9192",
sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"CAL_DELETE",text:"menu.web.cal_delete",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"CAL_UPDATE",text:"\u4fee\u6539\u65e5\u7a0b\u63d0\u9192",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"CAL",text:"\u65e5\u7a0b\u63d0\u9192",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"LOG_LOGIN",text:"menu.web.log_login",sortId:0,url:"",urlType:1},{attrs:"",
checked:!1,children:[],isShow:1,name:"LOG_SEND",text:"menu.web.log_send",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"LOG_RECV",text:"menu.web.log_recv",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"LOG_DEL",text:"menu.web.log_del",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"LOG_AGENT",text:"menu.web.log_agent",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"LOG",text:"menu.web.log",
sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:0,name:"ADDREP",text:"\u7ec4\u7ec7\u901a\u8baf\u5f55",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"NOTICE",text:"\u4f01\u4e1a\u516c\u544a",sortId:0,url:"",urlType:2},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_UPLOAD",text:"menu.web.drive_person_upload",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_DOWNLOAD",text:"menu.web.drive_person_download",
sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_NEWFOLDER",text:"menu.web.drive_person_newfolder",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_COPY",text:"menu.web.drive_person_copy",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_MOVE",text:"menu.web.drive_person_move",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_DELETE",text:"menu.web.drive_person_delete",
sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_RENAME",text:"menu.web.drive_person_rename",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_SHARE",text:"menu.web.drive_person_share",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_MODIFYSHARE",text:"menu.web.drive_person_modifyshare",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_CHNCELSHARE",
text:"menu.web.drive_person_chncelshare",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_PERSON_PREVIEW",text:"menu.web.drive_person_preview",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"DRIVE_PERSON",text:"menu.web.drive_person",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_UPLOAD",text:"menu.web.drive_group_upload",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_DOWNLOAD",
text:"menu.web.drive_group_download",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_NEWFOLDER",text:"menu.web.drive_group_newfolder",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_COPY",text:"menu.web.drive_group_copy",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_MOVE",text:"menu.web.drive_group_move",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_DELETE",
text:"menu.web.drive_group_delete",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_RENAME",text:"menu.web.drive_group_rename",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_ADDTOPERSON",text:"menu.web.drive_group_addtoperson",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_ADDGROUP",text:"menu.web.drive_group_addgroup",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,
name:"DRIVE_GROUP_PREVIEW",text:"menu.web.drive_group_preview",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_RENAMEGROUP",text:"menu.web.drive_group_renamegroup",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_MEMBER",text:"menu.web.drive_group_member",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_GROUP_DELETEGROUP",text:"menu.web.drive_group_deletegroup",sortId:0,url:"",urlType:1},{attrs:"",
checked:!1,children:[{}],isShow:1,name:"DRIVE_GROUP",text:"menu.web.drive_group",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_UPLOAD",text:"menu.web.drive_corp_upload",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_DOWNLOAD",text:"menu.web.drive_corp_download",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_NEWFOLDER",text:"menu.web.drive_corp_newfolder",sortId:0,url:"",urlType:1},
{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_COPY",text:"menu.web.drive_corp_copy",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_MOVE",text:"menu.web.drive_corp_move",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_DELETE",text:"menu.web.drive_corp_delete",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_RENAME",text:"menu.web.drive_corp_rename",sortId:0,url:"",urlType:1},
{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_ADDTOPERSON",text:"menu.web.drive_corp_addtoperson",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_PREVIEW",text:"menu.web.drive_corp_preview",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_NEWCORPFOLDER",text:"menu.web.drive_corp_newcorpfolder",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_CORP_RENAMECORP",text:"menu.web.drive_corp_renamecorp",
sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"DRIVE_CORP",text:"menu.web.drive_corp",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_RECYCLE_CLEAR",text:"menu.web.drive_recycle_clear",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_RECYCLE_RESTORE",text:"menu.web.drive_recycle_restore",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[],isShow:1,name:"DRIVE_RECYCLE_DELETE",text:"menu.web.drive_recycle_delete",
sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"DRIVE_RECYCLE",text:"menu.web.drive_recycle",sortId:0,url:"",urlType:1},{attrs:"",checked:!1,children:[{}],isShow:1,name:"DRIVE",text:"menu.web.drive",sortId:0,url:"",urlType:1}],settingsMap={INDEX:"",PREF:"",AUTOREPLY:"",ACCOUNT:"",DEFAULTACCOUNT:"",MEMMANAGER:"",BLACK:"",NOTIFY:"",FACE:"",SKIN:"",SIGN:"",AUTOFORWARD:"",MAILPOP:"",FILTER:"",PASSWORD:"",FOLDERLOCK:"",PHONEBIND:"",WHITE:"",ANTIGARGAGE:"",ANTIVIRU:"",LOGINNOTIFY:""},
menu2AuthorityMap={MAIL_INBOX_REALDELETE:"MAIL_INBOX_DELETE",MAIL_INBOX_DELETE:"MAIL_INBOX_DELETE",MAIL_INBOX_EMPTY:"MAIL_INBOX_DELETE"},ModuleManager=cmail.emptyFunction();ModuleManager.prototype.showMsg=CC.showMsg;ModuleManager.prototype.hideMsg=CC.hideMsg;
ModuleManager.prototype.get=function(a,b,c){try{var d=function(){};typeof b=="function"&&(d=b,b=null);b=b||!1;c=c||a;if(this.initModule(a)){var e=GE.tab.curid;if((c==e||GE.tab.exist(c))&&e!="attachList"&&!GE.tab.isSession)return GE.tab.active(c),d(),e.length>10&&c.length>10&&GE.tab.close(e),!0;b?MM[a].hidden=!0:this.laterRequestModule=c;this[a].needRequest?(this._request(a,d,this[a].msg),this.showWait(a)):this._create(a,c);return!1}else b?window.setTimeout("MM.getModule('"+a+"', true,'"+c+"');",1500):
window.setTimeout("MM.getModule('"+a+"', false,'"+c+"');",1500)}catch(f){return ch("fModuleManagerGet",f),!1}};ModuleManager.prototype.getAjaxXml=function(a){return Util.jsonToXml(a)+"\n\n"};ModuleManager.prototype.getAjaxJson=function(a){return JSON.stringify(a)};
ModuleManager.prototype.create=function(a,b,c,d,e){try{if(b=b||a,this.initModule(a)){var f="";try{f=this[a]._getHtml()}catch(g){}if(f){var f='<div id="'+gConst.mainBody+b+'">'+f+"</div>",h={name:d||b,text:MM[a].text,group:MM[a].group,isLink:!1,url:null,html:f,srep:!0,exitcall:function(c){if(c=="after")MM[a].isExit=!1;else return MM[a].exit(b)}};if(a=="welcome")h.close=!0;this[a].isLoaded=!0;if(!MM[a].noTab){GE.tab.add(h,c,e);var j=new Toolbar(b,function(){return MM[a].getToolbar(b)},function(b,c){return MM[a].getToolbarMenu(b,
c)},$(gConst.mainToolbar+b),MM[a].menuId);j.init();j.getToolbar();j.getDatePick()}this[a]._init(a);GE.currentModule=a;MM.hideMsg()}else window.setTimeout("fCreateModule_sub()",1500)}else window.setTimeout("fCreateModule_sub()",1500),MM.showMsg(gConst.msgLoadData,!0)}catch(n){}};
ModuleManager.prototype.updateBody=function(a,b){b=b||a;a.indexOf("_")>-1&&(b=a,a=a.substring(0,a.indexOf("_")));MM.laterRequestModule=a;if(!MM[a].isLoaded)if(MM.initModule(a)){var c=MM[a]._getHtml();c?($(gConst.mainBody+b).innerHTML=c,MM[a]._init(a),MM[a].isLoaded=!0,GE.currentModule=a,MM[a]._resize(a)):window.setTimeout("fUpdateBody_sub()",150)}else window.setTimeout("fUpdateBody_sub()",150),MM.showMsg(gConst.msgLoadData,!0)};ModuleManager.prototype.showWait=function(){};
ModuleManager.prototype.initialize=function(){var a=["get","create","request"];cmail.initMethod(cmail.ModuleManager,a);a.each(function(a,c){cmail.ModuleManager.prototype[c+"Module"]=function(a){return function(){return this["_"+a].apply(this,arguments)}}(c)});this.hash=new Hashtable};ModuleManager.prototype.observe=function(a,b,c){typeof a=="string"&&MM[a]&&(a=MM[a]);var d="_"+b;a[d]||(a[d]=new cmail.Delegate);a[d].add(c);a[b]=function(){a[d].run.apply(a[d],arguments)}};
ModuleManager.prototype.stopObserve=function(a,b,c){typeof a=="string"&&MM[a]&&(a=MM[a]);var d="_"+b;a[d]||(a[d]=new cmail.Delegate);a[d].hash.removeByObj(c);a[b]=function(){a[d].run.apply(a[d],arguments)}};ModuleManager.prototype.stopAllObserve=function(a,b){typeof a=="string"&&MM[a]&&(a=MM[a]);var c="_"+b;a[c]&&(a[c]=new cmail.Delegate)};
ModuleManager.prototype.execSubmit=function(a,b,c,d,e){MM.showMsg(e);Ajax.submit(a,{method:b,call:function(a){MM.hideMsg(!0);c&&c(a)},resType:d||"",encode:gMain.charset||"gb2312"})};
ModuleManager.prototype.getModuleByAjax=function(a,b,c,d,e){var f=MM[a].data,g=this,h=arguments,j;if(f.fid===7)f.order="modifyDate",j="blank";if(a.indexOf("sys")==0||a.indexOf("user")==0)f.total=CC.getPageSize();MM.initModule(a);if(f instanceof Array)MM.seqRequestCB(f,MM[a].call,null,MM[a].msg);else{f={func:MM[a].func,data:f,call:function(c){MM.loadModuleData(a,c,d,b,e,j)},failCall:function(){CC.error(a,MM[a].text,function(){g.getModuleByAjax.apply(g,h)})},param:"&norefreshSid="+(window.nsid!==void 0?
window.nsid:0),msg:c};if(typeof MM[a].failCall=="function")f.failCall=MM[a].failCall;MM[a].reqtype=="api"?MM.mailRequestApi(f):MM.mailRequest(f)}};ModuleManager.prototype.loadModuleData=function(a,b,c,d,e,f){CM[a]=b;MM.createModule(a,null,c,e,f);typeof d=="function"&&d()};ModuleManager.prototype.mailRequestApi=function(a){var b=MM.getRmXMLRequest();a.url=a.url||gConst.apiPostPath;a.xmlHttp=b;a.param="&norefreshSid="+(window.nsid!==void 0?window.nsid:0)+"&from=webapp";this.mailRequest(a)};
ModuleManager.prototype.mailRequestWebApi=function(a){var b=Ajax.getXMLHttp();a.url=a.url;a.xmlHttp=b;this.mailRequest(a)};ModuleManager.prototype.getRmXMLRequest=function(){var a;IsSimple?a=Ajax.getXMLHttp():(a=$(gConst.ifrmRmSvr).contentWindow,a=a.getXMLHttp());return a};
ModuleManager.prototype.mailRequest=function(a){var b;try{b=MM.getRmXMLRequest();var c=a.call,d=a.failCall||MM.failCallBack,e=a.func,f=a.param||"",g=a.url||gConst.reqUrl;if(a.params)for(var h in a.params)h&&a.params[h]&&(f+="&"+h+"="+a.params[h].toString().encodeHTML());e&&(g+="?func="+e+"&sid="+gMain.sid+f);if(e||g){a.msg&&MM.showMsg(a.msg);var j={url:g,mailCall:function(a,b){MM.beforeResp(a)?typeof c=="function"&&c(a):typeof d=="function"&&d(a,b);MM.hideMsg()},failCall:function(a,b){typeof d=="function"&&
d(a,b);MM.hideMsg()},async:a.async,xmlHttp:b};if(a.xmlHttp)j.xmlHttp=a.xmlHttp;if(a.data)j.data=this.getAjaxXml(a.data);Ajax.mailRequest(j)}}catch(n){ch("ModuleManager.mailRequest",n),MM.hideMsg()}};
ModuleManager.prototype.doService=function(a){try{var b=gMain.urlService,c=a.absUrl||"",d=a.call,e=a.failCall||MM.failCallBack,f=a.func,g=a.param||"";if(a.params)for(var h in a.params)h&&a.params[h]&&(g+="&"+h+"="+encodeURIComponent(a.params[h]));if(c)a.url=a.url||"";a.isNotAddUrl?b=a.url:a.url==gMain.rmSvrAppPath?b=a.url:Vd.checkUrl(a.url)?b=a.url:c?b=c:b+=a.url;f&&(b+="?func="+f+"&sid="+gMain.sid+g);if(f||b){a.msg&&MM.showMsg(a.msg);var j={url:b,callback:function(a,b){MM.beforeResp(a)?typeof d==
"function"&&d(a):typeof e=="function"&&e(a,b);MM.hideMsg()},failCall:function(a,b){typeof e=="function"&&e(a,b);MM.hideMsg()},async:a.async,method:a.method||"POST",head:["Content-Type","text/javascript; charset=utf-8"],noSetCT:!0,resType:"json"};if(a.data)j.data=this[a.dataType=="xml"?"getAjaxXml":"getAjaxJson"](a.data);Ajax.request(j)}}catch(n){ch("MM.doService",n),MM.hideMsg()}};
ModuleManager.prototype.failCallBack=function(a,b){a=a||{};if(typeof a=="object"){var c=a.code;(c=="FA_INVALID_SESSION"||c=="FA_SECURITY"||a.errorCode==2012||a.errorCode==2053)&&WLogin.show();Util.writeLogError(gConst.logFunc.js,b,"method=MM.failCallBack | code="+(a.code||c)+" | summary="+(a.summary||""))}else Util.writeLogError(gConst.logFunc.js,b,"method=MM.failCallBack | summary=response is not object. | resp="+a)};
ModuleManager.prototype.seqRequest=function(a,b,c,d,e){MM.mailRequest({func:gConst.func.seq,data:{items:a},call:b,failCall:c,msg:d,params:e})};
ModuleManager.prototype.seqRequestCB=function(a,b,c,d,e){var a=a||[],b=b||[],f=!1,b=typeof b=="function"?b:Util.emptyFunction,c=typeof c=="function"?c:Util.emptyFunction;a&&a.length&&MM.seqRequest(a,function(d){if(d.code==gConst.statusOk){var e=d.result;if(e&&e.length>=a.length){for(var j=0;j<a.length;j++)if(f=e[j]==0?!0:!1,!f){c(e[j]);return}f?b(d):c(d)}}},c,d,e)};ModuleManager.prototype.ajaxRequest=function(a,b,c,d){this.mailRequest({func:a,data:b,call:c,msg:d})};
ModuleManager.prototype.request=function(a,b,c,d){this.getModuleByAjax(a,b,c,d)};
ModuleManager.prototype.initModule=function(a){var b=!1;if(MM[a].name=="attachList"&&window.gMain&&gMain.hasPassFlag&&!gMain.lock_close&&!gMain.hasSearchAttachList_lockOpen&&MM[a].inited)b=!0,gMain.hasSearchAttachList_lockOpen=!0;if(!MM[a].inited||b)try{var c=a.substring(0,1).toUpperCase()+a.substr(1),d=cmail.createClass();Object.extend(d.prototype,new window[c]);new d;MM[a].inited=!0;this.hash.add(a,MM[a])}catch(e){return ch("fMMInitModule",e),!1}return!0};
ModuleManager.prototype.goTo=function(a,b,c){for(var d=[],e=arguments,f=3;f<e.length;f++)d.push(e[f]);if(this.initModule(a))if(c=="0")return MM[a][b].apply(MM[a],d);else if(c=="1")return MM[a][b];else c=="2"&&(MM[a][b]=e[3]);else throw{description:"module not loaded!"};};ModuleManager.prototype.onAfterInit=function(){};
ModuleManager.prototype.mainResize=function(){function a(){try{var h=El.pos($(gConst.menuC.mail)),j=0,n=CC.docHeight();El.height(b);var k=El.height(c);n-=k;jQuery(g).find("li").size();j=n-jQuery(g).outerHeight()-20-32;El.visible($(gConst.menuC.service))&&El.height($(gConst.menuC.service),j);n>0&&j>0&&h[1]>0?(El.height(e,n),El.height(f,n),El.height(d,n)):window.setTimeout(a,1E3)}catch(q){}}var b=$(gConst.divTopTab),c=$(gConst.divTop),d=$(gConst.divMain),e=$(gConst.divLeft),f=$(gConst.divBox),g=$(gConst.menuC.mail);
a()};ModuleManager.prototype.onAfterExit=function(a){MM[a].isExit=!0;window.setTimeout("MM['"+a+"'].isExit=false",1)};ModuleManager.prototype.onBeforeGet=function(){};ModuleManager.prototype.onAfterGet=function(){};ModuleManager.prototype.onBeforeCreate=function(){};ModuleManager.prototype.onAfterCreate=function(a){MM.initModule(a);MM[a]._resize(a);$(gConst.divMain).scrollTop=0};
ModuleManager.prototype.getModuleByFid=function(a){var b=MM.getFolderObject(a);if(b)return CC.getFolderTypeName(b.type)+a};ModuleManager.prototype.getFidByModule=function(a){return MM[a].fid};ModuleManager.prototype.getFolderObject=function(a){var b=null;Util.each(CM[gConst.folderMain]["var"],function(c,d){a==d.fid&&(b=d)});return b};
ModuleManager.prototype.getFolderObjectFromTree=function(a,b){var c=null,d=function(a){for(var f=null,a=a||[],g=0;g<a.length;g++){f=a[g];if(b==f.fid){c=f;break}d(f.nodes)}};d(MM[gConst.folderMain][a+"Folders"]);return c};
ModuleManager.prototype.req=function(a){var b=this,c=a.msg;try{c&&b.showMsg(c);a.resType=a.resType||"html";a.method=a.method||"post";var d=a.failCall,e=a.call;a.failCall=function(a){b.hideMsg();typeof d=="function"&&d(a)};a.callback=function(a){b.hideMsg();typeof e=="function"&&e(a)};Ajax.request(a)}catch(f){ch("ModuleManager.req",f),b.hideMsg()}};ModuleManager.prototype.post=function(a,b,c,d){MM.req({url:a,data:b,method:"post",cal:c,msg:d})};
ModuleManager.prototype.ajaxGet=function(a,b,c){MM.req({url:a,data:null,method:"get",cal:b,msg:c})};
ModuleManager.prototype.goOutLink=function(a,b,c,d,e){var d=d||b,e=e||"outLink",f=MM.goTo("outLink","exist",0,b);if(f){if(d=f.url,f.url=a,f.text=c,f.moduleType=e,GE.tab.exist(b)){GE.tab.title(b,c);if(a!=d)$(gConst.ifrm+b).src=a;GE.tab.active(b)}}else MM.goTo("outLink","oldurl",2,a),MM.goTo("outLink","MulTab",2,!0),MM.goTo("outLink","url",2,a),MM.goTo("outLink","text",2,c),MM.goTo("outLink","name",2,b),MM.goTo("outLink","group",2,d),MM.goTo("outLink","moduleType",2,e),MM.getModule("outLink",!1,b)};
ModuleManager.prototype.beforeResp=function(a){if(a&&a.code==gConst.statusOk)return!0;else{var b=a.code;(b=="FA_INVALID_SESSION"||b=="FA_SECURITY"||a.errorCode==2012||a.errorCode==2053)&&WLogin.show();return!1}};function fGEOnBeforeInit(){EV.observe(window,"resize",fGEDocResize);EV.observe(document,"keypress",fGEKeyPress)}function fGEOnAfterInit(){}
function fGEDocClick(){var a=EV.getTarget();a&&a.tagName&&a.tagName.toUpperCase()=="A"&&a.href.indexOf("javascript:fGoto()")>-1&&(a.blur(),EV.stopEvent())}function fGEDocResize(){if(GE.tab.curid){var a=GE.tab.curid,a=a.indexOf("_")>-1?a.substr(0,a.indexOf("_")):a;MM[a]._resize()}else MM.mainResize()}function fGEKeyPress(a){if(EV.getCharCode(a)==13){var b=EV.getTarget(a),b=El.getNodeType(b,!0);b!="text"&&b!="textarea"&&EV.stopEvent(a)}return!0}
function MMInit(){cmail.ModuleManager=cmail.createClass();var a=cmail.ModuleManager;a.prototype=new ModuleManager;a.prototype.name="ModuleManager";a.prototype.laterRequestModule=null;a.prototype.hash=null;a.moduleConfig={outLink:[!1,Lang.Mail.tab_Link,"",0],folderMain:[!0,Lang.Mail.tab_Folder,"",0],home:[!1,Lang.Mail.tab_Home,"",0],folder:[!0,"","",1],compose:[!1,Lang.Mail.tab_Compose,"",2],readMail:[!0,Lang.Mail.tab_ReadMail,"",3],setting:[!1,Lang.Mail.tab_Setting,"",5],address:[!1,"","",6],sms:[!1,
"","",7],mms:[!1,"","",8],fax:[!1,"","",9],attachList:[!1,Lang.Mail.ConfigJs.attachManage,"",11]};a.prototype.ModuleClass=cmail.createClass();a.prototype.ModuleClass.prototype={isLoaded:!1,needRequest:!0,name:null,text:"",getHtml:null,init:cmail.emptyFunction(),reset:cmail.emptyFunction(),exit:function(){return!0},response:cmail.emptyFunction(),resize:cmail.emptyFunction(),isModule:!0,func:"",group:0,execSubmit:a.prototype.execSubmit,getToolbar:function(){return[]},getToolbarMenu:function(){return[]},
initialize:function(b,c,d,e,f){cmail.initMethod(a.prototype.ModuleClass,"getHtml,init,reset,exit,response,resize".split(","));this.needRequest=b;this.text=c;this.name=d;this.url=e;this.group=f}};window.MM=new cmail.ModuleManager;window.GE=new cmail.GlobeEngine;cmail.CoremailManager=cmail.createClass();window.CM=new cmail.CoremailManager;(new Hashtable(a.moduleConfig)).each(function(a,c){MM[a]=new cmail.ModuleManager.prototype.ModuleClass(c[0],c[1],a,c[2],c[3]);MM.observe(a,"onafterinit",MM.onAfterInit);
MM.observe(a,"onafterresize",MM.mainResize);MM.observe(a,"onafterexit",MM.onAfterExit)});MM.observe(GE,"onbeforeinit",fGEOnBeforeInit);MM.observe(GE,"onafterinit",fGEOnAfterInit);MM.observe(MM,"onbeforeget",MM.onBeforeGet);MM.observe(MM,"onafterget",MM.onAfterGet);MM.observe(MM,"onbeforecreate",MM.onBeforeCreate);MM.observe(MM,"onaftercreate",MM.onAfterCreate)}
function Frm_Init(){GEInit();MMInit();GE.tab=new TabLabel;GE.tab.call.push(function(){CC.updateHome()});GE.tab.composeTabs={};GE.Drag={};GE._init();CC.getShowFolderList()}function OutLink(){}
OutLink.prototype={initialize:function(){var a,b;for(a in this)b=this[a],typeof b=="function"&&(MM.outLink[a]=b);MM.outLink.h=800},getHtml:function(){return GMC.getHtml(this.name,this.url)},init:function(){GMC.setUrl(this.name,this.url)},resize:function(){this.setDivHeight()},setDivHeight:function(){try{GMC.setDivHeight(this.name)}catch(a){}},exist:function(a){return GE.tab.exist(a)},exit:function(){var a=CC.getCurLabId(),b;try{b=jQuery("#ifrm_"+a)[0].contentWindow}catch(c){}return b&&b.Meeting?b.Meeting.isChanged()?
(parent.CC.confirm("\u73b0\u5728\u79bb\u5f00\u5df2\u7f16\u8f91\u7684\u4f1a\u8bae\u9080\u8bf7\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931,\u662f\u5426\u786e\u8ba4\u5173\u95ed?",function(){GE.tab.del(a)}),!1):(GMC.gcMem(this.name),!0):!0}};
function TabLabel(){this.win=window;this.doc=this.win.document;this.id=gConst.divTab;this.bodyId=gConst.divMain;this.tabbody=this.main=null;this.curid=0;this.tabs=[];this.group=[];this.width=this.count=0;this.max=100;this.pw=41;this.min=10;this.fixLeftWidth=199;this.closeAllWidth=22;this.rightSpace=20;this.history=[];this.call=[];this.init=function(){jQuery("#divTabls").css("overflow","hidden");try{var a=this;this.main=this.doc.getElementById(this.id);this.tabbody=this.doc.getElementById(this.bodyId);
if(top.Browser.isIE)this.closeAllWidth=24;this.width=CC.docWidth()-this.fixLeftWidth-this.closeAllWidth-this.rightSpace;jQuery(window).resize(function(){GE.tab.size();a.updateCloseAllPosition(GE.tab.count>=6)})}catch(b){ch("Tab Init Error",b)}};this.init()}
TabLabel.prototype={add:function(a,b,c){function d(a){var b=this.parentNode.parentNode.getAttribute("tabid");h("before")&&e.del(b);a!="close"&&EV.stopEvent(a||u.event);h("after");return!1}var e=this,f=a.name,f=this.getSafeTableId(f),g=a.text||"",h=a.exitcall||function(){return!0};a.isLink=a.isLink||!1;a.close=a.close||!1;var j=e.exist(f),n=!1,k=0,q,t=IsShowWelcome||!1;if(j){b||e.active(f);if(a.srep)j.b.innerHTML=a.html;a.name=="sys0"&&this.title(a.name,a.text)}else{if(c==="blank")n=!1;else if(a.group){if((k=
e.group[a.group])&&k!=f)if(q=e.exist(k))n=!0,e.group[a.group]=f;e.group[a.group]=f}var u=e.win,b=El.createElement("li","tab_h_"+f);b.setAttribute("tabid",f);b.className="";b.onclick=function(){var a=this.getAttribute("tabid");if(a!=e.curid){e.active(a);var b=a;a.indexOf("_")>-1&&(b=a.substring(0,b.indexOf("_")));MM[b]._resize()}};b.title=g.encodeHTML();b.onmouseover=function(){if(this.className!="on")this.className="hover"};b.onmouseout=function(){if(this.className!="on")this.className=""};g=El.createElement("i",
"","l");c=El.createElement("i","","r");j=El.createElement("div","","m");if(f==gConst.home)b.className=" on",j.innerHTML="<p>"+Lang.Mail.tab_Home+"</p>";else if((f.indexOf("sys")!=-1||f.indexOf("user")!=-1)&&!t)b.className=" on",j.innerHTML="<p>"+a.text.encodeHTML()+"</p>";else{j.innerHTML="<p>"+a.text.encodeHTML()+"</p>";var s=El.createElement("a");s.title=Lang.Mail.Close;s.className="close";s.href="javascript:fGoto()";s.onclick=d;j.appendChild(s)}b.appendChild(g);b.appendChild(j);b.appendChild(c);
b.ondblclick=function(){if(s)s.onclick()};n?this.main.insertBefore(b,q.t):this.main.appendChild(b);q=El.createElement("div","tab_b_"+f,"tab_outlink");a=a.isLink?CC.getIframe(f,url,"auto"):a.html;q.innerHTML=a;this.tabbody.appendChild(q);this.tabs[f]=f;f.indexOf("compose")>=0&&(GE.tab.composeTabs[f]=f.substr(f.indexOf("_")+1));e.active(f);e.count++;e.size();e.count>gConst.tab_ShowCloseAll&&this.updateCloseAllPosition(!0);n&&e.replace(k,f)}},exist:function(a){var a=this.getSafeTableId(a),b=this.tabs[a];
return b&&b==a?{t:$("tab_h_"+a),b:$("tab_b_"+a)}:null},updateCloseAllPosition:function(a){var b=$(gConst.tab_CloseAllId),c=jQuery("#"+gConst.divTop).width(),d=0,d=jQuery("#"+gConst.divTab).width(),e=jQuery("#"+gConst.divTab).offset().left-jQuery("#header").offset().left,f=0,f=El.width(b);El.setStyle(b,{right:c-e-d-f-15+"px"});a?El.show(b):El.hide(b)},del:function(a){var a=this.getSafeTableId(a),b=this.exist(a);if(b){if(this.curid==a)this.curid=0;El.gc(b.t);El.gc(b.b);El.remove(b.t);El.remove(b.b);
delete this.tabs[a];delete GE.tab.composeTabs[a];this.count--;this.size();this.update(a,!1);!this.curid&&this.history.length&&(a=this.history[this.history.length-1],this.history.length--,this.active(a));this.updateCloseAllPosition(!0);this.count<=gConst.tab_ShowCloseAll&&this.updateCloseAllPosition(!1)}},active:function(a,b){function c(a,b){var c=d.exist(a),e=c.t,c=c.b;e.getAttribute("tabid");b?(e.className="on",c.style.display="block"):(e.className="",c.style.display="none")}try{if(a=this.getSafeTableId(a)){var d=
this;if(this.exist(a)){d.curid&&c(d.curid,!1);d.curid=a;c(a,!0);if(this.call[0])this.call[0](a);d.update(a,!0);b||d.setHistory(a)}}}catch(e){ch("fTabLabelActive",e)}},title:function(a,b){var c=this.exist(a);if(c){a.substr(8);var d=c.t.childNodes[1].childNodes[0];if(b)d.innerHTML=b.encodeHTML(),c.t.title=b.decodeHTML();else return d.innerHTML.stripTags()}},close:function(a){if(a=this.exist(a))if(a=a.t.getElementsByTagName("a"),a.length)a[0].onclick("close")},closeAll:function(){var a=this,b=this.tabs;
b?Util.eachObj(b,function(b){b!=gConst.home&&a.close(b)}):ch("closeAll Error",null)},closeAllForce:function(){var a=this.tabs;a?Util.eachObj(a,function(a){a!=gConst.home&&GE.tab.del(a)}):ch("closeAll Error",null)},replace:function(a,b){!this.exist(a)||!this.exist(b)?ch("Tab Replace Error",null):(this.del(a),this.active(b))},size:function(){var a=jQuery("#header").width()-214;jQuery("#divTabls li div").first().find("a").length==0&&(jQuery("#divTabls li div").first().append('<a title="\u5173\u95ed" class="close" style="visibility: hidden;" href="javascript:fGoto()"></a>'),
jQuery("#divTabls li p").first().css("text-align","center"));jQuery("#divTabls").width(a);var b=Math.floor(a/GE.tab.count)-1;b>126&&(b=126);jQuery("#divTabls li p").width(b-44);var c=0;jQuery("#divTabls li").each(function(){c=jQuery(this).outerWidth(!0)+c});jQuery("#divTabls").width(c>a?a:c)},update:function(a,b){var c,d=this.history.length,e,f=[];for(c=0;c<d;c++)e=this.history[c],e!=a&&(f[f.length]=e);b&&(f[f.length]=a);this.history=f},setHistory:function(a){$("ifrmHistory").src=gConst.historyUrl+
"?"+a},getHistory:function(a){a=this.getSafeTableId(a);if(a!=this.curid){var b=a=this.history.length>1?this.history[this.history.length-2]:gConst.home;a.indexOf("_")>-1&&a.substring(0,b.indexOf("_"));a&&this.active(a,!0)}},getSafeTableId:function(a){return typeof a=="string"?a.trim():""},clearDomEvent:function(){var a="data,onmouseover,onmouseout,onmousedown,onmouseup,ondblclick,onclick,onselectstart,oncontextmenu".split(",");window.attachEvent("onunload",function(){for(var b,c=document.all.length;c--;){b=
document.all[c];for(var d=a.length;d--;)b[a[d]]=null}})}};function Address(){this.win=null;this.name=gConst.address;this.menuId="ADDR";this.path="addr";this.config={myaddr:{text:"",url:"index.do"},csaddr:{text:"",url:"index.do"},epaddr:{text:"",url:"index.do"},newaddr:{text:"",url:"quickadd.do"},importAddr:{text:"",url:"importfromfile.do"},exportAddr:{text:"",url:"exportaddr.do"},corpaddr:{text:"",url:"corpaddr.do"},defaultUrl:{text:"",url:"index.do"}}}
Address.prototype={initialize:function(){GMC.initialize(this.name,this)},getHtml:function(){return'<div id="'+gConst.mainToolbar+this.name+'"></div>'+CC.getIframe(this.name,this.url,"auto")},init:function(){this.setDivHeight()},getToolbar:function(){},resize:function(){this.setDivHeight()},exit:function(){GMC.gcMem(this.name);return!0},setDivHeight:function(){GMC.setDivHeight(this.name)},getUrl:function(a){a=a||"defaultUrl";a=="defaultUrl"&&!GC.check("CONTACTS_ENT")&&(a="corpaddr");var b=this.config;
return{url:"/addr/"+(b[a].url||"index.do"),name:b[a].text||Lang.Mail.tab_addr}},setUrl:function(a,b){return GMC.setUrl(this.name,a,b)},doMenu:function(a,b){var c=MM[a].getWin();if(c)switch(b){case "ADD":case "USER":c.AddrCom.opAddr("addUser",Lang.Mail.addr_AddLink);break;case "GROUP":c.AddrCom.opAddr("addGroup",Lang.Mail.addr_AddGroup);break;case "LIST":case "PERSON":c.AddrCom.opAddr("myAddr",Lang.Mail.addr_AddGroup);break;case "EP":c.AddrCom.opAddr("epAddr",Lang.Mail.addr_AddGroup);break;case "CS":c.AddrCom.opAddr("csAddr",
Lang.Mail.addr_AddGroup);break;case "SENDMAIL":c.AddrCom.opAddr("sendMail",Lang.Mail.tb_SendMail);break;case "IMPORT":CC.goAddress("importAddr","",!0);break;case "FILE":CC.goAddress("importAddr","",!0);break;case "EXPORT":CC.goAddress("exportAddr")}},getWin:function(){return this.win?this.win:GMC.getFrameWin(this.name)}};function AttachList(){}function goReadMail(a,b,c,d,e,f){CC.goReadMail(a,b,{fid:c,markRead:1,encode:1,isAttach:1},{mid:a,fid:c,flags:{},from:e,subject:f,sendDate:d})}
function enableDownload(a,b,c){if(!$(c).checked)b.className=""}function showDownload(a,b,c){if(!$(c).checked)b.className="overColor"}
AttachList.prototype={initialize:function(){var a=MM[gConst.attachList],b="";a.needRequest=!0;a.start=0;a.bOrder="receiveDate";a.order="receiveDate";a.orderField=["receiveDate","attachSize","subject","name","attachSuffix"];a.attachTypeName={1:Lang.Mail.ConfigJs.iamge,2:Lang.Mail.ConfigJs.media,3:Lang.Mail.ConfigJs.doc,0:Lang.Mail.ConfigJs.other};a.attachDateType={date1:Lang.Mail.ConfigJs.Oneweek,date2:Lang.Mail.ConfigJs.OneMonth,date3:Lang.Mail.ConfigJs.threeMonth,date4:Lang.Mail.ConfigJs.halfayear};
a.isSearch=1;a.desc=1;a.total=30;a.filter={};a.pageCurrent=0;a.pageCount=0;a.fid=0;a.showRowCount=6;a.call=function(){};a.seachDate="date1";a.data={start:a.start,total:a.total,order:a.order,isSearch:a.isSearch,stat:1,fid:a.fid,desc:a.desc};if(b=folderlock.lock_pass)a.data.folderPass=b;if(gMain.IsAttachSearch)a.data.filter={attachName:gMain.IsAttachSearch};a.func=gConst.func.attachList;a.name=gConst.attachList;GMC.initialize(a.name,this)},getHtml:function(){var a=[],b=this.name;this.count=CM[b].total;
var c=this.orderField;this.filter.attachName=this.filter.attachName||gMain.IsAttachSearch;for(var d=0;d<c.length;d++);a.push("<div id='{0}' style='overflow-y:scroll;overflow-x:hidden;'><div id=\"adjManage\">".format(gConst.listMailId+b));a.push("<div id='attachlist_wrapper' class=\"wrapper\">");a.push("<div id='attachlist_container' class=\"container\">");c=this.filter.attachName;d="";c&&(d="&nbsp;&gt;&gt;&nbsp;"+Lang.Mail.SearchKeyAndCount+c);a.push("<div class='' style=' height:30px; line-height:30px;'><h5 class='pl_10'><strong onclick='CC.goAttachList();return false;' class='hoverUnderline'  style='cursor:pointer;'>"+
Lang.Mail.ConfigJs.allAttach+"</strong><span id='attachList_title'>"+d+"</span><span> ("+Lang.Mail.ConfigJs.total.format("<em id='attachList_AllCount' style='color:#D30009;'>"+CM[b].total+"</em>")+")</span></h5></div>");a.push("<div class='top_compose m_clearfix' style=''><ul class='pt_5 pl_5 fl'><li><a class=\"n_btn mr_5\" href=\"javascript:fGoto();\"  onclick=\"MM['"+b+"'].sendMail();\"><span><span>"+Lang.Mail.ConfigJs.fwmail+"</span></span></a></li></ul><div style='float:right; margin:7px 10px 0 0;' class=\"pager\" id='"+
gConst.listTopPageId+b+"' >");a.push(this.getPagerHtml());a.push("</div>");a.push("</div>");a.push('<div class="list " id="{0}">'.format(gConst.listBodyId+b));a.push(this.getListData());a.push("</div>");a.push('<div class=\'btm_pager\' {1}><div class="fr attr_pager pt_7"id="{0}">'.format(gConst.listFootPageId+b,this.count>0?"":"style='display:none;'"));a.push(this.getPagerHtml());a.push("</div>");a.push("</div>");a.push("</div>");a.push("</div>");a.push('<div class="sider" id="sider">');a.push('<div class="j_search j_search_margin"><i class="j_search_d"></i>');
a.push("<input style='width:165px;' value=\""+Lang.Mail.ConfigJs.AttachList_SeachKey+'" type="txt" id=\'searchKey\' onclick="MM[\'{0}\'].searchTextOnClick(this)" onblur="MM[\'{0}\'].searchTextOnblur(this)" onkeyup="MM[\'{0}\'].searchTextOnKeyUp()" class="j_search_txt fl" />'.format(b));a.push('<input type="button" id="btnSearch" onclick="MM[\'{0}\'].getFilter(\'attachName\');" class="j_search_btn fr"  style="width:27px;" /> </div>'.format(b));a.push('<dl id="searchType" class="classly_search mt5">');
a.push(this.getAttachTypeHtml());a.push("</dl>");a.push("</div>");a.push("</div></div>");return a.join("")},getAttachTypeHtml:function(){var a=this.name,b=CM[a].stat,c=[];this.typeDataList={attachType:[],from:[],fid:[],recvTime:[]};c.push("<dt style='font-size:15px;' id='searchTitle'>"+Lang.Mail.ConfigJs.typeSeach+"(<em id='attachList_ClassCount'>"+CM[a].total+"</em>)</dt>");c.push('<DD><ul id="filtersResult"></ul></DD>');c.push("<dt id='filter_attachType' class='colE0E4F6'>"+Lang.Mail.ConfigJs.fileTypeSeach+
"</dt>");c.push("<dd id='filter__content_attachType'>");c.push("<ul>");for(var d in this.attachTypeName)this.typeDataList.attachType.push("<li><a href=\"javascript:fGoto();\" onclick=\"MM['{0}'].getFilter('attachType','{1}','{2}');\">{2}<span>({3})</span></a></li>".format(a,d,this.attachTypeName[d],b.attachType[d]));c.push(this.getDefultRowHTML("attachType"));c.push("</ul>");c.push("</dd>");c.push("<dt id='filter_from' class='colE0E4F6'>"+Lang.Mail.ConfigJs.sender+"</dt>");c.push("<dd id='filter__content_from'>");
c.push("<ul>");for(var e in b.from){try{if(b.from[e]==0)continue}catch(f){}d=(Email.getName(e)||e).left(20,!0);var g=(Email.getValue(e)||e).replace(/['"]/g,"");this.typeDataList.from.push("<li><a title=\"{1}\" onclick=\"MM['{0}'].getFilter('from','{1}','{2}');\" href=\"javascript:fGoto();\">{2}<span>({3})</span></a></li>".format(a,g,d,b.from[e]))}c.push(this.getDefultRowHTML("from"));c.push("</ul>");c.push("</dd>");c.push("<dt id='filter_fid' class='colE0E4F6'>"+Lang.Mail.ConfigJs.folderSeach+"</dt>");
c.push("<dd id='filter__content_fid'>");c.push("<ul>");e=[];for(var h in b.fid)e.push(h-0);e=e.sort(function(a,b){return a-b});for(d=0;d<e.length;d++)h=e[d]+"",(g=MM.getModuleByFid(h))&&this.typeDataList.fid.push("<li><a onclick=\"MM['{0}'].getFilter('fid','{1}','{2}')\" href=\"javascript:fGoto();\" >{2}<span>({3})</span></a></li>".format(a,h,MM[g].text,b.fid[h]));c.push(this.getDefultRowHTML("fid"));c.push("</ul>");c.push("</dd>");c.push("<dt id='filter_recvTime' class='colE0E4F6'>"+Lang.Mail.ConfigJs.dateRange+
"</dt>");c.push("<dd id='filter__content_recvTime'>");c.push("<ul>");for(var j in this.attachDateType)this.typeDataList.recvTime.push("<li><a onclick=\"MM['{0}'].getFilter('recvTime','{1}','{2}')\" href=\"javascript:fGoto();\" >{2}<span>({3})</span></a></li>".format(a,j,this.attachDateType[j],b.receiveDate[j]));c.push(this.getDefultRowHTML("recvTime"));c.push("</ul>");c.push("</dd>");c.push("<dt id='filter_read' class='colE0E4F6'>"+Lang.Mail.ConfigJs.readORnoread+"</dt>");c.push("<dd id='filter__content_read'>");
c.push("<ul>");c.push("<li><A onclick=\"MM['{0}'].getFilter('read',1,'{2}')\" href=\"javascript:fGoto();\" >{2} <span>({1})</span></a></li>".format(a,b.read[1],Lang.Mail.ConfigJs.notReadMail));c.push("<li><A onclick=\"MM['{0}'].getFilter('read',0,'{2}')\" href=\"javascript:fGoto();\" >{2} <span>({1})</span></a></li>".format(a,b.read[0],Lang.Mail.ConfigJs.readMail));c.push("</ul>");c.push("</dd>");return c.join("")},getDefultRowHTML:function(a){var b=this.typeDataList[a];if(!b&&b.length==0)return"";
var c=[];if(b.length>this.showRowCount){for(var d=0;d<this.showRowCount;d++)c.push(b[d]);c.push("<li><strong onclick=MM['{0}'].showMore('{2}') style='color:5A759E;cursor:pointer;' class='attachList_moreType' href=\"javascript:fGoto();\" >{1}</strong></li>".format(gConst.attachList,Lang.Mail.ConfigJs.Lookmore,a));return c.join("")}else return b.join("")},showNDFSelector:function(a,b,c,d){var e="",f="";if(CM[top.gConst.readMail+a]){if(f=CM[top.gConst.readMail+a]["var"],attachName="",f&&f.attachments&&
f.attachments.length)attachName=f.attachments[d].fileName}else if(CM.attachList&&CM.attachList["var"]&&CM.attachList["var"][d])attachName=CM.attachList["var"][d].attachName;if(!window.gMain||!gMain.rmSvr)e=window.location.href,e=e.split(":")[0]+"://"+e.split("/")[2];a={attachUrl:(e+CC.getDownloadLink(a,b,c,attachName,"attach",1,"1")).encodeHTML(),fileSize:c,attachName:attachName.encodeHTML()};new NDFileSelector(a)},showDefult:function(a){var b=[];b.push("<ul>");b.push(this.getDefultRowHTML(a));b.push("</ul>");
$("filter__content_"+a).innerHTML=b.join("")},showMore:function(a){var b=[],c=this.typeDataList[a];b.push("<ul>");for(var d=0;d<c.length;d++)b.push(c[d]);b.push("<li><strong onclick=MM['{0}'].showDefult('{2}') style='color:5A759E;cursor:pointer;' class='attachList_moreType' href=\"javascript:fGoto();\" >{1}</strong></li>".format(gConst.attachList,Lang.Mail.ConfigJs.showpart,a));b.push("</ul>");$("filter__content_"+a).innerHTML=b.join("")},getListData:function(){var a=[],b=this.name,c=CM[b],d=c["var"];
this.count=c.total;a.push("<table class='enclosure_table'>");a.push("<thead><tr>");c=this.desc?"desc":"asc";a.push("<th class=\"jnotice_border_r\" style='width:25px;text-align:center'><input type='checkbox' id='{0}_AllChecked' class='fl'  onclick=\"MM['{1}'].checkedBoxAll(this);\"/></th>".format(gConst.checkBoxName,b));a.push("<th class=\"jnotice_border_r\" colspan='2' ><a title='"+Lang.Mail.ConfigJs.Click_to_sort+'\' href="#" onclick="MM[\''+gConst.attachList+"'].sortList('name')\"><em style='display: inline-block; width: 14px;'></em>"+
Lang.Mail.ConfigJs.fileName+"</a><i id='listMailSortIcon_name' class='"+(this.order=="name"?c:"")+"'></i></th>");a.push("<th class=\"time\" style='width:253px'><a title='"+Lang.Mail.ConfigJs.Click_to_sort+'\' href="#" onclick="MM[\''+gConst.attachList+"'].sortList('receiveDate')\">"+Lang.Mail.ConfigJs.date+"</a><i id='listMailSortIcon_receiveDate' class='"+(this.order=="receiveDate"?c:"")+"'></i></th>");a.push("<th class=\"size\" style='width:170px;border-right:medium none;'><a title='"+Lang.Mail.ConfigJs.Click_to_sort+
'\' href="#" onclick="MM[\''+gConst.attachList+"'].sortList('attachSize')\">"+Lang.Mail.ConfigJs.size+"</a><i id='listMailSortIcon_attachSize' class='"+(this.order=="attachSize"?c:"")+"'></i></th>");a.push("</tr></thead></table> <table class='filezz_con'>");if(d.length>0)for(c=0;c<d.length;c++){var e=d[c],f=Util.formatDate(new Date(e.receiveDate*1E3));a.push("<tr onmouseover=showDownload('"+c+"',this,'"+gConst.checkBoxName+"_"+b+"_"+c+"')  onMouseOut=enableDownload('"+c+"',this,'"+gConst.checkBoxName+
"_"+b+"_"+c+"') id='"+b+"_Tr_"+c+"' >");a.push("<td style='width:25px;'>");a.push("<input type='checkbox'  name='{0}_{1}' class='fl' value='{2}' id='{0}_{1}_{2}' onclick=\"MM['{1}'].checkOneClick(this);\"/></td>".format(gConst.checkBoxName,b,c));a.push('<td><div><i class="big_{0} fl"></i><div>'.format(Util.getFileExtensionCss(e.attachName)));var g=e.attachName.encodeHTML(),h=this.filter.attachName;if(h)var j=h.replace(".","\\."),g=g.replace(RegExp(j,"gmi"),"<span style='background-color:Gold;padding-left:2px;padding-right:2px;'>"+
h+"</span>");a.push("<p title='"+e.attachName.encodeHTML()+"'>"+g+"</p>");a.push("<p id='divDownload"+c+"'>");GC.check("CENTER_PREVIEW")&&parseInt(parent.gMain.attachPreivewMaxSize)>=e.attachRealSize&&(g=CC.getAttachType(e.attachName,e.attachSize)||{isView:!1,type:""},g.isView&&(h=CC.getDownloadLink(e.mid,e.attachOffset,e.attachSize,e.attachName,"attach",1),h.indexOf("http")!=0&&(h=location.protocol+"//"+location.host+h),j=CC.getViewLink(gMain.webPath||"http://view.se139.com","cmail",gMain.sid,h,
gMain.userNumber,e.attachName,e.attachRealSize,gMain.mailId,e.mid+e.attachOffset,0)+"&attachManage=1",viewLink=g.type=="image"?'<a href="javascript:void(0)" class="mr_15" onclick=CC.previewImg("'+encodeURIComponent(e.attachName)+'","'+encodeURIComponent(h)+'") >'+Lang.Mail.readMail_lb_viewAttach+"</a>":'<a target="_blank" class="mr_15" title=\''+(g.type=="zip"?Lang.Mail.open:Lang.Mail.readMail_lb_viewAttach)+"' href=\""+j+'" {0} >'+(g.type=="zip"?Lang.Mail.open:Lang.Mail.readMail_lb_viewAttach)+"</a>",
a.push(viewLink)),a.push("<a href='javascript:fGoto();' target='_blank' class='mr_15' title='"+Lang.Mail.ConfigJs.download+"' onclick=\"javascript:MM['"+b+"'].download("+c+');return false;">'+Lang.Mail.ConfigJs.download+"</a>"));a.push('<a href="javascript:fGoto();" class=\'mr_15\' title=\'{7}\'  onclick=\'MM["{0}"].singSendMail({1},"{2}","{3}","{4}","{5}","{6}");\'>{7}</a>'.format(b,e.fid,e.mid,e.attachName.encodeHTML(),e.attachSize,e.attachRealSize,e.attachOffset,Lang.Mail.ConfigJs.fwmail));a.push("<a href='javascript:fGoto();' class='mr_15' title='{0}' onclick=\"goReadMail('{2}','{1}','{3}','{4}','{5}','{1}');\">{0}</a>".format(Lang.Mail.ConfigJs.open_mail,
e.subject.encodeHTML(),e.mid,e.fid,e.sendDate,e.from.encodeHTML()));GC.check("DISK")&&(a.push("<a href='javascript:fGoto();' class='mr_15' "),a.push("title='"+Lang.Mail.saveDisk+"'"),a.push("onclick=\"javascript:MM['"+b+"'].showNDFSelector('"+e.mid+"', '"+e.attachOffset+"', '"+e.attachSize+"', '"+c+"');return false;\">"),a.push(Lang.Mail.saveDisk+"</a>"));a.push("</p></div></div></td>");a.push('<td class="time" style="width:253px">'+f+"</td>");a.push('<td class="size" style="width:170px;">'+Util.formatSize(e.attachRealSize,
null,2)+"</td>");a.push("</tr>")}else a.push('<tr><td colspan="5"><p class="set_rule_box_tips" style="display:block;margin-bottom: 12px;">'),this.filter.attachName?a.push(Lang.Mail.NotSearchData):a.push(Lang.Mail.ConfigJs.notAttach),a.push("</p></td></tr>");a.push("</table>");gMain.IsAttachSearch="";return a.join("")},checkedBoxAll:function(a){for(var b=this.name,c=document.getElementsByName("{0}_{1}".format(gConst.checkBoxName,b)),d=0;d<c.length;d++)c[d].checked=a.checked,c[d].checked?$(b+"_Tr_"+
c[d].value).className="overColor":$(b+"_Tr_"+c[d].value).className=""},checkOneClick:function(a){for(var b=this.name,c=document.getElementsByName("{0}_{1}".format(gConst.checkBoxName,b)),d=0,e=0;e<c.length;e++)c[e].checked&&d++;$("{0}_AllChecked".format(gConst.checkBoxName)).checked=d!=0&&d==c.length?!0:!1;b=$(b+"_Tr_"+a.value);if(a.checked)b.className="overColor"},getPagerHtml:function(){var a=this.name;this.pageCount=Math.ceil(this.count/this.total);this.pageCurrent=this.start/this.total||0;var b=
[],c=this.pageCount,d=Math.max(this.pageCurrent,0);if(c<2)return"";d>0&&(b.push('<a href="javascript:fGoto();" onClick="MM[\''+a+"'].goPage(0);return false;\">"+Lang.Mail.list_FirstPage+"</a>"),b.push(' <a href="javascript:fGoto();" onClick="MM[\''+a+"'].goPage("+(d-1)+');return false;">'+Lang.Mail.list_PrevPage+"</a>"));d>0&&c>d+1&&(b[b.length]=" ");c>d+1&&(b.push('<a href="javascript:fGoto();" onClick="MM[\''+a+"'].goPage("+(d+1)+');return false;">'+Lang.Mail.list_NextPage+"</a>"),b.push(' <a href="javascript:fGoto();" onClick="MM[\''+
a+"'].goPage("+(c-1)+');return false;">'+Lang.Mail.list_LastPage+"</a>"));b.push(' <select id="select_page_'+a+'" name="select_page_'+a+'" onchange="var nValue=this.selectedIndex;MM[\''+a+"'].goPage(nValue);\">");for(a=0;a<c;a++)b.push('<option value="'+a+'"'+(d==a?" selected":"")+">"+(a+1)+" / "+c+"</option>");c==0&&b.push('<option value="1">1 / 1</option>');b.push("</select>");return b.join("")},getListRequest:function(a,b){var c={},c=a?{start:0,total:20,order:"receiveDate",isSearch:0,stat:1,desc:1,
fid:this.filter.fid}:{start:this.start==0?this.start:this.start+1,total:this.total,order:this.order,isSearch:b==!0?0:1,stat:1,desc:this.desc,fid:this.filter.fid,filter:this.filter};this.data.isSearch=c.isSearch;return c},searchTextOnClick:function(a){if(a.value==Lang.Mail.ConfigJs.AttachList_SeachKey)a.value="";jQuery(a).attr("style","color: black;width:165px;")},searchTextOnblur:function(a){var b=Lang.Mail.ConfigJs.AttachList_SeachKey;if(a.value=="")jQuery(a).removeAttr("style","color: black;"),
a.value=b},searchTextOnKeyUp:function(a){var b=document.getElementById("btnSearch");EV.getEvent(a);if(EV.getCharCode()==13)b.onclick()},loadAttachList:function(a){var b=this,c=a.call;a&&MM.mailRequest({func:b.func,data:a.data,call:function(a){b.freshData(a);typeof c=="function"&&c()},msg:a.msg})},freshData:function(a){var b=this.name,c=a||{};this.count=a.total;document.getElementById("attachList_AllCount").innerHTML=a.total;if(c.code==gConst.statusOk){CM[b]=c;var a=$(gConst.listBodyId+b),c=$(gConst.listTopPageId+
b),b=$(gConst.listFootPageId+b),d=$("searchType"),e=this.getPagerHtml();if(a)a.innerHTML=this.getListData();if(c)c.innerHTML=e;if(b)b.innerHTML=e;if(d)d.innerHTML=this.getAttachTypeHtml();var b=this.name,f;for(f in this.filter){a=this.filter[f];c="";switch(f){case "attachType":c=this.attachTypeName[a];break;case "from":c=(Email.getName(a)||a).left(20,!0);break;case "fid":c=MM[MM.getModuleByFid(a)].text;break;case "recvTime":c=this.attachDateType[this.seachDate];break;case "read":c=a==1?Lang.Mail.ConfigJs.notReadMail:
Lang.Mail.ConfigJs.readMail}if(c)try{var g=$("filtersResult"),h=El.createElement("div","filtersSelected_"+f);h.innerHTML='<span class="filtersResult"><span class="afTypeName">{0}</span> <a onclick="MM[\'{1}\'].getFilter(\'{2}\',\'\',null,true)" class="enclosure-cancle" href="javascript:fGoto();">{3}</a> </span>  '.format(c,b,f,Lang.Mail.ConfigJs.cancel);g.appendChild(h);$("filter_"+f).style.display="none";$("filter__content_"+f).style.display="none"}catch(j){}}}},getFilter:function(a,b,c,d){$("filtersResult");
d?delete this.filter[a]:a=="attachName"&&!b?(b=$("searchKey").value.trim()==Lang.Mail.ConfigJs.AttachList_SeachKey?"":$("searchKey").value.trim(),this.filter[a]=b):a=="recvTime"?(this.filter.recvTime=this.getFilterTime(b),this.seachDate=b):a!="attachSize"&&(this.filter[a]=b);c=$("searchKey").value.trim()==Lang.Mail.ConfigJs.AttachList_SeachKey?"":$("searchKey").value.trim();a=="attachName"&&b&&(c=b);c?(a="&nbsp;&gt;&gt;&nbsp;"+Lang.Mail.SearchKeyAndCount,$("attachList_title").innerHTML=a+c.encodeHTML()):
$("attachList_title").innerHTML="";a={msg:Lang.Mail.list_LoadMailList,data:this.getListRequest(),func:this.func};this.start=0;a.data.start=0;this.loadAttachList(a)},getFilterTime:function(a){var b=new Date,c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),b=b.getSeconds(),c=new Date(c,d,e,f,g,b),c=c.getTime();switch(a){case "date1":startTime=c-6048E5;break;case "date2":startTime=c-2592E6;break;case "date3":startTime=c-15552E6;break;case "date4":startTime=c-31536E6}startTime=
new Date(startTime);return{startTime:startTime/1E3,endTime:c/1E3}},exit:function(){this.filter={};this.start=0;MM[gConst.attachList].data.start=0;return!0},getDeliverStatus:function(){var a=this;MM.mailRequest({func:gConst.func.deliverStatus,data:{sort:this.sort,start:0,total:200},call:function(b){try{CM.deliver=b;var c=a.getDeliverStatusHtml();$(gConst.mainBody+GE.folderObj.sent).innerHTML=c;a.setDivHeight()}catch(d){}},msg:Lang.Menu.Web.kanStatus})},getSelectAttach:function(){var a=this.name,b=
CM[a]["var"],c=[];try{for(var d=$(gConst.listBodyId+a).getElementsByTagName("input"),e=0,f=d.length;e<f;e++){var g=d[e];if(g.type=="checkbox"&&g.name==gConst.checkBoxName+"_"+a&&g.checked){var h=b[g.value-0];c.push({mid:h.mid,offset:h.attachOffset,size:h.attachSize,name:h.attachName,fid:h.fid,realSize:h.attachRealSize})}}return c}catch(j){return c}},click:function(a,b){function c(a,b){d.setTrClass(a,b)}var d=this,e=d.name,f=$("checkbox_"+e+"_all");if(a=="all"&&(d.setCheckBox($("mailList_"+e),b,c),
!(a=="all"&&b)))f.checked=!1},singleClick:function(a){this.setTrClass(a,a.checked);$("checkbox_"+this.name+"_all").checked=!1},goPage:function(a){var b=this.pageCount;if(this.pageCurrent!=a)a=Math.min(a,b-1),a=Math.max(a,0),this.start=this.total*a,this.pageCurrent=a,this.data.start=this.start,CC.scrollTop(),this.loadAttachList({msg:Lang.Mail.list_LoadMailList,data:this.getListRequest(),func:this.func});else return!1},setPageSize:function(a){this.total=a;this.data.total=this.total;this.loadAttachList({msg:Lang.Mail.list_LoadMailList,
data:this.getListRequest(),func:this.func})},sortList:function(a){this.order==a?this.desc=1-this.desc:(this.order=a,this.desc=this.order==GE.list.order?1:0);this.start=0;this.loadAttachList({msg:Lang.Mail.ConfigJs.loadAttachList,isUpdate:!1,data:this.getListRequest()});this.bOrder=this.order},setCheckBox:function(a,b,c){for(var a=a.getElementsByTagName("input"),d=0,e=a.length;d<e;d++)if(a[d].type=="checkbox"&&a[d].checked!=b)a[d].checked=b,c&&c(a[d],b)},setTrClass:function(a,b){var c=$(a.id.replace("checkbox",
"tr"));b?El.addClass(c,"on"):El.removeClass(c,"on")},setDivHeight:function(){var a=this.name,b=CC.docHeight()-GE.pos()[1];$(gConst.listMailId+a);try{El.setStyle($(gConst.listMailId+a),{height:b+"px"})}catch(c){}},resize:function(){var a=$(gConst.listMailId+this.name);CC.docWidth();GE.pos();a.style.width="100%";this.setDivHeight()},download:function(a){if(a=CM[this.name]["var"][a])location.href=CC.getDownloadLink(a.mid,a.attachOffset,a.attachSize,a.attachName,"attach",1,"1")},downloads:function(){var a=
this.getSelectAttach();CC.downloads(a,Lang.Mail.ConfigJs.zipAttach)},singSendMail:function(a,b,c,d,e,f){var g={attachments:[]};g.attachments.push({fileId:b+"_"+a,type:"attach",fileName:c,fileSize:d,fileOffSet:f,fileRealSize:e,isAttachForward:1});var h=[];MM.mailRequestApi({func:gConst.func.forwardAttachs,data:g,call:function(b){try{window.IsOA!=1&&(!b["var"].attachments||b["var"].attachments.length==0)?CC.alert(Lang.Mail.forbidForward):(h.push({name:c,url:"",size:d,id:a,fileId:a,fileName:c,fileOffSet:f,
fileSize:e,isAttachForward:1}),window.parent.parent.CC.sendMail("","",h,b["var"].id))}catch(g){}}})},sendMail:function(a){var b={attachments:[]};a||(a=this.getSelectAttach());if(!a||a.length==0)window.parent.parent.CC.alert(Lang.Mail.ConfigJs.AttachList_SeleteAttr);else{for(var c=0;c<a.length;c++){var d=a[c];b.attachments.push({fileId:d.mid+"_"+d.fid,type:"attach",fileName:d.name,fileSize:d.size,fileOffSet:d.offset,fileRealSize:d.realSize})}MM.mailRequestApi({func:gConst.func.forwardAttachs,data:b,
call:function(a){try{var b=MM[gConst.attachList].getSelectAttach(),c=[];if(window.IsOA==0){var d=a["var"].attachments;if(!d||d.length==0){CC.alert(Lang.Mail.cforbidForward);return}for(var j=0;j<d.length;j++)c.push({name:d[j].fileName,url:"",size:d[j].fileSize,id:d[j].fileId,fileId:d[j].fileId,fileName:d[j].fileName,fileOffSet:"",fileSize:d[j].fileSize,isAttachForward:1})}else for(j=0;j<b.length;j++){var n=b[j];c.push({name:n.name,url:"",size:n.size,id:n.fid,fileId:n.fid,fileName:n.name,fileOffSet:n.offset,
fileSize:n.realSize,isAttachForward:1})}window.parent.parent.CC.sendMail("","",c,a["var"].id)}catch(k){}}})}}};function Compose(){this.name=gConst.compose;this.win=null;this.menuId="MAIL"}Compose.menuData={};
Compose.prototype={initialize:function(){GMC.initialize(this.name,this);Compose.fMenus={};var a=CC.getMailMenu(gConst.menu.compose);if(a)for(var b in a)Compose.fMenus[a[b].name]=a[b]},getHtml:function(){return'<div class="compose_shadow" id="'+gConst.mainToolbar+this.name+'"></div>'+GMC.getHtml(this.name,this.url,"overflow-x:hidden;overflow-y:auto;")},init:function(){this.win=this.getWin();this.setDivHeight()},getToolbar:function(){var a=[],b=[],c;for(c in Compose.menuData)Compose.fMenus[c]&&a.push(Compose.fMenus[c]);
b.push('<div id="'+CC.getCurLabId()+'_compose_top_action" class="top_compose mt_5">');GC.check("MAIL_INBOX_WRITE")&&(b.push('<a id=\'btnSend\' href="javascript:fGoto();" onclick="GMC.getFrameWin(CC.getCurLabId()).oWrite.doSend(this);" class="n_btn_on mt_5" title="\u53d1\u9001">'),b.push("<span><span>\u53d1&nbsp;\u9001</span></span>"),b.push("</a>"));GC.check("MAIL_INBOX")&&(b.push('<a id=\'btnSave\' href="javascript:fGoto();" onclick="GMC.getFrameWin(CC.getCurLabId()).oWrite.doSave(this);" class="n_btn mt_5" title="\u5b58\u8349\u7a3f">'),
b.push("<span><span>\u5b58\u8349\u7a3f</span></span></a>"));GC.check("MAIL_INBOX")&&(b.push('<a id=\'btnCancel\' href="javascript:fGoto();" onclick="parent.CC.exit();" class="n_btn mt_5" title="\u53d6\u6d88">'),b.push("<span><span>\u53d6&nbsp;\u6d88</span></span>"),b.push("</a>"));b.push("</div>");$(gConst.mainToolbar+this.name).innerHTML=b.join("");return this.menu=a},getToolbarMenu:function(){return[]},resize:function(){this.setDivHeight()},exit:function(a){a=a||CC.getCurLabId();try{var b=!1,c=
CC.isCompose(a);if(c){c.oWrite.dispose();try{b=c.oWrite.checkChange()}catch(d){}if(b)return parent.CC.confirm("\u5173\u95ed\u5199\u4fe1\u9875\uff0c\u672a\u4fdd\u5b58\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u662f\u5426\u5173\u95ed\uff1f",function(){GE.tab.del(a);GE.maxComposeId--;GE.diskFiles[a]&&delete GE.diskFiles[a]}),!1}}catch(e){GE.maxComposeId--}return!0},setDivHeight:function(){var a=CC.getCurLabId(),b=GMC.getFrameWin(a),a=CC.docHeight()-GE.pos()[1],b=CC.DocWidth()-GE.pos()[0];$(gConst.mainToolbar+
this.name)&&(a-=$(gConst.mainToolbar+this.name).offsetHeight);a=Math.max(a,0)+"px";Math.max(b,0);var c=GMC.getFrameObj(this.name),b=GMC.getFrameWin(this.name);try{if(c)c.style.height=a}catch(d){}if(Browser.isIE&&b)try{b.oWrite.setSize()}catch(e){}},doMenu:function(a,b){var c=MM.compose.getWin();if(c&&c.oWrite)switch(b){case "SEND":c.oWrite.doSend();break;case "SAVE":c.oWrite.doSave();break;case "PRINT":c.oWrite.doPreview();break;case "CANCEL":CC.exit()}},getWin:function(){var a=CC.getCurLabId();try{var b=
CC.isCompose(a);return b?b:null}catch(c){ch(c)}}};function Deliver(){this.divId="divListDeliver_"}
Deliver.prototype={initialize:function(){var a=MM[gConst.deliver];a.name="deliver";a.needRequest=!0;a.func="mbox:getDeliverStatus";a.start=0;a.sort=0;a.total=200;a.data={sort:0,start:0,total:200};a.call=function(){};GMC.initialize(a.name,this)},getDeliverStatus:function(){var a=this,b=a.name;MM.mailRequest({func:gConst.func.deliverStatus,data:{sort:this.sort,start:0,total:200},call:function(c){try{CM[b]=c;var d=a.getHtml();$(gConst.mainBody+b).innerHTML=d;a.setDivHeight()}catch(e){}},msg:"\u67e5\u8be2\u90ae\u4ef6\u6295\u9012\u72b6\u6001"})},
getHtml:function(){var a=[],b=this.name,c=CM.deliver["var"];this.deliverData={info:{},items:[]};this.headId="headStatus_"+b+"_";var d={iTotal:0,iOk:0,iFail:0,iDeliver:0};a.push('<div id="mailsentStatus" class="mailsentStatus">');a.push('<div class="wrapper"><div class="container">');a.push('<h3><strong>\u90ae\u4ef6\u53d1\u9001\u72b6\u6001</strong><span>[</span><div class="clearfloat">');a.push('<div class="deliver"><i class="i-mD1"></i><span id="{0}ok">0\u5c01\u6210\u529f</span></div>'.format(this.headId));
a.push('<div class="deliver"><i class="i-mD2"></i><span id="{0}deliver">0\u5c01\u6295\u9012\u4e2d</span></div>'.format(this.headId));a.push('<div class="deliver"><i class="i-mD3"></i><span id="{0}fail">0\u5c01\u5931\u8d25</span></div>'.format(this.headId));a.push("</div><span>]</span></h3>");a.push('<div class="list" id="{0}{1}_main"><table><tbody>'.format(this.divId,b));a.push('<tr><th class="tos">\u6536\u4ef6\u4eba</th><th class="subject" >\u4e3b\u9898</th>');a.push('<th class="dlStatus" >\u6295\u9012\u72b6\u6001</th>');
a.push('<th class="date" onclick="MM[\''+b+'\'].rankList();"><a title="\u70b9\u51fb\u53ef\u6309\u6b64\u6392\u5e8f" href="javascript:fGoto();">\u65f6\u95f4 </a><i id="'+gConst.listMailSortIcon+'receiveDate_deliver" class="desc"></i></th>');if(c.length>0){a[a.length]="<table>";for(var e=0;e<c.length;e++){var f=c[e],g=this.getToInfo(f.tos);tos=g.toTotal.join(",");tos=tos.encodeHTML();var h=Util.formatDate(f.sendDate),f=f.subject||"<\u65e0>",f=f.encodeHTML();g.subject=f;g.date=h;a.push('<tr class="">');
a.push('<td class="tos">{0}</td>'.format(tos));a.push('<td class="subject" >{0}</td>'.format(f));a.push('<td class="dlStatus" >');a.push("<div>");a.push('<div class="deliver"><i class="i-mD1"></i><a href="javascript:fGoto();" onclick="MM[\'{0}\'].showSendStatus(0,{1})">{2}\u5c01\u6210\u529f</a></div>'.format(b,e,g.iOk));a.push('<div class="deliver"><i class="i-mD2"></i><span>{0}\u5c01\u6295\u9012\u4e2d</span></div>'.format(g.iDeliver));a.push('<div class="deliver"><i class="i-mD3"></i><a href="javascript:fGoto();" onclick="MM[\'{0}\'].showSendStatus(1,{1})">{2}\u5c01\u5931\u8d25</a></div>'.format(b,
e,g.iFail));a.push("</div></td>");a.push('<td class="date" >{0}</td>'.format(h));a.push("</tr>");d.iOk+=g.iOk;d.iTotal+=g.iTotal;d.iFail+=g.iFail;d.iDeliver+=g.iDeliver;this.deliverData.items.push(g)}this.deliverData.info=d;a.push("</tbody></table>")}else a[a.length]='<p class="empty" style="display:block">\u6ca1\u6709\u90ae\u4ef6\u53d1\u9001\u72b6\u6001\u8bb0\u5f55</p>';a.push("</div>");a.push("</div></div>");a.push("</div>");return a.join("")},getToInfo:function(a){for(var b={iTotal:0,iOk:0,iFail:0,
iDeliver:0,toTotal:[],toOk:[],toFail:"",toDeliver:[]},c=0,d=a.length;c<d;c++){var e=a[c],f=e.state,e=e.mail;b.toTotal.push(e);b.iTotal++;f==0||f==101?(b.iDeliver++,b.toDeliver.push(e)):f>=1||f<=3||f==100?(b.iOk++,b.toOk.push(e)):(b.iFail++,b.toFail.push(e))}return b},updateStatus:function(){var a=this.headId,b=this.deliverData.info,c=$(a+"ok"),d=$(a+"fail"),a=$(a+"deliver");c.innerHTML=b.iOk+"\u5c01\u6210\u529f";d.innerHTML=b.iFail+"\u5c01\u6295\u9012\u4e2d";a.innerHTML=b.iDeliver+"\u5c01\u5931\u8d25"},
showSendStatus:function(a,b){var c=[],d="showMsg_"+this.name+"_"+a+"_"+b,e=this.deliverData.items[b];if(e){var f=a==0?e.toOk:e.toFail,g=a==0?"\u6295\u9012\u6210\u529f":"\u6295\u9012\u5931\u8d25";c.push('<div class="mailsentStatus"><div class="list">');c.push("<h3><strong>{0}</strong></h3>".format(e.subject));c.push("<br><table><tbody>");c.push('<tr><th class="to">\u6536\u4ef6\u4eba</th>');c.push('<th class="type" >\u6295\u9012\u72b6\u6001</th>');c.push('<th class="date" >\u65f6\u95f4</th></tr>');
for(var h=0;h<f.length;h++)c.push('<tr class="">'),c.push('<td class="to">{0}</td>'.format(f[h])),c.push('<td class="type">{0}</td>'.format(g)),c.push('<td class="date" >{0}</td>'.format(e.date)),c.push("</tr>");c.push("</tbody></table><br></div></div>");c={id:d,title:"\u90ae\u4ef6\u53d1\u9001\u72b6\u6001",text:c.join(""),width:400,zindex:1100,buttons:[]};CC.msgBox(c)}},init:function(){this.updateStatus();this.setDivHeight()},setDivHeight:function(){var a=CC.docHeight()-GE.pos()[1];try{El.setStyle($("mailsentStatus"),
{height:a+"px"})}catch(b){}},rankList:function(){this.sort=1-this.sort;this.getDeliverStatus();var a=this.sort==0?"desc":"asc";El.setClass($(gConst.listMailSortIcon+"receiveDate_deliver"),a)},resize:function(){this.setDivHeight()},exit:function(){return!0}};
function Fax(){this.name=gConst.fax;this.config={sendfax:{text:Lang.Mail.tb_FaxSend,url:"/MFaxSend.aspx"},faxinbox:{text:Lang.Mail.tb_FaxReceive,url:"/MFaxReceive.aspx"},faxsent:{text:Lang.Mail.tb_FaxSendlist,url:"/MFaxSendList.aspx"},faxjunk:{text:Lang.Mail.tb_FaxReclist,url:"/MFaxRemoveList.aspx"}}}
Fax.prototype={initialize:function(){GMC.initialize(this.name,this)},getHtml:function(){return'<div id="'+gConst.mainToolbar+this.name+'"></div>'+GMC.getHtml(this.name,this.url)},init:function(){this.setDivHeight()},getToolbar:function(){var a=this,b=a.name,c=a.config,d=[];d[d.length]={name:"sendfax",text:c.sendfax.text,clickEvent:function(b){a.optFax(b.name);GC.ossHit(9001)},className:"faxCompose",hasDrop:!1};d[d.length]={name:"faxinbox",text:c.faxinbox.text,clickEvent:function(b){a.optFax(b.name);
GC.ossHit(9002)},className:"faxInbox",hasDrop:!1};d[d.length]={name:"faxsent",text:c.faxsent.text,clickEvent:function(b){a.optFax(b.name);GC.ossHit(9003)},className:"faxSent",hasDrop:!1};d[d.length]={name:"faxjunk",text:c.faxjunk.text,clickEvent:function(b){a.optFax(b.name);GC.ossHit(9004)},className:"faxSpam",hasDrop:!1};var c=El.createElement("div","faxSearch","search"),e=[];e[e.length]='<input class="text" maxlength="50" type="text" value="'+Lang.Mail.fax_InputFaxNumber+'" id="faxSearchInput" onfocus="MM[\''+
b+"'].optSearch(this,'focus')\" onblur=\"MM['"+b+"'].optSearch(this,'blur')\" onkeydown=\"MM['"+b+"'].optSearch(this,'onkeydown')\" onkeyup=\"MM['"+b+"'].optSearch(this,'onkeyup')\"/>";e[e.length]='<a class="btn" href="javascript:fGoto();" onclick="MM[\''+b+'\'].optSearch(this,\'search\');"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.fax_Search+'</span></span><b class="r1"></b></a>';c.innerHTML=e.join("");c.isNode=!0;d[d.length]=c;return d},getToolbarMenu:function(){return[]},resize:function(){this.setDivHeight()},
exit:function(){GMC.gcMem(this.name);return!0},setDivHeight:function(){GMC.setDivHeight(this.name);var a=GMC.getFrameWin(this.name);El.docHeight(a)},getUrl:function(a){var b=this.config,c=b[a].url||"/MFaxSend.aspx",a=b[a].text,c=GC.getCookie("FaxServer")+c+"?sid="+GC.getSid();return{url:c,name:a}},setUrl:function(a){return GMC.setUrl(this.name,a)},optFax:function(a){a=this.getUrl(a);CC.updateTitleNew(a.name,a.url);this.setUrl(a.url)},optSearch:function(a,b){function c(){var a=document.getElementById("faxSearchInput").value;
a==""||a==Lang.Mail.fax_InputFaxNumber?CC.alert(Lang.Mail.Please+Lang.Mail.fax_InputFaxNumber,function(){},Lang.Mail.sys_SystemInfo):(a=GC.getCookie("FaxServer")+"/MFaxQueryList.aspx?key="+a,CC.updateTitleNew(Lang.Mail.fax_SearchList,a),d.setUrl(a))}var d=this;switch(b){case "blur":if(a.value=="")a.value=Lang.Mail.fax_InputFaxNumber;break;case "focus":if(a.value==Lang.Mail.fax_InputFaxNumber)a.value="";break;case "click":if(a.value==Lang.Mail.fax_InputFaxNumber)a.value="";break;case "onkeyup":EV.getEvent().keyCode==
13&&(c(),GC.fireEvent(a,"blur"));break;case "search":c()}}};function Folder(){this.listReadMailDiv=this.listBodyDiv=null;this.menuId="MAIL"}Folder.menu={sys0:{MAIL_INBOX_EDIT:1,MAIL_INBOX_DELETE:1,MAIL_INBOX_EMPTY:1},sys1:{MAIL_INBOX_EDIT:1,MAIL_INBOX_REALDELETE:1,MAIL_INBOX_EMPTY:1},sys2:{MAIL_INBOX_FORWARD:1,MAIL_INBOX_REALDELETE:1,MAIL_INBOX_EMPTY:1,MAIL_INBOX_REFUSE:1,MAIL_INBOX_LAYOUT:1},sys4:{MAIL_INBOX_EDIT:1,MAIL_INBOX_DELETE:1},sys5:{MAIL_INBOX_EDIT:1,MAIL_INBOX_DELETE:1}};
Folder.menuData={"default":{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_INFORM:{sort:7},MAIL_INBOX_MORE:{sort:8}},sys0:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_INFORM:{sort:6}},sys1:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},
MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_INFORM:{sort:7},MAIL_INBOX_MORE:{sort:8}},sys2:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_MARK:{sort:3},MAIL_INBOX_MOVE:{sort:4},MAIL_INBOX_MORE:{sort:8}},sys3:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_MORE:{sort:8}},sys4:{MAIL_INBOX_REALDELETE:{sort:1},
MAIL_INBOX_FORWARD:{sort:2},MAIL_INBOX_MARK:{sort:3},MAIL_INBOX_MOVE:{sort:4},MAIL_INBOX_FILTER:{sort:5},MAIL_INBOX_MORE:{sort:8}},sys5:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_NOTJUNK:{sort:4},MAIL_INBOX_MARK:{sort:5},MAIL_INBOX_MOVE:{sort:6},MAIL_INBOX_MORE:{sort:8}},sys6:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_FORWARD:{sort:2},MAIL_INBOX_NOTJUNK:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_MORE:{sort:8}},sys7:{MAIL_INBOX_MOVE:{sort:5}},
sys10:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_FORWARD:{sort:2},MAIL_INBOX_MARK:{sort:3},MAIL_INBOX_MOVE:{sort:4},MAIL_INBOX_FILTER:{sort:5},MAIL_INBOX_REFUSE:{sort:6},MAIL_INBOX_MORE:{sort:8}},user:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_INFORM:{sort:7},MAIL_INBOX_MORE:{sort:8}},label:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},
MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_INFORM:{sort:7},MAIL_INBOX_MORE:{sort:8}},MARK:{MAIL_INBOX_MARK_READ:{sort:1},MAIL_INBOX_MARK_UNREAD:{sort:2},MAIL_INBOX_MARK_URGENT:{sort:3},MAIL_INBOX_MARK_COMMON:{sort:4},MAIL_INBOX_MARK_TOP:{sort:5},MAIL_INBOX_MARK_NOTOP:{sort:6}},FILTER:{MAIL_INBOX_FILTER_ALL:{sort:1},MAIL_INBOX_FILTER_NOREAD:{sort:2},MAIL_INBOX_FILTER_READ:{sort:3},MAIL_INBOX_FILTER_URGENT:{sort:4},MAIL_INBOX_FILTER_COMMENTS:{sort:5},MAIL_INBOX_FILTER_FORWARD:{sort:6},
MAIL_INBOX_FILTER_STARRED:{sort:7},MAIL_INBOX_FILTER_UNSTARRED:{sort:8},MAIL_INBOX_FILTER_ATTACHMENT:{sort:9},MAIL_INBOX_FILTER_NOATTACHMENT:{sort:10}},MORE:{MAIL_INBOX_MORE_MAILEXPORT:{sort:1},MAIL_INBOX_MORE_MAILIMPORT:{sort:2}},sys12:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_INFORM:{sort:7},MAIL_INBOX_MORE:{sort:8}},sys13:{MAIL_INBOX_DELETE:{sort:1},MAIL_INBOX_REALDELETE:{sort:2},
MAIL_INBOX_FORWARD:{sort:3},MAIL_INBOX_MARK:{sort:4},MAIL_INBOX_MOVE:{sort:5},MAIL_INBOX_FILTER:{sort:6},MAIL_INBOX_INFORM:{sort:7},MAIL_INBOX_MORE:{sort:8}},sys14:{MAIL_INBOX_PASSAUDIT:{sort:1},MAIL_INBOX_NOTPASSAUDIT:{sort:2},MAIL_INBOX_DELETE:{sort:3},MAIL_INBOX_REALDELETE:{sort:4},MAIL_INBOX_FORWARD:{sort:5},MAIL_INBOX_MARK:{sort:6},MAIL_INBOX_MOVE:{sort:7},MAIL_INBOX_FILTER:{sort:8},MAIL_INBOX_INFORM:{sort:9},MAIL_INBOX_MORE:{sort:10}}};
Folder.notNeedIds={EMPTY:1,newLabel:1,FILTERALL:1,FILTERNOREAD:1,FILTERREAD:1,FILTERURGENT:1,FILTERCOMMENTS:1,FILTERFORWARD:1,FILTERSTARRED:1,FILTERUNSTARRED:1,FILTERATTACHMENT:1,FILTERNOATTACHMENT:1,FILTERMONITORRECEIVE:1,FILTERMONITORSEND:1,FILTERPASSAUDIT:1,FILTERNOTPASSAUDIT:1,FILTERUNAUDIT:1,FILTERALLAUDIT:1,FILTERRECEIVEAUDIT:1,FILTERSENDAUDIT:1,MAILIMPORT:1};
Folder.prototype={initialize:function(){var a=MM[gConst.folder];a.needRequest=!0;a.bOrder=GE.list.order;a.order=GE.list.order;a.desc=0;a.isLoadNoReadMail=!0;a.start=1;a.pageCurrent=0;a.fid=1;a.stats={};a.isSearch=!1;a.isFilter="";a.isSecondSearch=!1;a.pageCount=0;a.fromSearch=0;a.stateFlagArr=Lang.Mail.list_MailType.split(",");a.stateFlag=0;a.period=[];a.week=Lang.Mail.date_Weeks.split(",");a.isRefreshFolders=!1;a.currentPeriod=-1;a.drag=null;a.checkBoxAll=null;a.checkBox=null;a.flag=null;a.msg=Lang.Mail.LoadMailList;
a.isAll=!1;a.topNum=0;a.topMids=[];a.toolbarPosition=gConst.toolBarPosition.afterTitle;a.fMenus={};a.sessionCount=0;var b,c,d;d=CC.getMailMenu(gConst.menu.inbox);for(b in this)c=this[b],typeof c=="function"&&(a[b]=c);this.getMenuHash(d,a.fMenus);this.initEvents();if(!GC.check("MAIL_MANAGER_SESSIONMODE"))gMain.sessionMode="0"},getMenuHash:function(a,b){for(var c=a.length,d=0;d<c;d++)b[a[d].name]=a[d]},initEvents:function(){var a=folderlock,b=jQuery,c=b("#unlock_inUnRead"),d=b("#unlock_inSearch");c[0]&&
b("#unlock_inUnRead").click(function(){a.unlocked("","unRead",void 0,void 0)});d[0]&&d.click(function(){a.unlocked("","search",void 0,void 0)});this.changeStatus_read();TaskMail.bindTaskEvent(document);this.bindCloseInBarEvent(b);jQuery("#wrapper .toolbar").on("mouseenter",".pageNum",function(){var a=jQuery("#wrapper .toolbar .pageitem");a.show();/msie 6/i.test(navigator.userAgent)&&a.height()>200&&a.css("height","200px")});jQuery("#wrapper .toolbar").on("mouseenter",".pageitem",function(){jQuery("#wrapper .toolbar .pageitem").show()});
jQuery("#wrapper .toolbar").on("mouseleave",".pageNum",function(){jQuery("#wrapper .toolbar .pageitem").hide()});jQuery("#wrapper .toolbar").on("mouseleave click",".pageitem",function(){jQuery(this).hide()});jQuery("#footpage").on("mouseenter",".pageNum",function(){var a=jQuery("#footpage .pageitem");a.show();/msie 6/i.test(navigator.userAgent)&&a.height()>200&&a.css("height","200px")});jQuery("#footpage").on("mouseenter",".pageitem",function(){jQuery("#footpage .pageitem").show()});jQuery("#footpage").on("mouseleave",
".pageNum",function(){jQuery("#footpage .pageitem").hide()});jQuery("#footpage").on("mouseleave click",".pageitem",function(){jQuery(this).hide()})},changeStatus_read:function(){var a=jQuery,b=this;a(".folderList_status").bind("click",function(c){if(a(this).find("i").attr("class")=="status5"){a(this).find("i").attr("class","status6");var d=a(this).parent().parent().find("input[type=checkbox]").val(),e=[];e.push(d);b.mark(e,"read",0);c.stopPropagation()}else a(this).find("i").attr("class")=="status6"&&
(a(this).find("i").attr("class","status5"),d=a(this).parent().parent().find("input[type=checkbox]").val(),e=[],e.push(d),b.mark(e,"read",1),c.stopPropagation())})},getLockTip:function(a){var b=[],c="",c="unlock_inSearch";a.offUnreadFolder()&&a.isLoadNoReadMail&&a.isSearch&&gMain.hasLock_unReadMail==!0&&gMain.lock_close==!0&&(b.push("<div class=\"cy-yellowtips\" id='unReadMail_lockTip'>"),b.push(Lang.Mail.ConfigJs.someLockedTip),b.push('<a href="javascript:void(0);" id="'+c+'">'),b.push(Lang.Mail.Write.unlockAndsearch+
"</a></div>"));a.text==="\u654f\u611f\u90ae\u4ef6"&&b.push(SensitiveMail.addTips());return b.join("")},offUnreadFolder:function(){var a=!0,b=0;if(GE.currentFid&&GE.currentFid!=0)return!1;for(var c in GE.searchFlag)GE.searchFlag.hasOwnProperty(c)&&b++;b===1&&GE.searchFlag&&!GE.searchFlag.read&&(a=!1);return a},getTaskTipShow:function(){var a;a=Folder.taskType===2?GE.taskedMailNum:GE.taskMailNum;return this.text==="\u5f85\u529e\u90ae\u4ef6"&&a!==this.stats.messageCount},getHtml:function(){var a=[],
b=this.name,c=this.fid,d;GE.topNum=0;GE.topMids.splice(0);this.start=1;this.limit=CC.getPageSize();if(this.fid==1&&gMain.sessionMode=="1")this.sessionCount=CM[b].sessionCount;if(this.isSearch=this.name==GE.folderObj.search?!0:!1)this.fid=0;for(var e=0,f=0,e=this.stats.messageCount,f=this.stats.unreadMessageCount,g=[],h=this.desc?"desc":"asc",j=0;j<GE.list.orderCount;j++)g[j]=this.order==GE.list.orderField[j]?this.order==GE.list.orderField[1]?'<i id="'+gConst.listMailSortIcon+GE.list.orderField[j]+
'"  class="'+h+'"></i>':'<i id="'+gConst.listMailSortIcon+GE.list.orderField[j]+'" class="'+h+'"></i>':j==1?'<i id="'+gConst.listMailSortIcon+GE.list.orderField[j]+'" ></i>':'<i id="'+gConst.listMailSortIcon+GE.list.orderField[j]+'"></i>';h=Lang.Mail.list_Send;j=1;if(c==GE.folder.draft||c==GE.folder.sent)h=Lang.Mail.list_Recipients,j=2;this.type==="label"&&(d=c);var n=this.text.lefts(30).encodeHTML(),k=/^(sys|user)[1-9]\d*$/.test(b)?'  <a href="#" onclick="CC.setAllRead(\''+b+"')\">\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb</a>":
"";d='<h1 id="'+gConst.listMailId+"h1_"+b+'">'+n+'</h1><p id="'+gConst.listMailId+"mailCount_"+b+'">(<span>'+Lang.Mail.maicountTitle.format(e)+'\uff0c<a href="#" onclick="CC.searchNewMail('+c+",true, "+d+')">'+Lang.Mail.unreadMailTitle+"</a>"+Lang.Mail.countTitle.format(f)+"</span>"+k;var q=gMain.mailFileCount?parseInt(gMain.mailFileCount):1E4;e>=q&&c==1&&(d+="\uff0c",d+=Lang.Mail.mailFileTitle.format("&nbsp;<a onclick=\"MM['sys1'].loadMailFileHtml()\" href='#'>"+Lang.Mail.mailFile+"</a>&nbsp;"));
d+=")</p>";d+=this.isPopFolder(c);q=GE.searchKey||"";if(this.isFilter)if(GE.folderMap&&GE.folderMap[gConst.folderEnum.audit]&&this.fid==gConst.folderEnum.audit&&this.isFilter==Lang.Mail.Write.FilterAll||this.isFilter==Lang.Mail.Write.reMailAudit||this.isFilter==Lang.Mail.Write.sendMailAudit)if(this.isFilter==Lang.Mail.Write.FilterAll)d='<h1 id="'+gConst.listMailId+"h1_"+b+'">'+Lang.Mail.Write.unAudit+"</h1>",d+='<p id="'+gConst.listMailId+"mailCount_"+b+'">('+Lang.Mail.list_FilterMailCount.format(e)+
"";else{if(this.isFilter==Lang.Mail.Write.reMailAudit||this.isFilter==Lang.Mail.Write.sendMailAudit)d='<h1 id="'+gConst.listMailId+"h1_"+b+'">'+Lang.Mail.Write.unAudit+"</h1>",d+='<span id="'+gConst.listMailId+"span_"+b+'">&nbsp;&gt;&gt;&nbsp;</span>',d+='<h1 id="'+gConst.listMailId+"h2_"+b+'">'+this.isFilter+"</h1>",d+='<p id="'+gConst.listMailId+"mailCount_"+b+'">('+Lang.Mail.list_FilterMailCount.format(e)+k+")</p>"}else GE.folderMap&&(GE.folderMap[gConst.folderEnum.audit]||GE.folderMap[gConst.folderEnum.monitor])&&
(this.fid==gConst.folderEnum.audit||this.fid==gConst.folderEnum.monitor)&&this.isFilter==Lang.Mail.Write.dateFilter?(d='<h1 id="'+gConst.listMailId+"h1_"+b+'">'+n+"</h1>",d+='<span id="'+gConst.listMailId+"span_"+b+'">&nbsp;&gt;&gt;&nbsp;</span>',d+='<h1 id="'+gConst.listMailId+"h2_"+b+'">'+this.selectDate+"</h1>"):(d='<h1 id="'+gConst.listMailId+"h1_"+b+'">'+n+"</h1>",d+='<span id="'+gConst.listMailId+"span_"+b+'">&nbsp;&gt;&gt;&nbsp;</span>',d+='<h1 id="'+gConst.listMailId+"h2_"+b+'">'+this.isFilter+
"</h1>"),d+='<p id="'+gConst.listMailId+"mailCount_"+b+'">('+Lang.Mail.list_FilterMailCount.format(e)+k+")</p>";this.isSearch&&(q?(c=q.trim(),q=q.trim().lefts(30),q=q.encodeHTML(),d='<h1 id="'+gConst.listMailId+"h1_"+b+'">'+Lang.Mail.Write.searchResult+"</h1>",d+='<p style="color:#333333;" title="'+c.encodeHTML()+'">&nbsp;&gt;&gt;&nbsp;'+Lang.Mail.SearchKeyAndCount+q+"</p>",d+='<p id="'+gConst.listMailId+"mailCount_"+b+'">('+Lang.Mail.list_searchMailNumber.format(e)+k+")</p>"):(d='<h1 id="'+gConst.listMailId+
"h1_"+b+'">'+n+'</h1><p id="'+gConst.listMailId+"mailCount_"+b+'">('+Lang.Mail.maicountTitle.format(e)+"\uff0c",this.checkObjLen(GE.searchFlag)===1&&GE.searchFlag.read===1?d+=Lang.Mail.unreadMailTitle:(d+='<a href="javascript:;" onclick="CC.searchFolderNoRead('+c+');">',d+=Lang.Mail.unreadMailTitle+"</a> "),d+=Lang.Mail.countTitle.format(f)+k+")</p>"));a[a.length]='<div class="main" id="'+gConst.listMailId+b+'">';a[a.length]=this.getLockTip(this);this.text==="\u5f85\u529e\u90ae\u4ef6"&&(a[a.length]=
'<div class="header" id="'+gConst.listHeaderId+b+'">',a[a.length]='<div style="overflow:hidden;">',a[a.length]='<ul class="nav-hd"><li '+(Folder.taskType!==2?'class="currentd"':"")+'><a onclick="CC.receiveMail({taskFlag: 1});return false;" href="javascript:fGoto();">\u5f85\u529e\u90ae\u4ef6</a></li><li '+(Folder.taskType===2?'class="currentd"':"")+'><a onclick="CC.receiveMail({taskFlag: 2}); return false;" href="javascript:fGoto();">\u5df2\u5b8c\u6210</a></li></ul>',a[a.length]="</div></div>");this.fid==
8?(a[a.length]='<div class="header" id="'+gConst.listHeaderId+b+'">',a[a.length]='<div style="overflow:hidden;">',a[a.length]='<ul class="nav-hd"><li class="currentd"><a onclick="return false;" href="javascript:fGoto();">'+Lang.Mail.Write.accoutMail+'</a></li><li><a onclick=CC.goBillmanager("'+b+'");return false;" href="javascript:fGoto();">'+Lang.Mail.Write.accoutDetail+"</a></li></ul>",a[a.length]="</div>"):(a[a.length]='<div class="listHeader" id="'+gConst.listHeaderId+b+'">',a[a.length]=d);a[a.length]=
"</div>";a[a.length]='<div id="'+gConst.mainToolbar+b+'">';a[a.length]="</div>";a[a.length]='<div class="mailList list">';a[a.length]='<table cellpadding="0" id="'+gConst.listTitleId+b+'"><thead><tr>';a[a.length]='<th class="check" id="secondSearchMenu_'+b+'"><input id="'+gConst.listCheckBoxId+b+'_all"  name="checkbox_'+b+'_all" onClick="MM[\''+b+'\'].click(\'all\',this.checked)" type="checkbox" value=""/>';a[a.length]="</th>";a[a.length]='<th class="icons">&nbsp;</th>';a[a.length]='<th class="from" onClick="MM[\''+
b+"'].rankList('"+GE.list.orderField[j]+'\')" ><a href="javascript:fGoto();" title="'+Lang.Mail.list_ClickSort+'" ><em style=" width:27px; display:inline-block;"></em>'+h+"</a>"+g[j]+"</th>";a[a.length]='<th class="subject"  onClick="MM[\''+b+'\'].rankList(\'subject\')"><a href="javascript:fGoto();" title="'+Lang.Mail.list_ClickSort+'" ><em style=" width:15px; display:inline-block;"></em>'+Lang.Mail.list_Subject+"</a>"+g[4]+"</th>";a[a.length]='<th class="date"  onClick="MM[\''+b+"'].rankList('"+
GE.list.order+'\')"><a href="javascript:fGoto();" title="'+Lang.Mail.list_ClickSort+'"><em style=" width:15px; display:inline-block;"></em>';a[a.length]=this.fid!==7?Lang.Mail.list_Date:"\u5220\u9664\u65e5\u671f";a[a.length]="</a>"+g[0]+"</th>";a[a.length]='<th class="size" onClick="MM[\''+b+'\'].rankList(\'size\')"><a href="javascript:fGoto();" title="'+Lang.Mail.list_ClickSort+'" ><em style=" width:15px; display:inline-block;"></em>'+Lang.Mail.list_Size+"</a>"+g[3]+"</th>";a[a.length]=TaskMail.getListThHtml();
a[a.length]='<th class="scroll"></th>';a[a.length]="</tr></thead></table>";CC.power.offRestoreDeleted()&&this.fid===7&&a.push('<div style="margin: 0px;text-indent: 5px;" class="set-tips">\u53ea\u53ef\u4ee5\u6062\u590d\u6700\u8fd13\u5929\u5f7b\u5e95\u5220\u9664\u7684\u90ae\u4ef6</div>');a[a.length]='<div class="listBody p_relative" id="'+gConst.listBodyId+b+'">';a[a.length]=this.getListData();a[a.length]="</div>";a[a.length]='<div id="footpage" style="height:40px; position:relative; border-top:1px solid #e2e2e2;">'+
this.getfooterPage()+"</div>";a[a.length]="</div>";a[a.length]="</div>";a[a.length]=this.getReadMailHtml();GE.isFullSearch=0;return a.join("")},checkObjLen:function(a){var b=0,c;for(c in GE.searchFlag)a.hasOwnProperty(c)&&b++;return b},isPopFolder:function(a){for(var b=CM.folderMain[gConst.dataName],c=b.length,d=0,e="";d<c;d++)if(b[d].fid===a&&b[d].type===6){e=this.getPopBtnHtml(b[d].popMailId,a);break}return e},getPopBtnHtml:function(a,b){return'<p style="margin-left: 30px"><a href="javascript:;" onclick=CC.compose("","","","","'+
this.text.encodeHTML()+'")>\u5199\u4fe1</a> | <a href="javascript:;" onclick="mailPOP.syncPOP('+a+", false, true, "+b+');">'+Lang.Mail.ConfigJs.receiveMail+'</a> | <a href="javascript:;" onclick="CC.setConfig(\'mailPOP\', true);mailPOP.showAdd('+a+');mailPOP.setHeight();">'+Lang.Mail.ConfigJs.modSetting+'</a> | <a href="javascript:;" onclick="CC.goLogLink(\''+Lang.Mail.ConfigJs.LogQuery+"', 'agent');\">"+Lang.Mail.ConfigJs.viewColltectionRecord+'</a></p><p style="float:right;margin-right: 30px"><a href="javascript:;" onclick=javascript:jQuery("#-6").find(".action").click()>\u6dfb\u52a0</a> |<a href="javascript:;" onclick=javascript:jQuery("#-6").find(".manage").click()>\u7ba1\u7406\u4ee3\u6536\u90ae\u7bb1</a> </p>'},
getToolbarRightPart:function(){var a=this.name,b=El.createElement("div",gConst.listTopPageId+a,"pager"),c=this.getDatePicker(),d="";d+=GE.folderMap&&(GE.folderMap[gConst.folderEnum.audit]||GE.folderMap[gConst.folderEnum.monitor])&&(a=="sys"+gConst.folderEnum.monitor||a=="sys"+gConst.folderEnum.audit)?c+this.getPage():this.getPage();b.innerHTML=d;return b},getReadMailHtml:function(){var a=this.name,b=[],c=gConst.listReadMailId,d=c+"Drag_"+a,e=c+"Default_"+a,f=c+"Toolbar_"+a,g=c+"Icon_"+a,h=c+"Title_"+
a,j=c+"Content_"+a;b.push('<div class="readInbox" id="'+c+a+'" style="bottom:0px;right:0px">');b.push('<div class="border" style="Z-Index:1000;" id="'+d+'" title="'+Lang.Mail.list_DragSize+'"><i></i></div>');b.push('<div class="selectResult" id="'+e+'"><h2>'+Lang.Mail.list_NoSelectMail+"</h2><p>"+Lang.Mail.list_ClickReadMail+"</p></div>");b.push('<div class="riWrapper" id="'+j+'"><div class="riHeader" id="'+f+'"><h1><i id="'+g+'" class="off" onclick="MM[\''+a+"'].optReadMail('setTitle',this);\"></i><p id=\""+
h+'"></p></h1>');b.push('<div class="btnRIWrapper">');GC.check("MAIL_READ_REPLY")&&b.push('<div class="btnReadInbox"><p onclick="MM[\''+a+"'].optReadMailMenu('rm_rpl');\">"+Lang.Mail.tb_Reply+'</p><i class="menuSwitch" onclick="MM[\''+a+"'].optReadMailMenu('replymenu');\"></i></div>");GC.check("MAIL_INBOX_FORWARD")&&b.push('<div class="btnReadInbox"><p onclick="MM[\''+a+"'].optReadMailMenu('rm_fwd');\">"+Lang.Mail.tb_Forward+"</p></div>");GC.check("MAIL_INBOX_REFUSE")&&b.push('<div class="btnReadInbox"><p onclick="MM[\''+
a+"'].optReadMailMenu('rm_blacklist');\">"+Lang.Mail.tb_Refuse+'</p><i class="menuSwitch" onclick="MM[\''+a+"'].optReadMailMenu('refusemenu');\"></i></div>");b.push('</div><a class="action" href="javascript:fGoto();" title="'+Lang.Mail.list_ClickOpenLable+'" id="'+c+"newLabel_"+a+'">'+Lang.Mail.list_NewLable+"</a></div>");b.push('<div id="pageReadMail'+a+'"></div>');b.push("</div>");return b.join("")},getReadMailToolbarMenu:function(a){var b=this,c=[];switch(a){case "reply":c.push({isShow:!0,name:"MAIL_READ_REPLY_ONE",
text:Lang.Mail.tb_ReplySend,attrs:"isBold=true",url:function(){b.optReadMailMenu("rm_rpl")},children:[]});c.push({isShow:!0,name:"MAIL_READ_REPLY_ALL",text:Lang.Mail.tb_ReplyAll,attrs:"",url:function(){b.optReadMailMenu("rm_rpl")},children:[]});break;case "refuse":c.push({isShow:!0,name:"MAIL_INBOX_REFUSE_BLACKLIST",text:Lang.Mail.tb_RefuseSend,attrs:"isBold=true",url:function(){b.optReadMailMenu("rm_blacklist")},children:[]}),c.push({isShow:!0,name:"MAIL_INBOX_REFUSE_FILTER",text:Lang.Mail.tb_AddFilter,
attrs:"",url:function(){b.optReadMailMenu("rm_filter")},children:[]})}return c},init:function(){var a=this.name;this.listBodyDiv=$(gConst.listBodyId+a);this.listReadMailDiv=$(gConst.listReadMailId+a);this.checkBoxAll=$("checkbox_"+a+"_all");this.initDragEvent();a=CC.getReadMode();if(a==""||a==null)a=0;this.readMailType=a;this.setReadMailStyle(this.readMailType,!0);CC.isLabelMail()&&CC.labelBind(this.listBodyDiv);EV.addEvent(document,"click",function(){if(document.getElementById("divRemark")){var a=
document.getElementById("divRemark");a.parentNode.removeChild(a)}},!1);this.initEvents()},setDivHeight:function(a){var b=this,c=b.name,d=0,d=b.stats.messageCount;if(gMain.sessionMode=="1"&&this.fid==1)d=b.sessionCount;b.pageCount=Math.ceil(d/b.limit);(function(a,d){try{var g=GMC.getMainHeight(c);typeof a=="number"&&$(gConst.divToolbar+c)&&(a-=$(gConst.divToolbar+c).offsetHeight);g<120&&(g=120);var h=g,j=0,n=0;if(b.readMailType==1){typeof a=="number"?(h=a,j=g-h):(h=g*0.5,j=g*0.5);j<120&&(j=120,h=g-
j);h<120&&(h=120,j=g-h);var k=j-$(gConst.listReadMailId+"Toolbar_"+c).offsetHeight-$(gConst.listReadMailId+"Drag_"+c).offsetHeight,q=$("readHeader_"+c),n=q?q.offsetHeight:0}var g=k-n,t=h-$(gConst.listHeaderId+c).offsetHeight-$(gConst.listTitleId+c).offsetHeight;El.setStyle($(gConst.listMailId+c),{height:h+"px"});b.listBodyDiv&&(d>1?(t<122&&(t=122),El.setStyle(b.listBodyDiv,{height:t-40+"px"})):El.setStyle(b.listBodyDiv,{height:t+"px"}));b.readMailType==1?(El.setStyle(b.listReadMailDiv,{height:j+"px"}),
El.height($(gConst.ifrmReadmail+c),g)):b.listReadMailDiv.style.display="none"}catch(u){}})(a,b.pageCount)},initPeriod:function(){var a=this.period,b=this.week,c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate()+1),e="";a["-1"]={name:Lang.Mail.tb_Top,start:null,end:null};for(var f=0,c=c.getDay();f<=c;f++)e=f==0?Lang.Mail.date_Today:f==1?Lang.Mail.date_Yesterday:Lang.Mail.date_Week+b[c-f],a[a.length]={name:e,start:d.dateAdd(-(f+1)),end:d.dateAdd(-f)};a[a.length]={name:Lang.Mail.date_LongAgo,
start:new Date(-1E4,0,1),end:d};if(a[0].name==Lang.Mail.date_Today)a[0].end=new Date(1E4,0,1)},getPeriodIndex:function(a,b){var c=this.period;if(b)return b;else for(var d=0,e=c.length;d<e;d++){var f=c[d];if(a>=f.start&&a<=f.end)return d}return-99},getListData:function(){var a=this.name,b=CM[a]["var"]||[],c=null,d=-99,e=-99,f=[];GE.topNum=0;this.order==GE.list.order&&this.period.length==0&&this.initPeriod();var g=this.getPage(),h=this.getfooterPage(),j=this.getDatePicker(),n=$(gConst.listTopPageId+
a),k=jQuery("#footpage")[0],a=$(gConst.listCheckBoxId+a+"_all");if(n)GE.folderMap&&(GE.folderMap[gConst.folderEnum.audit]||GE.folderMap[gConst.folderEnum.monitor])&&(this.name=="sys"+gConst.folderEnum.monitor||this.name=="sys"+gConst.folderEnum.audit)?n.innerHTML=j+g:(n.innerHTML=g,k.innerHTML=h);this.getDatePick();if(a)a.checked=!1;if(!b||b.length==0){if(this.text==="\u5f85\u529e\u90ae\u4ef6")return d=CC.getResourceAbsoluteURL()+"/images/undomission_default.jpg",c=Folder.taskType===1?"\u5f85\u529e\u90ae\u4ef6":
"\u5df2\u5b8c\u6210",b='<div class="undo_default">',b+='<h2>\u60a8\u6682\u65f6\u6ca1\u6709"'+c+'"\u90ae\u4ef6</h2>',b+="<p>\u60a8\u53ef\u4ee5\u5c06\u60a8\u7684\u5f85\u529e\u4efb\u52a1\u90ae\u4ef6\u8bbe\u4e3a"+c+"\u3002</p>",b+='<img src="'+d+'">',b+="</div>",b;else if(this.isFilter==="\u5df2\u52a0\u661f\u6807")return d=CC.getResourceAbsoluteURL()+"/images/StarIntro.gif",b='<div class="undo_default">',b+='<h2>\u60a8\u6682\u65f6\u6ca1\u6709"\u661f\u6807"\u90ae\u4ef6</h2>',b+="<p>\u60a8\u53ef\u4ee5\u5728\u90ae\u4ef6\u5217\u8868\u4e2d\u5c06\u90ae\u4ef6\u8bbe\u4e3a\u661f\u6807\uff0c\u65b9\u4fbf\u67e5\u627e\u91cd\u8981\u90ae\u4ef6\u3002</p>",
b+='<img src="'+d+'">',b+="</div>",b;b='<p class="set_rule_box_tips" style="display:block">'+Lang.Mail.list_NoMail+"</p>";this.isSearch&&!this.isLoadNoReadMail&&(b='<p class="set_rule_box_tips" style="display:block">'+Lang.Mail.NotSearchData+"</p>");return b}try{this.isSearch&&GE.searchKey&&f.push(this.getCloseInBarHtml(this.stats));for(var g=0,q=b.length;g<q;g++){var t=b[g],u=t.flags||{},s=t[GE.list.order],s=new Date(s*1E3),r=u.top?"-1":null;this.order==GE.list.order?(c&&e!=d&&(f[f.length]=this.getTable(d,
!0)),d=this.getPeriodIndex(s,r),e!=d&&(c=this.getTable(d),e=d,f[f.length]=c)):c||(c=this.getTable(),f[f.length]=c);f[f.length]=this.getSingleHtml(b[g],g,d);b[g].flags.top&&(GE.topNum++,GE.topMids.push(b[g].mid))}f[f.length]=this.order==GE.list.order?this.getTable(d,!0):this.getTable("",!0)}catch(w){}return f.join("")},setPageStart:function(a){var b=CM[this.name]["var"];if(this.pageCurrent==this.pageCount-1&&this.pageCurrent>0&&b&&b.length>0&&b.length-a==0)this.start=(this.pageCurrent-1)*this.limit+
1},getTable:function(a,b){var c=this.name,d=this.order==GE.list.order,e="",e="";b?e='</tbody><tfoot><tr><td colspan="6"></td></tr></tfoot></table>':d?(e='<table cellpadding="0" id="'+("period_table_"+c+a)+'"><caption onclick="MM[\''+c+"'].controlPeriod(this)\" ><i></i>"+this.period[a].name+"</caption><tbody>",this.currentPeriod=a):(e=this.order+"_table_"+c,e='<table cellpadding="0" id="'+e+'"><tbody>');return e},getSecondSearch:function(){for(var a=GE.secondSearch,b=this.isSearch?a.name:this.name,
c=this.isSearch?a.fid:this.fid,d={id:"folderSecondSearch"+b,name:"folderSecondSearch"+b,div:$("secondSearchMenu_"+b)},e=[],f=[{name:Lang.Mail.Write.FilterAll,val:""},{name:Lang.Menu.Web.mail_inbox_mark_unread,val:{read:1}},{name:Lang.Mail.Write.hasAttach,val:{attached:1}},{name:Lang.Mail.Write.replyed,val:{replied:1}},{name:Lang.Mail.Write.forworded,val:{forwarded:1}}],g=0;g<f.length;g++){var h=f[g];h.val?e.push([h.name,function(){a.fid=c;a.name=b;GE.isSecondSearch=!0;CC.searchMailByFlag(c,h.val)}]):
e.push([h.name,function(){GE.isSecondSearch=!1;CC.goFolder(c,b)}])}CC.getMenu(d,e)},getSingleHtml:function(a,b){var c=this.name,d=[],e=a.fid,f=a.from;if(e==GE.folder.draft||e==GE.folder.sent)f=a.from.trim(),f.right(1)==";"&&(f=f.left(f.length-1));var g=CC.getMailText(a.subject,Lang.Mail.list_noSubject),h=g,j=new Date(a.receiveDate*1E3),n=a.size,n=Util.formatSize(n,null,1),k=a.flags||{},q=a.mid,t=a.mailSession,u=a.mailNum||0,s=a.to,r=a.meetingFlag||!1;s.length>0&&s.substr(s.length-1)==";"&&(s=s.substring(0,
s.length-1));var s=CC.getMailText(s,Lang.Mail.list_nosender),f=CC.getMailText(f,Lang.Mail.list_nosender),w="",x=!1;gMain.sessionMode=="1"&&this.fid==1&&u>1&&(w="<span class='mailList_sessionCount'>"+u+"</span>",x=!0);d[d.length]='<tr data-mid="'+a.mid+'" id="tr_'+c+"_"+b+'" onmouseover="MM[\''+c+"'].trMouseOver(this);\" onmouseout=\"MM['"+c+'\'].trMouseOut(this);"  style="cursor:pointer"';k.read&&(d[d.length]=' class="new"');d[d.length]=">";d[d.length]='<td class="check">';d[d.length]='<input title="'+
Lang.Mail.list_SelectOrNo+'" type="checkbox" onclick=MM[\''+c+"'].selectMail(this,\"tr_"+c+"_"+b+'"); ';d[d.length]=' value="'+q;d[d.length]='" name="'+gConst.checkBoxName+'" id="checkbox_'+c+"_"+b+'"';d[d.length]=' sessionId="'+t+'"  />';d[d.length]="</td>";d[d.length]='<td class="icons">';d[d.length]=this.getIcons(a);d[d.length]="</td>";d[d.length]='<td class="from">';d[d.length]=this.fid==GE.folder.sent?'<span class="sendStatus">'+this.getSendStatus(a.rcptFlag,a)+"</span>":'<span class="status folderList_status">'+
this.getStatus(k,a)+"</span>";if(this.fid==2||this.fid==3)f=s;s=(s=Email.getName?Email.getName(f.decodeHTML()):f)?s.encodeHTML():Lang.Mail.list_nosender;d[d.length]='<a href="javascript:fGoto();return false;" class="mailList_sender" onclick="MM[\''+c+"'].gotoRead("+b+","+x+", "+r+');return false;" title="'+f+'">'+s+"</a></td>";d[d.length]='<td class="subject"><div class="tagWp" style="position:relative">';if(CC.isLabelMail()){d[d.length]='<div class="tag_div">';s=0;for(t=a.label.length;s<t;s++)if(u=
MM.getFolderObject(a.label[s]))d[d.length]='<a href="javascript:void(0);" data-lid="'+u.fid+'" data-mid="'+q+'" class="'+gConst.labelColor[u.folderColor]+' tag_squ ml_5"><span>',d[d.length]=u.name,d[d.length]="</span><i></i></a>";d[d.length]="</div>"}d[d.length]='<div class="tagCon"  onclick="MM[\''+c+"'].gotoRead("+b+","+x+", "+r+');return false;">';r=a.summary.encodeHTML();if(this.isSearch)e=MM.getFolderObject(e).name,h=CC.getMailText(a.subject,Lang.Mail.list_noSubject).replace(gConst.searchBrightKeyLeft,
"").replace(gConst.searchBrightKeyRight,""),g=g.replace(gConst.searchBrightKeyLeft,"<span style='background-color:Gold;padding-left:2px;padding-right:2px;'>").replace(gConst.searchBrightKeyRight,"</span>"),this.isLoadNoReadMail||(g="<span style='color:#999999;'>["+e+"]</span>"+g),r&&(r=r.replace(gConst.searchBrightKeyLeft,"<span style='background-color:Gold;padding-left:2px;padding-right:2px;'>").replace(gConst.searchBrightKeyRight,"</span>"));d[d.length]='<div class="tagText" id="tagText_'+q+'">';
k.memoFlag&&(d[d.length]='<span class="qm_ico_remarkon" onmouseover="MM[\''+c+"'].showRemark('"+q+"',this)\"></span>");GC.check("MAIL_INBOX_SECURITY")&&a.securityLevel&&(d[d.length]="\u3010"+parent.CC.getSecurityMailName(a.securityLevel)+"\u3011");d[d.length]='<a id="listsubject_'+c+"_"+b+'" href="javascript:fGoto();return false;"  title="'+h+'"';if(a.color)try{if(gConst.subjectColor.length<=a.color)a.color=gConst.subjectColor.length-1;var z=CC.getSubjectColorObject(a.color).value;d[d.length]="style='color: "+
z+";'"}catch(y){}d[d.length]=g.length>35&&!this.isSearch?">"+g.substring(0,35)+"...":">"+g;d.push(this.getAutoDestroyHtml(a));d.push(w);this.isSearch&&GE.isFullSearch&&GE.isFullSearch==1?d[d.length]="<span class='mailSummary_style' >  ["+Lang.Mail.Write.mailSummary+"] "+r+"</span>":gMain.showSummary=="1"&&r!=""&&(d[d.length]="<span class='mailSummary_style' >  ["+Lang.Mail.Write.mailSummary+"] "+r+"</span>");d[d.length]="</a></div></div></div></td>";c=Util.DateDiffMore(j,new Date,"s");g=null;c>0&&
c<60?g=c+Lang.Mail.Write.secbefore:c>60&&c<3600?g=parseInt(c/60)+Lang.Mail.Write.minuiteBefore:c>3600&&c<7200?g=Lang.Mail.Write.oneHourBefore:(c=j.getYear(),g=j.getMonth(),h=j.getDate(),k=new Date,g=k.getYear()==c&&k.getMonth()==g&&k.getDate()==h?Lang.Mail.Write.todyaMail+Util.formatDate(j,"HH:nn"):k.getYear()==c?Util.formatDate(j,"mm-dd HH:nn"):j.format("yyyy-mm-dd"));d[d.length]='<td class="date">'+g+"</td>";d[d.length]='<td class="size"><div style="float:left;">'+n+"</div>";d[d.length]="</td>";
a.emailName=Email.getName(f.decodeHTML());d.push(TaskMail.getListIconHtml(a));d[d.length]="</tr>";return d.join("")},getAutoDestroyHtml:function(a){var b="";a.flags.selfdestruct&&(b+='<span style="color: red;">',a.keepDay===0?b+="\u3010\u8bfb\u5b8c\u81ea\u9500\u6bc1\u3011":a.keepDay>0&&(a=a.keepDay*86400+a.receiveDate,a=new Date(a*1E3),b+="\u3010"+a.getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u53f7\u8fc7\u671f\u3011"),b+="</span>");return b},getIcons:function(a){var b=[],c=this.name,
d=a.flags||{},e=a.mid;b[b.length]='<span class="priority">'+this.getPriority(a.priority)+"</span>";b[b.length]=d.starFlag?'<span><input type="button" id="aStarFlag_'+e+'"  class="qm_ico_flagon" onclick="MM[\''+c+"'].fStarFlag('"+e+'\',0);" title="'+Lang.Mail.haveStar+'"></span>':'<span ><input type="button" id="aStarFlag_'+e+'"  class="qm_ico_flagoff" onclick="MM[\''+c+"'].fStarFlag('"+e+'\',1);" title="'+Lang.Mail.noStar+'"></span>';a=this.getAttach(a.flags);a!=""&&(b[b.length]='<span class="attach">'+
a+"</span>");return b.join("")},getToolbar:function(a){function b(a){var b={};b.name=a;b.children=[];switch(a){case "MAIL_INBOX_FILTER":b.id="-1";b.url="";b.text=Lang.Mail.ConfigJs.filter;b.attrs="getsub=true";break;case "MAIL_INBOX_INFORM":b.id="-2";b.url="menu";b.text=Lang.Mail.ConfigJs.inform;break;case "MAIL_INBOX_NOTJUNK":b.id="-3";b.url="";b.text=Lang.Mail.ConfigJs.notJunk;break;case "MAIL_INBOX_NOTVIRUS":b.id="-4";b.url="";b.text=Lang.Mail.ConfigJs.notVirus;break;case "MAIL_INBOX_PASSAUDIT":b.id=
"-5";b.url="menu";b.text=Lang.Mail.Write.auditPass;break;case "MAIL_INBOX_NOTPASSAUDIT":b.id="-6";b.url="menu";b.text=Lang.Mail.Write.auditNotPass;break;case "MAIL_INBOX_DATEPICKER":b.id="-7";b.url="menu";b.text=Lang.Mail.Write.dateFilter;break;default:b=null}return b}var c=MM[a],d=[];a.substr(0,4)=="user"?a="user":a.substr(0,5)=="label"&&(a="label");var a=Folder.menuData[a]||Folder.menuData["default"],e;CC.getFolders();e=null;for(var f in a)if(!menu2AuthorityMap||menu2AuthorityMap&&!menu2AuthorityMap[f]||
menu2AuthorityMap&&menu2AuthorityMap[f]&&GC.check(menu2AuthorityMap[f]))if(c.fMenus[f])c.fMenus[f].sort=a[f].sort,c.fMenus[f].isShow=!0,d.push(c.fMenus[f]);else if(e=b(f))e.isShow=!0,e.sort=a[f].sort,d.push(e);return d.sort(function(a,b){return a.sort>b.sort})},createVisualNode:function(a){var b={},c;for(c in a)b[c]=a[c];return b},getToolbarMenu:function(a,b){var c=this,d=[],b=b||[],e=0,e="";switch(a){case "MOVE":e=CC.getFolders();c.getAllFolder(d,e);break;case "MARK":d=c.getAllChildren("MARK");if(gMain.sessionMode==
"1"&&this.fid==1)for(e=0;e<d.length;e++)(d[e].name=="MAIL_INBOX_MARK_NOTOP"||d[e].name=="MAIL_INBOX_MARK_TOP")&&d.splice(e,2);break;case "FILTER":d=c.getAllChildren("FILTER");break;case "LAYOUT":for(e=0;e<b.length;e++)b[e].url=function(a){return function(){c.setReadMailStyle(a)}}(e),b[e].attrs=c.readMailType==e?Util.setAttrsValue(b[e].attrs,"checked","true"):Util.setAttrsValue(b[e].attrs,"checked","false"),d.push(b[e]);break;case "MORE":d=c.getAllChildren("MORE")}return d},getAllChildren:function(a){var b=
[],c=Folder.menuData[a],d=this.name;if(c)for(var e in c)if(this.fMenus[e]){var f=Object.extend({},this.fMenus[e]);if(CC.isLabelMail()&&a=="MARK"&&e=="MAIL_INBOX_MARK_NOTOP"||(d=="sys"+gConst.folderEnum.monitor||d=="sys"+gConst.folderEnum.audit)&&a=="FILTER"&&e=="MAIL_INBOX_FILTER_NOATTACHMENT")f.attrs="sep=true";b.push(f)}c={id:0,url:"menu",attrs:"",text:"",isShow:!0,name:"",children:[]};if(d=="sys"+gConst.folderEnum.monitor&&a=="FILTER")c.id=-101,c.text=Lang.Mail.Write.receiveMonitor,c.name="MAIL_INBOX_FILTER_MONITORRECEIVE",
e=this.createVisualNode(c),c.id=-102,c.text=Lang.Mail.Write.sendMonitor,c.name="MAIL_INBOX_FILTER_MONITORSEND",f=this.createVisualNode(c),b.push(e),b.push(f);if(d=="sys"+gConst.folderEnum.audit&&a=="FILTER")c.id=-201,c.text=Lang.Mail.Write.unAudit,c.name="MAIL_INBOX_FILTER_UNAUDIT",c.url="",c.children=[this.getVnode("all_audit"),this.getVnode("receive_audit"),this.getVnode("send_audit")],d=this.createVisualNode(c),c.id=-202,c.text=Lang.Mail.Write.auditPass,c.name="MAIL_INBOX_FILTER_PASSAUDIT",c.children=
[],c.url="menu",e=this.createVisualNode(c),c.id=-203,c.text=Lang.Mail.Write.auditnoPass,c.name="MAIL_INBOX_FILTER_NOTPASSAUDIT",c.children=[],c.url="menu",f=this.createVisualNode(c),b.push(d),b.push(e),b.push(f);if(CC.isLabelMail()&&a=="MARK")c.id=-201,c.text=Lang.Mail.label_MyLabel,c.name="MAIL_INBOX_MARK_LABEL",c.url="",c.children=this.getVnode(),d=this.createVisualNode(c),b.push(d);return b},getVnode:function(a){var b={id:0,url:"menu",attrs:"",text:"",isShow:!0,name:"",children:[]},c=this;switch(a){case "all_audit":b.id=
-301;b.text=Lang.Mail.Write.FilterAll;b.name="MAIL_INBOX_FILTER_ALLAUDIT";b.children=[];break;case "receive_audit":b.id=-302;b.text=Lang.Mail.Write.reMailAudit;b.name="MAIL_INBOX_FILTER_RECEIVEAUDIT";b.children=[];break;case "send_audit":b.id=-303;b.text=Lang.Mail.Write.sendMailAudit;b.name="MAIL_INBOX_FILTER_SENDAUDIT";b.children=[];break;default:for(var a=CM.folderMain[gConst.dataName],d=[],e=0,f=a.length;e<f;e++){var g=a[e];if(g.type==5)b.id=g.fid,b.text=g.name,b.name="MAIL_INBOX_MARK_LABEL",b.pm=
g.fid,b.attrs=(e+1==f?"sep=true&":"")+"className="+gConst.labelColor[g.folderColor],b.children=[],d.push(this.createVisualNode(b))}d.push(this.createVisualNode({id:0,url:function(a){var b=[];c.getSelectValue(b,[]);MM.folderMain.opt("addLabel",null,null,b.length>0?{from:CC.getMailFromByID(a,b[0]),mid:b,o:a}:null)},attrs:"",text:Lang.Mail.label_NewLabel,isShow:!0,name:"MAIL_INBOX_MARK_ADD",children:[]}));d.push(this.createVisualNode({id:0,url:function(){CC.goFolderMain(function(){MM.folderMain.folderCallback()})},
attrs:"",text:Lang.Mail.ManageLabel,isShow:!0,name:"MAIL_INBOX_MARK_MANAGER",children:[]}));return d}return this.createVisualNode(b)},getAllFolder:function(a,b,c){for(var d=this,e=null,f=!1,g="",h=!1,j="",g="",n=0,k=b.length;n<k;n++){var e=b[n],f=e.nodes&&e.nodes.length>0,h=n==b.length-1,j=c||"",g=e.parentId==0?"":h?"\u2514 ":"\u251c ",g=j+g+e.name,q=e.fid;q!=d.fid&&q!==2&&(GC.check("MAIL_INBOX_DELETE")||q!=4)&&a.push({name:"MAIL_INBOX_MOVE"+q,text:g,value:e.name,url:function(a){return function(b,
c,e){e.pm=a;e.op=Lang.Mail.tb_Move;d.doMenu(b,"MOVE",e)}}(q)});f&&(j+=h||e.parentId==0?"\u3000":"\u2502 ",d.getAllFolder(a,e.nodes,j))}},gotoRead:function(a,b,c){if(GC.check("MAIL_INBOX_READ")){GE.tab.isSession=!1;var d=this.name,e=this.getTrIndex(a),f=$(gConst.listBodyId+d).getElementsByTagName("tr")[e];try{this.click("all",!1)}catch(g){}if(a=CM[d][gConst.dataName][a]){GE.lastFolder=d;var d=a.fid,e=a.mid,h=a.mailSession,j=a.auditStatus;this.mid=e;var n=a.flags.read?1:0,k=a.flags.top?1:0,q=!1,t=!1;
if(a.secureEncrypt=="1"||a.flags&&a.flags.secureEncrypt=="1")q=!0;if(a.secureSigned=="1"||a.flags&&a.flags.secureSigned=="1")t=!0;var u=a.flags&&a.flags.read=="1"?!0:!1,s=MM.getFolderObject(d).type,r=CC.getMailText(a.subject,Lang.Mail.list_ReadingMail);if(d!=GE.folder.draft){if(n){q||El.removeClass(f,"new");try{if(d!=3&&j!=5&&j!=6&&!q&&!t&&a.flags&&!a.flags.selfdestruct)f.childNodes[2].firstChild.firstChild.className=k?"status9":"status6"}catch(w){}MM.folderMain.folderInfo.unreadMessageCount>0&&(MM.folderMain.folderInfo.unreadMessageCount--,
messageInfo&&parseInt(messageInfo.unreadMessageCount));d=CC.getFolderTypeName(s)+d;MM[d].stats.unreadMessageCount>0&&(q||MM[d].stats.unreadMessageCount--);MM[d].mailCount>0&&MM[d].mailCount--;CC.isLabelMail()&&/^label/.test(this.name)&&MM.folderMain.refreshFolders();this.refreshMenu(d);CC.syncMailData();CC.updateHome();s==3?(c=jQuery("#-1 em").eq(0).html(),jQuery("#-1 em").eq(0).html(c-1)):s==6&&(c=jQuery("#-6 em").eq(0).html(),jQuery("#-6 em").eq(0).html(c-1));a.label[0]&&(c=jQuery("#-2  em").eq(0).html(),
jQuery("#-2 em").eq(0).html(c-1))}b={markRead:n,fid:this.isSearch?0:this.fid,sessionId:h,rcptFlag:a.rcptFlag,isSession:b||!1,isEncrypt:q,unread:u,ignoreCache:!0,returnHeaders:["X-IBC-SecMail"]};if(t)b.isSign=t;if(a.flags&&a.flags.selfdestruct)b.scope=this,b.callback=this.refresh;if(this.isFilter!="")b.fid=0;this.readMailType==1?this.optReadMail("readMail",null,e,r,b,a):CC.goReadMail(e,r,b,a)}else c?(url=CC.getMeetingUrl("&mid="+e+"&funcid="+gConst.func.restore),r=Lang.Mail.list_EditMail+r||Lang.Mail.list_EditMail,
CC.goOutLink(url,"meeting_"+e,r)):(url=CC.getComposeUrl("&mid="+e+"&funcid="+gConst.func.restore),r=Lang.Mail.list_EditMail+r||Lang.Mail.list_EditMail,CC.goCompose(url,"compose_"+e,r));return!1}}else CC.forbidden()},getTrIndex:function(a){var b=this.name;try{for(var c=$(gConst.listBodyId+b).getElementsByTagName("tr"),d=0;d<c.length;d++)if(c[d].id=="tr_"+b+"_"+a)return d;return-1}catch(e){return a-0}},getAttach:function(a){return a.attached?'<i class="status10" title="'+Lang.Mail.list_AttachMail+'"></i>':
""},getPriority:function(a){return a==GE.priority.hight?'<i class="status7" style="width:12px" title="'+Lang.Mail.search_msg_hight+'"></i>':'<i class="" style="width:12px"></i>'},getSendStatus:function(a,b){var c="",d=b.flags||{};switch(a){case 0:c="<i class='status1_3'  title='"+Lang.Mail.Write.Queue+"'></i>";break;case 1:c="<i class='status1_1'  title='"+Lang.Mail.Write.sendSuccess+"'></i>";break;case 2:c="<i class='status1_1' title='"+Lang.Mail.Write.sendSuccess+"'></i>";break;case 3:c="<i class='status1_4'  title='"+
Lang.Mail.Write.Partiallysuccessful+"'></i>";break;case 4:c="<i class='status1_2'  title='"+Lang.Mail.Write.Failure+"'></i>"}if(d.recall&&d.hasOwnProperty("recallok"))switch(d.recallok.toString()){case "1":c="<i class='m18' title='\u53ec\u56de\u6210\u529f'></i>";break;case "2":c="<i class='m17' title='\u90e8\u5206\u53ec\u56de\u6210\u529f'></i>";break;case "3":c="<i class='m16' title='\u53ec\u56de\u5931\u8d25'></i>"}b.flags.signed&&(c="<i class=\"m19\" title='\u654f\u611f\u90ae\u4ef6'></i>");return c},
getStatus:function(a,b){var c=this.stateFlagArr,d=b.auditStatus,a=a||{},e="",e=+b.meetingFlag===1?"<i class='i-meetiv' title='\u4f1a\u8bae\u9080\u8bf7'></i>":a.signed===1?"<i class=\"m19\" title='\u654f\u611f\u90ae\u4ef6'></i>":a.selfdestruct?"<i class='m21' title='\u81ea\u9500\u6bc1\u90ae\u4ef6'></i>":a.top?"<i class='"+(a.read?"status8":"status9")+"' title='"+c[7]+"'></i>":a.fixedtime?"<i class='status1' title='"+c[1]+"'></i>":a.read&&d!=5&&d!=6?"<i class='status5' title='"+c[5]+"'></i>":a.replied&&
a.forwarded?"<i class='status2' title='"+c[2]+"'></i>":a.replied?"<i class='status3' title='"+c[3]+"'></i>":a.forwarded?"<i class='status4' title='"+c[4]+"'></i>":"<i class='status6' title='"+c[0]+"'></i>";if(CC.isSecurityMail()){var c=(typeof b.secureEncrypt!="undefined"?b.secureEncrypt:!1)||b.flags&&b.flags.safemail_crypt||b.flags&&b.flags.secureEncrypt,f=(typeof b.secureSigned!="undefined"?b.secureSigned:!1)||b.flags&&b.flags.safemail_sign||b.flags&&b.flags.secureSigned;typeof b!=="undefined"&&
c=="1"&&f=="1"?e="<i class='i-redmedal' title='\u52a0\u5bc6\u7b7e\u540d\u90ae\u4ef6'></i>":typeof b!=="undefined"&&c=="1"?e="<i class='i-ykey' title='\u52a0\u5bc6\u90ae\u4ef6'></i>":typeof b!=="undefined"&&f=="1"?e="<i class='i-graymedal' title='\u7b7e\u540d\u90ae\u4ef6'></i>":typeof b!=="undefined"&&f==-1?e="<i class='i-mixmedal' title='\u7b7e\u540d\u4e0d\u901a\u8fc7\u90ae\u4ef6'></i>":typeof b!=="undefined"&&c==-1&&(e="<i class='i-notPassed' title='\u52a0\u5bc6\u4e0d\u901a\u8fc7\u90ae\u4ef6'></i>")}if(GE.folderMap&&
GE.folderMap[gConst.folderEnum.audit])if(d==5)e="<em class='i-examined' title='"+Lang.Mail.Write.hasaudited+"'></em>";else if(d==6)e="<em class='i-unexamine' title='"+Lang.Mail.Write.hasNotaudited+"'></em>";else if(d==3||d==4)e=a.read?"<i class='status5' title='"+Lang.Mail.Write.unAudit+"'></i>":"<i class='status6' title='"+Lang.Mail.Write.unAudit+"'></i>";return e},getLabels:function(a,b){var a=a||[],c=[],d=this.name;Util.each(CM.folderMain[gConst.dataName],function(e,f){if(a.has(f.fid)){var g=f.folderColor;
if(g>0||g>34)g=0;g=gConst.labelColor[g];c.push('<div class="tagList" onmouseover="MM[\''+d+"'].labelMouseOver(this);\" onmouseout=\"MM['"+d+"'].labelMouseOut(this);\">");c.push('<div class="tu c1"><div class="ru {3}"><span>{0}</span><a href="javascript:fGoto();" onclick="MM[\'{4}\'].marklabel(\'delete\',[\'{1}\'],{2});">X</a></div></div></div>'.format(f.name,b,f.fid,g,d))}});return c.join("")},refreshMenu:function(a){try{var b=this.fid,c=a||this.type+b,d=$(gConst.listMailId+"mailCount_"+c),e=$("leftMenu_newMailCount_"+
c),f;if(this.isFilter&&this.filterStats)this.stats=this.filterStats;var g=MM[c].stats.unreadMessageCount,h=MM[c].stats.messageCount,j="",n=/^(sys|user)[1-9]\d*$/.test(c)?'  <a href="#" onclick="CC.setAllRead(\''+c+"')\">\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb</a>":"";if(this.isSearch&&GE.searchFlag&&this.checkObjLen(GE.searchFlag)===1&&GE.searchFlag.read===1)j=Lang.Mail.list_searchMailNumber.format(Math.max(h,0));else{this.type==="label"&&(f=b);var j=Lang.Mail.maicountTitle.format(h)+'\uff0c<a href="#" onclick="CC.searchNewMail('+
b+",false, "+f+')">'+Lang.Mail.unreadMailTitle+"</a>"+Lang.Mail.countTitle.format(g)+n,k=gMain.mailFileCount?parseInt(gMain.mailFileCount):1E4;b==1&&h>=k&&(j+="\uff0c",j+=Lang.Mail.mailFileTitle.format("&nbsp;<a onclick=\"MM['sys1'].loadMailFileHtml()\" href='#'>"+Lang.Mail.mailFile+"</a>&nbsp;"))}var q=$(gConst.listMailId+"h1_"+c);if(q&&this.isSearch&&this.isLoadNoReadMail&&GE.searchFlag&&this.checkObjLen(GE.searchFlag)===1&&GE.searchFlag.read===1)q.innerHTML=Lang.Mail.Write.unRead_mail;var t=$(gConst.listMailId+
"span_"+c);if(t&&!this.isFilter)t.innerHTML="";var u=$(gConst.listMailId+"h2_"+c);if(u&&!this.isFilter)u.innerHTML="";if(d)d.innerHTML=this.isFilter?"("+Lang.Mail.list_FilterMailCount.format(Math.max(this.filterStats.messageCount,0))+")":"("+j+")";if(e&&a)e.innerHTML=g>0?'<a style="display:inline;padding-left:5px;font-weight:bold" class="leftFolder-mailNum" title='+Lang.Mail.unreadmailCount_AllCount.format(g,h)+">("+g+")</a>":"";CC.synData({newMailCount:MM.folderMain.folderInfo.unreadMessageCount})}catch(s){}},
trMouseOver:function(a){(function(a,c){try{var c=c||EV.getEvent(),d=c.fromElement||c.relatedTarget;return El.descendantOf(c.toElement||c.target,a)&&!El.descendantOf(d,a)?!0:!1}catch(e){return!0}})(a)&&GE.Drag.moveType!="folder"&&($(a.id.replace("tr","checkbox")).checked||a.className!="checkColor"&&a.className!="new checkColor"&&El.addClass(a,"overColor"))},trMouseOut:function(a){(function(a,c){try{var c=c||EV.getEvent(),d=c.fromElement||c.target;return!El.descendantOf(c.toElement||c.relatedTarget,
a)&&El.descendantOf(d,a)?!0:!1}catch(e){return!0}})(a)&&GE.Drag.moveType!="folder"&&($(a.id.replace("tr","checkbox")).checked||El.removeClass(a,"overColor"))},labelMouseOver:function(a){try{a.childNodes[0].childNodes[0].childNodes[1].style.display="INLINE"}catch(b){}},labelMouseOut:function(a){try{a.childNodes[0].childNodes[0].childNodes[1].style.display="none"}catch(b){}},setTrClass:function(a,b,c){a=$(a.id.replace("checkbox","tr"));El.removeClass(a,"overColor");b?El.addClass(a,"checkColor"):(El.removeClass(a,
"checkColor"),c||El.addClass(a,"overColor"))},getDatePicker:function(){var a=0,b=[],a=this.stats.messageCount;Math.ceil(a/this.limit);b.push("<span style='margin-right:10px;' id='datePicker' class='date'><input type=\"hidden\"/><a style=\"float:left;\" class=\"add-on date_picker\"></a></span>");return b.join("")},getPage:function(){var a=this.name,b=0,b=this.stats.messageCount;if(gMain.sessionMode=="1"&&this.fid==1)b=this.sessionCount;this.pageCount=Math.ceil(b/this.limit);this.pageCurrent=parseInt((this.start-
1)/this.limit,10)||0;var b=[],c=this.pageCount,d=Math.max(this.pageCurrent,0);CC.power.offRestoreDeleted()&&this.fid===4&&b.push('<a href="javascript:;" onclick="CC.goFolder(7,\'sys7\')" class="del_reback" title="\u6062\u590d\u5f7b\u5e95\u5220\u9664\u7684\u90ae\u4ef6"></a>');if(c>1){b.push('<div class="pagediv" id="toppagediv">');b.push('<span class="pageNum pageNum-on"><var>'+(d+1)+"/"+c+'</var><i class="ptg"></i></span>');b[b.length]=d>0?'<a class="page_forword" href="javascript:;" onClick="MM[\''+
a+"'].goPage("+(d-1)+');return false;">'+Lang.Mail.list_PrevPage+"</a>":'<a class="page_forword disable" href="javascript:;">'+Lang.Mail.list_PrevPage+"</a>";b[b.length]=c>d+1?'<a class="page_next" href="javascript:;" onClick="MM[\''+a+"'].goPage("+(d+1)+');return false;">'+Lang.Mail.list_LastPage+"</a>":'<a class="page_next disable" href="javascript:;">'+Lang.Mail.list_LastPage+"</a>";b.push('<ul class="pageitem" style="display: none;">');for(d=0;d<c;d++)b.push('<li><a href="javascript:;" onclick="MM[\''+
a+"'].goPage("+d+');return false;">'+(d+1)+" / "+c+"</a></li>");b.push("</ul>");b.push("</div>")}return b.join("")},getfooterPage:function(){var a=this.name,b=0,b=this.stats.messageCount;if(gMain.sessionMode=="1"&&this.fid==1)b=this.sessionCount;this.pageCount=Math.ceil(b/this.limit);this.pageCurrent=parseInt((this.start-1)/this.limit,10)||0;var b=[],c=this.pageCount,d=Math.max(this.pageCurrent,0);CC.power.offRestoreDeleted()&&this.fid===4&&b.push('<a href="javascript:;" onclick="CC.goFolder(7,\'sys7\')" class="del_reback" title="\u6062\u590d\u5f7b\u5e95\u5220\u9664\u7684\u90ae\u4ef6"></a>');
if(c>1){b.push('<div class="pagediv" style="position:absolute; top:10px; right:15px;">');b.push('<span class="pageNum pageNum-on"><var>'+(d+1)+"/"+c+'</var><i class="ptg"></i></span>');b[b.length]=d>0?'<a class="page_forword" href="javascript:;" onClick="MM[\''+a+"'].goPage("+(d-1)+');return false;">'+Lang.Mail.list_PrevPage+"</a>":'<a class="page_forword disable" href="javascript:;">'+Lang.Mail.list_PrevPage+"</a>";b[b.length]=c>d+1?'<a class="page_next" href="javascript:;" onClick="MM[\''+a+"'].goPage("+
(d+1)+');return false;">'+Lang.Mail.list_LastPage+"</a>":'<a class="page_next disable" href="javascript:;">'+Lang.Mail.list_LastPage+"</a>";b.push('<ul class="pageitem" style="top:auto; bottom:23px;display: none;">');for(d=0;d<c;d++)b.push('<li><a href="javascript:;" onclick="MM[\''+a+"'].goPage("+d+');return false;">'+(d+1)+" / "+c+"</a></li>");b.push("</ul>");b.push("</div>")}return b.join("")},selectMail:function(a,b){this.setTrClass($(b),a.checked)},handleShift:function(){function a(a,b,c){var d=
a.checkBox;if(d&&c.id!=d.id)for(var e=!1,k=0,q=b.length;k<q;k++)if(e)if(b[k].id!=d.id&&b[k].id!=c.id&&d.id!=c.id){if(!b[k].checked)b[k].checked=!0,a.setTrClass(b[k],!0)}else break;else b[k].id!=d.id&&b[k].id!=c.id&&d.id!=c.id||(e=!0);a.checkBox=c.checked?c:null}var b=EV.getEvent(),c=EV.getTarget(),d=null;if(b.shiftKey){try{if(El.getNodeType(c)!="input"){d=El.getParentNodeIsTag(c,"tr");if(!d)return;c=d.getElementsByTagName("input")[0]}}catch(e){}c&&(d=c.id.split("_")[1],b=MM[d],d=document.getElementsByName("checkbox_"+
d),a(b,d,c))}},click:function(a,b){function c(a,c){d.setTrClass(a,c,b?!1:!0)}var d=this,e=d.checkBoxAll;d.checkBox=null;if(a=="all"&&(d.setCheckBox(d.listBodyDiv,b,c,b?null:!0),d.optReadMail("select"),!(a=="all"&&b)))e.checked=!1},setCheckBox:function(a,b,c){for(var a=a.getElementsByTagName("input"),d=0,e=a.length;d<e;d++)if(a[d].type=="checkbox"&&a[d].checked!=b)a[d].checked=b,c&&c(a[d],b)},singleClick:function(a){this.setTrClass(a,a.checked);this.checkBoxAll.checked=!1;this.optReadMail("select");
this.handleShift()},controlPeriod:function(a){var b=a.childNodes[0],c=a.nextSibling;b.className.trim()=="off"?(El.removeClass(b,"off"),c.style.display="",a.title=Lang.Mail.Hide):(El.addClass(b,"off"),c.style.display="none",a.title=Lang.Mail.Show)},loadFolder:function(a,b){LM.freshFolderMain(a,b||!1)},move:function(a,b,c,d,e){var f=this;b-=0;b={newFid:b};CC.isSessionModeReadMail(f.fid)&&d?b.sessionIds=d:b.ids=a;f.setPageStart(a.length);var g={func:f.isFilter?gConst.func.searchMail:f.func,data:f.getListRequest(),
call:function(a){f.freshData(a,!0);CC.showMsg(e,!0,!1,"option")},msg:Lang.Mail.search_NowSearch};MM.mailRequest({func:gConst.func.moveMessages,data:b,call:function(a){a.code==gConst.statusOk&&(f.isFilter?MM.mailRequest(g):MM.mailRequestApi(g))},msg:c})},marklabel:function(a,b,c,d){var e=this,c=c||e.fid,b=b instanceof Array?b:[b],f=[];f.push({func:gConst.func.markLabel,"var":{ids:b,type:a,labelId:c}});f.push({func:e.func,"var":e.getListRequest()});e.seqLoadMailList({data:f,seqCall:function(a){e.refresh();
typeof d=="function"&&d.call(e,a)},msg:Lang.Mail.Write.nowdo+(a=="delete"?Lang.Mail.Write.Delete:Lang.Mail.Write.addMail)+Lang.Mail.Write.labelMail})},auditPass:function(a,b,c,d,e,f){var g=this,c=c||Lang.Mail.Write.mailHasPass,h={result:parseInt(b),ids:a},j=function(){var a={func:"mbox:auditFeedback",data:h,url:"/RmWeb/mail",call:function(a){if(a.code==gConst.statusOk){if(a=document.getElementById("ifrmReadmail_Content_readMail"+f))var h=a.contentWindow.document.getElementById("readMail_status");
if(h)h.innerHTML=Lang.Mail.Write.hasPassed+"\uff1a";e?MM.mailRequest(d):parseInt(b)==1?CC.showMsg(c,!0,!1,"option"):CC.showMsg(c,!0,!1,"caution")}},failCall:function(){CC.alert(Lang.Mail.Write.opFail)}},d={func:g.isFilter?gConst.func.searchMail:g.func,data:g.getListRequest(),call:function(a){g.freshData(a,!0);parseInt(b)==1?CC.showMsg(c,!0,!1,"option"):CC.showMsg(c,!0,!1,"caution")}};MM.mailRequest(a)};d?j():CC.confirm(Lang.Mail.Write.makeSureAuditPass,function(){j()})},del:function(a,b,c,d){var e=
this,b=b||Lang.Mail.list_NowDelMail,f=Lang.Mail.list_ConfirmDeleteMail;d.length&&(f="\u5c06\u5f7b\u5e95\u5220\u9664\u6240\u9009\u4f1a\u8bdd\u90ae\u4ef6\u4e0b\u5305\u542b\u7684\u6240\u6709\u90ae\u4ef6\uff0c\u5220\u9664\u540e\u4e0d\u80fd\u6062\u590d\uff0c\u5982\u9700\u5355\u72ec\u5220\u9664\u672c\u4e3b\u9898\u67d0\u5c01\u90ae\u4ef6\u8bf7\u53bb\u8bbe\u7f6e-\u5e38\u89c4-\u90ae\u4ef6\u89c6\u56fe\u4e2d\u4fee\u6539");e.setPageStart(a.length);var g=function(){var c={func:e.isFilter?gConst.func.searchMail:
e.func,data:e.getListRequest(),call:function(a){e.freshData(a,!0);CC.showMsg(Lang.Mail.delMailSuccess,!0,!1,"option")},msg:Lang.Mail.search_NowSearch},f={ids:a};if(e.fid==1&&gMain.sessionMode=="1"&&d&&d.length>0)f.sessionIds=d;f={func:gConst.func.delMail,data:f,call:function(a){a.code==gConst.statusOk&&(e.isFilter?MM.mailRequest(c):MM.mailRequestApi(c))},msg:b};if(CC.isExtMail())f.data.opUser=gMain.mailId+"@"+gMain.domain;MM.mailRequestApi(f)};c?g():CC.confirm(f,function(){g()})},saveDeleteLog:function(a){for(var b=
[],c={},d={},c=CM[this.name]["var"],e=0,f=c.length;e<f;e++)d[c[e].mid]=c[e];e=0;for(f=a.length;e<f;e++)c={},c.mid=a[e],c.sender=d[c.mid].from,c.subject=d[c.mid].subject,b.push(c);MM.doService({func:"log:deleteMail",data:{mailList:b},call:function(){},failCall:function(){},url:"/log/log.do"})},mark:function(a,b,c,d){var e=this,f={};c-=0;f=e.isAll?{func:gConst.func.updateMailAll,data:{type:b,fid:e.fid,value:c}}:{func:gConst.func.updateMail,data:{ids:a,type:b,value:c}};e.isFilter&&b=="read"&&d&&d!=e.isFilter&&
e.setPageStart(a.length);var g=b=="read"?!0:!1,h={func:e.isFilter?gConst.func.searchMail:e.func,data:e.getListRequest(),call:function(a){e.freshData(a,g)}};f.msg=Lang.Mail.list_MarkMail;f.call=function(a){a.code==gConst.statusOk&&(MM.showMsg(e.isAll?"\u6240\u6709\u90ae\u4ef6\u6807\u8bb0\u6210\u529f":"\u6807\u8bb0\u6210\u529f",!0,!1,"option"),!e.isFilter&&e.fid!=7&&!e.isSearch?MM.mailRequest(h):MM.mailRequestApi(h))};CC.isSecurityMail()?MM.mailRequestApi(f):MM.mailRequest(f)},rankList:function(a){this.clearCache();
this.order==a?this.desc=1-this.desc:(this.order=a,this.desc=this.order==GE.list.order?1:0);this.start=1;!this.isSearch&&!this.isFilter?this.loadMailList({msg:Lang.Mail.list_LoadMailList,isFresh:!1,data:this.getListRequest()}):(a=GE.searchData,a.desc=this.desc,a.order=this.order,a.start=this.start,CC.searchMail(a,this.isLoadNoReadMail));a=this.desc?"desc":"asc";El.setClass($(gConst.listMailSortIcon+this.bOrder),"");El.setClass($(gConst.listMailSortIcon+this.order),a);this.bOrder=this.order},goPage:function(a){var b=
this.pageCount;if(this.pageCurrent!=a)a=Math.min(a,b-1),a=Math.max(a,0),this.clearCache(),this.start=this.limit*a+1,this.pageCurrent=a,CC.scrollTop(),a={msg:Lang.Mail.list_LoadMailList,data:this.getListRequest(),func:this.isFilter?gConst.func.searchMail:this.func},jQuery("#listBody_"+this.name).scrollTop(0),this.loadMailList(a);else return!1},getSelectValue:function(a,b){var c=this.name,d=CM[c]["var"]||[],e=d.length,f=[],g=eval("/"+parent.gMain.domain+">?$/i");this.checkedStatus="";this.checked_secureSigned=
this.checked_secureEncrpt=!1;try{for(var h=this.listBodyDiv.getElementsByTagName("input"),j=0,n=h.length;j<n;j++){var k=h[j];if(k.type=="checkbox"&&k.name==gConst.checkBoxName&&k.checked){if(GE.folderMap&&GE.folderMap[gConst.folderEnum.audit]&&this.fid==gConst.folderEnum.audit&&(this.menuId=="PASSAUDIT"||this.menuId=="NOTPASSAUDIT"||this.menuId=="DELETE"||this.menuId=="REALDELETE"||this.menuId=="MOVE"||typeof this.menuId=="undefined"))for(var q=0;q<e;q++)if(k.defaultValue==d[q].mid)if(d[q].auditStatus==
3||d[q].auditStatus==4)f.push(k.id.replace("checkbox_"+c+"_","")-0),this.checkedStatus="bUnAudited";else if(d[q].auditStatus==5||d[q].auditStatus==6){if(this.checkedStatus!="bUnAudited")this.checkedStatus="bAudited"}else if(typeof d[q].auditStatus!="undefined"&&!this.checkedStatus)this.checkedStatus="bCommon";if(CC.isSecurityMail()&&(this.menuId=="FORWARD"||this.menuId=="READ"))for(q=0;q<e;q++)if(k.defaultValue==d[q].mid){var t=d[q];if(t.flags&&t.flags.read=="1"){if(t.secureEncrypt=="1"||t.flags.secureEncrypt==
"1")this.checked_secureEncrpt=!0;if(t.secureSigned=="1"||t.flags.secureSigned=="1")this.checked_secureSigned=!0}}if(this.menuId=="INFORM"){var u=jQuery(k.parentNode.parentNode.children[2].children[1]).attr("title")||"";if(typeof u=="undefined")break;if(u.search(g)!=-1){this.hasDomain=!0;break}}a.push(k.value);b.push(parseInt(k.getAttribute("sessionId")));f.push(k.id.replace("checkbox_"+c+"_","")-0)}}return f}catch(s){return f}},getDenyForwardObject:function(){var a=CM[this.type+this.fid][gConst.dataName],
b={};try{if(a&&a.length)for(var c=0;c<a.length;c++)a[c].denyForward&&a[c].denyForward==1&&(b[a[c].mid]=1)}catch(d){}return b},getConditionListObject:function(a){var b=CM[this.type+this.fid][gConst.dataName],c={};try{if(b&&b.length)for(var d=0;d<b.length;d++)typeof a=="function"&&a(b[d])&&(c[b[d].mid]=1)}catch(e){}return c},doMenu:function(a,b,c){function d(b,c,d){var e=[],f=CM[a]["var"],h={},g=CC.getComposeUrl("&mid="+c+"&funcid="+b);if(k.length>1&&b=="forwardMore"){for(b=0;b<u.length;b++)h=f[u[b]],
e.push(h.mid);MM.folder.data=e;CC.goCompose(g,"compose_"+c,d);return!1}else if(k.length>1)return CC.showMsg(Lang.Mail.list_OnlySelectOne,!0,!1,"alert"),!1;CC.goCompose(g,"compose_"+c,d)}function e(){var b=[];CM[a]["var"].each(function(a,c){for(var d=0,e=k.length;d<e;d++)if(k[d]==c.mid){b[b.length]=Email.getValue(c.from.decodeHTML());break}});return b.unique().join(",")}var f=MM[a],g=c.text,h=f.fid,j="",n="",k=[],j=c.pm||0,q=Lang.Mail.list_Operate;f.menuId=b;q=q.toLowerCase();f.hasDomain=!1;var t=
[],u=f.getSelectValue(k,t),s=f.checkedStatus,r=f.checked_secureEncrpt,w=f.checked_secureSigned;try{var x=c.name,x=x.substr(0,x.lastIndexOf("_")),x=x.substr(x.lastIndexOf("_")+1);switch(x){case "MARK":b="MARK"+b;break;case "FILTER":b="FILTER"+b}}catch(z){}if(!Folder.notNeedIds.hasOwnProperty(b)){if(b=="PASSAUDIT"||b=="NOTPASSAUDIT")if(s=="bAudited")return CC.showMsg(Lang.Mail.Write.auditedStatus,!0,!1,"caution"),!1;else{if(s=="bCommon")return CC.showMsg(Lang.Mail.Write.thisIsNotAuditMail,!0,!1,"caution"),
!1}else if(b=="DELETE"&&s=="bUnAudited")return CC.showMsg(Lang.Mail.Write.connotDeleteUnaudit,!0,!1,"caution"),!1;else if(b=="REALDELETE"&&s=="bUnAudited")return CC.showMsg(Lang.Mail.Write.connotRealDeleteUnaudit,!0,!1,"caution"),!1;else if(b=="MOVE"&&s=="bUnAudited")return CC.showMsg(Lang.Mail.Write.connotMoveUnaudit,!0,!1,"caution"),!1;else if(b=="INFORM"&&f.hasDomain){parent.CC.showMsg(Lang.Mail.Write.connotJoinBlackUnaudit,!0,!1,"caution");return}else if(b=="FORWARD"&&(r||w)){parent.CC.showMsg("\u60a8\u9009\u62e9\u4e86\u52a0\u5bc6\u6216\u7b7e\u540d\u90ae\u4ef6\uff0c\u8bf7\u89e3\u5bc6\u6216\u9a8c\u7b7e\u540e\u518d\u8f6c\u53d1",
!0,!1,"caution");return}else if(b=="MARKREAD"&&r){parent.CC.showMsg("\u60a8\u9009\u62e9\u4e86\u52a0\u5bc6\u90ae\u4ef6\uff0c\u8bf7\u89e3\u5bc6\u540e\u518d\u6807\u8bb0\u4e3a\u5df2\u8bfb",!0,!1,"caution");return}if(k.length<1)return CC.alert(Lang.Mail.list_SelectDoMail.format(q)),!1;else n=encodeURIComponent(k[0])}switch(b){case "PASSAUDIT":f.auditPass(k,1,Lang.Mail.Write.mailHasPass,!0,!0);break;case "NOTPASSAUDIT":f.auditPass(k,0,Lang.Mail.Write.mailHasNotPass,!0,!0);break;case "FILTER":if(k.length>
1)CC.showMsg(Lang.Mail.list_OnlySelectOne,!0,!1,"option");else{var y=e();CC.setConfig("filter",{name:y,from:y})}break;case "FILTERALL":f.isFilter="";CC.filterMail(h,[],v,2,a);break;case "FILTERREAD":var v={read:0};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERNOREAD":v={read:1};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERURGENT":y=[];v={};y.push({field:"priority",value:1});f.isFilter=g;CC.filterMail(h,y,v,2,a);break;case "FILTERCOMMENTS":v={replied:1};f.isFilter=g;CC.filterMail(h,
[],v,2,a);break;case "FILTERFORWARD":v={forwarded:1};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERSTARRED":v={starFlag:1};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERUNSTARRED":v={starFlag:0};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERATTACHMENT":v={attached:1};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERNOATTACHMENT":v={attached:0};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERMONITORRECEIVE":v={auditStatus:2};f.isFilter=g;CC.filterMail(h,
[],v,2,a);break;case "FILTERMONITORSEND":v={auditStatus:1};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERPASSAUDIT":v={auditStatus:5};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERNOTPASSAUDIT":v={auditStatus:6};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERALLAUDIT":v={auditStatus:16};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERRECEIVEAUDIT":v={auditStatus:4};f.isFilter=g;CC.filterMail(h,[],v,2,a);break;case "FILTERSENDAUDIT":v={auditStatus:3};f.isFilter=
g;CC.filterMail(h,[],v,2,a);break;case "REFUSE":case "BLACKLIST":k.length>1?CC.showMsg(Lang.Mail.list_OnlySelectOne,!0,!1,"option"):CC.setConfig("black",e());break;case "EDIT":d(gConst.func.restore,n,Lang.Mail.list_EditMail);break;case "FORWARD":v=f.getConditionListObject(function(a){return a.securityLevel&&a.securityLevel>0?!0:!1});b=!1;j=Lang.Mail.list_FwdMail;if(k.length>1){g=0;for(h=k.length;g<h;g++)if(!b)for(y in v)v&&v.hasOwnProperty(k[g])&&(b=!0);b?parent.CC.alert(Lang.Mail.multiplyMailNotAllowForward):
d("forwardMore",n,j)}else d(gConst.func.forward,n,j);break;case "DELETE":case "DEL":f.fid==GE.folder.del?f.del(k):f.move(k,GE.folder.del,Lang.Mail.list_NowDelMail,t||[],Lang.Mail.movemail_success.format('"'+Lang.Mail.folder_4+'"'));break;case "NOTJUNK":f.move(k,1,Lang.Mail.list_NowMoveMail,t||[],Lang.Mail.movemail_success.format('"'+Lang.Mail.folder_1+'"'));break;case "REALDELETE":case "DELETEREALDEL":case "REALDEL":CC.isSessionMode()||(t=[]);f.del(k,null,null,t||[]);break;case "EMPTY":MM.folderMain.opt("empty",
h);break;case "MARKREAD":f.mark(k,"read",0,g);break;case "MARKUNREAD":f.mark(k,"read",1,g);break;case "MARKURGENT":f.mark(k,"priority",GE.priority.hight);break;case "MARKCOMMON":f.mark(k,"priority",GE.priority.common);break;case "MARKTOP":k.length+GE.topNum<=gConst.topNum?f.mark(k,"top",1):CC.showMsg(Lang.Mail.folder_topNum_over.format(gConst.topNum),!0,!1,"option");break;case "MARKNOTOP":GE.topNum=0;f.mark(k,"top",0);break;case "MARKLABEL":f.marklabel("add",k,j);break;case "MOVE":if(j==0||j==h)return CC.showMsg(Lang.Mail.list_MailExistFolder,
!0,!1,"alert"),!1;f.move(k,j,Lang.Mail.list_NowMoveMail,t||[],Lang.Mail.movemail_success.format('"'+c.value+'"'));break;case "MAILEXPORT":j=f.getDenyForwardObject();n=!0;h=!1;v=f.getConditionListObject(function(a){return a.securityLevel&&a.securityLevel>0?!0:!1});b=!1;for(g=0;g<k.length;g++)if(j.hasOwnProperty(k[g])?h=!0:n=!1,!b)for(y in v)v&&v.hasOwnProperty(k[g])&&(b=!0);n?parent.CC.alert(Lang.Mail.Write.forbitForwardInMailExportTip):h?parent.CC.alert(Lang.Mail.Write.hai_mailAutoFilter,function(){f.downloadEmail(k,
t)}):b?parent.CC.alert(Lang.Mail.export_sm_tips):f.downloadEmail(k,t);break;case "MAILIMPORT":CC.importMail();break;case "INFORM":n=CM[a]["var"];y={};g=0;for(h=n.length;g<h;g++)if(j=n[g],j.mid)v=j.from.decodeHTML(),c=v.indexOf("<"),x=v.indexOf(">"),c>0&&x>0?(b=v.substr(0,c),v=v.substr(c+1,x-c-1)):b="",j=j.mid,y[j]={mid:j,email:v,userName:b};j={mails:[],sessionMails:[],moduleId:a};for(g=0;g<k.length;g++)y[k[g]]&&j.mails.push(y[k[g]]);CC.inform(j)}},hasTopMail:function(a){if(a)for(var b=0,c=a.length;b<
c;b++)if(this.topMids.has(a[b]))return!0;return!1},refresh:function(){this.isRefreshFolders=!0;this.isSearch?(CC.searchMail(GE.searchData),this.loadFolder(function(){},!0)):this.loadMailList({data:this.getListRequest(),msg:Lang.Mail.LoadMailList,isFresh:!0})},clearCache:function(){this.start=1;this.limit=gMain.pageSize;p1readMailType=gMain.readMailMode},initDragEvent:function(){var a=this.listBodyDiv;a&&EV.observe(a,"mousedown",MM.folder.mouseDown,!1)},mouseDown:function(){try{var a=EV.getEvent(),
b=EV.getTarget(a,!0),c=El.getNodeType(b),d=!1,e="",f="";if(b.getAttribute("data-action")==="showTaskMenu")return!1;c=="input"&&(d=!0);b.previousSibling&&b.previousSibling.children[0]&&(e=b.previousSibling.children[0]);if(e&&e.className)f=e.className;var g=El.getParentNodeIsTag(b,"tr"),b="";if(!g||f=="status3"||f=="status4")return;var h=g.getElementsByTagName("input")[0],j=g.id.split("_"),n=j[1],k=j[2],q=MM[n];h.checked=!h.checked;if(d)h.checked=!h.checked;q.setTrClass(g,h.checked);d=[];q.getSelectValue(d,
[]);var t=d.length+(!h.checked?1:0),b=t>1?Lang.Mail.list_SelectNumberMail.format(t):$("listsubject_"+n+"_"+k).innerHTML;g.mouseDownY=EV.pointerY(a);g.mouseDownX=EV.pointerX(a);var u=new Drag("folder",g);u.getDragItem(b);MM.folder.drag=u;u.doDragOver=MM.folder.handleDrag;u.doDragUp=MM.folder.moveByDrag;u.init()}catch(s){}return!1},handleDrag:function(){function a(b,c){var d;if(b.tagName&&(d=El.getNodeType(b)))return d==c?b:b.parentNode?a(b.parentNode,c):null}function b(a){for(var b=a=a.parentNode,
c=0;a&&a!=a.parentNode&&c<gConst.dragLimit;){if(a.id=="ulMailFunc"||a.id=="leftFolderContainer_-1")return b.id;b=a;a=a.parentNode;c++}return!1}if(GE.Drag.moveType=="folder"){var c=EV.getEvent(),c=EV.getTarget(c,!0),d=El.getNodeType(c),e=MM.folder.drag,f;Folder.checkedStatus&&alert(Folder.checkedStatus);var g=c.id;if(d!="li"&&(f=a(c,"li"))&&f.id)g=f.id;(d=="li"||d=="a"||d=="span")&&g!="-1"&&g!="-2"&&g!=GE.currentFolder&&b(c)?(e.folderMoveTo=g,e.isOn=!0):(e.folderMoveTo=null,e.isOn=!1)}},moveByDrag:function(a,
b){if(a&&b.id){var c=b.id.split("_")[1],d=MM[c];if(a==name)CC.alert(Lang.Mail.list_SelectSameFolder);else{var e=MM.getFolderObject(a);e&&(e.type==GE.folderType.label?d.doMenu("addLabel",Lang.Mail.Write.isusingLabel+"...",a):d.doMenu(c,"MOVE",{text:Lang.Mail.tb_Move,value:e.name,pm:a}))}}},resize:function(){this.setDivHeight()},exit:function(){this.start=1;return!0},getListRequest:function(a){var b={},b=this.limit;if(this.isSearch||this.isFilter)a?(this.start=1,b=GE.searchData):(b=GE.searchData,b.start=
this.start);else if(a?(this.start=1,b={fid:this.fid,order:GE.list.order,desc:0,total:b,param:"&norefreshSid="+(window.nsid!==void 0?window.nsid:0),sessionEnable:gMain.sessionMode}):b={fid:this.fid,order:this.order,desc:this.desc,start:this.start,total:b,param:"&norefreshSid="+(window.nsid!==void 0?window.nsid:0),sessionEnable:gMain.sessionMode},b.sessionEnable=this.fid==1?gMain.sessionMode:"0",this.fid===7)b.order="modifyDate";return b},getDatePick:function(a){var b=a||this.name,c=MM[b],d=null,e=
null;if((GE.folderMap&&GE.folderMap[gConst.folderEnum.audit]||GE.folderMap&&GE.folderMap[gConst.folderEnum.monitor])&&(b=="sys"+gConst.folderEnum.audit||b=="sys"+gConst.folderEnum.monitor))c.picker=new CCalendar("#datePicker",{onSelectBack:function(a){var g=parseInt(a.yyyy,10),h=parseInt(a.mm,10),a=parseInt(a.dd,10);c.isFilter=Lang.Mail.Write.dateFilter;d=(new Date(g,h-1,a)).getTime()/1E3;e=d+86400;c.selectDate=g+Lang.Mail.Write.lb_timesend_year+h+Lang.Mail.Write.lb_timesend_month+a+Lang.Mail.Write.lb_timesend_day;
c.isFilter=Lang.Mail.Write.dateFilter;c.text=c.fid==gConst.folderEnum.monitor?Lang.Mail.Write.monitorMail:Lang.Mail.Write.audit_mail;g=[];d&&(g.push({field:"sentDate",operator:"GE",value:d}),g.push({field:"sentDate",operator:"LT",value:e}));CC.filterMail(c.fid,g,"",2,b);return!0}})},loadMailList:function(a){var b=this,c=a.call;if(a){var d=arguments,e={func:a.func||b.func,data:a.data,call:function(d){b.freshData(d,a.isFresh);typeof c=="function"&&c()},failCall:function(){CC.error(b.name,b.text,function(){b.loadMailList.apply(b,
d)})},msg:a.msg,param:"&norefreshSid="+(window.nsid!==void 0?window.nsid:0),sessionEnable:gMain.sessionMode};if(this.fid!=1)e.sessionEnable=0;b.isSearch||b.isFilter?MM.mailRequestApi(e):MM.mailRequest(e)}},seqLoadMailList:function(a){a&&MM.seqRequestCB(a.data||[],a.seqCall||Util.emptyFunction,a.failCall||function(a){var c="Error Code:";c+=typeof a=="object"?a.code:a;CC.alert(Lang.Mail.fail+c)},a.msg,a.params||{})},freshData:function(a,b){var c=this,d=c.name,e=a||{};if(e.code==gConst.statusOk){CM[d]=
e;if(c.isSearch)c.stats=e.stats;if(c.isFilter)c.filterStats=e.stats;b&&c.loadFolder(function(){c.refreshMenu();CC.updateHome();if(c.listBodyDiv)c.listBodyDiv.innerHTML=c.getListData();c.changeStatus_read()},!0);if(c.listBodyDiv)c.listBodyDiv.innerHTML=c.getListData(),c.changeStatus_read();c.isSearch&&GE.searchKey&&c.bindCloseInBarEvent(jQuery)}},setReadMailStyle:function(a,b){function c(a){var c=$(gConst.listReadMailId+e);a==0?El.hide(c):(El.show(c),El.show($(gConst.listReadMailId+"Default_"+e)),
El.hide($(gConst.listReadMailId+"Content_"+e)));if(!b&&d.readMailType!=a)d.readMailType=a,MM.mailRequest({func:gConst.func.setAttrs,data:{readmailmode:a},call:function(){gMain.readMailMode=a}}),d.setDivHeight()}var d=this,e=d.name;switch(a){case 0:case "0":c(0);break;case 1:case "1":c(1);break;default:c(0)}},optReadMail:function(a,b,c,d,e,f){function g(a,b,c,d){El.hide($(gConst.listReadMailId+"Default_"+k));El.show($(gConst.listReadMailId+"Content_"+k));var e=$("pageReadMail"+k);MM.mailRequestApi({func:gConst.func.readMail,
data:{mode:"both",filterStylesheets:0,filterImages:0,filterLinks:0,supportTNEF:0,fileterScripts:1,filterFrames:1,markRead:c.markRead,encoding:c.encode||gConst.encode_utf8,mid:a,fid:c.fid},call:function(f){try{CM[gConst.readMail+a]=f;var h=f["var"],g=$(gConst.listReadMailId+"Title_"+k),j=n.getReadMailData(a,h);e.innerHTML=j;g.innerHTML=b.left(gConst.mailSubjectLength,!0);$(gConst.listReadMailId+"newLabel_"+k).onclick=function(){var b=h.subject,b=b||Lang.Mail.list_ReadingMail,b=b.encodeHTML();CC.goReadMail(a,
b,c,d);return!1};CC.sendMDN(h.requestReadReceipt,h.readReceipt)}catch(v){}n.setDivHeight()}})}function h(){var a=[];n.getSelectValue(a,[]);var a=a.length,b=$(gConst.listReadMailId+"Content_"+k),c=$(gConst.listReadMailId+"Default_"+k);El.show(c);El.hide(b);c.innerHTML=a==0?"<h2>"+Lang.Mail.list_NoSelectMail+"</h2><p>"+Lang.Mail.list_ClickReadMail+"</p>":"<h2>"+Lang.Mail.list_SelectNumberMail.format(a)+"</h2><p>"+Lang.Mail.list_ClickReadMail+"</p>"}function j(){var a=n.mid,b="readHeader_table_"+n.mid,
c=$(gConst.listReadMailId+"Icon_"+k),a=$("icon_"+a),b=$(b);El.visible(b)?(b.style.display="none",c.className="off",a.className="action off"):(b.style.display="",c.className="on",a.className="action on");n.setDivHeight()}var n=this,k=n.name;switch(a){case "readMail":g(c,d,e,f);break;case "setTitle":j(b);break;case "select":h()}},getReadMailData:function(a,b){var c=this.name,d=[],e=CC.getMailText(b.subject,Lang.Mail.list_noSubject);this.mid=a;var f=(b.account||"").encodeHTML(),g=Util.formatDate(new Date(b.sendDate*
1E3)),h=CC.getMailText(b.to),j=CC.getMailText(b.cc),n=b.attachments||[],k=0,q="";Email.getValue(f.decodeHTML());this.maildata=CC.getMailContent(b);d.push('<div id="container">');d.push('<div class="rmHeader" id="readHeader_{0}" {1}>'.format(c,Browser.isIE?"style='z-index:-1;'":""));d.push('<a class="action" id=\'openwindow_'+a+'\' href="javascript:fGoto();" onclick="MM[\''+c+"'].openNewFrom();\">"+Lang.Mail.readMail_lb_newwindow+"</a>");d.push('<i id="icon_'+a+'"class="action off" onclick="MM[\''+
c+"'].optReadMail('setTitle',this);\"></i>");d.push('<table cellpadding="0" style="height:26px;line-height:26px;">');d.push("<tr>");d.push("<th>"+Lang.Mail.readMail_lb_subject+"</th>");d.push('<td id="tdsubject" align="left"><h1>'+e+"</h1></td>");d.push('<td class="placeHolder"></td>');d.push("</tr>");d.push("</table>");d.push("<table id='readHeader_table_"+a+"' style='display:none;'>");d.push("<tr>");d.push("<th>"+Lang.Mail.list_Send+"\uff1a</th>");d.push("<td id='FromUserTr' align=\"left\">"+f+
"</td>");d.push("</td>");d.push('<td class="placeHolder"></td>');d.push("</tr>");d.push("<tr>");d.push("<th>"+Lang.Mail.readMail_lb_time+"</th>");d.push('<td align="left">'+g+"</td>");d.push('<td class="placeHolder"></td>');d.push("</tr>");d.push("<tr>");d.push("<th>"+Lang.Mail.readMail_lb_to+"</th>");d.push('<td id=\'{0}to\' align="left" style="word-wrap:break-word;">'.format(c)+h+"</td>");d.push('<td class="placeHolder"></td>');d.push("</tr>");j!=""&&(d.push("<tr>"),d.push("<th>"+Lang.Mail.readMail_lb_cc+
"</th>"),d.push("<td id='{0}cc' align=\"left\">".format(c)+j+"</td>"),d.push('<td class="placeHolder"></td>'),d.push("</tr>"));d.push("</table>");if(n&&n.length>0){d.push("<table>");d.push('<tr class="attach">');d.push("<th>"+Lang.Mail.readMail_lb_attach+"</th>");d.push('<td align="left">');for(e=0;e<n.length;e++)f=n[e],k=f.fileRealSize,k=Util.formatSize(k,null,2),q=f.fileName||"",q=q.encodeHTML(),d.push(('<a href="'+CC.getDownloadLink(a,f.fileOffSet,f.fileSize,f.fileName,f.type,f.encoding)+'" {0}><i></i>{1}(<span title="{2}">{2}</span>)</a>').format("",
q,k));n.length>1&&d.push('<a href="'+CC.getDownloadsLink(a)+'"  style="cursor:pointer;" target="_blank">['+Lang.Mail.readMail_lb_bt_PackMail+"]</a>".format(c));d.push("</td>");d.push('<td class="placeHolder"></td>');d.push("</tr>");d.push("</table>")}d.push("</table>");d.push("</div>");this.readMailHTML='<div id="pageReadMail">'+d.join("")+"</div>";d.push('<div id="mailContent">');d.push('<iframe id="{0}" name="{0}" frameborder="0" src="{1}?mid={2}&type=1&rnd={3}" style="width:100%;height:100%;" scrolling="auto"></iframe>'.format(gConst.ifrmReadmail+
c,gConst.readMailUrl,a,GC.gRnd()));d.push("</div>");d.push("</div>");return d.join("")},downloads:function(){var a=CM[gConst.readMail+this.mid]["var"],b=a.attachments,a=a.subject||Lang.Mail.list_noSubject;b&&CC.downloads(b,a,this.mid)},optReadMailMenu:function(a){function b(b){var c={id:"readMail_"+a,name:"readMail"+a},b=d.getReadMailToolbarMenu(b);CC.getMenu(c,b,null,f)}function c(a,b,c){a=CC.getComposeUrl("&funcid="+a+"&mid="+b);CC.goCompose(a,"compose_"+b,c)}var d=this,e=d.name,f=EV.getEvent();
EV.getTarget(f);var g=GE.cToolbar,h=d.mid;g&&El.hide(g);switch(a){case "rm_rpl":c(gConst.func.reply,h,Lang.Mail.tb_ReplyMail);break;case "rm_rpla":c(gConst.func.replyAll,h,Lang.Mail.tb_ReplyAll);break;case "rm_fwd":d.doMenu(e,"FORWARD",{text:Lang.Mail.tb_Forward});break;case "rm_blacklist":d.doMenu(e,"BLACKLIST",{text:Lang.Mail.tb_RefuseSend});break;case "rm_filter":d.doMenu(e,"FILTER",{text:Lang.Mail.tb_filter});break;case "replymenu":b("reply");break;case "refusemenu":b("refuse")}},openNewFrom:function(){var a=
gConst.mailPrintUrl+"&mid="+(gConst.readMail+this.mid)+"&t=open&"+Math.random();window.open(a)},showRemark:function(a,b){var c=this.name;El.getX(b);El.getY(b);var d=[];d.push('<div  id="fremark"   class="tips write-tips" style="width:300px;" >');d.push('<div class="tips-text"><div id="recepitent_tips_content">');d.push(' <div class="mail_mark_wrap"><i></i><h4>'+Lang.Mail.readMail_addnote+"</h4>");d.push('<p id="remarkContent" style="font-weight: normal;"></p>');d.push('</div></div></div><div class="tipsTop diamond"></div></div>');
document.getElementById("fremark")||(jQuery(b).parents(".subject").append(d.join("")),jQuery("#fremark").bind("mouseleave",function(){MM[c].hideRemark(document.getElementById("fremark",null))}),jQuery("#tagText_"+a).bind("mouseleave",function(){MM[c].hideRemark(document.getElementById("fremark",null))}),MM.mailRequestApi({func:"mbox:mailMemo",data:{opType:"get",mid:a,memo:""},call:function(a){if(a.code=="S_OK"){var b=document.getElementById("remarkContent"),a=a["var"].memo;if(b)b.innerHTML=a.encodeHTML()}}}))},
hideRemark:function(){var a=EV.getEvent(),a=EV.getTarget(a,!0);if(a=El.getParentNodeIsTag(a,"tr")){if(a.className=="overColor")a.className="";if(a=document.getElementById("fremark"))jQuery(a).parents(".subject").css("overflow","hidden"),a.parentNode.removeChild(a)}},delRemark:function(a){var b={func:"mbox:mailMemo",data:{opType:"delete",mid:a,memo:""},call:function(){b.code=="S_OK"&&this.hideRemark()}};MM.mailRequestApi(b)},fStarFlag:function(a,b){var c=this.name,d=this;MM.mailRequest({func:"mbox:updateMessagesStatus",
data:{type:"starFlag",value:b,ids:[a]},call:function(e){if(e.code=="S_OK")e=document.getElementById("aStarFlag_"+a),b==1?(El.setClass(e,"qm_ico_flagon"),El.setAttr(e,{title:Lang.Mail.haveStar}),e.onclick=function(){MM[c].fStarFlag(a,0)}):(El.setClass(e,"qm_ico_flagoff"),El.setAttr(e,{title:Lang.Mail.noStar}),e.onclick=function(){MM[c].fStarFlag(a,1)}),d.refresh()}})},showTipsSuccess:function(a){var b=setInterval(function(){if(jQuery("#tipsfinish").html()==""||!$("loading_ajax"))CC.showMsg(a,!0,!1,
"option"),clearInterval(b)},50)},downloadEmail:function(a,b){for(var c="",d=0;d<a.length;d++)c+="<string>"+a[d]+"</string>";c={formName:"downloadEamil",url:gMain.rmSvr+"/RmWeb/mail?func=mbox:downloadMessages&sid="+gMain.sid,inputName:"downloadDate",data:'<object><array name="ids">'+c+"</array></object>",iframeName:"downloadEmailIframe"};if(b&&this.fid==1&&gMain.sessionMode&&gMain.sessionMode==1){for(var d="",e=0;e<b.length;e++)d+="<int>"+b[e]+"</int>";c.data='<object><array name="sessionIds">'+d+
"</array></object>"}Util.ajaxForm(c)},loadMailFileHtml:function(){this.dropFileType_Time=new DropSelect({id:"dropFileType_Time",data:[{text:Lang.Mail.mailFileTime_month.format("1"),value:"1"},{text:Lang.Mail.mailFileTime_month.format("2"),value:"2"},{text:Lang.Mail.mailFileTime_month.format("3"),value:"3"},{text:Lang.Mail.mailFileTime_month.format("6"),value:"6"},{text:Lang.Mail.mailFileTime_year.format("1"),value:"12"},{text:Lang.Mail.mailFileTime_year.format("2"),value:"24"}],width:130,height:200});
this.dropFileType_count=new DropSelect({id:"dropFileType_count",data:[{text:Lang.Mail.mailFileOldCount.format("10000"),value:"10000"},{text:Lang.Mail.mailFileOldCount.format("5000"),value:"5000"},{text:Lang.Mail.mailFileOldCount.format("1000"),value:"1000"},{text:Lang.Mail.mailFileOldCount.format("500"),value:"500"}],width:130,height:200});var a='<div class="place-fliewrap"><div class="place-flie"><div class="place-flie-lt">'+Lang.Mail.selectMailFileType+'</div><div class="place-flie-rt"><div class="pb_5"><input type="radio" checked id="rdiFileTime" name="chkmaiFileType" class="set-radio">'+
Lang.Mail.MailFileTimeTitle+'<span class="ml_5" style="display:inline-block;">'+this.dropFileType_Time.getHTML()+'</span></div><div class="pb_5"><input type="radio" name="chkmaiFileType" class="set-radio">'+Lang.Mail.MailFileCountTitle+'<span class="ml_5" style="display:inline-block;">'+this.dropFileType_count.getHTML()+'</span></div></div></div><div class="place-flie"><div class="place-flie-lt">'+Lang.Mail.mailFileSavePath+'</div> <div class="place-flie-rt"><input style="width:215px;color:#000" type="text" maxlength="14" value="\u5b58\u6863['+
(new Date).format("yyyy.mm")+']" id="mailFileName" class="set-mand-txt"></div></div></div>';CC.showDiv(a,this.startMailFile,Lang.Mail.mailFile,null,null,388);this.dropFileType_Time.loadEvent();this.dropFileType_count.loadEvent()},startMailFile:function(){function a(a){var c=0,d=(new Date).getTime();g?(d=(new Date).addMonth(-f).getTime(),d=parseInt(d/1E3)):c=1;MM.mailRequestApi({func:gConst.func.mailFile,data:{type:2,archiveType:c,olderNum:e,srcFolderId:1,desFolderId:a,startDate:0,endDate:d,keepNum:0},
call:function(a){CC.hideMsg();a='<div class="place-fliewrap"><div class="file-reback-suceess"><h3>'+Lang.Mail.mailFileSuccess+'</h3><p class="">'+Lang.Mail.mailFileSaveTitle.format(a["var"].totalNum,'<strong class="fw_b">'+b+"</strong>")+"</p></div></div>";CC.alertTips(a);jQuery("#span_1").click()}})}var b=jQuery("#mailFileName").val().trim(),c=new ToolTips({id:"txtNewFolderName_error",direction:ToolTips.direction.Bottom,left:"150px",top:"70px"});if(!b.checkSpecialChar()||RegExp("[~\uff01#\uffe5%\u2026\u2026&*\uff08\uff09=+{}\uff1b\u2018\uff1a\u201c\uff0c\uff1f/<>;]",
"ig").test(b))return c.show($("mailFileName"),Lang.Mail.Write.cannotInputTips),$("mailFileName").focus(),!0;if(b==Lang.Mail.folder_MyFolder||b==="\u4ee3\u6536\u90ae\u4ef6\u5939")return c.show($("mailFileName"),Lang.Mail.folder_NameExist),$("mailFileName").focus(),!0;var d=gConst.folderLength*2;if(b.len()>d)return c.show($("mailFileName"),Lang.Mail.folder_FolderLength.format(d,gConst.folderLength)),$("mailFileName").focus(),!0;CC.showMsg(Lang.Mail.mailFileLoading+",",!1);for(var e=parseInt(MM.sys1.dropFileType_count.getValue()),
f=parseInt(MM.sys1.dropFileType_Time.getValue()),g=jQuery("#rdiFileTime").is(":checked"),c=CM.folderMain[gConst.dataName],d="",h=0;h<c.length;h++)if(c[h].name==b){d=c[h].fid;break}d?a(c[h].fid):(c=1E4,MM.folderMain.Folders.user.length>0&&(c=MM.folderMain.Folders.user[MM.folderMain.Folders.user.length-1].location+1),MM.mailRequest({func:gConst.func.createFolder,data:{parentId:0,type:3,location:c,name:b,pop3Flag:0},call:function(b){a(b["var"]);MM.folderMain.refresh()}}))},getCloseInBarHtml:function(a){var b=
"",c=0,d=0;names=[];folders=[];during=[];b+='<div id="boxCloseInBar" style="background-color: #ffffff; right: 0px; top:-1px;" class="close-search pb_10">';b+='<a id="btnCloseInBar" title="\u9690\u85cf\u5206\u7c7b\u641c\u7d22" href="javascript:;" class="tx-tr" style="right:206px; top:39px;"><i></i></a>';b+='<div class="close-search-hd p_relative">';b+="\u5206\u7c7b\u67e5\u627e\uff08<em>"+a.messageCount+"</em>\uff09";b+='<i class="triangle-bg"></i>';b+="</div>";b+='<div class="close-search-bd">';jQuery.isEmptyObject(GE.approachSearchData)||
(b+='<dl id="boxCheckedList">',b+="<dd>",b+="<ul>",GE.approachSearchData.from!==void 0&&(b+='<li data="from" class="p_relative">',b+='<a href="#"><span class="max-ft" style="_width:140px;">'+GE.approachSearchData.from+"</span>",b+="</a>",b+='<i style="right:4px; top:7px;" class="i-fakeTxt-close"></i>',b+="</li>",c++),GE.approachSearchData.fid!==void 0&&(b+='<li data="fid" class="p_relative">',b+='<a href="#"><span class="max-ft" style="_width:140px;">'+GE.approachSearchTempFolderName+"</span>",b+=
"</a>",b+='<i style="right:4px; top:7px;" class="i-fakeTxt-close"></i>',b+="</li>",c++),GE.approachSearchData.during!==void 0&&(b+='<li data="during" class="p_relative">',b+='<a href="#"><span class="max-ft" style="_width:140px;">'+GE.approachSearchTempDuring+"</span>",b+="</a>",b+='<i style="right:4px; top:7px;" class="i-fakeTxt-close"></i>',b+="</li>",c++),GE.approachSearchData.attached!==void 0&&(b+='<li data="attached" class="p_relative">',b+='<a href="#"><span class="max-ft" style="_width:140px;">'+
GE.approachSearchTempAttach+"</span>",b+="</a>",b+='<i style="right:4px; top:7px;" class="i-fakeTxt-close"></i>',b+="</li>",c++),b+="</ul>",c>1&&(b+='<div class="see-all-cont"><a href="#" class="see-all btn-see-cancel"><span>\u5168\u90e8\u53d6\u6d88</span></a></div>'),b+="</dd>",b+="</dl>");if(GE.approachSearchData.from===void 0){names=a.fromStats;c=names.length;b+='<dl id="boxSenderList">';b+="<dt>\u6309\u53d1\u4ef6\u4eba</dt>";b+="<dd>";b+="<ul>";for(d=0;d<c;d++)b+='<li data="'+names[d].from+'"',
d>3&&(b+=' style="display: none;"'),b+='><a href="#"><span class="max-ft" style="_width:140px;">'+names[d].from+"</span><span>("+names[d].count+")</span></a></li>";b+="</ul>";c>4&&(b+='<div class="see-all-cont"><span class="see-all btn-see-more"><span>\u663e\u793a\u5168\u90e8</span><i class="i-c i_2trid_down ml_5" style="margin-top:-2px;"></i></span></div>');b+="</dd>";b+="</dl>"}if(GE.approachSearchData.fid===void 0){folders=a.folders;c=folders.length;b+='<dl id="boxFolderList">';b+="<dt>\u6309\u6240\u5728\u6587\u4ef6\u5939</dt>";
b+="<dd>";b+="<ul>";for(d=0;d<c;d++)b+='<li data="'+folders[d].fid+'"',d>3&&(b+=' style="display: none;"'),b+='><a href="#" title="'+folders[d].folderName+'"><span class="max-ft">'+folders[d].folderName+"</span><span>("+folders[d].count+")</span></a></li>";b+="</ul>";c>4&&(b+='<div class="see-all-cont"><span class="see-all btn-see-more"><span>\u663e\u793a\u5168\u90e8</span><i class="i-c i_2trid_down ml_5" style="margin-top:-2px;"></i></span></div>');b+="</dd>";b+="</dl>"}if(GE.approachSearchData.during===
void 0){during=a.during;c=during.length;b+='<dl id="boxDuringList">';b+="<dt>\u6309\u65f6\u95f4\u8303\u56f4</dt>";b+="<dd>";b+="<ul>";for(d=0;d<c;d++)b+='<li data="'+during[d].during+'"',d>3&&(b+=' style="display: none;"'),b+='><a href="#" title="'+during[d].name+'"><span class="max-ft">'+during[d].name+"</span><span>("+during[d].count+")</span></a></li>";b+="</ul>";c>4&&(b+='<div class="see-all-cont"><span class="see-all btn-see-more"><span>\u663e\u793a\u5168\u90e8</span><i class="i-c i_2trid_down ml_5" style="margin-top:-2px;"></i></span></div>');
b+="</dd>";b+="</dl>"}GE.approachSearchData.attached===void 0&&(b+='<dl id="boxAttachList">',b+="<dt>\u6309\u9644\u4ef6\u7c7b\u578b</dt>",b+="<dd>",b+="<ul>",a.attachMessageCount>0&&(b+='<li data="1"><a href="#" title="\u5e26\u9644\u4ef6"><span class="max-ft">\u5e26\u9644\u4ef6</span><span>('+a.attachMessageCount+")</span></a></li>"),a.messageCount-a.attachMessageCount>0&&(b+='<li data="0"><a href="#" title="\u4e0d\u5e26\u9644\u4ef6"><span class="max-ft">\u4e0d\u5e26\u9644\u4ef6</span><span>('+(a.messageCount-
a.attachMessageCount)+")</span></a></li>"),b+="</ul>",b+="</dd>",b+="</dl>");b+="</div>";b+="</div>";return b},bindCloseInBarEvent:function(a){a("#btnCloseInBar").on("click",function(){a(this).hasClass("tx-tr")?(a("#boxCloseInBar").animate({right:"-191px"}),a(this).removeClass("tx-tr").addClass("tx-tl").attr("title","\u5c55\u5f00\u5206\u7c7b\u641c\u7d22")):(a("#boxCloseInBar").animate({right:"0px"}),a(this).removeClass("tx-tl").addClass("tx-tr").attr("title","\u9690\u85cf\u5206\u7c7b\u641c\u7d22"))});
a("#boxCheckedList .i-fakeTxt-close").click(function(){var b=a(this).parent().attr("data");delete GE.approachSearchData[b];CC.approachSearch(1)});a("#boxCheckedList .btn-see-cancel").click(function(){GE.approachSearchData={};CC.approachSearch(1)});a("#boxSenderList li").click(function(){var b=a(this).attr("data");GE.approachSearchData.from=b;CC.approachSearch()});a("#boxFolderList li").click(function(){var b=a(this).attr("data");GE.approachSearchData.fid=~~b;GE.approachSearchTempFolderName=a(this).find("a").attr("title");
CC.approachSearch()});a("#boxDuringList li").click(function(){var b=a(this).attr("data");GE.approachSearchData.during=~~b;GE.approachSearchTempDuring=a(this).find("a").attr("title");CC.approachSearch()});a("#boxAttachList li").click(function(){var b=a(this).attr("data");GE.approachSearchData.attached=~~b;GE.approachSearchTempAttach=a(this).find("a").attr("title");CC.approachSearch()});a("#boxCloseInBar .btn-see-more").click(function(){a(this).attr("unfold")==="true"?(a(this).children("span").html("\u663e\u793a\u5168\u90e8"),
a(this).parent().siblings("ul").find("li:gt(3)").hide(),a(this).removeAttr("unfold").children("i").addClass("i_2trid_down").removeClass("i_2trid_up")):(a(this).children("span").html("\u53ea\u663e\u793a\u90e8\u5206\u9879"),a(this).parent().siblings("ul").children().show(),a(this).attr("unfold","true").children("i").addClass("i_2trid_up").removeClass("i_2trid_down"))})}};var dropMailType=null;
function FolderMain(){this.name=gConst.folderMain;this.isDel=!1;this.listLabelTable=this.listFolderMainDiv=null;this.isOk=!1;this.folderPwd=""}
FolderMain.prototype={initialize:function(){var a=MM[gConst.folderMain];a.func=gConst.func.listFolder;a.data={stats:!0};a.msg=Lang.Mail.folder_LoadingFolder;a.needRequest=!0;a.Folders=[];a.Folders[GE.folder.sys]=[];a.Folders[GE.folder.user]=[];a.Folders[GE.folder.admin]=[];a.Folders[GE.folder.label]=[];a.Folders[GE.folder.pop]=[];a.allFolders=[];a.unUsedColors=[];var b,c;for(b in this)c=this[b],typeof c=="function"&&(a[b]=c)},init:function(){this.resize();this.listFolderMainDiv=$(gConst.listFolderMainId);
$(gConst.listFolderMainId).style.paddingRight="5px";this.listFolderMainDiv&&this.initDragEvent();EV.observe(window.document,"click",function(){for(var a=document.getElementsByName("labelColor"),b=0;b<a.length;b++)if(a[b].style.display!="none")a[b].style.display="none"})},resize:function(){var a=this.name;(function(){var b=El.docHeight()-GE.pos()[1];try{var c=b-El.height($("listHeader_"+a))-1;El.height($(gConst.listFolderMainId),c)}catch(d){}})()},getHtml:function(){function a(a,c){data=d.Folders[c];
CC.removeFolderItem(data);if(c=="sys")for(var e=d.Folders.admin,f=0;f<e.length;f++)data.push(e[f]);var h=[];h[h.length]='<div style="+zoom:1;"><table class="addr_table_head" width="100%" id="'+gConst.listFolderMainTableId+c+'">';h[h.length]="<tbody>";h[h.length]='<tr id="'+gConst.listFolderMainTrId+c+'_0">';h[h.length]=c==GE.folder.label?'<td width="20%">'+Lang.Mail.label_MyLabel+"</td>":'<td width="20%">'+Lang.Mail.folder_FolderName+"</td>";h[h.length]="<td>"+Lang.Mail.label_Status+"</td>";h[h.length]=
'<td width="40%">'+Lang.Mail.label_Action+"</td>";h[h.length]="</tr>";h[h.length]="</tbody>";h[h.length]="</table></div>";h[h.length]='<div style="+zoom:1;"><table width="100%" class="addr_table_body">';var g="",s=function(c,d,e){for(var f=null,k=!1,n=!1,q="",F="",q="",H=0,C=c.length;H<C;H++){f=c[H];g=CC.getFolderTypeName(f.type)+f.fid;for(var k=f.nodes&&f.nodes.length>0,n=H==c.length-1,F=d||"",q=f.parentId==0?"":n?"\u2514 ":"\u251c ",q=F+q,E=[],A={L0:"L0.png",L1:"L1.png",L2:"L2.png",L3:"L3.png",
L4:"L4.png",PM0:"P0.png",PM1:"P1.png",PM2:"P2.png",PM3:"P3.png",empty:"L5.png",root:"root.png",folder:"folder.png",file:"file.png",exit:"exit.png"},D=0;D<q.length;D++){var B="";switch(q.charAt(D)){case "\u2502":B="L4";break;case "\u2514":B="L2";break;case "\u3000":B="empty";break;case "\u251c":B="L1";break;case "\u2500":B="L3";break;case "\u250c":B="L0"}B!=""&&E.push("<img align='absMiddle' src='"+gMain.resourceRoot+"/images/tree/"+A[B]+"' height='30' width='20'>")}q=E.join("");f.type==5&&(q='<a  data-fid="'+
f.fid+'" class="col_sld mr_5 '+gConst.labelColor[f.folderColor]+'" href="javascript:void(0);"><i class="i-dw"></i></a>');h.push(b(q,f,g,a,!f.nodes?0:f.nodes.length,H,e));k&&(F+=n||f.parentId==0?"\u3000":"\u2502 ",s(f.nodes,F,!f.nodes?0:f.nodes.length))}};s(data,"",data.length);h[h.length]="</table></div>";return h.join("")}function b(a,b,d,e,f,h,g){var r=b.stats,w=b.fid,x=CC.getFolderTypeName(b.type),z=[],y=Util.formatSize(r.messageSize,null,1),v=!1;z.push('<tr id="'+gConst.listFolderMainTrId+x+"_"+
b.fid+"\" onMouseOver=\"MM['folderMain'].mouseOver(this,'tr');\" onMouseOut=\"MM['folderMain'].mouseOut(this,'tr');\">");if(b.type==5)z[z.length]='<td width="20%">'+a+'<a class="vertical_a" href="javascript:void(0)" onclick="CC.goFolder(\''+w+"','"+d+'\');"  title="'+b.name.encodeHTML()+'">'+b.name+"</a></td>";else{var G="";gMain.lock_close&&b.folderPassFlag&&(b.type==3||b.type==6)?(z.push('<td width="20%">'+a+'<a  href="javascript:void(0);" style = display:inline-block; *display:inline; margin:0;padding:0;width:11px;background-image:url(\'../images/edit.png\');background-repeat:no-repeat;  height:11px;color:#989898; overflow:hidden; text-indent:-9999px;background-position:-220px -73px; class="add lockico lockFolder_pos"></a><a href="javascript:void(0)" onclick="folderlock.unlocked(\''+
w+"','myfolder','"+d+'\');"  title="'+b.name.encodeHTML()+'">'+b.name+"</a></td>"),v=!0):z.push('<td width="20%">'+a+'<a href="javascript:void(0)" onclick="CC.goFolder(\''+w+"','"+d+"');\" >"+b.name.encodeHTML()+"</a></td>")}z[z.length]='<td>\u90ae\u4ef6:<span class="c_ff6600">'+r.unreadMessageCount+"</span>/"+r.messageCount+" \u5360\u7528:"+y+"</td>";z[z.length]='<td width="40%">'+c(x,w,e,f,h,g,v)+"</td>";z.push("</tr>");return z.join("")}function c(a,b,c,d,e,h,g){var r=[],w="";c.each(function(c,
d){var k=f[d].authority||"";if(k==""||GC.check(k))if(d!="sort"){w=f[d];var k=w.name,q={v:d,fid:b,type:a};g&&d!="rename"?r.push('<a href="javascript:fGoto();" '+(c!=0?'class="pl_10"':"")+" onclick=\"folderlock.unlocked('','myfolder_op','"+q+"')\">"+k+"</a>"):r.push('<a href="javascript:fGoto();" '+(c!=0?'class="pl_10"':"")+" onclick=\"MM.folderMain.opt('"+d+"',"+b+",'"+a+"');return false;\">"+k+"</a>")}else w=f[d],h>1&&e!=0&&r.push('<a class="move-up pl_10"  href="javascript:fGoto();" onclick="MM.folderMain.opt(\''+
d+"',"+b+",'"+a+"','up');return false;\"><i></i></a>"),h>1&&e!=h-1&&r.push('<a class="move-down pl_10"  href="javascript:fGoto();" onclick="MM.folderMain.opt(\''+d+"',"+b+",'"+a+"','down');return false;\"><i></i></a>")});return r.join("")}var d=this,e=MM.folderMain.folderInfo,f={empty:{name:Lang.Mail.folder_Empty,id:"MAIL_FOLDER_EMPTY",authority:"MAIL_INBOX_DELETE"},del:{name:Lang.Mail.folder_Del,id:"MAIL_FOLDER_DEL"},rename:{name:Lang.Mail.folder_ReName,id:"MAIL_FOLDER_UPDATE"},filter:{name:Lang.Mail.folder_AddFilter,
id:"MAIL_CONFIG_FILTER"},label:{name:"\u7ed9\u6307\u5b9a\u90ae\u4ef6\u8d34\u6807\u7b7e",id:"MAIL_CONFIG_FILTER",authority:"MAIL_MANAGER_FILTER"},edit:{nam:Lang.Mail.folder_Edit,id:"MAIL_FOLDER_UPDATE"},pop:{name:Lang.Mail.folder_Pop,id:"MAIL_FOLDER_POP"},encrypt:{name:Lang.Mail.Write.encryption,id:"MAIL_FOLDER_ENCRYPT"},sort:{up:"\u2191",down:"\u2193"}},g=e.totalSize,g=g.replace(" ","");if(g=="200G"||g=="0"||g=="UNLIMITED")e.usedPercent="1.0%",g=Lang.Mail.Unlimited;var h=[];h[h.length]='<div id="'+
gConst.listFolderMainId+'" style="OVERFLOW:auto">';h[h.length]='<div class="volume-til">';h[h.length]="<span>"+Lang.Mail.Write.totalAmount+'<var class="full-volume">'+g+"</var></span>";h[h.length]="<span>"+Lang.Mail.Write.used+'<var class="already-use">'+e.usedSize+"</var></span>";g!=Lang.Mail.Unlimited&&(h[h.length]="<span>"+Lang.Mail.Write.theRest+(e.userdPercentNum==0?'<var class="new-mail">  '+Lang.Mail.Write.fullCapacity+"</var>":'<var class="left-volume">'+e.userdPercentNum+"%</var>")+"</span>");
h[h.length]="<span>"+Lang.Mail.Write.together+'<var class="all-mail">'+e.messageCount+"</var>"+Lang.Mail.Write.letters+'\uff0c<var class="new-mail">'+e.unreadMessageCount+"</var>"+Lang.Mail.Write.newMails+"</span>";h[h.length]="</div>";h[h.length]="<div >";h[h.length]='<h3 class="ban-til">'+Lang.Mail.folder_SysFolder+"</h3>";e=[];e.push("empty");h[h.length]=a(e,GE.folder.sys);h[h.length]="</div>";h[h.length]='<div class="pt_30">';h[h.length]='<h3 class="ban-til">'+Lang.Mail.folder_MyFolder;GC.check("MAIL_CONFIG_FOLDER")&&
(h[h.length]=' <a class="pl_15" href="javascript:fGoto();" onClick="MM.folderMain.opt(\'addUser\');return false;">'+Lang.Mail.folder_NewFolder+"</a>");h[h.length]='<a class="pl_15"  href="javascript:fGoto();" onClick="MM.folderMain.refresh();return false;">'+Lang.Mail.folder_Fresh+"</a></h3>";e=[];GC.check("MAIL_CONFIG_FOLDER")&&(e.push("empty"),e.push("del"),e.push("rename"),e.push("sort"));h[h.length]=a(e,GE.folder.user);h[h.length]="</div>";GC.check("MAIL_MANAGER_FILTER")&&(h[h.length]='<div class="mail-tips "><strong>'+
Lang.Mail.FolderManageTips+"\uff1a</strong>",h[h.length]=' <p>\u521b\u5efa<a href="javascript:void(0)" onclick=MM.folderMain.opt("filter",1,"sys");return false;>\u90ae\u4ef6\u5206\u62e3</a>\u89c4\u5219\uff0c\u6309\u53d1\u4ef6\u4eba\u81ea\u52a8\u6295\u5230\u6307\u5b9a\u90ae\u4ef6\u5939\uff0c\u90ae\u4ef6\u5904\u7406\u66f4\u65b9\u4fbf\u3002</p></div>');CC.checkConfig("mailPOP")&&(e=[],GC.check("MAIL_CONFIG_FOLDER")&&e.push("empty"),h[h.length]='<div class="pt_30">',h[h.length]='<h3  class="ban-til">'+
Lang.Mail.ConfigJs.popMailFolder,h[h.length]='<a class="pl_15" href="javascript:fGoto();" onClick="MM[\'folderMain\'].refresh();return false;">'+Lang.Mail.folder_Fresh+"</a></h3>",h[h.length]=a(e,GE.folder.pop),h[h.length]="</div>");CC.isLabelMail()&&(h[h.length]='<div class="pt_30">',h[h.length]='<h3 class="ban-til ">'+Lang.Mail.label_MyLabel,h[h.length]='   <a class="pl_15" href="javascript:fGoto();" onClick="MM[\'folderMain\'].opt(\'addLabel\');return false;">'+Lang.Mail.label_NewLabel+"</a>",
h[h.length]='   <a class="pl_15"  href="javascript:fGoto();" onClick="MM.folderMain.refresh();return false;">'+Lang.Mail.folder_Fresh+"</a></h3>",h[h.length]="<div>",h[h.length]=a(["rename","del","label"],GE.folder.label),h[h.length]="</div>",h[h.length]="</div>");return h.join("")},getFLength:function(a){var b=0,c=function(a){for(var e=0,f=a.length;e<f;e++)b++,a[e].nodes&&a[e].nodes.length>0&&c(a[e].nodes)};c(a);return b},add:function(a,b,c,d){function e(){$("labelMain");var a=$("contact-box"),b=
$("contact-body"),c=$("chk_filter"),d=$("setContact"),e=$("btn_colorselect"),h=["0","2"],g=function(){var a=$("divDialogconfirmlabel"),b=a.offsetWidth,c=a.offsetHeight,b=(CC.docWidth()-b)/2,c=(CC.docHeight()-c)/2;a.style.left=b+"px";a.style.top=c+"px"};e&&(t=new ColorBox(e,{target:"#colorValue",callback:function(a,b){$("colorView").className="i-colorsquare fl "+b}}),t.setValue(f.unUsedColors[0]));if(c&&a)c.onclick=function(){this.checked?(contact=contact||new parent.Contact("contact"),contact.groupMap=
LMD.groupMap,contact.group_contactListMap=LMD.group_contactListMap_mail,contact.addContact=function(a,b){d.value=b},contact.createBody(h,function(){b.innerHTML=contact.getHTML(!0)}),a.style.display=""):a.style.display="none";g()}}var f=this,g="",h=gConst.folderLength*2,j=CM.folderMain[gConst.dataName],n=0,k=0,q="",t=null,u=a==GE.folderType.label,s=!(d&&d.mid.length==1);if(c)n=b.fid,k=b.parentId,q=b.name.encodeHTML();else if(a==GE.folderType.user&&f.getFLength(f.Folders[GE.folder.user])>=GE.folder.limit){CC.alert(Lang.Mail.FolderLimitMsg.format(GE.folder.limit));
return}else if(f.getFLength(f.Folders[GE.folder.label])>=GE.folder.labelLimit){CC.alert(Lang.Mail.FolderLimitMsg.format(GE.folder.labelLimit));return}var r=f.Folders[GE.folder.sys].concat(f.Folders[GE.folder.user]),w=Lang.Mail.folder_InputName;u?(w=Lang.Mail.label_LabelName+"\uff1a",g+='<li class="j_formLine clearfix">',g+=['<label class="j_label">',w,'</label><div class="j_element">   <div class="setTag" id="setTag">','       <input type="text" id="txtNewFolderName" maxlength="'+h+'" class="iText" value="'+
q+'"/>','       <input type="hidden" id="colorValue"/>',c?"":'<div class="mailThemeBg" id="btn_colorselect"><i class="i-colorsquare c1 fl" id="colorView"></i><i class="i_triangle_d"></i></div>',"   </div>"].join(""),c||(g+=['<div class="mb_5" id="div_filterContact">   <input type="checkbox" id="chk_filter" value="" class="mr_5">','   <label for="chk_filter">'+(s?Lang.Mail.tips072:Lang.Mail.tips073)+"</label>",s?'<div id="contact-box" style="display: none;position: relative;"><input type="text" name="setContact" style="width:212px"  id="setContact" class="text" /><div id="contact-body"></div></div>':
"","</div>"].join("")),g+="</div></li>"):(!c&&(g+='<li class="j_formLine clearfix">'+f.getSelectFolders(r,"newfolder",k)+"</li>"),g+=['<li class="j_formLine clearfix">   <label class="j_label">',w,"</label>",'   <div class="j_element"><input type="text" style="width:150px" id="txtNewFolderName"  maxlength="'+h+'" class="iText" value="'+q+'"/></div>',"</li>"].join(""));g+="";k=(c?Lang.Mail.folder_ReName:Lang.Mail.folder_New)+Lang.Mail.folder_Folder;u&&(k=(c?Lang.Mail.folder_ReName:Lang.Mail.folder_New)+
Lang.Mail.label_Label);var x=function(a,b){function c(a){for(var e=!1,f=0;f<a.length;f++)a[f].fid==b?(d=a[f],e=!0):a[f].nodes.length>0&&e==!1&&c(a[f].nodes)}if(b==0)return a[a.length-1].location;var d=null;c(a);return d?d.nodes&&d.nodes.length>0?d.nodes[d.nodes.length-1].location:null:a[a.length-1].location};CC.showDiv('<div class="pop-wrap" style="padding:0"><ul class="form">'+g+"</ul></div>",function(){var e=new ToolTips({id:"txtNewFolderName_error",direction:ToolTips.direction.Bottom}),g=$("chk_filter"),
k=$("setContact");if(c)e.containerTop=78;var q=$("txtNewFolderName").value.trim(),t=0,r=1;dropMailType!=null&&(t=dropMailType.getValue(),r=dropMailType.getAttrValue("level"));var s=0,w=a==3?GE.userLocation:GE.labelLocation;a==GE.folderType.user&&$("cbPop3Flag")&&(s=$("cbPop3Flag").checked?1:0);q=q.trim();if(q==""){q=Lang.Mail.folder_NameIsNull;if(u)q=Lang.Mail.tips074;e.show($("txtNewFolderName"),q);$("txtNewFolderName").focus();return!0}if(q==Lang.Mail.folder_MyFolder||q==="\u4ee3\u6536\u90ae\u4ef6\u5939"||
q==="\u6211\u7684\u6807\u7b7e")return e.show($("txtNewFolderName"),Lang.Mail.folder_NameExist),$("txtNewFolderName").focus(),!0;if(!q.checkSpecialChar()||RegExp("[~\uff01#\uffe5%\u2026\u2026&*\uff08\uff09=+{}\uff1b\u2018\uff1a\u201c\uff0c\uff1f/<>;]","ig").test(q))return e.show($("txtNewFolderName"),Lang.Mail.Write.cannotInputTips),$("txtNewFolderName").focus(),!0;if(q.len()>h)return e.show($("txtNewFolderName"),Lang.Mail.folder_FolderLength.format(h,gConst.folderLength)),$("txtNewFolderName").focus(),
!0;if(r>=5)return e.show($("txtNewFolderName"),Lang.Mail.createFolderLevel),!0;r=!1;if(!u){for(var A=0;A<f.Folders.sys.length;A++)f.Folders.sys[A].name==q&&f.Folders.sys[A].fid!=n&&(r=!0);if(r==!1){for(A=0;A<j.length;A++)j[A].type!=5&&j[A].name==q&&j[A].fid!=n&&(r=!0);for(var D=gConst.sysFolderList,A=0;A<D.length;A++)if(D[A]==q)return e.show($("txtNewFolderName"),Lang.Mail.sameSysFolder),$("txtNewFolderName").focus(),!0}}if(u){for(A=0;A<j.length;A++)j[A].type==5&&j[A].name==q&&j[A].fid!=n&&(r=!0);
if(g&&g.checked&&k){if(k.value=="")return e.show(k,"\u8bf7\u9009\u62e9\u8981\u6536\u53d6\u7684\u8054\u7cfb\u4eba"),k.focus(),!0;if(k.value.replace(/[,;\uff0c\uff1b]/g,";").split(";").length>1)return e.show(k,"\u53ea\u80fd\u8f93\u5165\u4e00\u4e2a\u8054\u7cfb\u4eba\u5730\u5740"),k.focus(),!0;if(!Email.match(k.value))return e.show(k,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8054\u7cfb\u4eba\u5730\u5740"),k.focus(),!0}}if(a==GE.folderType.user)f.Folders[GE.folder.user].length>0&&(w=x(f.Folders[GE.folder.user],
t)||w);else if(f.Folders[GE.folder.label].length>0)w=f.Folders[GE.folder.label][f.Folders[GE.folder.label].length-1].location;w+=GE.locationAdd;if(r)return e.show($("txtNewFolderName"),u?"\u540c\u540d\u6807\u7b7e\u5df2\u7ecf\u5b58\u5728":Lang.Mail.folder_NameExist),$("txtNewFolderName").focus(),!0;e=[];r=!1;c?b.name!=q&&(e.push({func:gConst.func.updateFolder,"var":{fid:n,type:1,name:q}}),r=!0):(r=!0,u?(A=$("colorValue").value,e.push({func:gConst.func.createFolder,"var":{parentId:t,type:a,location:w,
name:q,folderColor:A,pop3Flag:s}})):e.push({func:gConst.func.createFolder,"var":{parentId:t,type:a,location:w,name:q,pop3Flag:s}}));r&&MM.seqRequest(e,function(a,b){b=b||a["var"];u&&g&&g.checked&&MM.mailRequest({func:gConst.func.setFilter,data:{conditionsRelation:1,dealHistoryMail:0,fromType:2,from:k?k.value:d.from,attachLabel:b,forwardBakup:1,opType:"add",dealType:"5",name:"m123456",ignoreCase:1},call:function(){}});c?CC.showMsg(u?"\u4fee\u6539\u6807\u7b7e\u6210\u529f":Lang.Mail.mailFolderUpdateSuccess,
!0,!1,"option"):CC.showMsg(u?"\u521b\u5efa\u6807\u7b7e\u6210\u529f":Lang.Mail.mailFolderCreateSuccess,!0,!1,"option");f.callback(a,b);d&&MM[d.o].marklabel("add",d.mid,b,function(){d.call&&d.call(b)})},function(){c?CC.showMsg(u?"\u4fee\u6539\u6807\u7b7e\u5931\u8d25":Lang.Mail.EditFolderFail,!0,!1,"error"):CC.showMsg(u?"\u521b\u5efa\u6807\u7b7e\u5931\u8d25":Lang.Mail.CreateFolderFail,!0,!1,"error")})},k,function(){t&&t.hide()},"label",u&&"385");u&&e();dropMailType!=null&&dropMailType.loadEvent();window.setTimeout('$("txtNewFolderName").focus();',
100)},empty:function(a){var b=this,c=a.fid,d=Lang.Mail.folder_ConfirmEmpty.format(a.name);if(c==GE.folder.del)d=Lang.Mail.folder_EmptyNoRecover;b.opFolder=CC.getFolderTypeName(a.type)+c;var e={};e.func=gConst.func.updateMailAll;e["var"]=c==GE.folder.del?{fid:c,type:"delete"}:a.type==GE.folderType.label?{fid:c,type:"empty"}:{fid:c,type:"move",newFid:GE.folder.del};e.call=b.callback;if(a.stats.messageCount>0)return CC.confirm(d,function(){b.isDel=!0;var a={},d=[];a.func=gConst.func.listFolder;a["var"]=
{stats:1};d[d.length]=e;d[d.length]=a;MM.seqRequest(d,function(a){b.callback(a,c);CC.showMsg(Lang.Mail.mailClearSuccess,!0,!1,"option")})});else CC.alert(Lang.Mail.folder_NoMailEmpty)},del:function(a){var b=this,c={};c.func=gConst.func.delFolder;c["var"]={fid:a.fid,type:a.type};c.call=b.callback;if(a.type==5||a.type==3&&a.stats.messageCount==0){var d=Lang.Mail.folder_ConfirmDel;if(a.type==GE.folderType.label)d=Lang.Mail.label_ConfirmDel;CC.confirm(d,function(){var d={},f=[];d.func=gConst.func.listFolder;
d["var"]={stats:1,type:0};f.push(c);f.push(d);if(CM.folderMain.passFlag==1){for(var d=CM.folderMain["var"],g="",h=0,j=0;j<d.length;j++)if(d[j].folderPassFlag==1)g=d[j].fid,h++;h==1&&g==a.fid&&MM.mailRequest({func:"mbox:setFolderPass",data:{oldPass:folderlock.lock_pass,type:3},call:function(){}})}MM.seqRequest(f,function(c){b.callback(c);CC.showMsg(a.type==5?"\u6807\u7b7e\u5220\u9664\u6210\u529f":Lang.Mail.mailFolderDelSuccess,!0,!1,"option")},b.failCallBack)})}else CC.alert(Lang.Mail.folder_BeforeEmpty)},
failCallBack:function(a){a&&a.errorCode==2323007?CC.alert(Lang.Mail.folder_below_are_a_folder):MM.failCallBack(a)},move:function(a,b,c){function d(a,b){var c=0,d=0,c=0,e={sys:GE.adminLocation,admin:GE.userLocation,user:GE.labelLocation,lable:GE.allLocation},f={1:"sys",2:"admin",3:"user",5:"label"}[a.type];b==1?(c=a.location,d=a.next?a.next.location:c+GE.locationAdd):(d=a.location,c=a.prev?a.prev.location:d-GE.locationAdd);c=Math.max(GE[f+"Location"],c);d=Math.min(e[f]-GE.locationAdd-1,d);return c=
Math.floor((c+d)/2)}var e=[],f=0,g=0,g=0,f={};if(a&&b)f=a.fid,a.parentId==b.parentId?(g=d(b,c),f={func:gConst.func.updateFolder,"var":{fid:f,type:2,location:g}}):(g=b.fid,f={func:gConst.func.updateFolder,"var":{fid:f,type:3,parentId:g}}),e.push(f),e.push({func:gConst.func.listFolder,"var":{stats:1,type:0}}),MM.seqRequest(e,this.callback)},rename:function(a){MM.folderMain.add(a.type,a,!0)},encrypt:function(a){var b=$("folderMain_pass"),c=$("folderPass_modpwd_span"),d=$("folderPass_folderpwd_span");
$("folderPass_type").value=a;this.isOk&&a>=5&&this.folderPwd!=""?this.encryptSave(a,this.folderPwd):a==4?(El.hide(c),El.hide(d),El.hide(b)):a==1||a>=5?(El.show(b),El.show(d),El.hide(c)):a==2?(El.show(b),El.show(c),El.hide(d)):a==3&&(El.show(b),El.show(d),El.hide(c))},encryptSave:function(a,b){var c=$("folderPass_type").value,d=$("folderPass_pwd"),e=$("folderPass_newpwd"),f=$("folderPass_folderpwd"),g={func:gConst.func.setFolderPass,type:c,ids:[]},h=f.value||"";a&&(c=a,h=b);f=[];if(c==1)this.getSelectedValue(f),
g.ids=f,g.newPass=h;else if(c==2)g.oldPass=d.value,g.newPass=e.value;else if(c==3)g.oldPass=h;else if(c==5)this.getSelectedValue(f),g={func:gConst.func.updateFolderPass,type:1,folderPass:h,ids:f};else if(c==6)this.getSelectedValue(f),g={func:gConst.func.updateFolderPass,type:2,folderPass:h,ids:f};else if(c==7){LM.getAllFolders(h);return}c=[];c.push(g);c.push({func:gConst.func.listFolder,folderPass:h,"var":{stats:1,type:0}});MM.seqRequest(c,function(a){if(a.code==gConst.statusOk)a.result[0]===0?(MM.folderMain.isOk=
!0,MM.folderMain.folderPwd=h,CM.folderMain=a,LM.loadFolderInfo(a,!0)):a.result[0]===6?CC.alert(Lang.Mail.Write.oldpwdw):CC.alert(Lang.Mail.Write.opFail)},function(){CC.alert(Lang.Mail.Write.opFail)})},encryptFolder:function(){},opt:function(a,b,c,d){var e=MM.getFolderObject(b);switch(a){case "del":MM.folderMain.del(e);break;case "addUser":MM.folderMain.add(GE.folderType.user);break;case "addLabel":MM.folderMain.add(GE.folderType.label,null,null,d);break;case "rename":MM.folderMain.rename(e);break;
case "empty":MM.folderMain.empty(e);break;case "filter":case "label":b={name:e.name.encodeHTML(),folderId:e.fid};if(a=="label")b.callback=function(){this.showAdd();$("option_check_dealType5").checked=!0;this.attrs.dropLabel.setValue(e.fid)};CC.setConfig("filter",b);break;case "edit":CC.setConfig("4","op=edit&fid="+b);break;case "pop":this.pop(b);break;case "popadd":CC.setConfig("341","edit=add");break;case "popall":this.pop();break;case "sort":this.saveSort(b,c,d);break;case "labelColor":this.setLabelColor(e,
d)}},callback:function(a,b){var c=gConst.folderMain,d=this,e=function(){CC.isLabelMail();d.folderCallback&&d.folderCallback(b)},f=MM[c].opFolder;if(a.code==gConst.statusOk){if(CM[c]=a,LM.loadFolderMain(!0,e),MM[c].isDel)GE.tab.exist(f)&&MM[f].refresh(e),MM[c].isDel=!1}else CC.alert(Lang.Mail.sys_UnKnowErrorMsg,null,Lang.Mail.sys_UnKnowError)},refreshFolders:function(){try{var a=$(gConst.menuC.mail),b=$(gConst.menuC.service);El.removeChildNodes(a);this.createFolderTree(this.Folders[GE.folder.sys],
a,0);this.createFolderTree(this.Folders[GE.folder.admin],a,0);this.createLink("",{fid:-1001,name:"",type:""},"",a,!1,0);if(b&&b.childNodes)for(a=0;a<b.childNodes.length;a++){var c=b.childNodes[a].id;if(c&&(c=="-1"||c=="-2"||c=="-6"))El.remove(b.childNodes[a]),a=-1}LM.folders.push({name:"\u5f85\u529e\u4efb\u52a1"},{name:Lang.Mail.folder_13},{name:Lang.Mail.folder_14},{name:Lang.Mail.Write.accoutMail});if(CC.isLabelMail()){LM.folders.push({name:Lang.Mail.label_MyLabel});var d=this.createLink("",{fid:-2,
name:Lang.Mail.label_MyLabel},"",b,!0,!1,"before",0);this.Folders[GE.folder.label].length>0&&this.createFolderTree(this.Folders[GE.folder.label],d,"before","",0)}if(CC.checkConfig("mailPOP")){LM.folders.push({name:Lang.Mail.ConfigJs.popMailFolder});var e=this.createLink("",{fid:-6,name:Lang.Mail.ConfigJs.popMailFolder,type:GE.folderType.pop},"",b,!0,!1,"before",0);this.Folders[GE.folder.pop].length>0&&this.createFolderTree(this.Folders[GE.folder.pop],e,"before","",0)}LM.folders.push({name:Lang.Mail.folder_MyFolder});
var f=this.createLink("",{fid:-1,name:Lang.Mail.folder_MyFolder,type:GE.folderType.user},"",b,!0,!1,"before",0);this.Folders[GE.folder.user].length>0&&this.createFolderTree(this.Folders[GE.folder.user],f,"before","",0);this.createMyOffice()}catch(g){ch("fFMRefreshFolders",g)}},initTaskRoles:function(){if(CorpType==2||CorpType=="2")gMain.taskRoles=[1,1,0]},createMyOffice:function(){this.bindWkEv();this.initTaskRoles()},bindWkEv:function(){var a=jQuery;a(function(){a("#boxWorkOrder").find("span").first().off("click").click(function(){var b=
a(this).siblings("i");b.hasClass("i-folderOff")?b.removeClass("i-folderOff").addClass("i-folderOn"):b.removeClass("i-folderOn").addClass("i-folderOff");a(this).siblings("ul").toggle()});a("#boxWorkOrder").find("i").first().off("click").click(function(){var b=a(this);b.hasClass("i-folderOff")?b.removeClass("i-folderOff").addClass("i-folderOn"):b.removeClass("i-folderOn").addClass("i-folderOff");a(this).siblings("ul").toggle()});a("#boxWorkOrder").off("click","a").on("click","a",function(){a(".navWrapper").find(".selectFolder_li").removeClass("selectFolder_li");
a(this).parent().addClass("selectFolder_li")}).off("mouseenter","a").on("mouseenter","a",function(){a(this).parent().hasClass("selectFolder_li")||a(this).addClass("mailFolderListColor")}).off("mouseleave","a").on("mouseleave","a",function(){a(this).removeClass("mailFolderListColor")})})},refresh:function(){var a=this;LM.loadFolderMain(!1,function(){a.folderCallback()})},refreshBody:function(a){var b=this.name;this.refreshFolderInfo();this.refreshFolders();typeof a=="function"&&a();if(GE.tab.exist(gConst.folderMain)&&
MM[b].isLoaded)MM[b].isLoaded=!1,MM.updateBody(b)},refreshModule:function(){this.refreshBody()},buildFolders:function(a,b){function c(b,f){var g=[],h=[];if(!f.nodes)f.nodes=[];for(var j=0;j<b.length;j++){var n=b[j],k=n.parentId;if(f.fid==0)n.index=j;k==f.fid?(n.next=j<b.length-1?b[j+1]:null,n.prev=j>0?b[j-1]:null,k==0?d.push(n):f.nodes.push(n),g.push(n.index)):h.push(n)}for(j=0;j<g.length;j++)c(h,a[g[j]])}var d=[];b||(b={fid:0});c(a,b);return d},sortFolders:function(a){if(a)return a.sort(function(a,
c){return a.location-c.location})},refreshFolderInfo:function(){var a=null,b=CM.folderMain[gConst.dataName],c=0,d=0,e=0;this.Folders={};this.Folders[GE.folder.sys]=[];this.Folders[GE.folder.admin]=[];this.Folders[GE.folder.user]=[];this.Folders[GE.folder.label]=[];this.Folders[GE.folder.inner]=[];this.Folders[GE.folder.pop]=[];for(var b=this.sortFolders(b),f=0;f<b.length;f++){a=b[f];a.stats.messageSize*=1024;switch(a.type){case 1:a.fid!=7&&this.Folders[GE.folder.sys].push(a);break;case 2:GE.folderMap&&
GE.folderMap[a.fid]&&this.Folders[GE.folder.admin].push(a);break;case 3:this.Folders[GE.folder.user].push(a);break;case 5:this.Folders[GE.folder.label].push(a);break;case 6:this.Folders[GE.folder.pop].push(a);break;case 9:this.Folders[GE.folder.inner].push(a)}a.type!=5&&!a.virtualFolder&&(c+=b[f].stats.messageSize,d+=b[f].stats.messageCount,e+=b[f].stats.unreadMessageCount)}f=0;for(a=this.Folders[GE.folder.sys].length;f<a;f++)this.Folders[GE.folder.sys][f].fid==12?(gMain.hasDiskFolder=!0,this.Folders[GE.folder.sys][f].order=
45):this.Folders[GE.folder.sys][f].fid!==9999998&&(this.Folders[GE.folder.sys][f].order=parseInt(this.Folders[GE.folder.sys][f].fid)*10-0);this.Folders[GE.folder.sys].sort(function(a,b){return a.order<b.order?-1:a.order>b.order?1:0});this.Folders[GE.folder.user]=this.buildFolders(this.Folders[GE.folder.user]);this.Folders[GE.folder.admin]=this.buildFolders(this.Folders[GE.folder.admin]);MM.folderMain.folderInfo=CC.getMailInfo({messageSize:c,messageCount:d,unreadMessageCount:e});this.refreshUnUsedColors()},
refreshUnUsedColors:function(){for(var a=function(a,b){for(var c=0;c<b.length;c++)if(a==b[c]){b.splice(c,1);break}return b},b=[],c=0;c<gConst.labelColor.length;c++)b.push(c);for(c=0;c<this.Folders[GE.folder.label].length;c++)b=a(this.Folders[GE.folder.label][c].folderColor,b);this.unUsedColors=b},mouseOver:function(a,b){if(a&&b)switch(b){case "tr":a.className="overColor";break;case "div":a.getElementsByTagName("i")[0].style.display="block"}},mouseOut:function(a,b){if(a&&b)switch(b){case "tr":a.className=
"";break;case "div":a.getElementsByTagName("i")[0].style.display="none";break;case "ul":a.style.display="none"}},onClick:function(a,b){if(a&&b)switch(b){case "div":a.getElementsByTagName("ul")[0].style.display="block";break;case "labelColor":a.parentNode.style.display="none"}EV.stopEvent()},getSelectFolders:function(a,b){var c=[];b&&c.push('<label class="j_label">'+Lang.Mail.parent_folder+"\uff1a</label>");var d=[];dropMailType=new DropSelect({id:"folderName_foderManage",data:d,type:"fileTree",selectedValue:"",
width:160,height:200,folderList:[{text:Lang.Mail.folder_MyFolder,value:""}]});for(var e=0,f=a.length;e<f;e++)aw=a[e],aw.type!=1&&d.push(aw);var g=function(a,b,c){for(var d=null,e=!1,f=!1,c=++c||0,u="",s=0,r=a.length;s<r;s++)d=a[s],d.type!=1&&(e=d.nodes&&d.nodes.length>0,f=s==a.length-1,u=b||"",e&&c+1<gConst.folderLimit&&(u+=f||d.parentId==0?"&nbsp;":"\u2502 ",g(d.nodes,u,c)))};g(a);dropMailType.data=d;c.push('<div class="j_element p_relative">'+dropMailType.getHTML()+"</div>");return c.join("")},
createFolderTree:function(a,b,c,d,e){var c=null,f="",g=!1,f=null,h=!1,d=d||"after";if(!b)return!1;for(var j=0,n=a.length;j<n;j++)c=a[j],g=c.nodes&&c.nodes.length>0,f=(h=j==n-1?!0:!1)&&c.type>1?"last":"",f=g?"folderSub":f,f=this.createFolderLink(c,b,g,f,h,d,e),g&&this.createFolderTree(c.nodes,f,h,d,e+1)},createFolderLink:function(a,b,c,d,e,f,g){var h=CC.getFolderTypeName(a.type)+a.fid;if(!d&&MM[h])d=MM[h].icon;return this.createLink(h,a,d||"mid",b,c,e,f,g)},createLink:function(a,b,c,d,e,f,g,h){var j=
this,n=b.fid,k=b.name;if(!b.stats)b.stats={};LM.folders.push(b);b.stats.messageCount=Math.max(b.stats.messageCount,0);b.stats.unreadMessageCount=Math.max(b.stats.unreadMessageCount,0);var q=b.stats.unreadMessageCount,t=b.stats.messageCount,u=b.type==GE.folderType.user?"User":b.type==GE.folderType.pop?"Pop":"Label",s=function(){n==0||b.flag?CC.receiveMail(b.flag):CC.goFolder(n,a)};n<0&&(s=function(){CC.goFolderMain(function(){CC.isLabelMail()&&j.folderCallback(n)})});var r="",w=function(){},x={};x.text=
q?'<a style="display:inline;padding-left:5px;font-weight:bold" class="leftFolder-mailNum" title='+((b.type!=GE.folderType.label?t:0)>0?Lang.Mail.unreadmailCount_AllCount.format(q,b.type!=GE.folderType.label?t:0):Lang.Mail.unreadmailCount.format(q))+">("+q+")</a>":"";x.id="leftMenu_newMailCount_"+a;if(a!="sys0")x.call=function(){if(b.flag&&b.flag.taskFlag)return!1;CC.searchNewMail(b.type==GE.folderType.label?0:n,!0,b.type==GE.folderType.label?[n]:null,b.flag)};if((n==GE.folder.virus||n==GE.folder.junk||
n==GE.folder.del)&&t>0)w=function(){MM.folderMain.opt("empty",n)},r=Lang.Mail.folder_Empty;if(a==""&&(n==-1||n==-2))if(GC.check(n==-1?"MAIL_CONFIG_FOLDER":"MAIL_MANAGER_LABELMAIL"))x.actionClass="add",w=function(a){MM.folderMain.opt("add"+u);EV.getEvent(a).cancelBubble=!0},r="["+Lang.Mail.folder_New+"]";if(n===-6)x.actionClass="add",w=function(a){a=EV.getEvent(a);CC.setConfig("mailPOP",!0);mailPOP.showAdd(0);mailPOP.setHeight();mailPOP.updatePosition("pmailPOPWrapper");mailPOP.correctWidthInIE6("pmailPOPWrapper",
1);a.cancelBubble=!0},r="["+Lang.Mail.folder_New+"]";return LM.addLink({id:n,text:k,folderColor:b.folderColor,url:s,isoutlink:!1,isnewwin:!1,isbold:!1,isred:!1,hasSub:e,action:r,actionClick:w,parentNode:d,attr:x,evts:{},pos:g||"after",passFlag:b.folderPassFlag,type:b.type,status:b.stats},{li:c},f,h)},pop:function(a){CC.showMsg(Lang.Mail.folder_NowPop,!0);var b="pref/popStats.jsp?sid="+GC.coreSid+"&rcvall=true";a&&(b+="");window.setTimeout(function(){Ajax.get(b,null);CC.alert(Lang.Mail.folder_PopSuccess)},
1E3)},saveSort:function(a,b,c){var d,e,f=!1,g=function(b){b.each(function(j,n){f||(n.fid==a?(d=n,e=c=="up"?b[j-1]:b[j+1],f=!0):n.nodes.length>0&&g(n.nodes))})};g(this.Folders[b]);typeof e=="undefined"||typeof e==null||MM.mailRequest({func:gConst.func.seq,data:{item:[{func:gConst.func.updateFolder,"var":{fid:d.fid,type:2,parentId:d.parentId,name:d.name,folderPass:"",location:e.location,pop3Flag:d.pop3Flag}},{func:gConst.func.updateFolder,"var":{fid:e.fid,type:2,parentId:e.parentId,name:e.name,folderPass:"",
location:d.location,pop3Flag:e.pop3Flag}},{func:gConst.func.listFolder,"var":{stats:0,type:0}}]},call:this.callback,failCall:function(){CC.alert(Lang.Mail.fail)}})},setLabelColor:function(a,b){MM.mailRequest({func:gConst.func.seq,data:{item:[{func:gConst.func.updateFolder,"var":{fid:a.fid,type:5,parentId:a.parentId,name:a.name,folderPass:"",folderColor:b}},{func:gConst.func.listFolder,"var":{stats:0,type:0}}]},call:this.callback,failCall:function(){CC.alert(Lang.Mail.fail)}})},initDragEvent:function(){EV.observe(this.listFolderMainDiv,
"mousedown",MM.folderMain.mouseDown,!1)},mouseDown:function(){try{var a=EV.getEvent(),b=EV.getTarget(a,!0),c=El.getNodeType(b),d=El.getParentNodeIsTag(b,"tr");if(!d&&c!="a")return;if(d.id.split("_")[1]==GE.folder.sys)return;var e=d.childNodes[0].getElementsByTagName("a")[0];if(!e)return;var f=e.innerHTML;d.mouseDownY=EV.pointerY(a);d.mouseDownX=EV.pointerX(a);(new Drag("folderMain",d)).getDragItem(f)}catch(g){}return!1},checkAll:function(a,b){for(var c=document.getElementsByName("folderMain_cb_"+
a),d=0,e=c.length;d<e;d++)if(c[d].checked!=b)c[d].checked=b,typeof wo=="function"&&wo(c[d],bx)},getColorHTML:function(){for(var a=[],b=0,c=gConst.labelColor.length;b<c;b++)a.push('<li index="{0}"><a href="javascript:;"><i class="i-colorsquare mr_5 {1}"></i></a></li>'.format(b,gConst.labelColor[b]));return"<ul>"+a.join("")+"</ul>"},checkAllType:function(a){this.checkAll(GE.folder.sys,a);this.checkAll(GE.folder.user,a);this.checkAll(GE.folder.label,a)},getSelectedValue:function(a){var b=$(gConst.listFolderMainId);
try{for(var c=b.getElementsByTagName("input"),b=0,d=c.length;b<d;b++){var e=c[b];e.type=="checkbox"&&e.name.indexOf("folderMain_cb_")>=0&&e.checked&&a.push(e.value-0)}return a}catch(f){return a}},folderCallback:function(a,b){var c=this,d=jQuery,e=d(MM.folderMain.listFolderMainDiv),f=d("#listForderMainTable_"+(a==-1?"user":"label")).offset();try{d(MM.folderMain.listFolderMainDiv).scrollTop(f.top+e.scrollTop()-(a==-1?120:140)),d(".col_sld").colorbox({direction:"Right",callback:function(a,b){var d=this.element,
e=d.data("fid");MM.getFolderObject(e)&&MM.seqRequest([{func:gConst.func.updateFolder,"var":{fid:e,type:5,folderColor:a}}],function(){d[0].className="col_sld mr_5 "+b;LM.loadFolderMain(!1,function(){c.folderCallback()});CC.showMsg("\u6807\u7b7e\u4fee\u6539\u6210\u529f",!0,!1,"option")},function(){})}})}catch(g){}b&&b.call(this,a)}};if(typeof infosoftglobal=="undefined")var infosoftglobal={};if(typeof infosoftglobal.FusionChartsUtil=="undefined")infosoftglobal.FusionChartsUtil={};
infosoftglobal.FusionCharts=function(a,b,c,d,e,f,g,h,j,n,k){if(document.getElementById&&(this.initialDataSet=!1,this.params={},this.variables={},this.attributes=[],a&&this.setAttribute("swf",a),b&&this.setAttribute("id",b),(c=c.toString().replace(/\%$/,"%25"))&&this.setAttribute("width",c),(d=d.toString().replace(/\%$/,"%25"))&&this.setAttribute("height",d),g&&this.addParam("bgcolor",g),this.addParam("quality","high"),this.addParam("allowScriptAccess","sameDomain"),this.addVariable("chartWidth",c),
this.addVariable("chartHeight",d),this.addVariable("debugMode",e?e:0),this.addVariable("DOMId",b),this.addVariable("registerWithJS",f?f:0),this.addVariable("scaleMode",h?h:"noScale"),this.addVariable("lang",j?j:"EN"),this.detectFlashVersion=n?n:1,this.autoInstallRedirect=k?k:1,this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion(),!window.opera&&document.all&&this.installedVer.major>7))infosoftglobal.FusionCharts.doPrepUnload=!0};
infosoftglobal.FusionCharts.prototype={setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=[],b,c=this.getVariables();for(b in c)a.push(b+"="+c[b]);return a},getSWFHTML:function(){var a="";if(navigator.plugins&&
navigator.mimeTypes&&navigator.mimeTypes.length){a='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var b=this.getParams(),c;for(c in b)a+=[c]+'="'+b[c]+'" ';b=this.getVariablePairs().join("&");b.length>0&&(a+='flashvars="'+b+'"');a+="/>"}else{a='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+
this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';a+='<param name="wmede" value="opaque">';a+='<param name="wmode" value="transparent">';b=this.getParams();for(c in b)a+='<param name="'+c+'" value="'+b[c]+'" />';b=this.getVariablePairs().join("&");b.length>0&&(a+='<param name="flashvars" value="'+b+'" />');a+="</object>"}return a},setDataURL:function(a){if(this.initialDataSet==!1)this.addVariable("dataURL",a),
this.initialDataSet=!0;else{var b=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));b.setDataURL||__flash__addCallback(b,"setDataURL");b.setDataURL(a)}},encodeDataXML:function(a){var b=a.match(/=\s*\".*?\"/g);if(b)for(var c=0;c<b.length;c++)var d=b[c].replace(/^=\s*\"|\"$/g,""),d=d.replace(/\'/g,"%26apos;"),e=a.indexOf(b[c]),d="='"+d+"'",f=a.substring(0,e),a=a.substring(e+b[c].length),a=f+d+a;a=a.replace(/\"/g,"%26quot;");a=a.replace(/%(?![\da-f]{2}|[\da-f]{4})/ig,"%25");return a=
a.replace(/\&/g,"%26")},setDataXML:function(a){this.initialDataSet==!1?(this.addVariable("dataXML",this.encodeDataXML(a)),this.initialDataSet=!0):infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id")).setDataXML(a)},setTransparent:function(a){typeof a=="undefined"&&(a=!0);a?this.addParam("WMode","transparent"):this.addParam("WMode","Opaque")},render:function(a){if(this.detectFlashVersion==1&&this.installedVer.major<6)if(this.autoInstallRedirect==1)if(window.confirm("You need Adobe Flash Player 6 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same."))window.location=
"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash";else return!1;else return!1;else return(typeof a=="string"?document.getElementById(a):a).innerHTML=this.getSWFHTML(),!document.embeds[this.getAttribute("id")]&&!window[this.getAttribute("id")]&&(window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))),!0}};
infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var a=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var b=navigator.plugins["Shockwave Flash"];b&&b.description&&(a=new infosoftglobal.PlayerVersion(b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0)for(var b=1,c=3;b;)try{c++,b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+c),
a=new infosoftglobal.PlayerVersion([c,0,0])}catch(d){b=null}else{try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),a=new infosoftglobal.PlayerVersion([6,0,21]),b.AllowScriptAccess="sameDomain"}catch(f){if(a.major==6)return a}try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(g){}}b!=null&&(a=new infosoftglobal.PlayerVersion(b.GetVariable("$version").split(" ")[1].split(",")))}return a};
infosoftglobal.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){for(var a=document.getElementsByTagName("OBJECT"),b=a.length-1;b>=0;b--){a[b].style.display="none";for(var c in a[b])typeof a[b][c]=="function"&&(a[b][c]=function(){})}};
if(infosoftglobal.FusionCharts.doPrepUnload&&!infosoftglobal.unloadSet)infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload),infosoftglobal.unloadSet=!0;if(!document.getElementById&&document.all)document.getElementById=function(a){return document.all[a]};
if(Array.prototype.push==null)Array.prototype.push=function(a){this[this.length]=a;return this.length};infosoftglobal.FusionChartsUtil.getChartObject=function(a){var b=null;(b=navigator.appName.indexOf("Microsoft Internet")==-1?document.embeds&&document.embeds[a]?document.embeds[a]:window.document[a]:window[a])||(b=document.getElementById(a));return b};
infosoftglobal.FusionChartsUtil.updateChartXML=function(a,b){var c=infosoftglobal.FusionChartsUtil.getChartObject(a);c.SetVariable("_root.dataURL","");c.SetVariable("_root.isNewData","1");c.SetVariable("_root.newData",b);c.TGotoLabel("/","JavaScriptHandler")};
var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject,updateChartXML=infosoftglobal.FusionChartsUtil.updateChartXML,FusionCharts=infosoftglobal.FusionCharts,documentEventManager={evts:{},docs:[],eventList:[],addEvent:function(a,b){var c=this.get(b),d=a.toString()+"_"+b.toString();if(c){for(var c=0,e=this.eventList.length;c<e;c++)if(this.eventList[c][0]===d)return;this.eventList.push([d,a,b])}},delEvent:function(a,b){var c=this.get(b),d=a.toString()+"_"+b.toString();if(c)for(var c=0,e=
this.eventList.length;c<e;c++)this.eventList[c][0]===d&&this.eventList.splice(c,1)},register:function(a,b){this.evts[a]=b},unregister:function(a){delete this.evts[a]},get:function(a){return this.evts[a]||!1},isDocument:function(a){return typeof Document!="undefined"?a instanceof Document:typeof a=="object"&&a.body?!0:!1},isVisibilityDocument:function(a){if(a)try{if(a.visibilityState)return a.visibilityState=="hidden"?!1:!0;if(a.webkitVisibilityState)return a.webkitVisibilityState=="visible";if(a.mozHidden!=
void 0)return!a.mozHidden;if(a.hidden!=void 0)return!a.hidden;if(a.body.isDisabled!=void 0)return!a.body.isDisabled}catch(b){}return!1},filterDoc:function(){if(this.docs.length)for(var a=0;a<this.docs.length;a++)this.isVisibilityDocument(this.docs[a])||this.docs.splice(a,1)},addDoc:function(a){for(var b=!1,c=0,d=this.docs.length;c<d;c++)this.docs[c]==a&&(b=!0);b||this.docs.push(a);this.bind()},bind:function(){var a,b,c;if(this.docs.length&&this.eventList.length){this.unbind();this.filterDoc();for(var d=
0,e=this.docs.length;d<e;d++)for(var f=0,g=this.eventList.length;f<g;f++)if(b=this.eventList[f][1],a=this.eventList[f][2],c=this.get(a),b&&a&&c)try{EV.observe(this.docs[d],b,c,!1)}catch(h){}}},unbind:function(a){function b(a){for(var b,d,h,j=0,n=c.eventList.length;j<n;j++)if(d=c.eventList[j][1],b=c.eventList[j][2],h=c.get(b),d&&b&&h)try{EV.stopObserving(a,d,h,!1)}catch(k){}}var c=this;if(a)b(a);else for(var a=0,d=this.docs.length;a<d;a++)b(this.docs[a])}};
function Home(){this.name=gConst.home;this.host=null;this.templatePrefix="custom_home_";this.datas={}}
Home.prototype={initialize:function(){GMC.initialize(this.name,this)},init:function(a,b,c){b=b||{};CC.syncMailData();this.host=a;this.mergeData(b);this.update();documentEventManager&&a.document&&documentEventManager.addDoc(a.document);typeof this.loadedCallback=="function"&&this.loadedCallback(this);if(c)this.loadHomeData(c),this.childDocument=c;this.registerHostEvents(c)},getFormatDate:function(a){var b=a.getMonth()-0+1,b=b<10?"0"+b:b,c=a.getDate()-0;return a.getFullYear()+"-"+b+"-"+(c<10?"0"+c:
c)},registerHostEvents:function(a){var b=jQuery("#custom_home_corp_notice",a);if((a=jQuery("#custom_home_recent_sch",a))&&a.size()>0)if(b&&b.size()>0){var c=function(a){var b=!1;return function(){return b||(b=a.bindCalData(a.childDocument))}}(this);a.bind("click",function(){c()})}else this.bindCalData(this.childDocument)},bindCalData:function(a){var b=this,c=b.getFormatDate(new Date),d=new Date,d=d.setDate(d.getDate()+30),d=b.getFormatDate(new Date(d)),c={data:Util.varToXml(null,{comeFrom:0,startDate:c,
endDate:d,maxCount:0},"\n").substr(1)+"\n\n",method:"post",resType:"json",failCall:function(a){console.log(a)},encode:"gb2312"};parent.CC.requestWebApi(gMain.urlCal+"/s?func=calendar:getRecentCalendarView&sid="+gMain.sid,function(c){jQuery("#custom_home_recent_tab",a)[0].innerHTML=b.getCalHtml(c)},c);return!0},goCal:function(){top.location.href=parent.gMain.urlCal+"/index.do?sid="+parent.gMain.sid},getCalHtml:function(a){if(!a)return"";var b=a["var"],a=a.table,c='<div class="timeLinewrap">';c+='<a href="javascript:void(0)" onClick="parent.MM[parent.gConst.home].goCal()" class="more">\u67e5\u770b\u6240\u6709\u65e5\u7a0b&gt;&gt;</a>';
c+='<div class="timeline-container"><div class="timeline"></div></div>';c+="";var d=10,e=5,f;for(f in b){var g=b[f];if(g&&g.info)for(var h=0;h<g.info.length;h++){e-=1;if(e<0||d>160)return c+="</div>",c+="</div>",c+="</div>",c;h==0&&(c+='<div class="brick" style="top:'+d+'px; left:115px;">',c+='<div class="brick-date">'+this.getCalDay(f)+"</div>",c+='<em class="arrow"></em>',c+='<div class="brick-inner">',d+=23);var j=a[g.info[h]],n=j.startTime.toString().length,k=j.startDate.split("-"),q=j.endDate.split("-"),
t="",u=new Date(j.startDate.replace(/-/g,"/")),s=new Date(f.replace(/-/g,"/")),r=new Date;k.length==3&&q.length==3&&(t=r>u?s.getMonth()-0+1+"\u6708"+s.getDate()+"\u65e5 "+j.startTime.toString().substring(0,n-2)+":"+j.startTime.toString().substring(n-2,4):k[1]+"\u6708"+k[2]+"\u65e5 "+j.startTime.toString().substring(0,n-2)+":"+j.startTime.toString().substring(n-2,4),t+="-"+q[1]+"\u6708"+q[2]+"\u65e5 "+j.endTime.toString().substring(0,n-2)+":"+j.endTime.toString().substring(n-2,4));c+='<div class="clist">';
c+='<p class="time">'+t+"</p>";c+='<i class="i-welcalendar"></i><span style="padding-left: 5px;">'+j.title+"</span>";c+="</div>";d+=20}c+="</div>";c+="</div>"}c+="</div>";e==5&&(c='<div class="timeLinewrap">',c+='<div style="padding: 93px 20px 40px 220px;position: relative;height: 8px;overflow: hidden;margin-right: 20px;">\u60a8\u8fd8\u6ca1\u6709\u5b89\u6392\u6d3b\u52a8\uff0c\u9a6c\u4e0a\u53bb<a href="javascript:void(0)" onClick="parent.MM[parent.gConst.home].goCal()" >\u521b\u5efa\u6d3b\u52a8</a></div>',
c+="",c+="</div>");return c},getCalDay:function(a){if(!a)return"";var b=new Date(a.replace(/-/g,"/")),c=new Date,d=new Date,e=d.setDate(c.getDate()+1),d=d.setDate(c.getDate()+2);if(c.toLocaleDateString()==b.toLocaleDateString())return"\u4eca\u5929";else if((new Date(e)).toLocaleDateString()==b.toLocaleDateString())return"\u660e\u5929";else if((new Date(d)).toLocaleDateString()==b.toLocaleDateString())return"\u540e\u5929";e=a.split("-");return b.getYear()-c.getYear()!=1&&e.length==3?e[1]+"\u6708"+
e[2]+"\u65e5":a},loadHomeData:function(a){var b=CM.folderMain[gConst.dataName],c=jQuery("#custom_home_topTips",a)[0];if(c){c.innerHTML="";c.innerHTML+='<a style="display:none;" id="custom_home_newMailCount_a" href="javascript:void(0);" onClick="parent.CC.goFolder(1, parent.GE.folderObj.inbox); return false;">\u6536\u4ef6\u7bb1\uff08<var class="col_orange" id="custom_home_newMailCount_sys1">Loading</var>\uff09</a>';for(var d=0;d<b.length;d++){var e=b[d];if(e.fid>9&&(e.type==3||e.type==6)){var f=e.stats.unreadMessageCount;
if(f-0>0){var g=a.createElement("a");g.setAttribute("fid",e.fid);g.setAttribute("folderPassFlag",e.folderPassFlag);g.setAttribute("href","javascript:void(0);");g.onclick=function(){var a=jQuery(this)[0].getAttribute("fid");if(jQuery(this)[0].getAttribute("folderPassFlag")=="1"&&parent.gMain.lock_close){var b={};b.obj=jQuery("#"+a);b.p=this;b.id=id;b.url=function(){parent.CC.goFolder(a,"user"+a)};folderlock.unlocked(0,"leftLock",b)}else parent.CC.goFolder(a,"user"+a)};g.innerHTML=e.name+'\uff08<var class="col_orange">'+
f+"</var>\uff09</a>";c&&c.appendChild(g)}}}if(b=jQuery("#custom_home_newMailCount_sys1",a)[0])c=parent.MM[gConst.folderMain].Folders.sys[0].stats.unreadMessageCount,a=jQuery("#custom_home_newMailCount_a",a),c-0>0?a.show():a.hide(),b.innerHTML=c}},getData:function(){return this.datas},setData:function(a){if(typeof a=="object")this.datas=a},updateCallback:function(){this.loadedCallback()},gatherData:function(){var a=this.datas,b=CC.getMailInfo(),c;for(c in b)a[c]=b[c];try{var d=new Date;c="";parent.lastLoginCity&&
parent.lastLoginCity!=""&&parent.lastLoginIp&&(c=parent.lastLoginCity+" ("+parent.lastLoginIp+")");a.lastLoginTime=parent.lastLoginTime;a.lastLoginIp=c;a.timeWord=this.getWelcome(d);var e=b.totalSize,e=e.replace(" ","");if(e=="UNLIMITED")a.isUNLIMITED=Lang.Mail.Unlimited,a.unlimitedPlaceholder=""}catch(f){}},getWelcome:function(a){var a=a.getHours(),b=parent.Lang;return a<6?b.Mail.home_Hello_0:a<9?b.Mail.home_Hello_1:a<12?b.Mail.home_Hello_2:a<14?b.Mail.home_Hello_3:a<17?b.Mail.home_Hello_4:a<19?
b.Mail.home_Hello_5:a<22?b.Mail.home_Hello_6:b.Mail.home_Hello_7},mergeData:function(a){if(typeof a=="object")for(var b in a)if(typeof a[b]=="string"||typeof a[b]=="number")this.datas[b]=a[b]},getHtml:function(){var a=this.getUrl(GC.userType),b=[];b[b.length]=CC.getIframe(this.name,a,"auto");return b.join("")},getUrl:function(){return gConst.mailHomeUrl},update:function(){this.gatherData();this.replaceTemplate();this.updateCallback();this.setHeight()},replaceTemplate:function(){var a=this.host;if(a&&
a.document&&a.document.body){var a=a.document,b,c;try{for(var d in this.datas){b=this.templatePrefix+d;c=this.datas[d];if(d=="totalSize"&&(this.datas.totalSize&&this.datas.totalSize.indexOf("G")>=0&&parseInt(this.datas.totalSize,10)>=200||this.datas.limitMessageSize=="UNLIMITED"))c=Lang.Mail.Unlimited||"\u65e0\u9650\u5bb9\u91cf";if(a.getElementById(b))a.getElementById(b).innerHTML=c}}catch(e){}}if(b=jQuery("#ifrm_home").contents().find(".gwel-info p")[0]){b.style.wordWrap="break-word";b.style.overflow=
"hidden";b.innerHTML=" <i class='i-symail' style='position: relative;margin-bottom: 3px;'></i><a href='javascript:void(0)' style='font-size: 14px; font-weight:200; margin-right:8px; width:auto;' onclick='parent.MM.home.receiveMail();return false;'>\u60a8\u6709<var id='custom_home_unreadMessageCount'>loading</var>\u5c01\u65b0\u90ae\u4ef6</a>";d=CM.folderMain[gConst.dataName];for(a=c=0;a<d.length;a++){var f=d[a];f.stats.unreadMessageCount>0&&f.type!=6&&f.folderColor==0&&f.fid!=4&&(c+=f.stats.unreadMessageCount)}if(a=
jQuery("#ifrm_home").contents().find("#custom_home_unreadMessageCount")[0])a.innerHTML=c;c=0;for(var g="",h="",a=0;a<d.length;a++)f=d[a],f.stats.unreadMessageCount>0&&f.type==6&&(c>0?(c++,h+="  <a href='javascript:void(0)' style='font-size: 14px; font-weight:200; margin-right:15px;' onclick='parent.CC.searchNewMail("+f.fid+", true, undefined, undefined);return false;'>"+f.name+"(&nbsp;"+f.stats.unreadMessageCount+"&nbsp;)</a>"):(c++,g+="  <a href='javascript:void(0)' style='font-size: 14px; font-weight:200; margin-right:15px;' onclick='parent.CC.searchNewMail("+
f.fid+", true, undefined, undefined);return false;'>"+f.name+"(&nbsp;"+f.stats.unreadMessageCount+"&nbsp;)</a>"));b.innerHTML+=c>2?g+"<a href='javascript:void(0)' class='showhide' style='color:#999999; font-size: 10px; font-weight:100; margin-left:-12px;' id='ssd' onclick='parent.MM.home.showhide(this);return false;'>\u663e\u793a\u66f4\u591a&gt;&gt;</a><span style='word-wrap:break-word; display:none'>   "+h+"</span>":g+h;c=jQuery("#ifrm_home").contents().find(".gwel-info p").height();if(c<70)jQuery("#ifrm_home").contents().find(".gwel-info p")[0].style.marginBottom=
"10px",jQuery("#ifrm_home").contents().find(".gwel-info")[0].style.height="110px";else if(c>70)jQuery("#ifrm_home").contents().find(".gwel-info")[0].style.height="auto",jQuery("#ifrm_home").contents().find(".gwel-info")[0].style.minHeight="110px",jQuery("#ifrm_home").contents().find(".gwel-info p")[0].style.marginBottom="10px"}},showhide:function(a){if(jQuery(a).next()[0].style.display=="inline"){if(a.innerHTML="\u663e\u793a\u66f4\u591a&gt;&gt;",jQuery(a).next()[0].style.display="none",a=jQuery("#ifrm_home").contents().find(".gwel-info p").height(),
a<70)jQuery("#ifrm_home").contents().find(".gwel-info p")[0].style.marginBottom="10px",jQuery("#ifrm_home").contents().find(".gwel-info")[0].style.height="110px"}else if(jQuery("#ifrm_home").contents().find(".gwel-info p > span").css({display:"none"}),jQuery("#ifrm_home").contents().find(".gwel-info p > .showhide").css("color","#CCC").html("\u663e\u793a\u66f4\u591a&gt;&gt;"),a.innerHTML="\u9690\u85cf&lt;&lt;",jQuery(a).next()[0].style.display="inline",a=jQuery("#ifrm_home").contents().find(".gwel-info p").height(),
a>70)jQuery("#ifrm_home").contents().find(".gwel-info")[0].style.height="auto",jQuery("#ifrm_home").contents().find(".gwel-info")[0].style.minHeight="110px",jQuery("#ifrm_home").contents().find(".gwel-info p")[0].style.marginBottom="10px"},receiveMail:function(){parent.CC.getPageSize();var a={read:1},b=2;parent.GE.currentFid=0;parent.GE.searchFlag=a;for(var b=typeof b=="undefined"?2:b,c=parent.GE.list.order,d=parent.CC.getPageSize(),a={fid:0,order:c,desc:1,recursive:0,condictions:null,flags:a,total:d,
start:1,ignoreCase:0,isSearch:1,statType:1,isFullSearch:b,exceptFids:[4]},b=CM.folderMain[gConst.dataName],c=[],d=0;d<b.length;d++){var e=b[d];console.log(e.label);if(e.stats.unreadMessageCount>0&&e.type==6)c[c.length]=e.fid}a.exceptFids=c;parent.GE.searchKey="";parent.GE.searchData=a;parent.CC.searchMail(a,!1)},resize:function(){this.setHeight()},setHeight:function(){function a(){var c=CC.docHeight()-GE.pos()[1];if(c>0){var d=GMC.getFrameObj(b.name);El.height(d,c)}else window.setTimeout(a,200)}var b=
this;a()},loadedCallback:function(){if(this.host){var a=this.host.document;parent.MM[parent.gConst.home].doc=a;var b=this.datas.usedPercent||0;b.indexOf("%")&&b.replace(/%/ig,"");a&&this.loadHomeData(this.childDocument)}},closeVolumeTips:function(){var a=parent.MM[parent.gConst.home].objMarqueeContent.contentItem,b=a.length,c,d;if(b>0){for(var e=0;e<b;e++)if(c=jQuery(a[e]).find("a[id='closeVolume2']")[0]){d=e;break}c&&a.splice(d,1);a.length==0&&jQuery("#top_tips_container",parent.MM[parent.gConst.home].doc).hide();
parent.MM[parent.gConst.home].objMarqueeContent.refresh()}},setUserQuestion:function(){top.location.href=gMain.webPath+"/se/account/accountindex.do?sid="+gMain.sid+"&mode=PassSec"}};myFolder=[];
var LM={FIDS:"search,inbox,drafts,sent,del,spam,virus".split(","),folders:[],selectFolderId:GC.check("MAIL_WELCOME")?-10:0,loadService:function(){try{try{GE.oLinks=leftMenu_data,LM.serviceCallback()}catch(a){ch("LM.loadService.callback",a)}}catch(b){ch("LM.loadService",b)}},serviceCallback:function(){function a(a,b){El.removeChildNodes(b);a.each(function(a,c){var g=GE.oLinks.service[c];if(g&&(GC.userNumber.substring(GC.userNumber.indexOf("@")+1),!(b.id=="ulService"&&c!="otheraddr")))for(var h=LM.addLink({id:g.id,
text:g.text,url:g.url,isoutlink:g.isoutlink,isnewwin:g.isnewwin,isbold:g.isbold,isred:g.isred,hasSub:g.submenu.length>0?!0:!1,parentNode:b,attr:{text:g.attr,call:g.attrclick}},{li:g.icon},b),j=0,n=g.submenu.length;j<n;j++){var k=g.submenu[j];k.icon=j+1==n?"last":"";LM.addLink({id:k.id,text:k.text,url:k.url,isoutlink:k.isoutlink,isnewwin:k.isnewwin,isred:k.isred,isbold:k.isbold,hasSub:g.submenu.length>0,attr:{text:k.attr,attrclick:k.atrclick}},{li:k.icon},h)}})}a(GE.oLinks.order.other,$(gConst.menuC.service));
var b=GE.oLinks.order.sms;b.length>0&&!GC.checkModule(GC.module.sms)?a(b,$(gConst.menuC.sms)):$(gConst.menuT.sms).style.display="none";b=GE.oLinks.order.mms;b.length>0&&!GC.checkModule(GC.module.mms)?a(b,$(gConst.menuC.mms)):$(gConst.menuT.mms).style.display="none";b=GE.oLinks.order.fax;b.length>0&&!GC.checkModule(GC.module.fax)?a(b,$(gConst.menuC.fax)):$(gConst.menuT.fax).style.display="none"},reRender:function(){document.body.style.zoom=1.1;document.body.style.zoom=""},addLink:function(a,b,c,d){function e(a,
b){var c="span_"+LM.selectFolderId;b=="-1"||b=="-2"||b=="ulMailFunc"||(c=b=="leftFolderContainer_-2"?"span_-4":"span_-3");if(jQuery("#"+c)){var d=document.getElementById("ContexMenuContainer");d&&El.remove(d);if(typeof GE.evts=="undefined")GE.evts={};GE.evts.contexMenu=null;c=new ContexMenu({currentMenuName:c,e:a,passFlag:C});c.show(a);GE.evts.contexMenu=c;f()}EV.stopEvent(a)}function f(){documentEventManager&&(documentEventManager.register("hideContextMenu",function(){typeof GE.evts!="undefined"&&
GE.evts&&GE.evts.contexMenu&&(GE.evts.contexMenu&&GE.evts.contexMenu.hide(),delete GE.evts.contexMenu)}),documentEventManager.addEvent("click","hideContextMenu"),documentEventManager.addDoc(document))}function g(a,b,c){c=="after"?b.appendChild(a):c=="before"&&(b.childNodes.length>0?b.insertBefore(a,b.childNodes[0]):b.appendChild(a))}function h(a,b,c,d,e,f){if(b){var h=El.createElement("a"),g="action";d!=""&&(g+=" "+d);h.className=g;if(d=="add"){g=Lang.Mail.folder_NewFolder;switch(f){case -2:g=Lang.Mail.label_NewLabel;
break;case -6:g="\u6dfb\u52a0\u4ee3\u6536\u90ae\u7bb1"}h.title=g;h.style.right="22px"}if(d=="")h.title=Lang.Mail.folder_Empty;h.href="javascript:fGoto();";h.innerHTML=b;if(c)h.onclick=typeof c=="function"?function(){c();return!1}:function(){eval(c);return!1};a.appendChild(h);if(d!=""&&GC.check("MAIL_CONFIG_FOLDER")){h=El.createElement("a");g="manage";d!=""&&(g+=" "+d);h.className=g;h.title=f==-6?"\u7ba1\u7406\u4ee3\u6536\u90ae\u7bb1":Lang.Mail.folder_AdminFolder;h.href="javascript:fGoto();";h.innerHTML=
b;if(e)h.onclick=typeof e=="function"?function(){e();return!1}:function(){eval(c);return!1};a.appendChild(h)}}}function j(a){for(;;){var b;b=a;if(b.indexOf("$")>-1){var c=void 0,d=void 0,c=b.indexOf("$"),d=b.indexOf("$",c+1);if(d<0)throw"menu format error!";b=b.substring(c+1,d)}else b="";if(b!="")c=GC.getCookie(b),a=a.replace("$"+b+"$",c);else return a}}var n=a.id,k=a.text,q=a.url,t=a.isoutlink,u=a.isnewwin,s=a.isred,r=a.isbold,w=a.hasSub,x=a.action,z=a.actionClick,y=a.parentNode,v=a.attr,G=b.li,
F=b.a,b=a.pos||"after",H=v.actionClass||"",C=a.passFlag,E=null,A=null,D=null,B=El.createElement("li");B.id=n;if(!w&&G)B.className=G;else if(c)B.className="last";else if(n<0){if(n<-1E3)B.className="line"}else if(w)B.className="folderSub";if(n==0||a.type<3)B.onmouseout=function(){El.removeClass(this,"mailFolderListColor")},B.onmouseover=function(){this.className.indexOf("selectFolder_li")==-1&&El.addClass(this,"mailFolderListColor")},B.onclick=function(){LM.selectFolderId=this.id},n==LM.selectFolderId&&
(B.className+=" selectFolder_li");if(n<0&&n>-1E3||w)D=El.createElement("i"),D.title=Lang.Mail.Hide,D.className=n<0?"i-folderOff":"i-folderOn",D.style.left=18+12*d+"px",D.onmouseover=function(){jQuery(this).next()[0].className.indexOf("selectFolder_li")==-1&&jQuery(this).next().addClass("mailFolderListColor")},B.appendChild(D);if(a.type==3||a.type==5||a.type===6||n==-1||n==-2||n===-6){d=d||0;A=El.createElement("span");A.className="mailFolder-span tf";if(LM.selectFolderId==n)A.className="mailFolder-span tf selectFolder_li";
A.style.paddingLeft=n==-1||n==-2||n===-6?"22px":a.type==5?"22px":33+14*d+"px";A.onmouseout=function(){El.removeClass(this,"mailFolderListColor")};A.onmouseover=function(){this.className.indexOf("selectFolder_li")==-1&&El.addClass(this,"mailFolderListColor")}}else A=El.createElement("span");A.title=k.decodeHTML();A.href="javascript:fGoto();";A.id="span_"+n;d="";switch(a.id){case 9999997:d="<i class='m20 mr_5'></i>";break;case 9999996:d="<i class='qm_ico_Lstar mr_5'></i>";break;default:d=a.type==5?
"<i class='i-colorsquare mr_5 "+gConst.labelColor[a.folderColor]+"'></i>":""}A.innerHTML=d+"<span class='tf' style=\"display: inline-block;"+(a.type===6&&/msie 6/i.test(navigator.userAgent)&&CC.countStrlength(k)>80?"width: 80px;":"")+'vertical-align: middle;max-width: 80px;">'+k.encodeHTML()+"</span>";(n=="-1"||n=="-2")&&EV.observe(A,"contextmenu",function(a){LM.selectFolderId=jQuery(A).parent()[0].id;e(a,n)},!1);if(typeof gMain.hasPassFlag=="undefined"&&C)gMain.hasPassFlag=!0;if(typeof gMain.lock_close==
"undefined")gMain.lock_close=!0;if(a.status&&a.status.unreadMessageCount&&C&&parseInt(a.status.unreadMessageCount)>0)gMain.hasLock_unReadMail=!0;if(C&&gMain.lock_close)a=El.createElement("a"),a.className="add lockico",B.appendChild(a),gMain.first_locked_id=n;w&&F?A.className=F+" mailFolder-span":A.className+=" leftFolder-FolderName";if(k==Lang.Mail.folder_MyFolder||k==Lang.Mail.label_MyLabel||k===Lang.Mail.ConfigJs.popMailFolder){D.title=Lang.Mail.Show;D.style.left="7px";t=CM.folderMain[gConst.dataName];
d=F=0;G=!1;for(a=0;a<t.length;a++){var I=t[a];if(I.fid>9&&(k==Lang.Mail.folder_MyFolder&&I.type==3||k==Lang.Mail.label_MyLabel&&I.type==5||k==Lang.Mail.ConfigJs.popMailFolder&&I.type===6))G=!0,F+=I.stats.unreadMessageCount,d+=I.stats.messageCount}if(!G)D.style.display="none";if(F>0)A.innerHTML='<span class="tag_txt">'+k+'</span><span class="count" style="display: inline-block;vertical-align : middle;" id=\'myMailFoderCount_span\'><a title="'+Lang.Mail.unreadmailCount_AllCount.format(F,d)+'"  style="display:inline-block;vertical-align:middle;padding-left:5px;font-weight:bold">(<em id=\'myMailFoderCount\'>'+
F+"</em>)</a></span>";A.onclick=function(){LM.showOrHiddenMyLabel(E,D,B)}}else if(typeof q=="function")A.onclick=function(){if(C&&gMain.lock_close){var a={};a.obj=jQuery("#"+LM.selectFolderId);a.p=this;a.id=n;a.url=q;folderlock.unlocked(0,"leftLock",a)}else{jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li");LM.selectFolderId=jQuery(this).parent()[0].id;if(n==0)LM.selectFolderId=0,jQuery("#0").attr("class","selectFolder_li");q()}},EV.observe(A,"contextmenu",function(a){LM.selectFolderId=
A.parentNode.getAttribute("id");var b=A.parentNode.parentNode.getAttribute("id"),c=CM.folderMain[gConst.dataName];if(c&&c.length>0)for(var d=0;d<c.length;d++)LM.selectFolderId==c[d].fid&&b!="leftFolderContainer_-6"&&e(a,b)},!1);else if(q.trim()!="")A.onclick=t?function(){MM.goOutLink(j(q.trim()),n,k);return!1}:function(){eval(q.trim());GE.currentFolder=n};if(u)A.target="id",A.onclick=function(){EV.stopPropagation()},A.href=j(q.trim());s&&El.setStyle(A,{color:"red"});r&&El.setStyle(A,{fontWeight:"bold"});
n>-1E3&&B.appendChild(A);(function(a,b){if(b&&b.id&&b.text!=""){var c=b.call,d=El.createElement("span",b.id,"count");d.href="javascript:fGoto();";d.innerHTML=b.text;if(c)d.onclick=typeof c=="function"?function(a){if(!C||!gMain.lock_close)return c(),EV.stopEvent(a),!1}:function(){eval(c);return!1};a.appendChild(d)}})(A,v);(!(n===4||n===5)||GC.check("MAIL_INBOX_DELETE"))&&h(B,x,z,H,q,n);if(w){D.className=myFolder[B.id]&&myFolder[B.id]=="show"?"i-folderOn":"i-folderOff";E=El.createElement("ul");E.style.display=
"none";u=B.id;if(u==-1||u==-2||u==-6)u=0;t=CM.folderMain[gConst.dataName];for(a=0;a<t.length;a++)if(t[a].fid>9&&t[a].parentId==u){E.style.display=myFolder[B.id]&&myFolder[B.id]=="show"?"":"none";break}B.appendChild(E);g(B,y,b);n<0?(E.id="leftFolderContainer_"+n,E.setAttribute("rel",n),E.className="left_folder_container"):E.className=c?"fList2":"fList1";D.onclick=function(){LM.showOrHiddenMyLabel(E,D,B)};return E}g(B,y,b);return B},loadFolderInfo:function(a){function b(a){MM.initModule(gConst.folder);
var b=a.fid||0,c=a.parentId||0,d=CC.getFolderTypeName(a.type),j=d+b,n=LM.FIDS,k="",k=b<GE.maxFolder?n[b]||"":"",n=a.name;if(!MM[j]){var q=MM[gConst.folder];MM[j]={};Object.extend(MM[j],q)}var q=MM[j],t=b>0?gConst.func.listMail:gConst.func.searchMail;CC.getPageSize();q.fid=b;q.parentId=c;q.type=d;q.text=n;q.name=j;q.icon=k;q.isFolder=!0;q.inited=!0;q.isLoaded=!1;q.stats=a.stats||{};q.func=t;q.order=GE.list.order;q.desc=1;q.data={start:1,order:GE.list.order,desc:1,fid:b,norefreshSid:window.nsid!==void 0?
window.nsid:0,total:CC.getPageSize(),sessionEnable:b==1?gMain.sessionMode:"0"};q.call=function(a){MM.loadModuleData(j,a)};q.limit=CC.getPageSize()}try{if(a){var c=CM.folderMain[gConst.dataName];if(!c||Util.getVarType(c)!="array")return;c.each(function(a,c){b(c)});b({fid:"0",type:1,name:Lang.Mail.search_Result,stats:MM[GE.folderObj.search]?MM[GE.folderObj.search].stats:{}});CC.power.offRestoreDeleted()&&b({fid:7,type:1,name:"\u5df2\u5f7b\u5e95\u5220\u9664 ",stats:{attachmentNum:0,messageCount:0,messageSize:0,
unreadMessageCount:0,unreadMessageSize:0}})}LM.isLoaded?MM.goTo("folderMain","refreshBody",0):(MM.goTo("folderMain","refreshBody",0),this.loadDefaultData(),LM.loadModule())}catch(d){ch("LM.loadFolderInfo",d)}},loadFolderMain:function(a,b,c){var d={stats:1,type:0};if(c)d.password=c;MM.mailRequest({func:gConst.func.listFolder,data:d,call:function(c){function d(){CM[gConst.folderMain]=c;for(var f=LM.FIDS,h=window.CorpFolders||{},j=CM[gConst.folderMain]["var"],n=0;n<j.length;n++){var k=j[n],q=h[f[k.fid]],
t=Lang.Mail["folder_"+k.fid];if(t)k.name=q||t}LM.loadFolderInfo(a);typeof b=="function"&&b()}MM.mailRequestApi({func:"global:sequential",data:{items:[{func:"mbox:searchMessages","var":{fid:0,order:"receiveDate",desc:1,recursive:0,condictions:[],flags:{meetingFlag:1},total:20,start:1,ignoreCase:0,isSearch:1,isFullSearch:2,exceptFids:[2,4,5,8,10]}},{func:"user:getPOPAccounts","var":{}},{func:"mbox:searchMessages","var":{fid:0,order:"receiveDate",desc:1,recursive:0,condictions:[],flags:{signed:1},total:20,
start:1,ignoreCase:0,isSearch:1,isFullSearch:2,exceptFids:[2,3,4,5,8]}},{func:"mbox:searchMessages","var":{fid:0,order:"receiveDate",desc:1,recursive:0,condictions:[],flags:{starFlag:1},total:20,start:1,ignoreCase:0,isSearch:1,isFullSearch:2,exceptFids:[4]}}]},call:function(a){LM.folders.length=0;if(GC.check("MAIL_VAS_MEETING"))CC.addFolderItem(c["var"],{fid:9999999,location:31800,name:"\u4f1a\u8bae\u9080\u8bf7",type:5,flag:{meeting:1}}),c["var"][c["var"].length-1].stats.messageCount=a["var"][0].stats.messageCount,
c["var"][c["var"].length-1].stats.unreadMessageCount=a["var"][0].stats.unreadMessageCount;TaskMail.addMenuItem(c);if(CC.checkConfig("mailPOP"))for(var b=0;b<c["var"].length;b++)for(var j=0;j<a["var"][1]["var"].length;j++)if(c["var"][b].folderColor===0&&c["var"][b].name===a["var"][1]["var"][j].folderName&&c["var"][b].type!==1)c["var"][b].type=6,c["var"][b].popMailId=a["var"][1]["var"][j].id,c["var"][b].userName=a["var"][1]["var"][j].username;if(CC.power.offSensMail())CC.addFolderItem(c["var"],{fid:9999997,
location:31800,name:"\u654f\u611f\u90ae\u4ef6",type:5,flag:{signed:1}}),c["var"][c["var"].length-1].stats.messageCount=a["var"][2].stats.messageCount,c["var"][c["var"].length-1].stats.unreadMessageCount=a["var"][2].stats.unreadMessageCount;if(CC.power.offStarMail())CC.addFolderItem(c["var"],{fid:9999996,location:31800,name:"\u661f\u6807\u90ae\u4ef6",type:5,flag:{starFlag:1}}),c["var"][c["var"].length-1].stats.messageCount=c.totalStarCount,c["var"][c["var"].length-1].stats.unreadMessageCount=a["var"][3].stats.unreadMessageCount;
d();CC.removeFolderItem(MM[gConst.folderMain].Folders.label);CC.removeFolderItem(MM[gConst.folderMain].Folders.sys);CC.removeFolderItem(CM[gConst.folderMain]["var"])},failCall:d,param:"&from=webapp"})},param:"&norefreshSid="+(window.nsid!==void 0?window.nsid:0)+"&sessionEnable="+gMain.sessionMode})},freshFolderMain:function(a,b,c){LM.loadFolderMain(b||!1,a,c)},getAllFolders:function(a){LM.loadFolderMain(!0,function(){LM.isLoaded=!0},a)},changeDiv:function(a){var b=gConst.menuT,c=gConst.menuC,d=null,
e=null,f;for(f in b)d=$(b[f]),e=$(c[f]),f==a?(d.className="on",e.style.display=""):(d.className="",e.style.display="none")},loadModule:function(){var a=GC.getUrlParamValue(location.href+"&rnd","module"),b={inbox:CC.goInbox,compose:CC.compose,address:CC.goAddress},c=[];a&&(a=a.toLowerCase(),c=a.split(","),c.each(function(a,c){if(typeof b[c]=="function")try{b[c]()}catch(f){}}));CC.zoomTip(jQuery,document);jQuery("#ifrm_home").load(function(){CC.zoomTip(jQuery,jQuery(this)[0].contentWindow.document)});
window.setTimeout(function(){try{if((!lastLoginTime||lastLoginTime=="")&&GC.getCookie(gMain.sid+"isFirstLogin")!="false"&&CC.IsEnableNoviceWizard()&&gMain.firstloginGuide=="true")new NoviceWizard,GC.setCookie(gMain.sid+"isFirstLogin","false","/","",0)}catch(a){}},10)},freshNewMail:function(){var a=gMain.freshFolderTime||5;a*=6E4;var b=function(){var a=CC.getMailInfo().unreadMessageCount-0-extralData.unreadMessageCount;if(a>0){if(typeof GE.evts=="undefined")GE.evts={};if(!GE.evts.mt)a=new MarqueeTitle("\u6536\u5230 {0} \u5c01\u65b0\u90ae\u4ef6\uff01".format(a)),
a.speed=500,a.run(),GE.evts.mt=a}};window.setInterval(function(){window.nsid=1;if(typeof extralData=="undefined")window.extralData={};var a=CC.getMailInfo();extralData.unreadMessageCount=a.unreadMessageCount||0;LM.freshFolderMain(b,!0);MM[GE.folderObj.inbox]&&MM[GE.folderObj.inbox].inited&&MM[GE.folderObj.inbox].refresh(!1)},a)},loadDefaultData:function(){this.showMail(function(){try{if(GC.getUrlParamValue(window.location.href,"opType")=="goUnRead")MM.createModule("home"),CC.searchNewMail(0,!0);else if(window.gMain&&
gMain.welcomePage)switch(parseInt(gMain.welcomePage)){case 1:MM.createModule("home");MM.laterRequestModule=gConst.home;break;case 2:CC.goFolder(1,"sys1");break;case 3:CC.searchNewMail(0,!0);break;default:window.IsOA==1?CC.searchNewMail(0,!0):CC.goFolder(1,"sys1")}else window.IsShowWelcome?(MM.createModule("home"),MM.laterRequestModule=gConst.home):window.IsOA==1?CC.searchNewMail(0,!0):CC.goFolder(1,"sys1")}catch(a){ch("LM.loadDefaultDataCallBack",a)}})},showMail:function(a){$("pageLoading").style.display=
"none";$("container").style.display="";$("accountbar").style.display="";MM.mainResize();typeof a=="function"&&a()},init_simple:function(){try{El.ready(function(){try{LM.checkLock()}catch(a){LM.initMethodes()}})}catch(a){ch("LM.init_simple",a)}},initMethodes:function(){LM.getAllFolders();LM.freshNewMail();LM.initBindPhone();Main.initMailMoveStatus();LM.registerDocEvents()},checkLock:function(){function a(){LM.oaInterval&&clearInterval(LM.oaInterval);LM.oaInterval=window.setInterval(LM.getOATip,3E5)}
var b=null,b=null;(new OptionBase).ajaxRequest(gConst.func.checkFolder,{type:"check"},function(){gMain.lock_close=!1;LM.initMethodes();LM.getOATip();a()},function(){LM.initMethodes();LM.getOATip();a()},mailPOP.getUrl(gConst.func.checkFolder))},getOATip:function(){var a=jQuery;MM.doService({url:"/workflow.do",func:"workflow:getBizMessageCount",data:{messageType:2},failCall:function(){},call:function(b){var c=b["var"];if(b&&b.code=="S_OK")b=parseInt(c.totals)+parseInt(c.waitCheck),gMain.oaTotals=parseInt(c.totals),
gMain.waitCheck=parseInt(c.waitCheck),a("#oaNumTip").html(b)},param:""})},initBindPhone:function(){if(parseInt(window.binding_reminder,10)===1){var a="";aTag="";wo=null;window.gMain&&gMain.webPath&&gMain.sid&&(a=gMain.webPath+"/se/account/accountindex.do?sid="+gMain.sid+"&mode=Mobile");a&&(wo=function(){window.location.href=a});CC.alert('<p style="padding-bottom:5px; font-size:14px;">\u60f3\u8981\u6536\u5230\u65b0\u90ae\u4ef6\u901a\u77e5\uff0c\u53ca\u65f6\u67e5\u9605\u56de\u590d\u90ae\u4ef6\u5417\uff1f</p><p style="padding-bottom:5px; font-size:14px;">\u60f3\u8981\u514d\u8d39\u53d1\u8d77\u591a\u4eba\u7535\u8bdd\u4f1a\u8bae\u5417\uff1f</p><p style="padding-bottom:5px; font-size:14px;">\u8d76\u7d27\u8fdb\u7ed1\u5b9a\u624b\u673a\u53f7\u7801\u5427~</p>',
wo);a&&jQuery("#divDialogClosealertbtn_0").find("span").find("span").html("\u7acb\u5373\u7ed1\u5b9a")}},initPWDtip:function(){if(!(window.LoginType==gConst.loginType.pm||window.LoginType==gConst.loginType.mm)){var a=jQuery,b="",c="",d=function(){CC.setConfig("password")},e=!1,f=function(){e&&MM.doService({url:"/mail/conf",func:"mail:setPwdModifyTime",data:"",failCall:function(){},call:function(){},param:""})};if(typeof isPwdModified!="undefined"&&!isPwdModified)c=Lang.Mail.Write.welLogMail,b="<p style='font-size:13px;color: #333333; padding:5px 0 5px'>"+
Lang.Mail.Write.sugModPwd+"<p>",CC.alert(b,d,Lang.Mail.Write.welLogMail),a(".topborder").css("text-align","center"),a("#divDialogClosealertbtn_0  span span").text(Lang.Mail.Write.modImmediatly),a("#divDialogClosealertbtn_0").removeClass("mt_8"),a(".boxIframeBtn").css("background","#ffffff"),a(".topborder").css("borderTop","none");else if(pwdExpiredDate!=-1)c=Lang.Mail.Write.niceTip,b="<p style='font-size:13px;color: #333333; padding:5px 0 5px'>  "+Lang.Mail.Write.pwdlongTimeNoMod+"</p>",CC.confirm(b,
function(){CC.setConfig("password")},c,f),a("#divDialogCloseconfirmbtn_0>span>span").text(Lang.Mail.Write.modYourpwd),a("#divDialogCloseconfirmbtn_1>span>span").text(Lang.Mail.Write.prv_lbt_close),a("#noRemind").click(function(){e=a(this).attr("checked")=="checked"?!0:!1}),a("#divDialogCloseconfirmbtn_0").bind("click",f)}},init:function(){try{window.onload=function(){LM.getAllFolders();LM.freshNewMail();LM.registerDocEvents();LM.getOATip()}}catch(a){ch("LM.init",a)}},registerDocEvents:function(){documentEventManager&&
(documentEventManager.register("stopMarqueeTitle",function(){typeof GE.evts!="undefined"&&GE.evts&&GE.evts.mt&&(GE.evts.mt.stop(),delete GE.evts.mt)}),documentEventManager.addEvent("click","stopMarqueeTitle"),documentEventManager.addDoc(document))},showOrHiddenMyLabel:function(a,b,c){var d=a.style.display=="none";b.title=d?Lang.Mail.Hide:Lang.Mail.Show;b.className=d?"i-folderOn":"i-folderOff";a.style.display=d?"":"none";myFolder[c.id]=d?"show":"enable";this.reRender();EV.stopEvent()}};
function getChangedFrames(){var a=[];jQuery('[tabid^="compose"]').each(function(){var b=jQuery(this).attr("tabid"),b=jQuery("#ifrm_"+b)[0].contentWindow,c=!1;if(b&&b.oWrite&&jQuery.type(b.oWrite.dispose)=="function"){b.oWrite.dispose();try{c=b.oWrite.checkChange()}catch(d){}c&&a.push({type:"mail",window:b})}});jQuery('[tabid^="outLink_meeting"]').each(function(){var b=jQuery(this).attr("tabid"),b=jQuery("#ifrm_"+b)[0].contentWindow;b.Meeting.isChanged()&&a.push({type:"meeting",window:b})});jQuery('[tabid^="outLink_sms"]').each(function(){var b=
jQuery(this).attr("tabid"),b=jQuery("#ifrm_"+b)[0].contentWindow;jQuery("#RichInputBoxID",b.document).text()+jQuery("#sms_content",b.document).val()!=""&&a.push({type:"sms",window:b})});jQuery('[tabid^="outLink_mms"]').each(function(){var b=jQuery(this).attr("tabid"),b=jQuery("#ifrm_"+b)[0].contentWindow;jQuery("#mms_text",b.document).val();b.MMS.isChanged()&&a.push({type:"mms",window:b})});return a}
function closeAllConfirm(a){var b=getChangedFrames();if(b.length==0)a();else if(b.length>1)parent.CC.confirm("\u60a8\u8fd8\u6709\u672a\u5b8c\u6210\u7f16\u8f91\u64cd\u4f5c\uff0c\u662f\u5426\u8981\u7acb\u5373\u8df3\u8f6c\uff1f",a);else if(b.length==1)switch(b[0].type){case "mail":parent.CC.confirm("\u5173\u95ed\u5199\u4fe1\u9875\uff0c\u672a\u4fdd\u5b58\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u662f\u5426\u5173\u95ed\uff1f",a);break;case "meeting":parent.CC.confirm("\u73b0\u5728\u79bb\u5f00\u5df2\u7f16\u8f91\u7684\u4f1a\u8bae\u9080\u8bf7\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u662f\u5426\u786e\u8ba4\u5173\u95ed\uff1f",
a);break;case "sms":parent.CC.confirm("\u73b0\u5728\u79bb\u5f00\u5df2\u7f16\u8f91\u7684\u77ed\u4fe1\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u662f\u5426\u786e\u8ba4\u5173\u95ed\uff1f",a);break;case "mms":parent.CC.confirm("\u73b0\u5728\u79bb\u5f00\u5df2\u7f16\u8f91\u7684\u5f69\u4fe1\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u662f\u5426\u786e\u8ba4\u5173\u95ed\uff1f",a)}}
jQuery(document).on("click","a",function(a,b){var c=this;if(window.VBArray&&/^\s*javascript/g.test(jQuery(this).attr("href")))return!1;this.href.substring(0,4)=="http"&&jQuery(this).attr("href").substring(0,1)!="#"&&!b&&getChangedFrames().length!=0&&(a.preventDefault(),closeAllConfirm(function(){beforeunloadConfirm=!1;location.href=c.href}))});jQuery(function(){beforeunloadConfirm=!0;jQuery(window).bind("beforeunload",function(){var a=getChangedFrames();if(beforeunloadConfirm&&a.length>0)return"--------------------------------------------------\n\u63d0\u793a\uff1a\u672a\u4fdd\u5b58\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\u3002\n--------------------------------------------------"})});
var Main={dropSelectFolder:null,dropSelectTime:null,dropSelectReadStatus:null,curSelectedLi:0,liList:null,searchKeyStr:"",init:function(){Main.initLoad()},initLoad:function(){Main.initSearch();control_Init();Main.initAdvSearchHTML();Main.initHideAdvSearch();Main.initControl();Main.initAdvSearch();Main.initAdvEvent()},initMailMoveStatus:function(){GC.check("MAIL_VAS_MOVE")==1&&gMain.mailMoveEnable=="1"&&MM.mailRequestApi({func:"user:queryMoveStatus",data:{},call:function(a){a["var"]&&a["var"].length>
0?a["var"][0].status==0&&a["var"][0].fromUser==""&&Main.showMailMoveDiv():Main.showMailMoveDiv()},failCall:function(){}})},initHideAdvSearch:function(){EV.observe(window.document,"click",Main.doHideAdvSearch)},doHideAdvSearch:function(){Main.IsShowAdvSearch||Main.HideAdvDiv();Main.IsShowAutoSearch&&Main.HideAdvAutoDiv();Main.IsShowAdvSearch=!1;Main.IsShowAutoSearch=!0},showMailMoveDiv:function(a){var b=this,c=[],d=90,e=133,f=Lang.Mail.ConfigJs.MailMove_Title;c.push('<div style="padding:20px 0 30px 40px">');
c.push("    {0};<br />".format(Lang.Mail.ConfigJs.MailMove_StratMove));typeof langconf!="undefined"&&c.push((Lang.Mail.ConfigJs.MailMove_importMail+"<br />").format(langconf.pre_crop_mail));c.push("\t{0}:<br />".format(Lang.Mail.ConfigJs.MailMove_inputUser));if(!window.gMain||!gMain.domain||!gMain.popAccountType||!parseInt(gMain.popAccountType,10))c.push("</br>"),d=110,e=145;c.push('    {0}\uff1a<input type="text" id="txtOldMail" style="width:150px" maxlength="50" class="text" value=""/><br /><br />'.format(Lang.Mail.ConfigJs.MailMove_oldMail));
c.push('    {0}\uff1a<input type="password" id="txtOldMailPwd" style="width:150px" maxlength="50" class="text" value=""/>'.format(Lang.Mail.ConfigJs.MailMove_oldPwd));c.push("</div>");CC.showDiv(c.join(""),function(){var c=$("txtOldMail").value.trim(),f=$("txtOldMailPwd").value.trim(),j="";b.toolTip_MailMoveUser=new ToolTips({id:"toolTip_MailMoveUser",direction:ToolTips.direction.Top,top:d,left:112});b.toolTip_MailMovePwd=new ToolTips({id:"toolTip_MailMovePwd",direction:ToolTips.direction.Top,top:e,
left:112});if(!c)return b.toolTip_MailMoveUser.show($("txtOldMail"),Lang.Mail.Write.pleaseInputAddr),!0;userId=top.gMain?top.gMain.uid:"";userId.indexOf("@")>-1&&(userId=userId.substring(0,userId.indexOf("@")));j=c.substring(0,c.indexOf("@"));if(gMain.openMailMove!="1"&&j!==userId)return b.toolTip_MailMoveUser.show($("txtOldMail"),Lang.Mail.Write.pleaseInputAccount+userId+"@xxx.com"),!0;if((!window.gMain||!gMain.popAccountType||!parseInt(gMain.popAccountType,10))&&!Vd.checkData("email",c))return b.toolTip_MailMoveUser.show($("txtOldMail"),
Lang.Mail.Write.pleaseInputCorrentAddr),!0;if(!f)return b.toolTip_MailMovePwd.show($("txtOldMailPwd"),Lang.Mail.Write.pInputPwd),!0;f={func:"user:startMove",data:{type:"start",corpId:gMain.corpid-0,fromUser:c.toLowerCase(),toUser:gMain.userNumber,fromPwd:f},call:function(b){jQuery("#divDialogCloseconfirmbtn_1").click();a?a(b,c):(b="{0}/se/mail/move/mailmove.do?sid={1}".format(gMain.webPath,gMain.sid),CC.goOutLink(b,"move",Lang.Mail.ConfigJs.MailMove_Title))},failCall:function(d){var e=d.code,f;f=
"";if(e=="FA_BAD_PASSWORD")f=Lang.Mail.Write.pwdWrong;else if(e=="FA_XXXX_EXISTS")f=Lang.Mail.Write.hasMoved;if(e!="S_OK")if(e=="FA_BAD_PASSWORD")return b.toolTip_MailMovePwd.show($("txtOldMailPwd"),f),!0;else if(e=="FA_XXXX_EXISTS")return b.toolTip_MailMoveUser.show($("txtOldMail"),f),!0;jQuery("#divDialogCloseconfirmbtn_1").click();a?a(d,c):(d="{0}/se/mail/move/mailmove.do?sid={1}&code={2}&user={3}".format(gMain.webPath,gMain.sid,d.code,c),CC.goOutLink(d,"move",Lang.Mail.ConfigJs.MailMove_Title))}};
MM.mailRequestApi(f);return!0},f);jQuery("#txtOldMail").focus()},initAdvSearchHTML:function(){var a=[],b=[];a.push('<div id="seacrchContent" class="searchContent searchContentOn">');a.push('<input type="text" class="searchInput" id="txtAdvSearch">');a.push('<span class="searchLeft">');a.push("</span>");a.push('<span class="searchRight " id="btnAdvSearch">');a.push("</span>");a.push("</div>");a.push('<div class="menuPop mailSearchboolBar hide" id="divSearchAutoComplete">');a.push("<ul>");a.push('<li id="searchMail" name="mail"><a href="javascript:fGoto();"><i class="i_s_mail"></i><span>');
a.push(Lang.Mail.AdvSearch_AutoFill_Contain);a.push('<strong id="strMail" class="strOpt"></strong>');a.push("\u7684\u90ae\u4ef6");a.push("</span></a></li>");a.push('<li id="searchMailSend" name="mailSend"><a href="javascript:fGoto();" style="padding-left: 33px;"><span class="col999">');a.push("\u53d1\u4ef6\u4eba\uff1a");a.push('<strong class="strOpt"></strong>');a.push("</span></a></li>");a.push('<li id="searchMailRev" name="mailRev"><a href="javascript:fGoto();" style="padding-left: 33px;"><span class="col999">');
a.push("\u6536\u4ef6\u4eba\uff1a");a.push('<strong class="strOpt"></strong>');a.push("</span></a></li>");a.push('<li id="searchMailSubject" name="mailSubject"><a href="javascript:fGoto();" style="padding-left: 33px;"><span class="col999">');a.push("\u4e3b\u9898\uff1a");a.push('<strong class="strOpt"></strong>');a.push("</span></a></li>");gMain.ftsFlag&&GC.check("MAIL_MANAGER_FTR")&&(a.push('<li id="searchAll" name="all"><a href="javascript:fGoto();" style="padding-left: 33px;"><span class="col999">'),
a.push("\u5168\u6587\u68c0\u7d22\uff1a"),a.push('<strong id="strAll" class="strOpt"></strong>'),a.push("</span></a></li>"));a.push('<li id="searchAttr" name="attr" {0}>'.format('style="display:none"'));a.push('<a href="javascript:fGoto();"><i class="i_s_arr"></i><span>');a.push(Lang.Mail.AdvSearch_AutoFill_Contain);a.push('<strong id="strAttr" class="strOpt"></strong>');a.push(Lang.Mail.AdvSearch_AutoFill_Attr);a.push("</span></a></li>");a.push('<li class="line"></li>');a.push('<li id="btn_AdvSearch"><a href="javascript:fGoto();"><span >');
a.push(Lang.Mail.AdvSearch);a.push("</span></a></li>");a.push("</ul>");a.push("</div>");b.push('<div class="advSearchpop hide" id="divAdvSearch">');b.push('<a class="i_u_close" href="#"></a>');b.push("<fieldset>");b.push('<legend class="hide">{0}</legend>'.format(Lang.Mail.AdvSearch));b.push('<ul class="form">');b.push('<li class="formLine">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_InTheFolder));b.push('<div class="element"  id="div_dropSelect_Folder">');b.push("</div>");
b.push("</li>");b.push('<li class="formLine">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_Subject));b.push('<div class="element">');b.push('<input type="text" value="" id="advtxtSubject" class="iText">');b.push("</div>");b.push("</li>");b.push('<li class="formLine">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_From));b.push('<div class="element">');b.push('<input type="text" value="" id="advtxtFrom" class="iText">');b.push("</div>");
b.push("</li>");b.push('<li class="formLine">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_To));b.push('<div class="element">');b.push('<input type="text" value="" id="advtxtTo" class="iText">');b.push("</div>");b.push("</li>");b.push('<li class="formLine" id="litxtContent">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_Content));b.push('<div class="element">');b.push('<input type="text" value="" id="advtxtContent" class="iText">');b.push("</div>");
b.push("</li>");b.push('<li class="formLine" id="litxtAttr">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_Attr));b.push('<div class="element">');b.push('<input type="text" value="" id="advtxtAttr" class="iText">');b.push("</div>");b.push("</li>");b.push('<li class="formLine">');b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_TimeRange));b.push('<div class="element" id="div_dropSelect_Time">');b.push("</div>");b.push("</li>");b.push('<li class="formLine">');
b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_ReadOrUnread));b.push('<div class="element" id="div_dropSelect_ReadStatus">');b.push("</div>");b.push("</li>");CC.isLabelMail()&&(b.push('<li class="formLine" id="litxtLabel">'),b.push('<ul class="form" style="padding:0">'),b.push('<li class="formLine">'),b.push('<label class="label">{0}\uff1a</label>'.format(Lang.Mail.AdvSearch_MailLabel)),b.push('<div class="element"  id="div_dropSelect_Label">'),b.push("</div>"),b.push("</li>"));
b.push('<li class="formLine">');b.push('<label class="label">&nbsp;</label>');b.push('<div class="element">');b.push('<label><input type="checkbox" id="advCheckedAttr" class="mr5"> {0}</label>'.format(Lang.Mail.AdvSearch_Attached));b.push("</div>");b.push("</li>");b.push('<li class="formLine">');b.push('<label class="label">&nbsp;</label>');b.push('<div class="element">');b.push('<a class="n_btn_on" id="btnAdvSearchOk" href="javascript:fGoto();"><span><span>{0}</span></span></a>'.format(Lang.Mail.AdvSearch_OK));
b.push('<a class="n_btn ml_5" id="btnAdvSearchCancel" href="javascript:fGoto();"><span><span>{0}</span></span></a></div>'.format(Lang.Mail.AdvSearch_Cancel));b.push("</li>");b.push("</ul>");b.push("</fieldset>");b.push("</div>");jQuery("#advSeacrch_HTMLDiv").html(a.join(""));jQuery(document.body).append(b.join(""))},OnAdvSearch:function(){MM.mailRequest({func:"user:setAttrs",data:{fts_flag:1},call:function(){gMain.ftsFlag=1;Main.searchKeyStr="\u90ae\u4ef6\u641c\u7d22";$("txtAdvSearch").value=Main.searchKeyStr;
jQuery("#txtAdvSearch").removeAttr("style");jQuery("#li_advSearchOn").hide();jQuery("#litxtAttr").show();jQuery("#litxtContent").show();if($("openRetrieval1"))$("openRetrieval1").checked=!0;CC.showMsg(Lang.Mail.advSearch_OnOk,!0,!1,"option")},failCall:function(){CC.showMsg(Lang.Mail.advSearch_OnNo,!0,!1,"option")}})},initControl:function(){var a=this;a.dropSelectTime=new DropSelect({id:"indexDropTime",data:[{text:Lang.Mail.AdvSearch_Unlimited,value:"0"},{text:Lang.Mail.AdvSearch_InOneDays,value:"1d"},
{text:Lang.Mail.AdvSearch_InThreeDays,value:"3d"},{text:Lang.Mail.AdvSearch_InOneWeek,value:"1w"},{text:Lang.Mail.AdvSearch_InTwoWeek,value:"2w"},{text:Lang.Mail.AdvSearch_InOneMonth,value:"1m"},{text:Lang.Mail.AdvSearch_InTwoMonth,value:"2m"},{text:Lang.Mail.AdvSearch_InSixMonth,value:"6m"},{text:Lang.Mail.AdvSearch_InOneYear,value:"1y"},{text:Lang.Mail.Write.customDefined,value:"customTime"}],type:"",itemClick:function(b){b=="customTime"?(a.initItemClick("customTime"),jQuery("#customtimesetting").show()):
a.initItemClick("other")},selectedValue:"0",width:262});jQuery("#div_dropSelect_Time").html(a.dropSelectTime.getHTML());a.dropSelectTime.loadEvent();a.selectType="";a.dropSelectReadStatus=new DropSelect({id:"indexDropReadStatus",data:[{text:Lang.Mail.AdvSearch_Unlimited,value:"2"},{text:Lang.Mail.AdvSearch_Read,value:"0"},{text:Lang.Mail.AdvSearch_Unread,value:"1"}],type:"",selectedValue:"2",width:262});jQuery("#div_dropSelect_ReadStatus").html(a.dropSelectReadStatus.getHTML());a.dropSelectReadStatus.loadEvent()},
initItemClick:function(a){a=="customTime"?this.initItemClick_custom():a=="other"&&this.initItemClick_other()},initItemClick_other:function(){jQuery("#drop_select_indexDropTime").css("width","262px");this.selectType="selectOther";document.getElementById("customtimesetting")&&(jQuery("#customtimesetting").remove(),jQuery(".ui-date").remove())},initItemClick_custom:function(){jQuery("#drop_select_indexDropTime").css("width","65px");var a=[],b=new Date,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),
f=c+Lang.Mail.Write.lb_timesend_year+d+Lang.Mail.Write.lb_timesend_month+e+Lang.Mail.Write.lb_timesend_day;b.setDate(b.getDate()-30);var g=b.getFullYear()+Lang.Mail.Write.lb_timesend_year+(b.getMonth()+1)+Lang.Mail.Write.lb_timesend_month+b.getDate()+Lang.Mail.Write.lb_timesend_day;a.push('<span id="customtimesetting" style="">');a.push('<span id="starttime" style="display:inline-block; width:86px;margin-left: 5px;">');a.push('<input class="txt" id="starttimeinput" readonly type="text" value="'+g+
'" ');a.push('style="width:84px;" readonly="readonly"  ');a.push(' year="2013" month="4" day="23">');a.push('</span><span style="padding:0 4px">'+Lang.Mail.Write.to+'</span><span id="endtime" style="display:inline-block; width:86px">');a.push('<input class="txt" id="endtimeinput" type="text" value="'+f+'" ');a.push('style="width:84px;" readonly="readonly" ');a.push(' year="2013" month="4" day="10">');a.push("</span></span>");document.getElementById("customtimesetting")?(jQuery("#starttimeinput").val(g),
jQuery("#endtimeinput").val(f)):jQuery("#drop_select_indexDropTime").after(a.join(""));this.startDate=parseInt(b.getTime()/1E3);this.endDate=parseInt((new Date(c,d-1,e)).getTime()/1E3);this.textStart=g;this.textEnd=f;this.selectType="selectCustomTime";this.initDatePicker()},initDatePicker:function(){var a=this;a.initedPicker=!0;a.pickerStart=new CCalendar("#starttimeinput",{onSelect:function(b){var c=parseInt(b.yyyy,10),d=parseInt(b.mm,10),b=parseInt(b.dd,10);dateStart=(new Date(c,d-1,b)).getTime()/
1E3;a.textStart=jQuery("#starttimeinput").val();a.selectDate=c+Lang.Mail.Write.lb_timesend_year+d+Lang.Mail.Write.lb_timesend_month+b+Lang.Mail.Write.lb_timesend_day;return!0},onSelectBack:function(){jQuery("#starttimeinput").val(a.selectDate).attr({year:void 0,month:NaN,ddate:void 0});return!0}});a.pickerEnd=new CCalendar("#endtimeinput",{onSelect:function(b){var c=parseInt(b.yyyy,10),d=parseInt(b.mm,10),b=parseInt(b.dd,10);dateEnd=(new Date(c,d-1,b)).getTime()/1E3;a.textEnd=jQuery("#endtimeinput").val();
a.selectDate=c+Lang.Mail.Write.lb_timesend_year+d+Lang.Mail.Write.lb_timesend_month+b+Lang.Mail.Write.lb_timesend_day;return!0},onSelectBack:function(){jQuery("#endtimeinput").val(a.selectDate).attr({year:void 0,month:NaN,ddate:void 0});return!0}});jQuery(".ui-date").css("zIndex","2000")},goUrl:function(a){Vd.checkUrl(a)&&window.open(a)},initSearch:function(){var a=Lang.Mail.search_SearchMail,b=$(gConst.txtSearch);$("btnSearch");b.value=a;GC.initText(b);b.onkeyup=function(a){EV.getEvent(a);EV.getCharCode()==
13&&CC.searchMailByTop(b)};b.onblur=function(){if(this.value.trim()=="")this.value=a};b.onclick=function(){if(this.value==a&&(this.value="",this.createTextRange)){var b=this.createTextRange();b.moveStart("character",this.value.length);b.collapse();b.select()}}},getWap:function(){var a=GC.getCookie("SMSServer");a+="/Lang/WebSMS/SendWapPush.aspx?sid="+GC.sid;CC.showMsg(Lang.Mail.other_getingWapUrl);GC.getScript("getWapPush",a,function(){typeof sReturnValue=="object"?CC.alert(sReturnValue.returnMsg):
CC.alert(Lang.Mail.other_getWapUrlError);CC.hideMsg()})},logout:function(){CC.confirm(Lang.Mail.sys_ConfirmLogoff,Main.doLogout)},doLogout:function(){if(window.gMain&&gMain.urlAdmin)try{jQuery.ajax({type:"GET",url:gMain.urlAdmin+"/login/logout.do?sid="+gMain.sid,data:{},success:function(){GC.top.location.href=gConst.logoutUrl},error:function(){GC.top.location.href=gConst.logoutUrl},dataType:"json"})}catch(a){GC.top.location.href=gConst.logoutUrl}else GC.top.location.href=gConst.logoutUrl},doSessionOut:function(){GC.top.location.href=
gConst.sessionoutUrl},UpdateSelectedClass:function(a,b){if(b=="on"){jQuery(a).addClass("on");var c=jQuery(a).find("i");c.attr("class",c.attr("class")+"_on")}else jQuery(a).removeClass("on"),c=jQuery(a).find("i"),c.length>0&&c.attr("class",c.attr("class").replace("_on",""))},initAllSearchDivWidth:function(){var a=jQuery;CC.isOA()&&(CC.isBigFont()?(a("#advSeacrch_HTMLDiv").css({width:348}),a("#advSeacrch_HTMLDiv div").css({width:270}),a("#divSearchAutoComplete").css({width:310,left:18})):(a("#advSeacrch_HTMLDiv").css({width:256}),
a("#advSeacrch_HTMLDiv div").css({width:206}),a("#divSearchAutoComplete").css({width:248,left:3})));a("#divSearchAutoComplete").css({width:340,left:-1});a("#advSeacrch_HTMLDiv").css({top:40});a("#divAdvSearch").css({top:"68px",right:"10px"})},initAdvSearch:function(){Main.searchKeyStr=gMain.ftsFlag=="0"||!GC.check("MAIL_MANAGER_FTR")?Lang.Mail.search_SearchMail:"\u90ae\u4ef6\u641c\u7d22";var a=$(gConst.txtAdvSearch),b=$("btnAdvSearch"),c=$("btnAdvSearchCancel"),d=$("btnAdvSearchOk"),e=$("btn_AdvSearch"),
f=$("divAdvSearch"),g=$("divSearchAutoComplete"),h=this;a.value=Main.searchKeyStr;this.initAllSearchDivWidth();Main.ShowAdvSearchDom();var j=0,n=gMain.ftsFlag,k=function(){h.liList&&Main.UpdateSelectedClass(h.liList[h.curSelectedLi],"");j=0;h.liList=jQuery(g).children().find("li[id]");h.liList.each(function(){if(j==0)Main.UpdateSelectedClass(this,"on"),h.curSelectedLi=0;jQuery(this).attr("index",j);j++;this.onmouseover=function(){Main.UpdateSelectedClass(h.liList[h.curSelectedLi],"");Main.UpdateSelectedClass(this,
"on");h.curSelectedLi=jQuery(this).attr("index").toInt()};if(this.id!="btn_AdvSearch")this.onclick=function(){var a=jQuery(this).attr("name");if(a)b.onclick(a)}})};k();a.onkeyup=function(c){if(!this.value||this.value==Main.searchKeyStr)jQuery(this).removeAttr("style"),jQuery(b).attr("class","searchRight"),Main.HideAdvAutoDiv();else{jQuery(this).attr("style","color: black;");Main.ShowAdvSearchDom();if(n!=gMain.ftsFlag)n=gMain.ftsFlag,k();jQuery(b).attr("class","searchEnter");Main.ShowAdvAutoDiv();
$("strMail");$("strAttr");var d=$("strAll");if(d)d.innerHTML=a.value.encodeHTML();jQuery("#divSearchAutoComplete .strOpt").html(a.value.encodeHTML());Main.HideAdvDiv()}jQuery("#divSearchAutoComplete").css("left","1");EV.getEvent(c);if(EV.getCharCode()==13){if(c=h.liList[h.curSelectedLi])if(c=jQuery(c).attr("name"))b.onclick(c);else e.onclick();else b.onclick("quick");Main.IsShowAdvSearch=!1}else if(EV.getCharCode()==40){Main.UpdateSelectedClass(h.liList[h.curSelectedLi],"");if(h.curSelectedLi==h.liList.length-
1)h.curSelectedLi=-1;h.curSelectedLi++;(c=h.liList[h.curSelectedLi])&&Main.UpdateSelectedClass(c,"on")}else if(EV.getCharCode()==38){Main.UpdateSelectedClass(h.liList[h.curSelectedLi],"");if(h.curSelectedLi==0)h.curSelectedLi=h.liList.length;h.curSelectedLi--;(c=h.liList[h.curSelectedLi])&&Main.UpdateSelectedClass(c,"on")}};a.onfocus=function(){jQuery("#advSeacrch_HTMLDiv").addClass("focusCol")};a.onblur=function(){jQuery("#advSeacrch_HTMLDiv").removeClass("focusCol");this.value.trim()==""?(this.value=
Main.searchKeyStr,jQuery(this).removeAttr("style")):jQuery(this).attr("style","color: black;")};a.onclick=function(){if(this.value==Main.searchKeyStr){if(this.value="",this.createTextRange){var a=this.createTextRange();a.moveStart("character",this.value.length);a.collapse();a.select()}}else this.value&&(Main.ShowAdvSearchDom(),Main.ShowAdvAutoDiv());jQuery(this).attr("style","color: black;");Main.IsShowAutoSearch=!1};b.onclick=function(b){if(!a.value||a.value==Main.searchKeyStr)Main.LoadDropHTML(),
Main.ShowAdvSearchDom(),Main.ShowAdvDiv(),Main.IsShowAdvSearch=!0,Main.initAdvEvent();else{var c=[],d=a.value.trim(),e=2;GE.isFullSearch=2;if(b=="mail")c.push({field:"subject",operator:"contains",value:d}),c.push({field:"from",operator:"contains",value:d}),c.push({field:"to",operator:"contains",value:d});else if(b==="mailSubject")c.push({field:"subject",operator:"contains",value:d});else if(b==="mailSend")c.push({field:"from",operator:"contains",value:d});else if(b==="mailRev")c.push({field:"to",
operator:"contains",value:d});else if(b=="attr"){gMain.IsAttachSearch=d.encodeHTML();if(document.getElementById("attachList_AllCount"))GE.tab.active(gConst.attachList,!0),MM[gConst.attachList].getFilter("attachName",d);else{if(MM[gConst.attachList].data)MM[gConst.attachList].data.filter={attachName:d};CC.goAttachList()}Main.HideAdvAutoDiv();return}else if(b=="addr"){CC.goOutLink(gConst.personalAddrUrl+"&keyVal={0}&op=key".format(encodeURI(d.encodeHTML())),"addr",Lang.Mail.Write.addrList);Main.HideAdvAutoDiv();
return}else if(b=="disk"){b=[];b.push("{");b.push("'key':'"+d+"',");b.push("'diskType':0,");b.push("'isSubDir':0,");b.push("'isViewFolder':1,");b.push("'curPage':1,");b.push("'pageSize':20");b.push("}");d=gMain.sid;b=escape(b.join(""));CC.goOutLink(gMain.webPath+"/se/disk/indexdisk.do?sid={0}&data={1}".format(d,b),"disk",Lang.Mail.Write.cabinet);Main.HideAdvAutoDiv();return}else if(b=="content")c.push({field:"content",operator:"contains",value:d}),e=1,GE.isFullSearch=1;else if(b=="all"){if(c.push({field:"subject",
operator:"contains",value:d}),c.push({field:"from",operator:"contains",value:d}),c.push({field:"to",operator:"contains",value:d}),c.push({field:"attachContent",operator:"contains",value:d}),gMain.ftsFlag=="1")c.push({field:"content",operator:"contains",value:d}),c.push({field:"attachName",operator:"contains",value:d}),e=1,GE.isFullSearch=1}else c.push({field:"subject",operator:"contains",value:d}),c.push({field:"from",operator:"contains",value:d}),c.push({field:"to",operator:"contains",value:d});
if(gMain.ftsFlag=="0")e=2,GE.isFullSearch=2;Main.HideAdvAutoDiv();GE.approachSearchData={};CC.advSearchMailByTop(a,c,{},e);Main.HideAdvDiv()}};d.onclick=function(){Main.AdvSearchOnClick()};c.onclick=function(){Main.HideAdvDiv();h.clearData()};e.onclick=function(){Main.LoadDropHTML();Main.ShowAdvSearchDom();Main.ShowAdvDiv();Main.IsShowAdvSearch=!0;Main.initAdvEvent()};f.onclick=function(){Main.IsShowAdvSearch=!0};g.onclick=function(){Main.IsShowAutoSearch=!1}},initAdvEvent:function(){var a=jQuery,
b=a("#advCheckedAttr");a("#advtxtAttr").keyup(function(){a(this).val().trim().length!==0?b.attr("checked",!0):b.attr("checked",!1)})},AdvSearchOnClick:function(){var a=Util.str2Num(this.dropSelectFolder.getValue()),b=this.dropSelectTime.getValue(),c=Util.str2Num(this.dropSelectReadStatus.getValue()),d=CC.isLabelMail()&&Util.str2Num(this.dropSelectLabel.getValue()),e=jQuery("#advtxtSubject").val(),f=jQuery("#advtxtFrom").val(),g=jQuery("#advtxtTo").val(),h=jQuery("#advtxtContent").val(),j=jQuery("#advtxtAttr").val(),
n=$("advCheckedAttr").checked,k="",q=new Date,t=function(a,b){var c;a=="1d"?c=Util.DateAdd("d",-1,b).getTime()/1E3:a=="3d"?c=Util.DateAdd("d",-3,b).getTime()/1E3:a=="1w"?c=Util.DateAdd("w",-1,b).getTime()/1E3:a=="2w"?c=Util.DateAdd("w",-2,b).getTime()/1E3:a=="1m"?c=Util.DateAdd("m",-1,b).getTime()/1E3:a=="2m"?c=Util.DateAdd("m",-2,b).getTime()/1E3:a=="6m"?c=Util.DateAdd("m",-6,b).getTime()/1E3:a=="1y"&&(c=Util.DateAdd("y",-1,b).getTime()/1E3);return Util.str2Num(c,0)};this.selectType=="selectCustomTime"?
function(){var a=jQuery("#starttimeinput").val().trim(),b=a.substring(0,a.indexOf(Lang.Mail.Write.lb_timesend_year)),c=a.substring(a.indexOf(Lang.Mail.Write.lb_timesend_year)+1,a.indexOf(Lang.Mail.Write.lb_timesend_month)),a=a.substring(a.indexOf(Lang.Mail.Write.lb_timesend_month)+1,a.indexOf(Lang.Mail.Write.lb_timesend_day)),c=parseInt(c,10)-1;k=(new Date(parseInt(b),parseInt(c),parseInt(a))).getTime()/1E3}():k=t(b,q);b=[];t={};GE.isFullSearch=0;e&&b.push({field:"subject",operator:"contains",value:e});
f&&b.push({field:"from",operator:"contains",value:f});g&&b.push({field:"to",operator:"contains",value:g});if(h)b.push({field:"content",operator:"contains",value:h}),GE.isFullSearch=1;j&&b.push({field:"attachName",operator:"contains",value:j});if(k){var u="";if(this.selectType=="selectCustomTime"){if(function(){var a=jQuery("#endtimeinput").val().trim(),b=a.substring(0,a.indexOf(Lang.Mail.Write.lb_timesend_year)),c=a.substring(a.indexOf(Lang.Mail.Write.lb_timesend_year)+1,a.indexOf(Lang.Mail.Write.lb_timesend_month)),
a=a.substring(a.indexOf(Lang.Mail.Write.lb_timesend_month)+1,a.indexOf(Lang.Mail.Write.lb_timesend_day)),c=parseInt(c,10)-1,a=parseInt(a,10)+1;u=(new Date(parseInt(b),parseInt(c),parseInt(a))).getTime()/1E3}(),k>u){parent.CC.showMsg(Lang.Mail.Write.pleaseInputRightEndTime,!0,!1,"caution");return}}else u=Util.str2Num(q.getTime()/1E3,0);b.push({field:"sendDate",operator:">",value:k});b.push({field:"sendDate",operator:"<",value:u})}if(n)t.attached=1;if(c!=2)t.read=c;Main.HideAdvDiv();Main.clearData();
CC.advSearchMail(a,b,t,0,d?[d]:null)},clearData:function(){jQuery("#advtxtSubject").val("");jQuery("#advtxtFrom").val("");jQuery("#advtxtTo").val("");jQuery("#advtxtContent").val("");jQuery("#advtxtAttr").val("");jQuery("#advCheckedAttr").attr("checked",!1);this.dropSelectFolder.setValue("0");this.dropSelectTime.setValue("0");this.dropSelectReadStatus.setValue("2")},ShowAdvSearchDom:function(){gMain.ftsFlag=="0"||!GC.check("MAIL_MANAGER_FTR")?(jQuery("#searchAll").hide(),jQuery("#litxtAttr").hide(),
jQuery("#litxtContent").hide()):(jQuery("#searchAll").removeAttr("style"),jQuery("#litxtAttr").show(),jQuery("#litxtContent").show());GC.check("MAIL_VAS_ATT")?jQuery("#searchAttr").show():jQuery("#searchAttr").hide();GC.check("MAIL_MANAGER_FTR")&&gMain.ftsFlag=="0"?jQuery("#li_advSearchOn").show():jQuery("#li_advSearchOn").hide()},ShowAdvAutoDiv:function(){jQuery("#divSearchAutoComplete").attr("class","menuPop mailSearchboolBar");Main.OpSelect()},HideAdvAutoDiv:function(){Main.UpdateSelectedClass(Main.liList[Main.curSelectedLi],
"");Main.curSelectedLi=0;Main.UpdateSelectedClass(Main.liList[Main.curSelectedLi],"on");jQuery("#divSearchAutoComplete").attr("class","menuPop mailSearchboolBar hide");Main.OpSelect()},ShowAdvDiv:function(){jQuery("#divAdvSearch").attr("class","advSearchpop");this.initAdvDropt();Main.OpSelect()},HideAdvDiv:function(){jQuery("#divAdvSearch").attr("class","advSearchpop hide");Main.OpSelect()},initAdvDropt:function(){var a=jQuery;a("#li_indexDropFolder_0")[0].click();a("#li_indexDropTime_0")[0].click();
a("#li_indexDropReadStatus_2")[0].click();a("#advCheckedAttr").attr("checked",!1);a("#advtxtSubject").val("");a("#advtxtFrom").val("");a("#advtxtTo").val("");a("#advtxtContent").val("");a("#advtxtAttr").val("");a("#advtxtFrom").val("")},LoadDropHTML:function(){var a=CC.getFolders([GE.folder.sys,GE.folder.user,GE.folder.pop]);Main.dropSelectFolder=new DropSelect({id:"indexDropFolder",data:a,type:"fileTree",selectedValue:"0",width:262,height:300,folderList:[{text:Lang.Mail.AdvSearch_AllMail,value:"0"}]});
jQuery("#div_dropSelect_Folder").html(Main.dropSelectFolder.getHTML());document.getElementById("customtimesetting")&&jQuery("#customtimesetting").hide();jQuery("#drop_select_indexDropTime").css("width","262px");Main.dropSelectFolder.loadEvent();if(CC.isLabelMail())a=CC.getFolders([GE.folder.label]),Main.dropSelectLabel=new DropSelect({id:"indexDropLabel",data:a,type:"fileTree",selectedValue:"0",width:262,height:300,folderList:[{text:Lang.Mail.label_AllLabel,value:"0"}]}),jQuery("#div_dropSelect_Label").html(Main.dropSelectLabel.getHTML()),
Main.dropSelectLabel.loadEvent()},OpSelect:function(){var a=jQuery("#divAdvSearch").attr("class").indexOf("hide")==-1,b=jQuery("#divSearchAutoComplete").attr("class").indexOf("hide")==-1;if(jQuery.browser.msie&&jQuery.browser.version=="6.0"&&!jQuery.support.style){var c=jQuery("select");(function(){for(var d=0;d<c.length;d++)a||b?jQuery(c[d]).hide():jQuery(c[d]).show()})()}}};function Main_Init(a){try{Frm_Init(),a?LM.init_simple():LM.init(),Main.init(),mailPOP.initAuto()}catch(b){}}
function Mms(){this.name=gConst.mms;this.config={sendMms:{text:Lang.Mail.tb_MMSSend,url:"/CMail/WebMMS/SendMMS/Send.aspx"},Mmsfolder:{text:Lang.Mail.tb_MMSFolder,url:"/CMail/WebMMS/MMSStore/FolderList.aspx"},Mmssign:{text:Lang.Mail.tb_MMSSign,url:"/CMail/WebMMS/MMSSign/SignList.aspx"},Mmstitle:{text:Lang.Mail.tb_MMSTitle,url:"/CMail/WebMMS/MMSTitle/TitleList.aspx"},Mmsrecord:{text:Lang.Mail.tb_MMSRecord,url:"/CMail/WebMMS/MMSHistory/HistoryList.aspx"}};this.configSSO={700:"sendMms",701:"sendMms",
702:"Mmsfolder",703:"Mmssign",704:"Mmstitle",705:"Mmsrecord"}}
Mms.prototype={initialize:function(){GMC.initialize(this.name,this)},getHtml:function(){return'<div id="'+gConst.mainToolbar+this.name+'"></div>'+GMC.getHtml(this.name,this.url)},init:function(){},getToolbar:function(){var a=this,b=a.config,c=[];c[c.length]={name:"sendMms",text:b.sendMms.text,clickEvent:function(b){a.optMms(b);GC.ossHit(8001)},className:"MMSCompose",hasMenu:!1};c[c.length]={name:"Mmsfolder",text:b.Mmsfolder.text,clickEvent:function(b){a.optMms(b);GC.ossHit(8002)},className:"MMSFolder",
hasMenu:!1};c[c.length]={name:"Mmssign",text:b.Mmssign.text,clickEvent:function(b){a.optMms(b);GC.ossHit(8003)},className:"MMSSignature",hasMenu:!1};c[c.length]={name:"Mmstitle",text:b.Mmstitle.text,clickEvent:function(b){a.optMms(b);GC.ossHit(8004)},className:"MMSTitle",hasMenu:!1};c[c.length]={name:"Mmsrecord",text:b.Mmsrecord.text,clickEvent:function(b){a.optMms(b);GC.ossHit(8005)},className:"MMSSent",hasMenu:!1};return c},getToolbarMenu:function(){return[]},resize:function(){this.setDivHeight()},
exit:function(){GMC.gcMem(this.name);return!0},setDivHeight:function(){GMC.setDivHeight(this.name)},getUrl:function(a){var a=a||"sendMms",b=this.config,c="",d="";(d=this.configSSO[a])?(c=b[d].url,d=b[d].text):(c=b[a].url,d=b[a].text);c=GC.getCookie("MMSServer")+"/"+(c||"/CMail/WebMMS/SendMMS/Send.aspx")+"?sid="+GC.getSid();return{url:c,name:d}},setUrl:function(a){return GMC.setUrl(this.name,a)},optMms:function(a){a=this.getUrl(a.name);CC.updateTitleNew(a.name,a.url);this.setUrl(a.url)}};
CC.getMailInfo=function(a){var b=a||messageInfo,c=messageInfo.limitMessageSize,d="0%",e=0,f="",g=b.messageSize,h=b.messageCount,j=MM.folderMain.folderInfo;umc=b.unreadMessageCount;try{if(c==gConst.unlimitedId||c>=214748364800)d="1.0%",e=1;else{d=Number(c-g).div(c);d=Util.str2Num(String(d),4,"str");if((d=="0"||d<1.0E-4)&&h>0)d="0";e=d*100;e==100&&parseInt(h)>0&&(e=99.99);e=Util.str2Num(String(e),2,"str");d+="%"}f=Util.formatSize(c,null,2)}catch(n){d="0%",e=100}b={limitMessageSize:c,limitMessageCount:messageInfo.limitMessageCount,
messageSize:g,messageCount:h,unreadMessageCount:umc,usedPercentBegin:d,userdPercentNum:e,totalSize:f,usedSize:Util.formatSize(g,null,2)};if(j&&(c=j.userdPercentNum,c=Util.str2Num(100-c,2)+"%",b.usedPercent=c,!a))b.usedSize=j.usedSize,b.unreadMessageCount=CC.getUnReadMailCount();return b};
CC.getUnReadMailCount=function(){for(var a=CM.folderMain[gConst.dataName],b=0,c=0;c<a.length;c++)!a[c].virtualFolder&&a[c].type!=5&&a[c].type!=2&&a[c].fid!=2&&a[c].fid!=3&&a[c].fid!=4&&a[c].fid!=5&&a[c].fid!=6&&a[c].fid!=10&&a[c].fid!=11&&(b+=a[c].stats.unreadMessageCount);return b};
CC.setConfig=function(a,b){jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li");jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li");a=a||"index";MM.getModule(gConst.setting);MM[gConst.setting].optSetting(a,b);return!1};CC.goSearch=function(){CC.setConfig("mailSearch")};
CC.goAddress=function(a,b){if(GC.check("CONTACTS"))return jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li"),jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li"),LM.selectFolderId="addr",jQuery("#addr").attr("class","selectFolder_li"),CC.goSSO(a,"address",b,"",!0),!1;else CC.forbidden()};CC.goSms=function(a,b,c){CC.goSSO(a||"601","sms",b,c)};CC.goMms=function(a,b,c){CC.goSSO(a||"701","mms",b,c)};CC.goFax=function(a){CC.goSSO(a||"sendfax","fax")};
CC.goDisk=function(){CC.goOutLink(gMain.webPath+"/se/disk/indexdisk.do?sid="+gMain.sid,"disk",Lang.Mail.Write.folderTransferStation)};
CC.goSSO=function(a,b,c,d,e){var c=c||"",e=e||!1,d=escape(d||""),a=MM.goTo(b,"getUrl",0,a),f=gMain.webPath+"/se"+a.url,f=GC.appendUrl(f,"sid",gMain.sid);if(b=="sms"||b=="mms"||b=="fax")c&&(f+="&mobile="+c),d&&(f+="&msg="+d);b=="setting"&&c&&(f+="&"+c);MM.goTo(b,"setUrl",0,f,e);MM.goTo(b,"url",2,f);MM.goTo(b,"text",2,a.name);MM.getModule(b);CC.updateTitleNew(a.name,f)};
CC.goInbox=function(a){if(GC.check("MAIL_INBOX")){if(LM.selectFolderId!=1)jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li"),LM.selectFolderId=1;MM[GE.folderObj.inbox].isFilter="";CC.showMsg(Lang.Mail.Write.receiving,!1,!1,"loading");MM.getModule(GE.folderObj.inbox);GE.tab.curid==GE.folderObj.inbox?MM.goTo(GE.folderObj.inbox,"refresh",0):(GE.currentFolder=GE.folder.inbox,GE.currentFolderModule=GE.folderObj.inbox,a&&LM.freshFolderMain(null,!1),CC.hideMsg())}else CC.forbidden()};
CC.receiveMail=function(a){CC.searchNewMail(0,!0,void 0,a);LM.freshFolderMain(null,!0);a&&(jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li"),jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li"));if(a&&a.meeting)LM.selectFolderId=9999999,jQuery("#9999999").addClass("selectFolder_li");if(a&&a.task)Folder.taskType=a.task,LM.selectFolderId=9999998,jQuery("#9999998").addClass("selectFolder_li");if(a&&a.signed)LM.selectFolderId=9999997,jQuery("#9999997").addClass("selectFolder_li");
if(a&&a.starFlag)LM.selectFolderId=9999996,jQuery("#9999996").addClass("selectFolder_li")};CC.goFolder=function(a,b,c,d){if(GC.check("MAIL_INBOX")){jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li");jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li");LM.selectFolderId=a;b||(b=MM.getModuleByFid(a));if(MM[b])MM[b].isFilter="";GE.currentFolder=a;GE.currentFolderModule=b;MM.getModule(b,void 0,void 0,d)?MM.goTo(b,"refresh",0):LM.freshFolderMain(null,!0)}else CC.forbidden()};
CC.goFolderMain=function(a){MM.getModule(gConst.folderMain,a);return!1};
CC.goAttachList=function(){if(gMain.IsAttachSearch=="")delete MM[gConst.attachList].data.filter,MM[gConst.attachList].filter={};MM.getModule(gConst.attachList);jQuery("head").append('<link rel="stylesheet" href="'+CC.getResourceAbsoluteURL()+'/css/preview/module/attrview.css" type="text/css" />');jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li");jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li");LM.selectFolderId="attach";jQuery("#attach").attr("class","selectFolder_li")};
CC.previewImg=function(a,b){document.getElementById("ifrmAttach").contentWindow.showImg(a,b)};CC.goDeliver=function(){MM.getModule(gConst.deliver)};CC.getComposeUrl=function(a){a=gConst.composeUrl+"{0}&rnd={1}".format(a||"",GC.gRnd());IsDebug&&(a+="&debug=true");return a};CC.getMeetingUrl=function(a){a=gMain.webPath+"/webtransit.do?sid="+top.gMain.sid+"&func=mail:meeting"+"{0}&rnd={1}".format(a,GC.gRnd());IsDebug&&(a+="&debug=true");return a};
CC.compose=function(a,b,c,d,e){CC.checkNetwork();jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li");LM.selectFolderId=0;var f="";a&&(f+="&to="+a);d&&(f+="&tid="+d);b&&(f+="&msg="+encodeURIComponent(b));e&&(f+="&senderUser="+e);var a=CC.getComposeUrl(f),b=Lang.Mail.tab_Compose,e=-1,f=GE.tab.composeTabs,g=!1,h;for(h in f){var j=CC.isCompose(h);if(j){g=!1;try{GE.tab.active(h),g=j.oWrite.checkChange()}catch(n){}if(!g){e=h;break}}}e==-1&&(e="compose_"+GE.maxComposeId,GE.maxComposeId++);a+="&composeid="+
e;GE.diskFiles[e]=c;d&&(GE.diskFiles[e+"_attr"]="attr");CC.goCompose(a,e,b)};CC.quickSendMail=function(a,b,c){var d=function(a){typeof c=="function"?c(a):CC.alert(Lang.Mail.Write.sendFail)};MM.mailRequestApi({func:"mbox:compose",data:{attrs:a,returnInfo:1,action:"reply"},call:function(a){a.code=="S_OK"?typeof b=="function"?b(a):CC.alert(Lang.Mail.Write.sendedSuc):d(a)},failCall:d})};CC.sendMail=function(a,b,c,d){CC.compose(a,b,c,d)};
CC.addCalendar=function(a){var b=GC.getCookie("MMSServer")+"/CMailCal/EventService2.ashx",c=a.mid,d=Util.parseDate(a.scheduleDate,"yyyy.mm.dd HH:nn"),e=Util.formatDate(d,"yyyy-mm-dd"),d=parseInt(Util.formatDate(d,"HH"),10)*60+parseInt(Util.formatDate(d,"nn"),10),a='<form><input name="Sid" value="'+GC.sid+'" /><input name="modId" value="1" /> <input name="SeqNo" value="'+c+'" /> <input name="Operate" value="1" /><input name="Receiver" value="'+a.to+'" /><input name="calContent" value="'+a.subject.replace(/&nbsp;/g,
" ")+'" /><input name="beginDate" value="'+e+'" /><input name="endDate" value="'+e+'" /><input name="beginTime" value="'+d+'" /><input name="endTime" value="'+d+'" /></form>';Ajax.submit(a,{method:"post",url:b,call:function(){},resType:"html",encode:gMain.charset},!0)};
CC.deleteCalendar=function(a){var b=GC.getCookie("MMSServer")+"/CMailCal/EventService.ashx";Ajax.submit('<form><input name="Sid" value="'+GC.sid+'" /><input name="modId" value="1" /> <input name="SeqNo" value="'+a+'" /> <input name="Operate" value="0" /><input name="Receiver" value="" /><input name="calContent" value="" /><input name="beginDate" value="" /><input name="endDate" value="" /><input name="beginTime" value="" /><input name="endTime" value="" /></form>',{method:"post",url:b,call:function(){},
resType:"html",encode:gMain.charset},!0)};CC.editMail=function(a,b){if(!b)b=Lang.Mail.tb_EditMail;var c="/coremail/cmail/compose.jsp?funcid=draft&sid="+GC.coreSid+"&mid="+a;Ajax.get(c,function(){a="compose_"+a;CC.goCompose(c,a,b)},null)};CC.deleteMail=function(){var a={method:"get",url:"/coremail/s?func=global:sequential&sid="+GC.coreSid+"&rnd="+Math.random(),call:function(){},resType:"html"};Ajax.submit("",a,!0);LM.getAllFolders()};
CC.refreshFolder=function(a){var b=GE.lastFolder;GE.tab.exist(b)&&MM[b].refresh(a)};CC.exit=function(a){a||(a=CC.getCurLabId());GE.tab.close(a)};CC.updateTitleNew=function(a){var b=CC.getCurLabId();GE.tab.title(b,a)};CC.updateTitle=function(a){var b=CC.getCurLabId();GE.tab.title(b,a)};CC.updateTitleAndId=function(a,b){var c=CC.getCurLabId();GE.tab.title(c,a,b)};
CC.goLink=function(a,b,c,d){GE.tab.exist(b)?(GE.tab.title(b,c),GE.tab.active(b),GMC.setUrl(b,a,!0)):(MM.goTo(d,"url",2,a),MM.goTo(d,"text",2,c),MM.goTo(d,"name",2,b),MM.goTo(d,"group",2,b),MM.getModule(d,!1,b))};CC.goCompose=function(a,b,c){CC.goLink(a,b,c,"compose")};CC.isSessionMode=function(){return!GC.check("MAIL_MANAGER_SESSIONMODE")?!1:gMain.sessionMode=="1"};CC.isSessionModeReadMail=function(a){return CC.isSessionMode()&&(a==GE.folder.inbox||a>GE.folder.virus)};
CC.goReadMail=function(a,b,c,d,e){function f(a,b,c,d,e,f,h){if(GE.tab.curid!="readMail"+a||c.ignoreCache){var g=gConst.readMail,c=c||{};isSession=c.isSession||!1;MM.inited||MM.initModule(g);var j=g+a,n=c.fid,v={mode:"both",filterStylesheets:0,filterImages:0,filterLinks:0,supportTNEF:0,fileterScripts:1,filterFrames:1,markRead:c.markRead||0,encoding:c.encode||gConst.encode_utf8,mid:a,fid:n};if(typeof f!="undefined")v.smailPass=f;if(typeof h!=="undefined")v.smailNoVerify=h;if(typeof gMain!="undefined"&&
gMain.ifibc=="1")v.returnHeaders=c.returnHeaders||[];f=gConst.func.readMail;if(CC.isSessionModeReadMail(n)&&isSession)v.sessionId=c.sessionId,v.readFlag=0,v.start=c.start||0,v.total=200,f=gConst.func.readSessionMail;!MM[j]||c.ignoreCache?(g=MM[g],MM[j]={},Object.extend(MM[j],g),g=MM[j],g.name=j,g.data=v,g.inited=!0,g.isLoaded=!1,g.mi=d,g.func=f,g.sessionId=v.sessionId,g.rcptFlag=c.rcptFlag||5,MM[j].closeTab=e,MM.goTo(j,"fid",2,c.fid),MM.goTo(j,"omid",2,a),MM.goTo(j,"text",2,b.replace(gConst.searchBrightKeyLeft,
"").replace(gConst.searchBrightKeyRight,"")),MM.goTo(j,"name",2,j),MM.goTo(j,"group",2,j),MM.goTo(j,"data",2,v)):(MM[j].name=j,MM[j].mi=d,MM[j].data=v,MM[j].text=b.replace(gConst.searchBrightKeyLeft,"").replace(gConst.searchBrightKeyRight,""),MM[j].func=f,MM[j].fid=c.fid,MM[j].sessionId=v.sessionId,MM[j].closeTab=e,MM[j].rcptFlag=c.rcptFlag||5);MM.getModule(j);MM[j]||CC.updateTitle(b);c.callback&&setTimeout(function(){c.callback.apply(c.scope)},300)}}if(CC.isSecurityMail()){var g=function(h){h["var"]&&
f(a,b,c,d,e,void 0,h["var"].smailNoVerify)},h=!1;if(typeof top.gMain!=="undefined"&&typeof top.gMain.userAttrs!=="undefined")var j=top.gMain.userAttrs.firstuseibc=="1"?!0:!1,h=top.gMain.userAttrs.modifyibcpwd=="1"?!0:!1;if((c.isEncrypt||c.isSign)&&!j&&typeof j!=="undefined")CC.showModIBCdiv(function(h){parent.MM.doService({func:"mail:SoapVerifyIbcPwd",absUrl:(parent.gMain?parent.gMain.webPath||"":"")+"/service/mail/ibcsoap",data:{oldpwd:h,autodec:0},call:function(g){g.code=="S_OK"&&f(a,b,c,d,e,h,
void 0)},failCall:function(){}})});else if(!c.unread||h||c.isSign)CC.getSmailNoVerify(a,g);else if(c.isEncrypt&&c.unread){var n=new parent.ToolTips({id:"",win:window,left:85,top:132,direction:parent.ToolTips.direction.Bottom});CC.showUndoIBCdiv(function(h){if(h)if(h["var"].result==1){CC.showMsg("\u89e3\u5bc6\u6210\u529f",!0,!1,"option");if(jQuery("#autopass",parent.document)[0].checked&&typeof gMain!="undefined"&&typeof gMain.userAttrs!="undefined")gMain.userAttrs.modifyibcpwd="1";try{MM.sys1.stats.unreadMessageCount--,
(new Folder).refreshMenu("sys1")}catch(g){}h=jQuery("#ibcPwd",parent.document).val().trim();jQuery("#divDialogCloseconfirm",parent.document).click();f(a,b,c,d,e,h,void 0)}else h["var"].result==0?n.show(jQuery("#ibcPwd",parent.document)[0],"\u5bc6\u7801\u9519\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165"):CC.showMsg("\u5bc6\u7801\u9519\u8bef\u6b21\u6570\u8fbe\u5230\u9650\u5236\uff0c\u8bf710\u5206\u949f\u540e\u91cd\u8bd5",!0,!1,"error")},"",n)}else c.isAttach==1&&CC.getAttachRead(a,function(b){if(b.code=="S_OK"&&
b["var"][0].flags){var c=b["var"][0].flags,b=c.read,c=c.secureEncrypt;b==1&&c==1?parent.CC.showMsg("\u8bf7\u5230\u6536\u4fe1\u7bb1\u89e3\u5bc6\u6b64\u5c01\u90ae\u4ef6\u4e4b\u540e\u518d\u67e5\u770b",!0,!1,"caution"):b==0&&CC.getSmailNoVerify(a,g)}})}else f(a,b,c,d,e)};CC.getCurLabId=function(){return GE.tab.curid};CC.goLogLink=function(a,b){var c="";typeof b==="string"&&(c=gMain.webPath+"/webtransit.do?sid="+gMain.sid+"&func=log:userMain&type="+b);CC.goOutLink(c,"log",a)};
CC.goOutLink=function(a,b,c){CC.checkNetwork();jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li");jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li");LM.selectFolderId=b;jQuery("#"+b).attr("class","selectFolder_li");var a=GC.rfUrl(a),d=new Setting;d&&d.phoneBindTip(b);CC.goLink(a,"outLink_"+b,c,"outLink")};
CC.goBillmanager=function(){if(jQuery("#ifrm_outLink_billmanager").length==0)return CC.goOutLink(gMain.webPath+"/webtransit.do?sid="+gMain.sid+"&func=mail:billmanager","billmanager","\u8d26\u5355\u660e\u7ec6"),!1;else GE.tab.active("outLink_billmanager")};CC.goBillmanagerFolder=function(){GE.tab.del("outLink_billmanager");CC.goFolder("8","user8")};CC.showHideMenu=function(a,b){a||(a=CC.getCurLabId());var c=$(gConst.divToolbar+a);if(c)c.style.display=b,GMC.setDivHeight(a)};
CC.hideMenu=function(a){CC.showHideMenu(a,"none")};CC.showMenu=function(a){CC.showHideMenu(a,"")};CC.synData=function(a,b){function c(){try{var a=GE.tab.composeTabs,b;for(b in a){var c=CC.isCompose(b);c&&c.oWrite.refreshAddr()}}catch(d){}}try{switch(b=b||gConst.home,b){case gConst.home:var d=MM[gConst.home];d.synData&&d.synData(a);break;case "common_addr":LMD.freshData(c);break;case "inbox":var e=GE.lastFolder||"inbox";if(a.refresh)MM[e].isLoaded=!1}}catch(f){}};
CC.searchMailByMain=function(){var a=$(gConst.txtSearch);GE.folderObj.user="";CC.searchMailByTop(a)};CC.searchMailByTop=function(a){var b=a.value.trim();if(b=="")CC.alert(Lang.Mail.search_InputKey,function(){a.focus()});else{var c=[{field:"subject",operator:"contains",value:b},{field:"from",operator:"contains",value:b},{field:"to",operator:"contains",value:b}];GE.searchKey=b;GE.folderObj.user="";CC.searchMailByParm(b,0,c);a.value=Lang.Mail.search_SearchMail}};
CC.advSearchMailByTop=function(a,b,c,d){var e=a.value.trim();e==""?CC.alert(Lang.Mail.search_InputKey,function(){a.focus()}):(GE.folderObj.user="",GE.searchKey=e,CC.searchMailByParm(e,0,b,c,{},d))};CC.advSearchMail=function(a,b,c,d,e){GE.folderObj.user="";CC.searchMailByParm("",a,b,c,{},d,null,null,e)};CC.filterMail=function(a,b,c,d,e,f){GE.folderObj.user=e;var g=!1;e=="sys0"&&(g=!0);CC.searchMailByParm("",a,b,c,{},d,g,f)};
CC.searchMailByFlag=function(a,b){GE.folderObj.user="";CC.searchMailByParm("",a,[],b)};
CC.searchNewMail=function(a,b,c,d){var e={},a=a||0;typeof c==="number"&&(c=[c]);d&&(d.meeting===1||d.meetingFlag===1)?e={meetingFlag:1}:d&&d.taskFlag?(e=d,Folder.taskType=d.taskFlag):e=d&&d.signed===1?d:d&&d.starFlag===1?d:{read:1};if(d&&c)c=void 0,e.read=1;c&&!d&&(a=0);GE.folderObj.user="";CC.searchMailByParm("",a,null,e,null,2,b,null,c);if(b)jQuery("#"+LM.selectFolderId).removeClass("selectFolder_li"),jQuery("#span_"+LM.selectFolderId).removeClass("selectFolder_li"),LM.selectFolderId=0,jQuery("#0").attr("class",
"selectFolder_li")};CC.searchFolderNoRead=function(a){var b=GE.searchFlag;b.read=1;CC.searchMailByParm("",a,null,b,null,2,!1)};
CC.searchMailByParm=function(a,b,c,d,e,f,g,h,j){CC.getPageSize();e=e||{};b=b||0;c=c||[];d=d||{};GE.currentFid=b;GE.searchFlag=d;var f=typeof f=="undefined"?2:f,n=GE.list.order,k=e.recursive||0,e=e.ignoreCase||0,q=CC.getPageSize(),c={fid:b,order:n,desc:1,recursive:k,condictions:c,flags:d,total:q,start:1,ignoreCase:e,isSearch:1,statType:1,isFullSearch:f};if(h)c.sentDate=h;if(j)c.label=j;if(g&&!b)c.exceptFids=[2,3,4,5,6,8,10];if(d.meetingFlag)c.exceptFids=[2,4,5,8,10];else if(d.taskFlag)c.exceptFids=
[];else if(d.signed)c.exceptFids=[2,3,4,5,8];else if(d.starFlag)c.exceptFids=[4];GE.searchKey=a?a:"";GE.searchData=c;CC.searchMail(c,g)};CC.approachSearch=function(a){var b=GE.searchData;b.isSearch=a||0;b.start=1;b.approachSearch=GE.approachSearchData;GE.searchData=b;CC.searchMail(b,!1)};
CC.searchMail=function(a,b){MM.mailRequestApi({func:gConst.func.searchMail,data:a,call:function(c){var d=GE.folderObj.user||GE.folderObj.search;GE.currentFolderModule=d;if(c.code==gConst.statusOk){CC.getPageSize();CM[d]=c;MM[d].stats=c.stats;MM.laterRequestModule=d;b?(MM[d].isLoadNoReadMail=!0,MM[d].text=Lang.Mail.Write.unRead_mail):MM[d].isSearch?(MM[d].isLoadNoReadMail=!1,MM[d].text=Lang.Mail.Write.searchResult):MM[d].isLoadNoReadMail=!1;if(c&&c.stats&&c.stats.folders&&c.stats.folders[0])MM[d].text=
c.stats.folders[0].folderName;if(a.flags&&a.flags.meetingFlag)MM[d].text="\u4f1a\u8bae\u9080\u8bf7";if(a.flags&&a.flags.taskFlag)MM[d].text="\u5f85\u529e\u90ae\u4ef6";if(a.flags&&a.flags.signed)MM[d].text="\u654f\u611f\u90ae\u4ef6";if(a.flags&&a.flags.starFlag)MM[d].text="\u661f\u6807\u90ae\u4ef6";MM.createModule(d);CC.power.offSensMail()&&!CC.getUserAttributeFromLocal("tipsSensOpen")&&SensitiveMail.openTips()}},msg:Lang.Mail.search_NowSearch})};
CC.getContactMail=function(a){MM.mailRequestApi({func:gConst.func.searchMail,data:a.searchParam,call:a.callback||function(){},msg:Lang.Mail.search_NowSearch})};
CC.getSubConfig=function(){CC.getSubConfig=function(){var a={id:"setMenu",name:"setConfig",div:$("divSetMenu")},b=[];b.notNeedCss=!0;b.push({isShow:1,name:"MAIL_CONFIG_INDEX",text:Lang.Mail.tb_MailSetting,url:function(){CC.setConfig()},attrs:"sep=true"});b.push({isShow:1,name:"MAIL_CONFIG_PASSWORD",text:Lang.Mail.tb_ModPwd,url:function(){CC.setConfig("password")},attrs:"sep=true"});b.push({isShow:1,name:"MAIL_CONFIG_MAILPOP",text:Lang.Mail.tb_MailPOP,url:function(){CC.setConfig("mailPOP")}});GC.check("MAIL_MANAGER_FILTER")&&
b.push({isShow:1,name:"MAIL_CONFIG_FILTER",text:Lang.Mail.tb_MailFilter,url:function(){CC.setConfig("filter")}});CC.getMenu(a,b)};CC.getSubConfig()};
CC.getSearchMenu=function(){var a={id:"hSearchMenu",name:"hSearch",div:$("divSearch")},b=[];b.notNeedCss=!0;b.push({isShow:!0,name:"MAIL_INBOX_SEARCH",text:Lang.Mail.search_SearchMail,attrs:"isBold=true&clsName=fixHeight",url:function(){CC.searchMailByTop($(gConst.txtSearch))},children:[]});b.push({isShow:!0,name:"MAIL_INBOX_HIGHSEARCH",text:Lang.Mail.search_HighSearch,attrs:"clsName=fixHeight",url:function(){CC.goSearch()},children:[]});b.push({isShow:!0,name:"MAIL_ATTACH_LIST",text:Lang.Mail.ConfigJs.attachManage,
attrs:"clsName=fixHeight",url:function(){CC.goAttachList()},children:[]});CC.getMenu(a,b)};CC.refreshModule=function(a,b){var a=a||"",b=b||"",c=GMC.getFrameWin(a);a=="address"&&c&&(b=="g"?c.ReFresh_G&&c.ReFresh_G():c.ReFresh_P&&c.ReFresh_P())};CC.closeAllTabs=function(){var a=getChangedFrames();a.length==0?GE.tab.closeAll():a.length>0&&parent.CC.confirm("\u60a8\u8fd8\u6709\u672a\u5b8c\u6210\u7f16\u8f91\u64cd\u4f5c\uff0c\u662f\u5426\u5173\u95ed\uff1f",function(){GE.tab.closeAllForce()});return!1};
CC.getFolderTypeName=function(a){var b=GE.folder.user;if(a===1)b=GE.folder.sys;else if(a===3)b=GE.folder.user;else if(a==5)b=GE.folder.label;return b};CC.getPageSize=function(){var a=gMain.pageSize-0;return a=a>0?a:GE.list.pageSize};CC.getTimezone=function(){var a=GC.getCookie("Timezone");return a=a||gMain.Timezone||"8"};CC.getReadMode=function(){return gMain.readMailMode||"0"};
CC.getDownloadLink=function(a,b,c,d,e,f,g){var h="{0}?func={1}&sid={2}&mid={3}&offset={4}&size={5}&name={6}&type={7}&encoding={8}",d=encodeURIComponent(d),h=h.format(gConst.downloadUrl,gConst.func.download,gMain.sid,a,b,c,d,e,f);g&&(h+="&df=1");return h};CC.getDownloadsLink=function(a,b){var c;return c="{0}?func={1}&sid={2}&mid={3}&format={4}".format(gConst.uploadUrl,gConst.func.autopack,gMain.sid,a,b||"zip")};
CC.downloads=function(a,b,c){for(var d=[],e=0;e<a.length;e++)d.push({mid:c||a[e].mid,offset:a[e].fileOffSet||a[e].attachOffset,size:a[e].fileSize||a[e].attachSize||0,name:encodeURIComponent(a[e].fileName||a[e].attachName),encoding:a[e].encoding||a[e].encode});a={version:"1.0",fileName:encodeURIComponent(b),format:"zip",compress:0,items:d};a={url:gConst.packDownUrl+"?func={0}&sid={1}".format(gConst.func.pack,gMain.sid),data:a,call:function(a){var b=a["var"].retCode,c=a["var"].taskno;a.code=="S_OK"?
b==0&&window.setTimeout(function(){CC.queryPack(c)},100):CC.confirm(Lang.Mail.dabaoWrongRetry,function(){CC.downloads(d.name)})},msg:Lang.Mail.dabaoing};MM.mailRequestApi(a)};
CC.queryPack=function(a){a={url:gConst.packDownUrl+"?func={0}&sid={1}&taskno={2}".format(gConst.func.queryPack,gMain.sid,a),call:function(a){var c=a["var"].taskno,d=a["var"].status;d==2?(a=gConst.packDownUrl+"/?func={0}&sid={1}&taskno={2}".format(gConst.func.downloadPack,gMain.sid,c),d=[],d.push('<p class="msgDialog">'+Lang.Mail.dbComplete+"</p>"),d.push('<p class="action dialogAction">'),d.push('<a class="btn" href="{0}"  onclick="CC.closeMsgBox(\'{2}\')" id="{1}" style="width:5.5em"><b class="r1"></b><span class="rContent"><span>'+
Lang.Mail.loadAt+'</span></span><b class="r1"></b></a>'.format(a,"attachPack0","downloads")),d.push('<a class="btn" href="javascript:fGoto();" id="{0}" onclick="CC.closeMsgBox(\'{1}\')" style="width:5.5em"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.cancelLoad+'</span></span><b class="r1"></b></a>'.format("attachPack1","downloads")),d.push("</p>"),a={id:"downloads",title:Lang.Mail.pkComplete,text:d.join("")},CC.msgBox(a)):d<2?window.setTimeout(function(){CC.queryPack(c)},100):CC.alert(Lang.Mail.pkFail+
a["var"].status)},failCall:function(a){CC.alert(Lang.Mail.pkFail+a["var"].status)}};MM.mailRequestApi(a)};CC.getFolders=function(a){a||(a=[GE.folder.sys,GE.folder.admin,GE.folder.user,GE.folder.pop]);var b=[];if(typeof a=="object")for(var c=0;c<a.length;c++){var d=MM[gConst.folderMain].Folders[a[c]];d&&(b=b.concat(d))}else b=MM[gConst.folderMain].Folders[a];return b};
CC.getSignList=function(a){CM.Option_Sign&&typeof a=="function"?a(CM.Option_Sign):MM.mailRequest({func:gConst.func.getSign,data:{},call:function(b){CM.Option_Sign=b["var"];typeof a=="function"&&a(CM.Option_Sign)},failCall:""})};CC.isCompose=function(a){try{if(a&&a.indexOf("compose_")>=0){var b=$(gConst.ifrm+a),c=b?b.contentWindow:null;if(c&&c.location.href.indexOf(gConst.composeFile)>-1)return c}}catch(d){}return!1};CC.getMailText=function(a,b){var c;c=(a||"").trim();return c=(c||b||"").encodeHTML()};
CC.getMailContent=function(a){var b=a.text||{},c=a.isHtml?a.html:b,d="",e=!1;if(typeof c=="object"){d=c.content||"";if(a.isHtml&&d==""&&b.content)d=b.content,e=!0;if(!a.isHtml||e==!0)d=d.encodeHTML(),d=d.replace(/\n/g,"<br>")}return d};CC.getMailTip=function(a){return a=(a||"").replace(/\"/g,'\\"')};
CC.sendMDN=function(a,b,c){try{if(a==1&&typeof b=="object"){if(c)b.account=c;CC.confirm(Lang.Mail.readMail_lb_receiveRecord,function(){MM.mailRequestApi({func:gConst.func.sendMDN,data:b,call:function(){},failCall:function(){CC.alert(Lang.Mail.fail)}})})}}catch(d){}};
CC.requestWebApi=function(a,b,c){var a=GC.rfUrl(a),c=c||{},d=c.method||"get",e=window.frames[gConst.ifrmWebApi]||Ajax;e&&typeof e.getXMLHttp=="function"&&(e=e.getXMLHttp(),Ajax.request({url:a,method:d,callback:b,failCall:c.failCall,data:c.data||"",resType:c.resType||"script",encode:c.encode,xmlHttp:e}))};CC.hideReadMailAddr=function(a,b){try{var c=window.frames[gConst.ifrmReadmail+gConst.readMail+a];c&&c.oSM.hideAddAddr(a,b)}catch(d){}};
CC.isInAddr=function(a){try{for(var b=LMD.userContancts,c=0;c<b.length;c++)if(b[c][3]==a)return!0;return!1}catch(d){return!1}};CC.inAddr=function(a,b){var c=[],d=function(a){a.code==gConst.statusOk?(a=a["var"],typeof b=="function"&&b(a[0])):b(!1)};c.push(a);parent.MM.doService({url:"/addr/user",func:"addr:isExist",data:{value:c},failCall:d,call:d})};CC.getMainMenu=function(a){for(var b=0;b<gMenu.length;b++)if(gMenu[b].name==a)return gMenu[b]};CC.getMailMenu=function(){return gMenu};CC.forbidden=function(){CC.alert(Lang.Mail.error_FA_FORBIDDEN)};
CC.getAttachType=function(a){var b={isView:!1,className:"",type:""},a=a.toLowerCase(),c="attach_ico a_unknow,attach_ico a_doc,attach_ico a_xls,attach_ico a_ppt,attach_ico a_pdf,attach_ico a_txt,attach_ico a_html,attach_ico a_img,attach_ico a_zip".split(","),d=".doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.txt,.htm,.html,.gif,.jpg,.jpeg,.bmp,.png,.ico,.jpe,.tiff,.jfif,.tif,.rar,.zip,.7z".split(",");b.className=c[0];b.isView=!1;for(var e=0;e<d.length;e++)if(a.length==a.indexOf(d[e])+d[e].length){b.isView=
!0;switch(d[e]){case ".doc":case ".docx":b.className=c[1];break;case ".xls":case ".xlsx":b.className=c[2];break;case ".ppt":case ".pptx":b.className=c[3];break;case ".pdf":b.className=c[4];break;case ".txt":b.className=c[5];break;case ".htm":case ".html":b.className=c[6];b.isView=!1;break;case ".gif":case ".jpg":case ".jpeg":case ".bmp":case ".png":case ".ico":case ".jfif":case ".tiff":case ".tif":case ".jpe":b.className=c[7];b.type="image";break;case ".zip":case ".rar":case ".7z":b.className=c[8];
b.type="zip";break;default:b.className=c[0],b.isView=!1}break}if(a.indexOf(".")==-1)b.isView=!1;return b};CC.isExtMail=function(){return window.LoginType==gConst.loginType.pm||window.LoginType==gConst.loginType.mm};CC.doLink=function(a){CC.confirm(Lang.Mail.ConfigJs.sureLeveMail,function(){window.location.href=a},Lang.Mail.ConfigJs.mailpop_sysPrompt)};
CC.showExtMailSelect=function(a){var b=$("ExtSelectDiv");b||(b=El.createElement("div","ExtSelectDiv","pop_selectmail"));var c=extmailList,d=[];d.push("<h2>");CC.isExtMail()?d.push(Lang.Mail.selectPublicMail):d.push(Lang.Mail.selectGrantMail);d.push("</h2>");d.push('<div class="pop_body">');var e=[],f=[];e.push('<ul class="manager_ul">');f.push('<ul class="user_ul">');for(var g=0;g<c.length;g++){var h=c[g],j=h.mailId,n=h.mailId+"@"+gMain.domain+" ("+h.mailName+")",h=h.type,k=gMain.webPath+"/login/selectmail.do?sid="+
gMain.sid+"&mailid="+j+"&relationtype="+h,q="";q+=gMain.uid==j&&gMain.relationType==h?'<li><a href="javascript:fGoto();" class="on">':"<li><a href='javascript:void(0);' onclick='CC.doLink(\""+k+"\")';>";h===0?(e.push(q),e.push('<i class="i_mgr"></i><span title="'+n+'">'+n+"</span></a></li>")):(f.push(q),f.push(n+"</a></li>"))}e.push("</ul>");f.push("</ul>");d.push(e.join(""));d.push(f.join(""));d.push("</div>");CC.isExtMail()&&d.push('<p class="pop_setBtn"><a href="javascript:fGoto();" onclick="CC.setConfig(\'defaultAccount\');">'+
Lang.Mail.setDefaultMailId+"</a></p>");b.style.position="absolute";b.style.left=El.getX(a)-150+"px";b.style.top=El.getY(a)+El.height(a)+10+"px";b.innerHTML=d.join("");document.body.appendChild(b);El.show(b);EV.stopEvent();EV.addEvent(document,"click",function(){El.hide($("ExtSelectDiv"))})};
CC.inform=function(a){var b=Lang.Mail.Write.sysPrompt,c=[],d=a.mails,e=a.sessionMails||[],f={},g="",h=a.callback||function(){};this.ms=f;for(var g=0,j=d.length;g<j;g++)d[g].checked=!1,f[d[g].email]=d[g];g=0;for(j=e.length;g<j;g++)e[g].checked=!1,f[e[g].email]=e[g];if(!d||d.length==0)CC.alert(Lang.Mail.sysW);else{var e=[],n;for(n in f)n&&f[n]&&n!=gMain.loginName&&(g=f[n].userName?f[n].userName+"({0})":"{0}",g=g.format(n),e.push('<div class="inform_dialog_item"><input id="chk_box_'+n.encodeHTML()+'" type="checkbox" value="'+
n.encodeHTML()+'" onclick="CC.updateMs(\''+n+'\', this.checked);" /><label for="chk_box_'+n.encodeHTML()+'">&nbsp;'+g+"</label></div>"));c.push('<div style="text-align:left; line-height:24px; padding:12px 0 0 24px;">');c.push('<ol class="dialog_ol"><li>'+Lang.Mail.choisedRmove+'"'+$("span_5").title+'"</li>');e.length>0&&c.push("<li>"+Lang.Mail.ConfigJs.addEmailSenderIntoBlacklist+"</li>");c.push("</ol>");c.push('<div id="inform_user_select">');c.push(e.join(""));c.push("");c.push("</div>");c.push("</div>");
b={id:"confirm_inform",title:b,type:"div",text:c.join(""),changeStyle:!1,zindex:1090,dragStyle:1,width:400,buttons:[{text:Lang.Mail.Ok,clickEvent:function(){function b(){var a=[],c;for(c in f)c&&f[c]&&f[c].checked&&a.push(c);return a.join(",")}for(var c=[],e=0,g=d.length;e<g;e++)c.push(d[e].mid);try{MM[a.moduleId].move(c,5,Lang.Mail.list_NowMoveMail,a.sessionId?[a.sessionId]:"",Lang.Mail.opSuc),b()!=""&&black.addBlack(b(),h),typeof a.callback=="function"&&a.callback()}catch(j){}}},{text:Lang.Mail.Cancel,
clickEvent:function(){},isCancelBtn:!0}]};CC.msgBox(b);b=$("inform_user_select");El.height(b)>120&&El.height(b,120)}};CC.updateMs=function(a,b){this.ms[a].checked=b||!1};
CC.checkConfig=function(a){if(a){var b=!1;a.toLowerCase()=="index"?b=GC.check("MAIL_CONFIG_INDEX"):typeof window[a]!="undefined"&&window[a].attrs&&(window[a].attrs.free?b=!0:window[a].attrs.authority&&(b=GC.check(window[a].attrs.authority)));var c=CorpType;if(window.gMain&&gMain.urlYaddr&&(a.toLowerCase()=="skin"||a.toLowerCase()=="password"||a.toLowerCase()=="face"||a.toLowerCase()=="phonebind"||a.toLowerCase()=="defaultaccount"))b=!1;CC.isExtMail()?a.toLowerCase()=="defaultaccount"&&(b=!0):(b=c==
1&&a=="loginNotify"?!1:b&&!parseInt(gConst.extMailMenus[a]),a.toLowerCase()=="memmanager"&&(b=!1));return b}else return!1};CC.getViewLink=function(a,b,c,d,e,f,g,h,j,n){e="{0}/se/mail/preview.do?src={1}&sid={2}&dl={3}&usernumber={4}&fi={5}&filesize={6}&mo={7}&id={8}&denyForward="+n;d=encodeURIComponent(d);f=encodeURIComponent(f);return e=e.format(a,b,c,encodeURIComponent(d),gMain.loginName,encodeURIComponent(f),g,gMain.loginId,j)};
CC.checkSupportFlash=function(){var a=!1;if(Browser.isIE||window.ActiveXObject){try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10")}catch(c){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.9")}catch(d){}}a=!!b}else a=navigator.plugins["Shockwave Flash"]?!0:!1;return a};
CC.importMail=function(){function a(){function a(b,d){for(var e=[],j=!1,n=!1,k=0;k<b.length;k++)j=b[k].nodes&&b[k].nodes.length,n=(n=k==b.length-1)?"\u2514 ":"\u251c ",n=d+n+b[k].name,e.push('<option value="'+b[k].fid+'" data-name="'+b[k].name+'">'+n+"</option>"),j&&e.push(a(b[k].nodes,d+"\u3000"));return e.join("")}var b=CC.getFolders(),e=[];e.push('<select id="fid" name="fid">');b&&b.length&&e.push(a(b,""));e.push("</select>");return e.join("")}var b={id:"import_mail",title:Lang.Mail.emailImport,
type:"text",text:function(){var b=[];b.push('<div><form id="importEml_form" method="post" enctype="multipart/form-data" target="import_mail_frm">');b.push(Lang.Mail.choiselala);b.push(a());b.push(Lang.Mail.choiselulu);b.push('<input type="file" id="import_mail_input" name="body" onchange="" />');b.push("</form></div>");b.push('<div id="import_mail_progress"></div>');b.push('<iframe id="import_mail_frm" name="import_mail_frm" src="'+gMain.rmSvr+'/RmWeb/blank.htm" onload="ImportMailLoaded(this)" style="display:none;"></iframe>');
return b.join("")}(),zindex:9999,dragStyle:1};b.text=function(){var b=[];if(CC.checkSupportFlash()){var d=gMain.rmSvr+"/RmWeb/upload.swf",e=CC.isBigFont()?55:46,f=CC.isBigFont()?180:118,d=new SWFObject(d,"flashplayer",e,"25");d.addParam("wmode","transparent");d.addParam("allowscriptaccess","sameDomain");d.addParam("flashVars","rmkey=1");b.push("<div>");b.push("<div>"+Lang.Mail.choisemb);b.push(a());b.push("</div>");b.push('<div style="position:relative;" class="mt5">'+Lang.Mail.choiselulu);b.push('<a class="n_btn_on"><span><span>'+
Lang.Mail.look+"</span></span></a>");b.push('<span style="position:absolute; left:'+f+'px; top:0;">');b.push(d.getHTML());b.push("</span>");b.push("</div>");b.push("</div>");b.push('<div id="import_mail_progress" style="position:relative; display:none;">');b.push('<div id="processing_container" class="pgressLine">');b.push('<div class="bg"></div>');b.push('<div id="processing_bar" class="bg_cur" style="swidth:0%;"></div>');b.push('<div id="processing_txt" class="num">'+Lang.Mail.oneMail+"</div>");
b.push("</div>")}else b.push("<div>"),b.push(Lang.Mail.noFlash);b.push("</div>");return b.join("")}();CC.msgBox(b);(function(){if(FlashImportMail)FlashImportMail.compoentId=b.id,FlashImportMail.beginBeforeInterface=function(a,b){if(a.typeErrors&&a.typeErrors.length){var e=[];e.push(Lang.Mail.emlFormat);CC.alert(e.join(""),b)}else b()},FlashImportMail.startBeforeInterface=function(){document.getElementById("import_mail_progress").style.display="block";jQuery("#divDialogClose"+b.id).unbind("click").unbind("mousedown").bind("mousedown",
function(){FlashImportMail.onClose()})},FlashImportMail.processInterface=function(a){var b=a.current+1,a=a.count,e=document.getElementById("processing_bar"),f=document.getElementById("processing_txt"),g=a?parseInt(b*100/a):0;f.innerHTML=b+Lang.Mail.feng+"/"+a+Lang.Mail.feng;e.style.width=g+"%"},FlashImportMail.finishInterface=function(a){var d=document.getElementById("fid"),e=d.options[d.selectedIndex].value||1,f=d.options[d.selectedIndex].getAttribute("data-name")||"",g=[],h=!1,d=!1;a.typeErrors&&
a.typeErrors.length?h=!0:a.fail.length>0?h=!0:g.push(Lang.Mail.mailInportSuc+"<br />"+Lang.Mail.gyou+a.count+Lang.Mail.mailImport+f+Lang.Mail.mailFolder);if(h)f=a.count,h=a.fail.length,a=a.typeErrors.length,f<=0?(g.unshift(Lang.Mail.importFail),d=!0):g.unshift((Lang.Mail.imported+"{0}"+Lang.Mail.fenyou+"{1}"+Lang.Mail.fengFail+" ").format(f-a-h+1,h));CC.closeMsgBox(b.id);d?setTimeout(function(){CC.alert(g.join(""))},10):CC.alert(g.join(""),function(){CC.goFolder(e)})},FlashImportMail.closeInterface=
function(a){var b=Lang.Mail.imported+"{0}"+Lang.Mail.fenyou+"{1}"+Lang.Mail.fengFail,e=a.current+1,b=b.format(e,a.count-e+a.fail.length);CC.alert(b,function(){CC.goFolder(1)})}})();window.ImportMailLoaded=function(){}};CC.getSentSaveDefault=function(){if(gMain.sendSave.toString()==""){if(LoginType==gConst.loginType.pm||LoginType==gConst.loginType.mm)return gMain.defaultPrefSavesendPublic;if(LoginType==gConst.loginType.web)return gMain.defaultPrefSavesend}return gMain.sendSave};
function SWFObject(a,b,c,d,e,f){this.params={};this.variables={};this.attributes={};this.setAttribute("id",b);this.setAttribute("name",b);this.setAttribute("width",c);this.setAttribute("height",d);this.setAttribute("swf",a);this.setAttribute("classid","clsid:D27CDB6E-AE6D-11cf-96B8-444553540000");e&&this.setAttribute("version",e);f&&this.addParam("bgcolor",f)}SWFObject.prototype.addParam=function(a,b){this.params[a]=b};SWFObject.prototype.getParam=function(a){return this.params[a]};
SWFObject.prototype.addVariable=function(a,b){this.variables[a]=b};SWFObject.prototype.getVariable=function(a){return this.variables[a]};SWFObject.prototype.setAttribute=function(a,b){this.attributes[a]=b};SWFObject.prototype.getAttribute=function(a){return this.attributes[a]};SWFObject.prototype.getVariablePairs=function(){var a=[];for(key in this.variables)a.push(key+"="+this.variables[key]);return a};
SWFObject.prototype.getHTML=function(){var a="",b="",b="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){a+='<embed class="zero-opacity" type="application/x-shockwave-flash"  pluginspage="'+location.protocol+'//www.macromedia.com/go/getflashplayer" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"';a+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';for(b in this.params)a+=[b]+'="'+this.params[b]+
'" ';b=this.getVariablePairs().join("&");b.length>0&&(a+='flashvars="'+b+'"');a+="/>"}else{a='<object class="zero-opacity" id="'+this.getAttribute("id")+'" classid="'+this.getAttribute("classid")+'"  codebase="'+location.protocol+"//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+this.setAttribute("version")+',0,0,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';for(b in this.params)a+=
'<param name="'+b+'" value="'+this.params[b]+'" />';b=this.getVariablePairs().join("&");b.length>0&&(a+='<param name="flashvars" value="'+b+'" />');a+="</object>"}return a};SWFObject.prototype.write=function(a){typeof a=="undefined"?document.write(this.getHTML()):(typeof a=="string"?document.getElementById(a):a).innerHTML=this.getHTML()};
JSForFlashUpload={getUploadUrl:function(){var a=document.getElementById("fid"),b=parent.gMain.sid;return(parent.gMain.rmSvr+"/RmWeb/mail?func=mbox:importMessages&sid={sid}&fid={fid}").replace("{fid}",a.options[a.selectedIndex].value||1).replace("{sid}",b)},onselect:function(a){for(var a=a.replace(/[\t\s]+/g,""),a=Util.str2Dom(a).firstChild.childNodes,b=[],c=[],d=0;d<a.length;d++){var e=a[d],f=parseInt(Util.getXMLValue(e.childNodes[2]),10),g=Util.getXMLValue(e.childNodes[1]),e={fileId:"",taskId:Util.getXMLValue(e.childNodes[0]),
fileName:g,fileSize:f,uploadType:"flash",status:"init"};CC.getFileExt(g)[1].toLowerCase()=="eml"?b.push(e):(e.errorType=1,c.push(e))}FlashImportMail.uploadList(b,c)},onprogress:function(){},oncomplete:function(a,b){try{var c=FlashImportMail.getFilesByString(b);c?c.code==gConst.statusOk?FlashImportMail.success.push(a):(FlashImportMail.fail.push(a),JSForFlashUpload.onerror(a,c.code)):(FlashImportMail.fail.push(a),JSForFlashUpload.onerror(a,code,"parse response error"));FlashImportMail.onProcess();FlashImportMail.nextUpload()}catch(d){FlashImportMail.fail.push(a)}},
onerror:function(a,b,c){CC.closeMsgBox(FlashImportMail.compoentId);switch(b){case "3":c=Lang.Mail.importLimit;break;default:c="\u6587\u4ef6\u5bfc\u5165\u5931\u8d25"}CC.alert(c)},onmouseover:function(){},onmouseout:function(){},onclick:function(){return!0}};FlashForJS={upload:function(a){document.getElementById("flashplayer").upload(a)},cancel:function(a){document.getElementById("flashplayer").cancel(a)}};
FlashImportMail={data:[],count:0,current:0,success:[],fail:[],regMatchFile:/(var\s+return_obj=[\s\S]+)<\/script>/i,beginBeforeInterface:null,startBeforeInterface:null,processInterface:null,finishInterface:null,closeInterface:null,uploadList:function(a,b){this.current=0;this.count=a.length;this.data=a;this.success=[];this.fail=[];this.typeErrors=b;var c=a[0],d=this;this.onBeginBefore(function(){if(c)d.onStartBefore(),d.upload(c);else d.onFinish()})},upload:function(a){FlashForJS.upload(a.taskId)},
nextUpload:function(){this.current++;if(this.current<this.count)this.upload(this.data[this.current]);else this.onFinish()},onBeginBefore:function(a){typeof this.beginBeforeInterface=="function"&&this.beginBeforeInterface(this,a)},onStartBefore:function(){typeof this.startBeforeInterface=="function"&&this.startBeforeInterface(this)},onProcess:function(){typeof this.processInterface=="function"&&this.processInterface(this)},onFinish:function(){typeof this.finishInterface=="function"&&this.finishInterface(this)},
onClose:function(){typeof this.closeInterface=="function"&&this.closeInterface(this)},getFilesByString:function(a){if(!a)return null;var b=a.match(FlashImportMail.regMatchFile);if(b)return eval(b[1]),return_obj&&return_obj["var"]?(a=return_obj["var"],{code:return_obj.code,taskId:a.fileId,fileId:a.fileId,fileName:a.fileName,fileSize:a.fileSize}):null;else if(typeof a=="string"&&a.indexOf("{")>-1&&a.indexOf("}")>-1){b=null;try{b=eval("("+a+")")}catch(c){}return b}else return null}};
CC.syncMailData=function(){for(var a=CC.getFolders(),b=0,c=0;c<a.length;c++)a[c].fid!=2&&a[c].fid!=3&&a[c].fid!=4&&a[c].fid!=5&&(b+=a[c].stats.unreadMessageCount);if(messageInfo)messageInfo.unreadMessageCount=b.toString()};CC.updateHome=function(){gMain.welcomePage&&gMain.welcomePage=="1"&&MM.home&&MM.home.update&&(CC.syncMailData(),MM.home.update())};
CC.getShowFolderList=function(){for(var a=[1,2,3,4,5,12],b=[],c=0;c<a.length;c++)b[a[c]]="show";IsOA!=1&&(b[6]="show");GC.check("MAIL_INBOX_BILL")&&(b[8]="show");GC.check("MAIL_MANAGER_MONITOR")&&(b[13]="y");GC.check("MAIL_MANAGER_AUDIT")&&(b[14]="show");GE.folderMap=b};CC.isAudit=function(){return GC.check("MAIL_MANAGER_AUDIT")?!0:!1};CC.isMonitor=function(){return GC.check("MAIL_MANAGER_MONITOR")?!0:!1};CC.isRmAddr=function(){return window.gMain&&gMain.urlYaddr&&gMain.urlYaddr!=""?!0:!1};
CC.getFileExt=function(a){if(a.indexOf(".")>0){var b=a.substr(0,a.lastIndexOf(".")),a=a.substr(a.lastIndexOf(".")+1);return[b,a]}else return[a,""]};
CC.labelBind=function(a){var b=jQuery;b(a).delegate("[data-lid]","mouseout mouseover",function(){var a=b(this);setTimeout(function(){a.toggleClass("tag_squ");a.toggleClass("tag_squ_on")},200)}).delegate("[data-lid]","click",function(){var a=b(this).closest("[data-lid]").data("lid");a&&CC.goFolder(a,"label"+a);return!1}).delegate("[data-lid] i","click",function(a){var a=b(a.target).parent("a"),d=a.data("mid"),e=a.data("lid");if(d&&e&&(MM["label"+e].marklabel("delete",[d],e),a.remove(),/^readMail/.test(""+
GE.tab.curid)))CM[GE.tab.curid][gConst.dataName].label=jQuery.map(CM[GE.tab.curid][gConst.dataName].label,function(a){var b=[e],c,d=b.length,n=!1;for(c=0;c<d;c++)b[c]==a&&(n=!0);return n?null:a});return!1})};CC.isLabelMail=function(){return GC.check("MAIL_MANAGER_LABELMAIL")?!0:!1};CC.isBigFont=function(){return gMain.defaultFontSize=="bigfont"?!0:!1};CC.isOA=function(){return CorpType&&CorpType==1?!0:!1};CC.isDisk=function(){return GC.check("DISK")};
CC.isMobileBind=function(a){a=a.toInt();return(a&1)!=0?!0:!1};CC.getMailFromByID=function(a,b){if(!a)return null;for(var c=CM[a]["var"],d,e=0,f=c.length;e<f;e++){var g=c[e];if(g.mid===b){d=g;break}}return d.from.replace(/([\s\S]+<)([\s\S]+)>/,"$2")};CC.getSecurityMailName=function(a){var b=[];a-=0;b.push(Lang.Mail.slPublic||"");b.push(Lang.Mail.slSecret||"");b.push(Lang.Mail.slTopSecret||"");if(a<0||a>2)a=0;return b[a]};
CC.getResourceAbsoluteURL=function(){var a=gMain.resourceRoot;return a.indexOf("http")>-1?a:location.protocol+"//"+location.host+a};CC.gotoSMS=function(a){a="{0}/se/sms/smsindex.do?sid={1}&to={2}".format(gMain.webPath,gMain.sid,a);CC.goOutLink(a,"sms","\u77ed\u4fe1")};CC.writeUserAttributesToServer=function(a){MM.doService({url:"/mail/data.do",func:"mail:setAttrs",data:a,call:function(b){if(b&&b.code=="S_OK")for(var c in a)CC.updateLocalUserAttribute(c,a[c])},failCall:function(){},msg:""})};
CC.getUserAttributeFromLocal=function(a){return!gMain.userAttrs?"":gMain.userAttrs[a]||""};CC.updateLocalUserAttribute=function(a,b){if(!gMain.userAttrs)gMain.userAttrs={};gMain.userAttrs[a]=b};
CC.getUserInfoFromLocalAddress=function(a){function b(a){this.type=a[0];this.id=a[1];this.name=a[2];this.mail=a[3];this.phone=a[4];this.fax=a[5];this.simple=a[6];this.full=a[7]}var c=GE.addressLocalStore||[];if(!a)return null;if(c.length){c=c[2];a=a.email||"not mail number";a.indexOf(">")&&a.indexOf("<")>-1&&(a=Email.getValue(a));for(var d=0,e=c.length;d<e;d++)if(c[d][3]==a)return new b(c[d])}else return null};
CC.countStrlength=function(a){var b=0,c=[],d=0;if(a.length>0)for(c=a.split("");b<c.length;b++)d+=/[\u4e00-\u9fa5]+/.test(c[b])?12:6;return d};CC.addFolderItem=function(a,b){a.push({fid:b.fid,folderColor:0,folderPassFlag:0,hideFlag:0,keepPeriod:0,location:b.location,name:b.name,parentId:0,pop3Flag:0,reserve:0,stats:{attachmentNum:0,messageCount:0,messageSize:0,unreadMessageCount:0,unreadMessageSize:0},type:b.type,vipFlag:0,flag:b.flag,virtualFolder:!0})};
CC.removeFolderItem=function(a){for(var b={9999996:1,9999997:1,9999998:1,9999999:1},c=a.length;c--;)b[a[c].fid.toString()]&&a.splice(c,1);return a};CC.power||(CC.power={});CC.power.offSensMail=function(){return GC.check("MAIL_INBOX_SEN")};CC.power.offQuickSubject=function(){return!0};CC.isSecurityMail=function(){return typeof top.gMain!=="undefined"&&top.gMain.ifibc=="1"?!0:!1};
CC.getSubjectColorObject=function(a){if(GE&&!GE.subjectColorObject&&(GE.subjectColorObject={},gConst.subjectColor&&gConst.subjectColor.length))for(var b=0;b<gConst.subjectColor.length;b++)gConst.subjectColor[b].val&&(GE.subjectColorObject[gConst.subjectColor[b].val]=gConst.subjectColor[b]);return GE.subjectColorObject[a.toString()]||{value:"#000000"}};CC.power.offAutoDestroy=function(){return GC.check("MAIL_INBOX_DESTROY")};CC.power.offRestoreDeleted=function(){return GC.check("MAIL_MANAGER_DElETED")};
CC.power.offStarMail=function(){return!0};CC.checkNetwork=function(a){var a=typeof tipFlag==="undefined"?!0:a,b;b=navigator.userAgent.indexOf("Firefox")>0||jQuery.browser.opera||/msie 6/i.test(navigator.userAgent)?CC.checkOtherBrowserNetwork():navigator.onLine==!1&&CC.checkOtherBrowserNetwork()==!1?!1:!0;!b&&a&&CC.showMsg("\u7f51\u7edc\u65ad\u5f00\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5.",!0,!1,"caution");return b};
CC.checkOtherBrowserNetwork=function(){var a=new (window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");a.open("HEAD","//"+window.location.hostname+"/?rand="+Math.floor((1+Math.random())*65536)+"&norefreshSid="+(window.nsid!==void 0?window.nsid:0),!1);try{return a.send(),a.status>=200&&a.status<300||a.status===304}catch(b){return!1}};CC.power.offWorkOrder=function(){return!0};CC.setAllRead=function(a){a=MM[a];a.isAll=!0;a.mark("","read",0,"\u5df2\u8bfb");a.isAll=!1};
CC.detectZoom=function(){var a=0,b=0,b=window.screen,c=navigator.userAgent.toLowerCase();window.devicePixelRatio!==void 0?a=window.devicePixelRatio:~c.indexOf("msie")?b.deviceXDPI&&b.logicalXDPI&&(a=b.deviceXDPI/b.logicalXDPI):window.outerWidth!==void 0&&window.innerWidth!==void 0&&(a=window.outerWidth/window.innerWidth);a&&(a=Math.round(a*100));window.devicePixelRatio&&window.devicePixelRatio===1&&(b=Math.round(window.outerWidth/window.innerWidth*100),Math.abs(a-b)>2&&(a=b));return a};
CC.zoomTip=function(a,b){var c="",d;CC.getUserAttributeFromLocal("offZoomTip")||(a(".top-navbarTip_yellow").length<1&&(c+='<div class="top-navbarTip_yellow">',c+='<a id="btnZoomTip"  href="javascript:;" class="clsbtn"></a>',c+='<i class="i-oarm ml_5 mr_5 vm"></i>',c+="<span>",c+='\u60a8\u7684\u6d4f\u89c8\u5668\u76ee\u524d\u5904\u4e8e\u7f29\u653e\u72b6\u6001\uff0c\u4f1a\u5bfc\u81f4\u90ae\u7bb1\u663e\u793a\u4e0d\u6b63\u5e38\uff0c\u60a8\u53ef\u4ee5\u952e\u76d8\u6309"ctrl+\u6570\u5b57\u952e0"\u7ec4\u5408\u952e\u6062\u590d\u521d\u59cb\u72b6\u6001\u3002',
c+="</span>",c+='<a class="dtno" href="javascript:;" id="btnOffZoomTip" title="\u4e0d\u518d\u63d0\u793a">\u4e0d\u518d\u63d0\u793a</a>',c+="</div>",a(c).insertBefore(a(".top-navbar")),a("#btnZoomTip").click(function(){a(this).parent().hide()}),a("#btnOffZoomTip").click(function(){CC.writeUserAttributesToServer({offZoomTip:"true"});CC.zoomTip.isNoShow=!0;a(this).parent().parent().hide()})),d=function(){CC.detectZoom()!==100&&!CC.zoomTip.isNoShow?a(".top-navbarTip_yellow").show():a(".top-navbarTip_yellow").hide()},
d(),jQuery(window,b).on("resize",function(){d()}),jQuery("body",b).keyup(function(){d()}))};
CC.showModIBCdiv=function(a,b,c){function d(){parent.MM.doService({func:"mail:SoapModifyMemberPwd",absUrl:(parent.gMain?parent.gMain.webPath||"":"")+"/service/mail/ibcsoap",data:{newpwd:e("#ibcNewPwd",parent.document).val().trim(),oldpwd:e("#ibcOldPwd",parent.document).val().trim()},call:f,failCall:b})}var e=jQuery,f=function(b){if(b){e("#ibcNewPwd",parent.document);var c=e("#ibcOldPwd",parent.document),d=e("#ibcConfirmPwd",parent.document);if(b.errorCode=="20022")h.show(c[0],"\u539f\u5bc6\u7801\u9519\u8bef, \u8bf7\u91cd\u65b0\u8f93\u5165");
else if(b.errorCode=="20080")g.show(c[0],"\u65b0\u5bc6\u7801\u683c\u5f0f\u9519\u8bef, \u8bf7\u91cd\u65b0\u8f93\u5165");else if(b.errorCode=="1"){b=d.val().trim();e("#divDialogCloseconfirm",parent.document).click();CC.showMsg("\u4fee\u6539\u5bc6\u7801\u6210\u529f",!0,!1,"option");if(typeof gMain!="undefiend"&&typeof gMain.userAttrs!="undefined")gMain.userAttrs.firstuseibc="1",gMain.userAttrs.modifyibcpwd="0",gMain.userAttrs.autosign="0";a&&a(b)}else b.summary!=""?CC.showMsg(b.summary,!0,!1,"error"):
CC.showMsg("\u4fee\u6539\u5bc6\u7801\u5931\u8d25",!0,!1,"error")}},b=b||function(){CC.showMsg("\u4fee\u6539\u5bc6\u7801\u5931\u8d25",!0,!1,"error")},g=new parent.ToolTips({id:"",win:window,left:117,top:86,direction:parent.ToolTips.direction.Up}),h=new parent.ToolTips({id:"",win:window,left:116,top:48,direction:parent.ToolTips.direction.Up}),j=new parent.ToolTips({id:"",win:window,left:126,top:186,direction:parent.ToolTips.direction.Bottom}),n="\u4f60\u7684\u5e10\u53f7\u7684\u79c1\u94a5\u5bc6\u7801\u4e3a\u521d\u59cb\u5bc6\u7801,\u4e3a\u4fdd\u969c\u5b89\u5168,\u8bf7\u4fee\u6539";
c||(n="\u4e3a\u4e86\u4fdd\u969c\u5b89\u5168\uff0c\u8bf7\u4fee\u6539\u79c1\u94a5\u5bc6\u7801");CC.showDiv("<div style='padding:0 0 35px 25px' id='ibcWrap'><p style='padding:0px 0 10px 0; color:gray'>"+n+"</p><ul><li style='padding:5px'><span style='display: inline-block;text-align: right;width: 85px;'>\u539f\u5bc6\u7801\uff1a</span><input class='rm_txt' style='width:180px; height:20px' maxlength='64' type='password' autoComplete='false' id='ibcOldPwd'/></li><li style='padding:5px'><span style='display: inline-block;text-align: right;width: 85px;'>\u65b0\u5bc6\u7801\uff1a</span><input class='rm_txt' style='width:180px; height:20px'  maxlength='64' type='password' autoComplete='false' id='ibcNewPwd'/></li><li style='padding:5px'><span style='display: inline-block;text-align: right;width: 85px;'>\u786e\u8ba4\u5bc6\u7801\uff1a</span><input class='rm_txt' style='width:180px; height:20px'  maxlength='64' type='password' autoComplete='false' id='ibcConfirmPwd'/></li></ul></div>",
function(){return!0},"\u79c1\u94a5\u5bc6\u7801\u4fee\u6539","","");e("#ibcOldPwd",parent.document).focus();(function(){function a(){if(c.val().trim()==="")return h.show(c[0],"\u65e7\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!1;else if(c.val().trim().length<6||c.val().trim().length>64)return h.show(c[0],"\u5bc6\u7801\u957f\u5ea6\u97006-64\u4f4d"),!1;if(b.val().trim()==="")return g.show(b[0],"\u65b0\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!1;else if(b.val().trim().length<6||b.val().trim().length>64)return g.show(b[0],
"\u5bc6\u7801\u957f\u5ea6\u97006-64\u4f4d"),!1;if(f.val().trim()==="")return j.show(f[0],"\u786e\u8ba4\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!1;else if(f.val().trim().length<6||f.val().trim().length>64)return j.show(f[0],"\u5bc6\u7801\u957f\u5ea6\u97006-64\u4f4d"),!1;return b.val().trim()!==f.val().trim()?(j.show(f[0],"\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),!1):!0}var b=e("#ibcNewPwd",parent.document),c=e("#ibcOldPwd",parent.document),f=e("#ibcConfirmPwd",
parent.document);e("#divDialogCloseconfirmbtn_0",parent.document).unbind().bind("click",function(){if(a())d();else return!0});e("#ibcConfirmPwd",parent.document).unbind().bind("keyup",function(b){b.keyCode==13&&a()&&d()})})()};
CC.showUndoIBCdiv=function(a,b,c){function d(){return e("#ibcPwd",parent.document).val().trim()===""?(c.show(e("#ibcPwd",parent.document)[0],"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!0):e("#ibcPwd",parent.document).val().trim().length<6||e("#ibcPwd",parent.document).val().trim().length>30?(c.show(e("#ibcPwd",parent.document)[0],"\u5bc6\u7801\u957f\u5ea6\u97006-64\u4f4d"),!0):(f=e("#autopass",parent.document)[0].checked?1:0,parent.MM.doService({func:"mail:SoapVerifyIbcPwd",absUrl:(parent.gMain?parent.gMain.webPath||
"":"")+"/service/mail/ibcsoap",data:{oldpwd:e("#ibcPwd",parent.document).val().trim(),autodec:f},call:g,failCall:b}),!1)}var e=jQuery,f=0,g=a||function(){e("#divDialogCloseconfirm",parent.document).click();CC.showMsg("\u89e3\u5bc6\u6210\u529f",!0,!1,"option");if(f&&typeof gMain!="undefined"&&typeof gMain.userAttrs!="undefined")gMain.userAttrs.modifyibcpwd="1"},b=b||function(){CC.showMsg("\u89e3\u5bc6\u5931\u8d25",!0,!1,"error")},c=c||new parent.ToolTips({id:"",win:window,left:85,top:75,direction:parent.ToolTips.direction.Bottom});
CC.showDiv("<div style='padding:20px 0 5px 10px' id='ibcWrap'><p style='color:gray; margin-bottom:15px;'>\u6b64\u90ae\u4ef6\u4e3a\u6570\u5b57\u52a0\u5bc6\u90ae\u4ef6\uff0c\u9700\u8981\u8f93\u5165\u4f60\u7684\u79c1\u94a5\u5bc6\u7801\u8fdb\u884c\u89e3\u5bc6\u90ae\u4ef6\u3002</p><span style='padding-left:36px'>\u5bc6 \u7801\uff1a</span><input class='rm_txt' style='width:180px; height:20px' type='password'maxlength='64' autoComplete='false' id='ibcPwd'/><p style='margin-top:30px'><span><input type='checkbox' id='autopass'/><label for='autopass' style='color:gray'>\u4ee5\u540e\u81ea\u52a8\u9a8c\u8bc1</label></span></p></div>",
function(){return!0},"\u79c1\u94a5\u5bc6\u7801\u9a8c\u8bc1","","");e("#ibcPwd",parent.document).focus();e("#divDialogCloseconfirmbtn_0").before("<a id='modIbc' href='###' style='margin-right:143px; padding-left:10px; color:#blue;'>\u79c1\u94a5\u5bc6\u7801\u4fee\u6539</a>");e("#modIbc").bind("click",function(){CC.showModIBCdiv()});e("#divDialogCloseconfirmbtn_0").bind("click",d);e("#ibcPwd",parent.document).unbind().bind("keyup",function(a){a.keyCode==13&&d()})};
CC.getAttachRead=function(a,b,c){MM.mailRequestApi({func:"mbox:getMessageInfo",data:{ids:[a],filterFields:"flags"},call:b,failCall:c||function(){}})};CC.getSmailNoVerify=function(a,b){top.MM.doService({func:"mail:SoapVerifyIbcPwd",absUrl:(parent.gMain?parent.gMain.webPath||"":"")+"/service/mail/ibcsoap",data:{mid:a},call:b})};
(function(){if(!window.GMC)window.GMC={},GMC.initialize=function(a,b){var c=MM[a],d,e;for(d in b)e=b[d],typeof e=="function"||typeof e=="object"?c[d]=e:e&&(c[d]=e)},GMC.getHtml=function(a,b,c){return CC.getIframe(a,b,"auto",c)},GMC.setDivHeight=function(a){var b=CC.docHeight()-GE.pos()[1],c=CC.DocWidth()-GE.pos()[0];$(gConst.divToolbar+a)&&(b-=$(gConst.divToolbar+a).offsetHeight);b=Math.max(b,0)+"px";Math.max(c,0);c=this.getFrameObj(a);a=this.getFrameWin(a);try{if(c)c.style.height=b,documentEventManager&&
documentEventManager.addDoc(a.document)}catch(d){}},GMC.getMainHeight=function(a){var b=CC.docHeight()-GE.pos()[1];$(gConst.divToolbar+a)&&(b-=$(gConst.divToolbar+a).offsetHeight);return Math.max(b,0)},GMC.setUrl=function(a,b){var c=this.getFrameObj(a);if(c)c.src=b},GMC.getMMObj=function(a,b){if(!MM[a])MM[a]={},Object.extend(MM[a],MM[b]),MM[a].name=a,MM[a].type=b;return MM[a]},GMC.getFrame=function(a){return window.frames[gConst.ifrm+a]},GMC.getFrameObj=function(a){return $(gConst.ifrm+a)},GMC.getFrameWin=
function(a){if(a=this.getFrameObj(a))return a.contentWindow},GMC.gcMem=function(a){try{var b=GMC.getFrameWin(a);b&&El.gc(b.document)}catch(c){}}})();function ReadMail(){this.omid=this.mid="";this.fid=0;this.menuId="MAIL";this.mailContent=""}ReadMail.fMenus={};
ReadMail.menuData={MAIL_INBOX_PASSAUDIT:{sort:-1},MAIL_INBOX_NOTPASSAUDIT:{sort:0},MAIL_READ_REPLY:{sort:1},REPLY:{MAIL_READ_REPLYATTACH:{sort:1},MAIL_READ_REPLYNOATTACH:{sort:2}},MAIL_READ_REPLYALL:{sort:2},REPLYALL:{MAIL_READ_REPLYALLATTACH:{sort:1},MAIL_READ_REPLYALLNOATTACH:{sort:2}},MAIL_WRITE_RESEND:{sort:3},MAIL_INBOX_FORWARD:{sort:4},MAIL_INBOX_DELETE:{sort:5},MAIL_INBOX_REALDELETE:{sort:6},MAIL_INBOX_MARK:{MAIL_INBOX_MARK_URGENT:{sort:3},MAIL_INBOX_MARK_COMMON:{sort:4},MAIL_INBOX_MARK_TOP:{sort:5},
MAIL_INBOX_MARK_NOTOP:{sort:6}},MAIL_INBOX_MOVE:{sort:8},MAIL_INBOX_INFORM:{sort:9},MORE:{MAIL_READ_PRINT:{sort:1},MAIL_READ_VIEW:{sort:2},MAIL_READ_DOWNLOAD:{sort:3}}};
ReadMail.prototype={initialize:function(){var a=MM[gConst.readMail];a.func=gConst.func.readMail;a.url=gConst.apiPostPath;a.reqtype="api";a.msg="";a.needRequest=!0;a.from="";a.menuId=this.menuId;a.stateFlagArr=Lang.Mail.list_MailType.split(",");a.sessionMail=[];a.attachImgList=[];var b,c;for(b in this)c=this[b],typeof c=="function"&&(a[b]=c);this.getMenuHash(CC.getMailMenu(gConst.menu.readmail),ReadMail.fMenus)},getMenuHash:function(a,b){for(var c=a.length,d=0;d<c;d++)b[a[d].name]=a[d]},showMore:function(a,
b,c,d){function e(a){a.length>120&&(a=a.substring(0,120)+"...");return a}var f=this.name,g="",h=this.to,j=this.cc;if(a.omid)a=a.omid,h=this.sessionMail[a].to,j=this.sessionMail[a].cc;switch(b){case "to":g=h;break;case "cc":g=j;break;case "bcc":g=this.bcc}g=g.split(",");h="";h=[];if(g.length>6)if(c&&c>0){for(j=0;j<g.length;j++)h.push('<span style="display:inline-block">'+e(g[j])+"</span>");h=h.join(",")+"<a href=\"javascript:;\" onclick=\"parent.MM['{0}'].showMore('{1}','{2}','{3}',document);\">[\u2191'{4}']</a>".format(f,
a,b,0,Lang.Mail.hideMsg)}else{h=[];for(j=0;j<6;j++)h.push('<span style="display:inline-block">'+e(g[j])+"</span>");h=h.join(",")+"<a href=\"javascript:;\" onclick=\"parent.MM['{0}'].showMore('{1}','{2}','{3}',document);\">[\u2193{5}{4}{6}]</a>".format(f,a,b,1,g.length-6,Lang.Mail.hy,Lang.Mail.gContact)}else{for(f=0;f<g.length;f++)h.push('<span style="display:inline-block" title=\''+g[f]+"'>"+e(g[f])+"</span>");h=h.join(",")}if(c<0)return h.replace(/&apos;/g,"&#39");else d.getElementById(a+b).innerHTML=
h.replace(/&apos;/g,"&#39")},getHtml:function(a){var b=this.name,a=a||CM[b]["var"],c=a.omid,d=a.sessionMails||[this.mi],e=Util.formatDate(new Date(a.sendDate*1E3)),f=CC.getMailText(a.account);this.data=a;this.mid=c;this.from=f;this.sessionMails=d;this.date=e;if(a.flag.memoFlag)this.remark=a.flag.memoFlag;return CC.isSessionModeReadMail(this.fid)&&d.length>1?'<div id="'+gConst.mainToolbar+b+'" class="mt_5"></div>'+'<iframe id="{0}" name="{0}" frameborder="0" src="{1}?sid={2}&mid={3}&type=2&rnd={4}" style="width:100%;height:100%;" scrolling="auto"></iframe>'.format(gConst.ifrmReadmail+
b,gConst.readMailSessionUrl,gMain.sid,c,GC.gRnd()):'<div id="'+gConst.mainToolbar+b+'"  class="mt_5"></div>'+'<iframe id="{0}" name="{0}" frameborder="0" src="{1}?sid={2}&mid={3}&type=1&rnd={4}" style="width:100%;height:100%;" scrolling="auto"></iframe>'.format(gConst.ifrmReadmail+b,gMain.webPath+"/static/se/mail/readmail.htm",gMain.sid,c,GC.gRnd())},init:function(){var a=this,b=CM[this.name]["var"];this.updatePrevNextStatus(b.prev,b.next);this.initSMS();typeof MM[this.name].closeTab=="function"&&
MM[this.name].closeTab();CC.sendMDN(b.requestReadReceipt,b.readReceipt,b.to);CC.isLabelMail()&&function(a){a("#ifrmReadmail_Content_"+GE.tab.curid).load(function(a){CC.labelBind(a.target.contentDocument||a.target.contentWindow.document)})}(jQuery);b=document.getElementById("ifrmReadmail_Content_readMail"+a.mid);b.attachEvent?b.attachEvent("onload",function(){a.fid==3&&parent.GC.check("MAIL_MANAGER_BACK")&&a.getRecallData();a.initPreviewEvent()}):b.onload=function(){a.fid==3&&parent.GC.check("MAIL_MANAGER_BACK")&&
a.getRecallData();a.initPreviewEvent()}},initPreviewEvent:function(){var a=jQuery,b=document.getElementById(parent.gConst.ifrmReadmail+"readMail"+this.mid).contentWindow.document;a(".li_preview",b).mouseover(function(){a(this).find("div").attr("class","imgInfo_Bank imgInfo m_clearfix")}).mouseout(function(){a(this).find("div").removeClass("imgInfo_Bank")})},getToolbar:function(){var a=[],b=this.mi.fid,c=this.data.denyForward||0,d=(this.data.headers||{}).securityLevel||0,e=this.data.sendWay||0,f=this.data,
g=0;if(typeof f!="undefined")g=f.auditStatus,!g&&f.headers&&(g=f.headers.auditStatus);if(f.sessionMails&&f.sessionMails.length>0)return[];if(!b)b=this.fid;if(a&&a.length>0)return a;for(var h in ReadMail.menuData)if(ReadMail.fMenus[h]){if((!menu2AuthorityMap||menu2AuthorityMap&&!menu2AuthorityMap[h]||menu2AuthorityMap&&menu2AuthorityMap[h]&&GC.check(menu2AuthorityMap[h]))&&!(b!=3&&h=="MAIL_WRITE_RESEND"))(b==4||g==3||g==4||gMain.sessionMode=="1")&&h=="MAIL_INBOX_DELETE"||c==1&&(h=="MAIL_INBOX_FORWARD"||
h=="MAIL_INBOX_MOVE"||h=="MAIL_INBOX_INFORM")||(h=="MAIL_READ_REPLY"?c?a.push(ReadMail.fMenus[h]):this.data.attachments.length>0||a.push(ReadMail.fMenus[h]):h=="MAIL_READ_REPLYALL"?c?a.push(ReadMail.fMenus[h]):this.data.attachments.length>0||a.push(ReadMail.fMenus[h]):gMain.sessionMode=="1"&&h=="MAIL_INBOX_REALDELETE"||(g==3||g==4||gMain.sessionMode=="1")&&h=="MAIL_INBOX_MOVE"||1<b&&b<6&&h=="MAIL_INBOX_INFORM"||b!=4&&h=="MAIL_INBOX_REALDELETE"||a.push(ReadMail.fMenus[h]))}else if(h=="MORE"&&c!=1&&
e==0&&d==0&&!CC.isSessionMode())f={id:"-5",attrs:"getsub=true",name:"MAIL_READ_MORE"},f.text=Lang.Mail.more,f.url="",f.isShow=!0,f.urlType=2,f.sort=8,f.children=[],a.push(f);else if(h=="REPLY"&&this.data.attachments.length>0&&!c)f={id:"-6",attrs:"getsub=true",name:"MAIL_READ_REPLY"},f.text=Lang.Mail.tb_Reply,f.url="",f.isShow=!0,f.urlType=2,f.sort=1,f.children=[],a.push(f);else if(h=="REPLYALL"&&this.data.attachments.length>0&&!c)f={id:"-6",attrs:"getsub=true",name:"MAIL_READ_REPLYALL"},f.text=Lang.Mail.tb_ReplyAll,
f.url="",f.isShow=!0,f.urlType=2,f.sort=1,f.children=[],a.push(f);else if(h=="MAIL_INBOX_PASSAUDIT"&&(g==3||g==4)){if(CC.isAudit()&&b=="14")f={id:"-7",name:"MAIL_INBOX_PASSAUDIT"},f.text=Lang.Mail.Write.auditPass,f.url="menu",f.isShow=!0,f.urlType=2,f.sort=1,f.children=[],a.push(f)}else if(h=="MAIL_INBOX_NOTPASSAUDIT"&&(g==3||g==4)&&CC.isAudit()&&b=="14")f={id:"-8",name:"MAIL_INBOX_NOTPASSAUDIT"},f.text=Lang.Mail.Write.auditNotPass,f.url="menu",f.isShow=!0,f.urlType=2,f.sort=2,f.children=[],a.push(f);
b=El.createElement("div","div_pages_"+this.mid,"pager");b.isNode=!0;b.isShow=!0;a.push(b);return this.menu=a},getToolbarMenu:function(a){var b=[],c=0,c="";switch(a){case "MOVE":c=CC.getFolders();this.getAllFolder(b,c);break;case "MARK":b=this.getAllChildren("MAIL_INBOX_MARK");if(CC.isSessionMode())for(c=0;c<b.length;c++)(b[c].name=="MAIL_INBOX_MARK_NOTOP"||b[c].name=="MAIL_INBOX_MARK_TOP")&&b.splice(c,2);break;case "REPLY":case "REPLYALL":case "MORE":var a=ReadMail.menuData[a],d;for(d in a)ReadMail.fMenus[d]&&
b.push(ReadMail.fMenus[d])}return b},getAllChildren:function(a){var b=[],c=ReadMail.menuData[a],d=this.name;if(c)for(var e in c)if(ReadMail.fMenus[e]){var f=Object.extend({},ReadMail.fMenus[e]);if(CC.isLabelMail()&&a=="MARK"&&e=="MAIL_INBOX_MARK_NOTOP"||(d=="sys"+gConst.folderEnum.monitor||d=="sys"+gConst.folderEnum.audit)&&a=="FILTER"&&e=="MAIL_INBOX_FILTER_NOATTACHMENT")f.attrs="sep=true";b.push(f)}c={id:0,url:"menu",attrs:"",text:"",isShow:!0,name:"",children:[]};if(CC.isLabelMail()&&a=="MAIL_INBOX_MARK")c.id=
-201,c.text=Lang.Mail.label_MyLabel,c.name="MAIL_INBOX_MARK_LABEL",c.url="",c.children=this.getVnode(),a=this.createVisualNode(c),b.push(a);return b},createVisualNode:function(a){var b={},c;for(c in a)b[c]=a[c];return b},getVnode:function(a){var b={id:0,url:"menu",attrs:"",text:"",isShow:!0,name:"",children:[]};switch(a){default:for(var a=CM.folderMain[gConst.dataName],c=[],d=0,e=a.length;d<e;d++){var f=a[d];if(f.type==5)b.id=f.fid,b.text=f.name,b.name="MAIL_INBOX_MARK_LABEL",b.pm=f.fid,b.attrs=(d+
1==e?"sep=true&":"")+"className="+gConst.labelColor[f.folderColor],b.children=[],c.push(this.createVisualNode(b))}c.push(this.createVisualNode({id:0,url:"menu",attrs:"",text:Lang.Mail.label_NewLabel,isShow:!0,name:"MAIL_INBOX_MARK_ADD",children:[]}));c.push(this.createVisualNode({id:0,url:function(){CC.goFolderMain(function(){MM.folderMain.folderCallback()})},attrs:"",text:Lang.Mail.ManageLabel,isShow:!0,name:"MAIL_INBOX_MARK_MANAGER",children:[]}));return c}},getAllFolder:function(a,b,c){for(var d=
this,e=null,f=!1,g="",h=!1,j="",g="",n=0,k=b.length;n<k;n++){var e=b[n],f=e.nodes&&e.nodes.length>0,h=n==b.length-1,j=c||"",g=e.parentId==0?"":h?"\u2514 ":"\u251c ",g=j+g+e.name,q=e.fid;q!=d.fid&&q!==2&&a.push({name:"MAIL_INBOX_MOVE"+q,text:g,value:e.name,url:function(a){return function(b,c,e){e.pm=a;e.op=Lang.Mail.tb_Move;d.doMenu(b,"MOVE",e)}}(q)});f&&(j+=h||e.parentId==0?"\u3000":"\u2502 ",d.getAllFolder(a,e.nodes,j))}},resize:function(){this.setDivHeight()},exit:function(){try{var a=$(gConst.ifrmReadmail+
this.name);if(a){var b=a.contentWindow;b&&El.gc(b.document)}return!0}catch(c){return!0}},setDivHeight:function(){var a=this.name,b=GMC.getMainHeight(a),c=$("readHeader_"+a);c&&(b-=c.off);El.height($(gConst.ifrmReadmail+a),b)},checkStatus:function(){var a=!1;document.getElementById("ifrmReadmail_Content_readMail"+this.mid).contentWindow.document.getElementById("readMail_status").innerHTML==Lang.Mail.Write.hasPassed+"\uff1a"&&(a=!0,parent.CC.showMsg(Lang.Mail.Write.auditedStatus,!0,!1,"caution"));return a},
mark:function(a,b,c){c-=0;a={func:gConst.func.updateMail,data:{ids:a,type:b,value:c}};a.msg=Lang.Mail.list_MarkMail;MM.mailRequest(a)},doMenu:function(a,b,c,d){function e(a){var b=MM.getFolderObject(a);if(b)var c='<a href="javascript:void(0);" data-lid="'+b.fid+'" data-mid="'+k.mid+'" class="'+gConst.labelColor[b.folderColor]+' tag_squ ml_5"><span>'+b.name+"</span><i></i></a>";b=jQuery("#ifrmReadmail_Content_"+GE.tab.curid)[0];jQuery(".tag_div",b.contentDocument||b.contentWindow.document).append(c);
q.push(a)}function f(a,b,c,d){a=CC.getComposeUrl("&funcid="+a+"&mid="+b);d&&(a+="&withAttachments=1");CC.goCompose(a,"compose_"+b,c)}CC.getCurLabId();var c=c||{},d=d||this.mid,a=a||gConst.readMail+d,g=this.from,h=parent.gMain.domain;eval("/"+h+"$/i");var g=g.decodeHTML(),j=parent.Email.getValue(g),n=c.pm||0,k="";b=="REPLYALLNOATTACH"?b="REPLYALL":b=="REPLYNOATTACH"&&(b="REPLY");if(b=="INFORM"&&j.substr(j.indexOf("@")+1).trim()==h)parent.CC.showMsg(Lang.Mail.domainNoBlack,!0,!1,"caution");else{var q=
CM[a][gConst.dataName].label;switch(b){case "URGENT":this.mark([d],"priority",GE.priority.hight);break;case "COMMON":this.mark([d],"priority",GE.priority.common);break;case "TOP":1+GE.topNum<=gConst.topNum?this.mark([d],"top",1):CC.showMsg(Lang.Mail.folder_topNum_over.format(gConst.topNum),!0,!1,"option");break;case "NOTOP":GE.topNum=0;this.mark([d],"top",0);break;case "LABEL":!this.isExists(q,n)&&MM[MM.getModuleByFid(this.fid==0?1:this.fid)].marklabel("add",[d],n,function(){e(n)});break;case "ADD":MM.folderMain.opt("addLabel",
null,null,{from:this.data.account.replace(/([\s\S]+<)([\s\S]+)>/,"$2"),mid:d,o:MM.getModuleByFid(this.fid==0?1:this.fid),call:function(a){e(a)}});break;case "REPLY":case "ONE":f(gConst.func.reply,d,Lang.Mail.tb_ReplyMail);break;case "REPLYALL":f(gConst.func.replyAll,d,Lang.Mail.tb_ReplyAll);break;case "REPLYATTACH":f(gConst.func.reply,d,Lang.Mail.tb_ReplyMail,1);break;case "REPLYALLATTACH":f(gConst.func.replyAll,d,Lang.Mail.tb_ReplyAll,1);break;case "FORWARD":f(gConst.func.forward,d,Lang.Mail.list_FwdMail);
break;case "REFUSE":case "BLACKLIST":CC.setConfig("black",Email.getValue(g.decodeHTML()));break;case "FILTER":g=Email.getValue(g.decodeHTML());CC.setConfig("filter",{name:g,from:g});break;case "VIEW":this.viewMailSource(d);break;case "DELETE":case "DEL":this.del();break;case "PASSAUDIT":(g=this.checkStatus())||this.auditPass("",1,Lang.Mail.Write.mailHasPass,!0,!0,this.mid);break;case "NOTPASSAUDIT":(g=this.checkStatus())||this.auditPass("",0,Lang.Mail.Write.mailHasNotPass,!0,!0,this.mid);break;case "DOWNLOAD":this.downloadsEmail(d,
this.sessionId);break;case "REALDELETE":this.realDelete();break;case "RESEND":f("mbox:editMessage",d,Lang.Mail.list_EditMail);break;case "PRINT":this.printMail(d);break;case "MOVE":(n==0||n==this.fid)&&CC.alert(Lang.Mail.list_MailExistFolder,function(){return!1});this.move(n,Lang.Mail.list_NowMoveMail,c.value);break;case "INFORM":c={mails:[{}],sessionMails:[]};if(g)a=g.indexOf("<"),b=g.indexOf(">"),a>0&&b>0?(c.mails[0].userName=g.substr(0,a),c.mails[0].email=g.substr(a+1,b-a-1)):(c.mails[0].userName=
"",c.mails[0].email=g);c.mails[0].mid=this.mid;c.callback=function(){CC.exit()};c.moduleId=GE.currentFolderModule;CC.inform(c)}}},goCompose:function(a,b,c,d){a=CC.getComposeUrl("&funcid="+a+"&mid="+b);d&&(a+="&withAttachments=1");CC.goCompose(a,"compose_"+b,c)},openReadMail:function(a,b,c){var d=this;MM.mailRequestApi({func:"mbox:getMessageInfo",data:{ids:[b]},call:function(a){var f={mid:b},g=d.name,h={markRead:1,isSession:!1,fid:c};if(a.code=="S_OK"){var j=a["var"][0];f.subject=a["var"][0].subject.encodeHTML();
f.color=a["var"][0].color;f.fid=a["var"][0].fid;f.read=a["var"][0].read;h.sessionId=a["var"][0].mailSession;h.rcptFlag=a["var"][0].flags;h.isEncrypt=typeof j.secureEncrypt!="undefined"&&j.secureEncrypt==1?!0:j.flags&&j.flags.safemail_crypt==1?!0:!1;h.unread=typeof f.read!="undefined"?f.read=="1"?!0:!1:j.flags&&j.flags.read==1?!0:!1;CC.goReadMail(b,f.subject,h,f,function(){GE.tab.del(g);LM.getAllFolders()})}}})},getLang:function(a,b){return a&&typeof a=="string"?a:b},downloads:function(){var a=CM[gConst.readMail+
this.mid]["var"],b=a.attachments,a=a.subject||Lang.Mail.list_noSubject;b&&CC.downloads(b,a,this.mid)},downloadsEmail:function(a,b){var c={formName:"downloadEamil",url:gMain.rmSvr+"/RmWeb/mail?func=mbox:downloadMessages&sid="+gMain.sid,inputName:"downloadDate",data:'<object><array name="ids"><string>'+a+"</string></array></object>",iframeName:"downloadEmailIframe"};if(b&&gMain.sessionMode&&gMain.sessionMode==1)c.data='<object><array name="sessionIds"><int>'+b+"</int></array></object>";this.ajaxForm(c)},
ajaxForm:function(a){function b(a){var b;try{b=document.createElement('<iframe name="'+a+'"></iframe>')}catch(c){b=document.createElement("iframe"),b.name=a}b.id=a;b.style.display="none";return b}var c=document,d=c.body,c=c.createElement("form"),e=function(a,b){var c=document.createElement("input");c.value=b;c.name=a;c.type="hidden";return c}(a.inputName,a.data);c.name=a.formName;c.method="post";c.action=a.url;c.encoding&&c.setAttribute("encoding","multipart/form-data");c.setAttribute("enctype","multipart/form-data");
document.getElementById(a.iframeName)||d.appendChild(b(a.iframeName));c.target=a.iframeName;c.appendChild(e);d.appendChild(c);c.submit();d.removeChild(c)},move:function(a,b,c){MM[GE.currentFolderModule].move([this.mid],a,b||Lang.Mail.list_NowMoveMail,[this.sessionId],Lang.Mail.movemail_success.format('"'+c+'"'));CC.exit()},auditPass:function(a,b,c,d,e,f){a||(a=a||this.mid);a=[a];MM[GE.currentFolderModule].auditPass(a,b,c,d,e,f)},del:function(a){var b=null;if(!a)a=this.mid,b=[this.sessionId];CC.confirm(Lang.Mail.rm_ConfirmDelMail,
function(){MM[GE.currentFolderModule].move([a],GE.folder.del,Lang.Mail.list_NowDelMail,b,Lang.Mail.movemail_success.format('"'+Lang.Mail.folder_4+'"'));CC.exit()})},realDelete:function(){var a=this.mid;CC.confirm(Lang.Mail.rm_ConfirmRealDelMail,function(){MM[GE.currentFolderModule].del([a],"",!0);CC.exit()})},printMail:function(a){a=a||this.mid;a=gConst.mailPrintUrl+"&mid="+(gConst.readMail+a)+"&t=print&"+Math.random();window.open(a)},viewMailSource:function(a){a="{0}?func={1}&sid={2}&mid={3}&part=0&mode=text".format(gConst.apiPostPath,
gConst.func.viewSource,gMain.sid,a);window.open(a,"MailSource","width=500,height=400,top=100,left=100,location=no,resizable=yes,toolbar=no,menubar=no,scrollbars=yes")},newOpen:function(a){a=a||this.mid;a=gConst.mailPrintUrl+"&mid="+(gConst.readMail+a)+"&t=open&"+Math.random();window.open(a)},initEmailContact:function(a){var b=this.sendUser;try{b&&b.length>1&&(LMD.isComplete?CC.isInAddr(b)||a():CC.inAddr(b,function(b){b||a()}))}catch(c){}},initSMS:function(){},addEmailContact:function(a,b){var a=a||
0,c=this.sessionMails[a],d=c.from,e=Email.getName(d),d=Email.getValue(d),c=c.mid;d&&(e=encodeURI(e),e="../addr/quickadd.do?op=addContactInFrom&sid="+GC.sid+"&name="+e+"&mail="+d+"&mid="+c,b&&(e+="&index="+a),CC.showHtml({id:"adddetail",title:Lang.Mail.Write.addContacter,type:"div",url:e,width:600,height:362}))},addEmailContacts:function(a,b){var c=a.decodeHTML().split(","),d=this.sessionMails[0].mid,e=c.length,f="",g=null;if(!parent.GE._AddrCheckData)parent.GE._AddrCheckData={};if(b=="ccType"||b==
"toType"||b=="fromType"){for(var h=g="",e=c.length,f="",j=0;j<e;j++){var n=c[j],f=n.substring(n.indexOf("<")+1,n.indexOf(">"));LMD.userContancts[f]||(g=n.substring(0,n.indexOf("<")).trim(),g=g.replace(/["']/g,""),h=f)}f=gMain.webPath+"/webtransit.do?func=addr:quickAdd&op=addContactToCc&sid="+GC.sid+"&name="+encodeURI(g)+"&mail="+h+"&mid="+d+"&CCOrTo="+b;g={id:"adddetail",title:Lang.Mail.Write.addContacter,type:"div",url:f,width:600,height:362}}else{f=gMain.webPath+"/webtransit.do?func=addr:copyToGroup&op=batchContacts&ccTo="+
b+"&sid="+GC.sid+"&mid="+d;g={id:"copyTo",title:Lang.Mail.addContact,type:"div",url:f,height:244};gMain.addressMails=[];for(j=0;j<e;j++)d=c[j],f=d.substring(d.indexOf("<")+1,d.indexOf(">")),!LMD.userContancts[f]&&!parent.GE._AddrCheckData[d]&&(gMain.addressMails.push(d),parent.GE._AddrCheckData[d]=!0)}CC.showHtml(g)},ToExistInAddressList:function(a){if(!parent.GE._AddrCheckData)parent.GE._AddrCheckData={};var a=a.decodeHTML().split(","),b=a.length,c={notInAddrCount:0,isAllInAddr:!0};if(b<1)return c;
if(b==1){var d=a[0],d=d.substring(d.indexOf("<")+1,d.indexOf(">"));if(d==gMain.userNumber)return c}for(d=0;d<b;d++){var e=a[d],e=e.substring(e.indexOf("<")+1,e.indexOf(">"));if(!LMD.userContancts[e]&&!parent.GE._AddrCheckData[e])c.isAllInAddr=!1,c.notInAddrCount++}return c},CCExistInAddressList:function(a){if(!parent.GE._AddrCheckData)parent.GE._AddrCheckData={};for(var a=a.decodeHTML().split(","),b=a.length,c={notInAddrCount:0,isAllInAddr:!0},d=0;d<b;d++){var e=a[d],e=e.substring(e.indexOf("<")+
1,e.indexOf(">"));if(!LMD.userContancts[e]&&!parent.GE._AddrCheckData[e])c.isAllInAddr=!1,c.notInAddrCount++}return c},closeSMS:function(){function a(a){var e="",e=a==1?Lang.Mail.readMail_alert_msg2:Lang.Mail.readMail_alert_msg1;CC.confirm(e,function(){var a=d+"?OpType=3&EMail="+b;GC.getScript("saveContactScript"+Math.random(),a,function(){ReturnInfos&&(ReturnInfos.retValue=="1"&&El.hide(c),CC.alert(ReturnInfos.retMsg))})})}var b=this.sendUser,c=$("closesms_"+this.mid),d=gMain.webApiServer+"/WebService/SmsNotifyService.aspx",
e;GC.getScript("saveContactScript"+Math.random(),d+"?OpType=1",function(){ReturnInfos&&a(ReturnInfos.retValue)})},loadData:function(a,b,c){var d=this,e=d.name,f={func:gConst.func.readMail,data:{mode:"both",filterStylesheets:0,filterImages:0,filterLinks:0,supportTNEF:0,fileterScripts:1,filterFrames:1,markRead:1,encoding:c.encode||gConst.encode_utf8,mid:a,fid:c.fid},call:function(c){var h=gConst.readMail+a;CM[h]=c;MM[h]=d;f=c["var"];MM[h].mi={subject:f.subject,sendDate:f.sendDate,from:f.account,flags:f.flag,
to:f.to,mid:f.omid,fid:f.fid,size:f.size};MM[h].name=h;var c=f.next,j=f.prev,n=d.getHtml(f);$(gConst.mainBody+e).innerHTML=n;$(gConst.mainBody+e).id=gConst.mainBody+h;n=new Toolbar(h,function(){return MM[h].getToolbar(h)},function(a,b){return MM[h].getToolbarMenu(a,b)},$(gConst.mainToolbar+h),MM[h].menuId);n.init();n.getToolbar();d.updatePrevNextStatus(j,c);CC.updateTitle(b);CC.sendMDN(f.requestReadReceipt,f.readReceipt,f.to);d.setDivHeight();d.name=h;MM[e]=null;jQuery(".toolbar")[0]&&jQuery(".toolbar").hide()},
failCall:function(a){a.errorCode==2306906&&CC.alert(Lang.Mail.maiNoFound)}};MM.mailRequestApi(f)},updatePrevNextStatus:function(a,b){var c=this.mid;if(!CC.isSessionMode()){var d=$("div_pages_"+c),e="";a&&(e+='<a href="javascript:fGoto()" onclick="MM[\'readMail'+c+"'].openReadMail('next','"+a.mid+"',"+this.fid+');" title="'+Lang.Mail.tb_Prev+'" id="btn_next'+c+'">'+Lang.Mail.tb_Prev+"</a>");b&&a&&(e+='<span id="btn_sep'+c+'">|</span>');b&&(e+='<a href="javascript:fGoto()" onclick="MM[\'readMail'+c+
"'].openReadMail('prev','"+b.mid+"',"+this.fid+');" title="'+Lang.Mail.tb_Next+'" id="btn_prev'+c+'">'+Lang.Mail.tb_Next+"</a>");d.innerHTML=e}},deleteSessionMail:function(a,b){var c=this.sessionId;if(CC.isSessionMode()){c={func:"mbox:deleteSessionMessages",data:{sessionId:c,flag:0},call:function(){a?typeof b=="function"&&b():CC.exit()}};if(a){var d=[a];c.data.requestType=1;c.data.ids=d}else c.data.requestType=0;MM.mailRequest(c)}else this.del(a)},bindMeetingEvent:function(a,b){var c=this,d=b||document;
jQuery("#btnMeetingAccepted",d).click(function(){c.replyMeeting(1,a,d,function(){jQuery("#boxMeetingBtns",d).hide();jQuery("#boxMeetingReason",d).hide();jQuery("#boxsettingResult",d).html(c.getSetMeetingHtml("\u63a5\u53d7",a.account))})});jQuery("#btnMeetingTentative",d).click(function(){c.replyMeeting(3,a,d,function(){jQuery("#boxMeetingBtns",d).hide();jQuery("#boxMeetingReason",d).hide();jQuery("#boxsettingResult",d).html(c.getSetMeetingHtml("\u6682\u65f6\u63a5\u53d7",a.account))})});jQuery("#btnMeetingRefuse",
d).click(function(){jQuery("#boxMeetingReason",d).show()});jQuery("#btnMeetingRefuseSubmit",d).click(function(){c.replyMeeting(2,a,d,function(){jQuery("#boxMeetingBtns",d).hide();jQuery("#boxMeetingReason",d).hide();jQuery("#boxsettingResult",d).html(c.getSetMeetingHtml("\u8c22\u7edd",a.account))})});jQuery("#btnMeetingRefuseCancel",d).click(function(){jQuery("#boxMeetingReason",d).hide()})},replyMeeting:function(a,b,c,d){var e="";a===2&&(e=jQuery("#textMeetingReason",c).val());a={func:"mbox:compose",
data:{attrs:{account:top.gMain.userNumber,mid:GC.getUrlParamValue(location.href,"mid"),to:b.account.match(/<(.*?)>/)[1],subject:b.subject,id:b.id,sendWay:5,content:e,meetingAttr:{location:b.meetingInfo.location,meetingStart:b.meetingInfo.meetingStart,meetingEnd:b.meetingInfo.meetingEnd,uid:b.meetingInfo.uid,partStat:a}},action:"deliver",returnInfo:1},call:function(){d&&d();CC.showMsg("\u8bbe\u7f6e\u6210\u529f",!0,!1,"option")},failCall:function(){CC.showMsg("\u53d1\u751f\u9519\u8bef",!0,!1,"error")},
params:{comefrom:5,categoryId:"103000000"},msg:""};top.MM.mailRequestApi(a)},getSetMeetingHtml:function(a,b){return"\u60a8\u5df2\u7ecf"+a+"\u4e86"+b+"\u53d1\u8d77\u7684\u4f1a\u8bae\u9080\u8bf7\u3002"},getMeetingHtml:function(a,b){var c=[],d=CC.getMailText(a.subject,Lang.Mail.list_noSubject),e=new Date(parseInt(a.meetingInfo.meetingStart)*1E3),f=new Date(parseInt(a.meetingInfo.meetingEnd)*1E3),g=a.to.split(","),h=[[],[],[],[]],j=a.meetingInfo.parts,n=0,k,q;for(k=0,q=j.length;k<q;k++)j[k].partStat===
1?h[0].push(j[k]):j[k].partStat===2?h[1].push(j[k]):j[k].partStat===3?h[2].push(j[k]):j[k].partStat===0&&h[3].push(j[k]),top.gMain.userNumber===j[k].parter&&(n=+j[k].partStat);if(parseInt(a.meetingInfo.meetingStart)<(new Date).getTime()/1E3)c.push('<div class="col_red meet-tip mt_15 radround">'),c.push('<i class="i-tx mr_5 ml_20"></i>'),c.push("\u4f1a\u8bae\u5df2\u8fc7\u671f"),c.push("</div>");else if(top.gMain.userNumber===a.account.match(/<(.*?)>/)[1]){c.push('<p class="meet_til">\u60a8\u7684\u4f1a\u8bae\u9080\u8bf7\uff1a\u5df2\u6709');
c.push('<var class="col_green"> ',h[0].length,"</var> \u4eba\u63a5\u53d7\uff1b");c.push('<var class="color_blue"> ',h[2].length,"</var> \u4eba\u6682\u65f6\u63a5\u53d7\uff1b");c.push('<var class="col_red"> ',h[1].length,"</var> \u4eba\u8c22\u7edd\uff1b");c.push('<var class="col_orange"> ',h[3].length,"</var> \u4eba\u672a\u77e5\u3002");c.push("</p>");c.push('<div class="meet-tip clearfix mt_15 radtop">');c.push('<i class="i-cret mt5 mr_5 ml_20 fl"></i>');c.push('<div class="noflow">');c.push('<div class="clearfix pl_5 pr_10" style="line-height:22px;">');
for(k=0;k<h[0].length;k++)c.push('<span class="meet_cn">',h[0][k].parter.encodeHTML(),"</span>");c.push("</div></div></div>");c.push('<div class="meet-tip clearfix" style="margin-top:1px;">');c.push('<i class="i-tx mt5 mr_5 ml_20 fl"></i>');c.push('<div class="noflow">');c.push('<div class="clearfix pl_5 pr_10" style="line-height:22px;">');for(k=0;k<h[2].length;k++)c.push('<span class="meet_cn">',h[2][k].parter.encodeHTML(),"</span>");c.push("</div></div></div>");c.push('<div class="meet-tip clearfix radbtm" style="margin-top:1px;">');
c.push('<i class="i-error mt5 mr_5 ml_20 fl"></i>');c.push('<div class="noflow">');c.push('<div class="clearfix pl_5 pr_10" style="line-height:22px;">');for(k=0;k<h[1].length;k++)c.push('<span class="meet_cn">',h[1][k].parter.encodeHTML(),"</span>");c.push("</div></div></div>");c.push('<div class="meet-tip clearfix radbtm" style="margin-top:1px;">');c.push('<i class="i-unknow mt5 mr_5 ml_20 fl"></i>');c.push('<div class="noflow">');c.push('<div class="clearfix pl_5 pr_10" style="line-height:22px;">');
for(k=0;k<h[3].length;k++)c.push('<span class="meet_cn">',h[3][k].parter.encodeHTML(),"</span>");c.push("</div></div></div>")}else switch(n){case 0:c.push('<p id="boxsettingResult" class="meet_til">');c.push('<strong class="col_green mr_10">',a.account.encodeHTML(),"</strong>");c.push("\u9080\u8bf7\u60a8\u53c2\u4e0e\u4f1a\u8bae\uff0c\u8bf7\u56de\u5e94\u4f1a\u8bae\u53d1\u8d77\u8005\uff1a");c.push("</p>");c.push('<p id="boxMeetingBtns" class="pt_10">');c.push('<a id="btnMeetingAccepted" href="javascript:;" class="n_btn_on"><span><span>\u63a5\u53d7</span></span></a>');
c.push('<a id="btnMeetingTentative" href="javascript:;" class="n_btn ml_5"><span><span>\u6682\u5b9a</span></span></a>');c.push('<a id="btnMeetingRefuse" href="javascript:;" class="n_btn ml_5"><span><span>\u8c22\u7edd</span></span></a>');c.push("</p>");break;case 1:c.push('<p class="meet_til">');c.push("\u60a8\u5df2\u7ecf\u63a5\u53d7\u4e86",a.account.encodeHTML(),"\u53d1\u8d77\u7684\u4f1a\u8bae\u9080\u8bf7\u3002");c.push("</p>");break;case 2:c.push('<p class="meet_til">');c.push("\u60a8\u5df2\u7ecf\u8c22\u7edd\u4e86",
a.account.encodeHTML(),"\u53d1\u8d77\u7684\u4f1a\u8bae\u9080\u8bf7\u3002");c.push("</p>");break;case 3:c.push('<p class="meet_til">'),c.push("\u60a8\u6682\u65f6\u63a5\u53d7\u4e86",a.account.encodeHTML(),"\u53d1\u8d77\u7684\u4f1a\u8bae\u9080\u8bf7\u3002"),c.push("</p>")}c.push('<div id="boxMeetingReason" class="reject_box" style="display: none;">');c.push('<div class="reject mt_10">');c.push('<textarea class="reject_font" id="textMeetingReason"></textarea>');c.push("</div>");c.push('<p class="ta_r pt_10">');
c.push('<a id="btnMeetingRefuseSubmit" href="javascript:;" class="n_btn_on"><span><span>\u786e\u5b9a</span></span></a>');c.push('<a id="btnMeetingRefuseCancel" href="javascript:;" class="n_btn ml_5"><span><span>\u53d6\u6d88</span></span></a>');c.push("</p>");c.push("</div>");c.push('<div class="meet-mode mt_20">');c.push("<ul>");c.push("<li>");c.push('<h2 class="ml_15 fw_b fz_14">',d,"</h2>");c.push("</li>");c.push("<li>");c.push('<div class="clearfix">','<i class="i-address ml_20 fl mt_5"></i>');
c.push('<div class="noflow">');c.push('<p class="meet-adr">',a.meetingInfo.location.encodeHTML(),"</p>");c.push("</div>","</div>","</li>");c.push("<li>");c.push('<div class="clearfix">');c.push('<i class="fl i-meetime ml_20"></i>');c.push('<p class="pl_10 noflow">');c.push("<span>",e.toLocaleDateString(),"</span>");c.push('<span class="pl_10">',e.getHours()+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()),"</span>");c.push('<span class="pl_10">\u81f3</span>');c.push('<span class="pl_10">',
f.toLocaleDateString(),"</span>");c.push('<span class="pl_10">',f.getHours()+":"+(f.getMinutes()<10?"0"+f.getMinutes():f.getMinutes()),"</span>");c.push("</p>","</div>","</li>");c.push("<li>");c.push('<div class="clearfix">');c.push('<i class="fl i-meetren ml_20 mt5"></i>');c.push('<div class="noflow">');c.push('<div class="clearfix pl_10 pr_10">');for(k=0,q=g.length;k<q;k++)c.push("<span>",g[k].encodeHTML(),"</span>");c.push("</div>","</div>","</div>");c.push("</li>");c.push("</ul></div>");return c.join("")+
b},getReadMailHtml:function(a){var b=this.name,a=a||CM[b]["var"],c=MM[b],d=a.omid,e=CC.getMailText(a.subject,Lang.Mail.list_noSubject);this.requestReadReceipt=a.requestReadReceipt;this.readReceipt=a.readReceipt;var f=this.from,g=this.date,h=CC.getMailText(a.to),j=a.cc,n=a.to,k=CC.getMailText(a.cc),q=CC.getMailText(a.bcc),t=a.attachments||[],u=Email.getValue(f.decodeHTML()),s=CC.getMailContent(a),r=u,w=a.denyForward||0,x=a.sendWay||0,z=a.auditStatus;x===4&&a.meetingInfo&&(s=this.getMeetingHtml(a,s));
!z&&a.headers&&(z=a.headers.auditStatus);var y="";if(z=="3"||z=="4")y="<span id='readMail_status'>"+Lang.Mail.Write.unAddit+"\uff1a</span>";else if(z=="5"||z=="6")y="<span id='readMail_status'>"+Lang.Mail.Write.audited+"\uff1a</span>";e=y+e;h&&(r+=","+h);k&&(r+=","+k);q&&(r+=","+q);r=r.split(",");z=[];for(y=0;y<r.length;y++)z.push(parent.Email.getValue(r[y].decodeHTML()));z=parent.Util.unique(z);this.sendName=Email.getName(f.decodeHTML());this.to=h;this.cc=k;this.bcc=q;this.subject=e;this.sendUser=
u;this.maildata=s;this.allUser=z.join(",");h=!0;z=parent.Email.getValue(this.from.decodeHTML());r=parent.Email.getValue(this.to.decodeHTML());this.fromMailAddr=z;this.toMailAddr=r;if(!GC.check("MAIL_INBOX_CONTACTS")||this.fid==3||gMain.userNumber===this.fromMailAddr)h=!1;r=[];r.push("<div id='readMail_all'>");r.push("<div id='readMail_mail_content_container' class='wl-mail'>");r.push("<div id='readMail_inner' class='wl-mail-inner p_relative' style='margin-right:0;'>");h&&r.push('<a id="contact_mail_switch" href="#" class="tx-tr"><i></i></a>');
r.push("<div class=\"readMail\" id='mailhead' >");r.push('<div class="hTitle">');r.push("<h2>");if(this.mi.color)try{if(this.mi.color>gConst.subjectColor.length)this.mi.color=gConst.subjectColor.length;var v=CC.getSubjectColorObject(this.mi.color).value;r.push("<font color='"+v+"'>"+e+"</font>")}catch(G){r.push(e)}else e.length>70?r.push(e.substring(0,70)+"<br/>"+e.substring(70,e.length)):r.push(e);(this.fid==5||this.mi.fid==5)&&r.push('<span style="padding-left:10px;font-weight:normal;"><a href="javascript:;" id=\'notJunk\' onclick="MR.notJunk();" >['+
Lang.Mail.noSpam+"]</a></span>");r.push(this.showMDSHtml(a,"MR"));window.LoginType==gConst.loginType.mm&&r.push("<span style=\"padding-left:10px;font-weight:normal;display:none\" id='isETLink'><a id='isETLink_a' target='_blank' href='#'>["+Lang.Mail.etLink+"]</a></span>");if(CC.isLabelMail()){r[r.length]='<div class="tag_div">';e=0;for(v=a.label.length;e<v;e++)if(y=MM.getFolderObject(a.label[e]))r[r.length]='<a href="javascript:void(0);" data-lid="'+y.fid+'" data-mid="'+d+'" class="'+gConst.labelColor[y.folderColor]+
' tag_squ ml_5"><span>',r[r.length]=y.name,r[r.length]="</span><i></i></a>";r[r.length]="</div>"}r.push("</h2>");r.push("</div>");a&&a.flag&&a.flag.taskFlag&&a.flag.taskFlag=="1"&&(a.headers&&a.headers.taskDate&&a.headers.taskDate>0?(e=new Date(a.headers.taskDate*1E3),e=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes(),r.push('<div class="divTips"><span>\u5df2\u8bbe\u4e3a\u5f85\u529e\u90ae\u4ef6\uff0c'+e+'\u63d0\u9192\u3002</span><li id="btnModRemind_2"><a href="javascript:;" >\u4fee\u6539</a></li><li id="btnTaskStatus_2"><a href="javascript:;" >\u8bbe\u4e3a\u5b8c\u6210</a></li></div>')):
a.headers&&a.headers.taskDate&&a.headers.taskDate==0&&(e=new Date(a.headers.taskDate*1E3),e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),r.push('<div class="divTips"><span>\u5df2\u8bbe\u4e3a\u5f85\u529e\u90ae\u4ef6\u3002</span><li id="btnTaskStatus_2"><a href="javascript:;" >\u8bbe\u4e3a\u5b8c\u6210</a></li></div>')));r.push("<div class=\"readMailInfo\" id='readMailInfo'>");r.push('<div class="rMList">');r.push('<span class="rMl">'+this.getLang(Lang.Mail.list_Send,Lang.Mail.sender)+
"\uff1a</span>");r.push('<div class="rMr">');r.push('<div class="gAddr">');e=f.substr(0,f.lastIndexOf("&lt;"));e.length>200?(e=e.substring(0,200)+"...",r.push('<strong class="gAddrN" tilele=\''+f+"' >"+e+"</strong>")):r.push('<strong class="gAddrN">'+e+"</strong>");r.push('<em class="gAddrE">&lt;'+u+"&gt;</em>");gMain.userNumber!=z&&GC.check("CONTACTS_PER")&&!LMD.userContancts[z]&&r.push('<span class="gAddrE"><a id="addToContact1_'+d+'"  class="addToContact" href="javascript:fGoto();" onclick="oSM.addEmailContacts(\''+
this.from.replace(/'|"/ig,"")+"','fromType');return false;\">"+Lang.Mail.readMail_lb_addtocontacts+"</a></span>");r.push("</div></div></div>");a.sender!=""&&Email.getValue(a.sender)!=Email.getValue(this.from.decodeHTML())&&(r.push('<div class="rMList"><span class="rMl" style="visibility: hidden;">\u53d1\u4ef6\u4eba\uff1a</span><div class="rMr"><div class="gAddr"><span style="margin-left: -17px;">'),r.push("\uff08\u7531"+this.from+"\u4ee3\u53d1\uff09</span></div></div></div>"));r.push('<div class="rMList">');
r.push('<span class="rMl">'+this.getLang(Lang.Mail.readMail_lb_to,Lang.Mail.recerver)+"</span>");r.push('<div class="rMr" ><span id="'+b+'to">'+this.showMore(b,"to",-1)+"</span>");GC.check("CONTACTS_PER")&&!this.ToExistInAddressList(this.to).isAllInAddr&&(this.ToExistInAddressList(this.to).notInAddrCount<2?(r.push('<span id="addTo" style="padding-left:5px"><a id="to_'+d+'"'),r.push(" onclick=\"oSM.addEmailContacts('"+n.replace(/'|"/ig,"")+"','toType');return false; \""),r.push('class="addToContact" href="javascript:fGoto();" >'+
Lang.Mail.addToAddr+"</a></span>")):(r.push('<span id="addTo" style="padding-left:5px"><a id="to_'+d+'"'),r.push(" onclick=\"oSM.addEmailContacts('"+this.to.replace(/'|"/ig,"")+"','to');return false; \""),r.push('class="addToContact" href="javascript:fGoto();" >'+Lang.Mail.pltj+"</a></span>")));r.push("</div></div>");r.push('<div class="rMList">');r.push('<span class="rMl">'+Lang.Mail.readMail_lb_time+"</span>");r.push(' <div class="rMr">'+g+"</div> </div>");GC.check("MAIL_INBOX_SECURITY")&&a.headers&&
a.headers.securityLevel&&(r.push("<div class='rMList'>"),r.push("<span class='rMl'>"+Lang.Mail.securityLevel+"</span>"),r.push("<div class='rMr'>"+parent.CC.getSecurityMailName(a.headers.securityLevel)+"</div></div>"));k!=""&&(r.push('<div class="rMList" id=\'cc_'+d+"'>"),r.push('<span class="rMl">'+this.getLang(Lang.Mail.readMail_lb_cc,Lang.Mail.copto)+"</span>"),r.push('<div class="rMr"><span id="'+b+'cc">'+this.showMore(b,"cc",-1)+"</span>"),f=".addEmailContacts('"+this.cc.replace(/'|"/ig,"")+
"','cc');",this.CCExistInAddressList(this.cc).notInAddrCount==1&&(f=".addEmailContacts('"+j.replace(/'|"/ig,"")+"','ccType');"),j='<span id="addCC" style="padding-left:5px"><a id="cc_{0}" onclick="oSM'+f+'return false; "class="addToContact" href="javascript:fGoto();" >{1}</a></span>',GC.check("CONTACTS_IMPORT")&&(GC.check("CONTACTS")&&GC.check("CONTACTS_OPER")&&this.CCExistInAddressList(this.cc).notInAddrCount==1?r.push(j.format(d,Lang.Mail.addToAddr)):GC.check("CONTACTS")&&GC.check("CONTACTS_OPER")&&
this.CCExistInAddressList(this.cc).notInAddrCount>1&&!this.CCExistInAddressList(this.cc).isAllInAddr&&r.push(j.format(d,Lang.Mail.pltj))),r.push("</div></div>"));q!=""&&this.fid==3&&(r.push('<div class="rMList" id=\'bcc_'+d+"'>"),r.push('<span class="rMl">'+this.getLang(Lang.Mail.prv_lbt_bcc,Lang.Mail.msTo)+"</span>"),r.push('<div class="rMr" id="'+b+'bcc">'+this.showMore(b,"bcc",-1)),r.push("</div></div>"));r.push(this.getAttachHtml(d,t,{denyForward:w}));r.push(this.getRemarkHtml("oSM",d,d,a.flag));
this.fid==3&&this.rcptFlag!=5&&(r.push('<div class="send-state-bg" >'),r.push(this.showDSHtml("oSM")),r.push("</div>"));CC.isSecurityMail()&&r.push(this.getSecurityMailHtml(a));r.push("</div>");r.push('<span class="readmialTool">');gMain.sessionMode&&gMain.sessionMode!="1"&&r.push("<a href='javascript:;'  title='"+(a.flag.starFlag==1?Lang.Mail.haveStar:Lang.Mail.noStar)+"'><i onclick=oSM.starFlag(this,'"+d+"')  flagval="+(a.flag.starFlag?a.flag.starFlag:0)+" id='StarFlag"+d+"' class=\""+(a.flag.starFlag==
1?"i_starFlag_on":"i_starFlag_off")+'"></i></a>  | ');x==0&&r.push("<a href='javascript:;' onclick=oSM.newOpen('"+d+"') title='"+Lang.Mail.readMail_lb_newwindow+'\'  ><i class="i_2win"></i></a> | ');r.push("<a href='javascript:;' onclick=oSM.showRemark('"+d+"',this); flagval='"+(a.flag.memoFlag?a.flag.memoFlag:0)+"'  ck=\"toggle\" title='"+(a.flag.memoFlag==1?Lang.Mail.haveRemark:Lang.Mail.noRemark)+"' id='remarkon_"+d+"'><i id='memoFlag_"+d+"' class='"+(a.flag.memoFlag==1?"i_note_on":"i_note_off")+
"' ></i></a> | ");x==0&&r.push("<a href='javascript:;' onclick=MR.printMail('"+d+"') title='"+Lang.Mail.tb_Print+'\' ><i class="i_alarm"></i></a> | ');r.push("<a href='javascript:;'  title='"+Lang.Mail.contraction+"'><i id='head_"+d+"' onclick=oSM.showHead(this,'"+d+'\') class="i_2trid_up"></i></a> </span>');r.push(TaskMail.getReadIconHtml(a));r.push("</div>");a.flag&&a.flag.selfdestruct?a.flag.selfdestruct===2?r.push('<div class="yellowTips">\u63d0\u9192\uff1a\u8fd9\u662f\u4e00\u5c01\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u53d1\u4fe1\u4eba\u8bbe\u7f6e\u4e86\u8be5\u90ae\u4ef6\u88ab\u9605\u8bfb\u540e\u81ea\u52a8\u9500\u6bc1\uff0c\u56de\u590d\u8fd9\u5c01\u90ae\u4ef6\u65f6\u4f1a\u9690\u85cf\u539f\u6587\u3002</div>'):
a.flag.selfdestruct===1&&r.push('<div class="yellowTips">\u63d0\u9192\uff1a\u8fd9\u662f\u4e00\u5c01\u81ea\u9500\u6bc1\u90ae\u4ef6\uff0c\u53d1\u4fe1\u4eba\u8bbe\u7f6e\u4e86\u90ae\u4ef6\u9605\u8bfb\u8fc7\u671f\u65f6\u95f4\uff0c\u8fc7\u671f\u540e\u5c06\u81ea\u52a8\u9500\u6bc1\uff0c\u56de\u590d\u8fd9\u5c01\u90ae\u4ef6\u65f6\u4f1a\u9690\u85cf\u539f\u6587\u3002</div>'):w&&r.push('<div class="yellowTips">'+Lang.Mail.forbidMaillTip+"</div>");if((x==2||x==3)&&parent.Email.getValue(a.account)==parent.gMain.userNumber&&
c.fid==3)r.push('<div id="pwd_tips" class="yellowTips"><i class="i-mail-lock mr_10"></i>'+Lang.Mail.setedPwd+'<span id="pwd_txt" style="display:none;">'+Lang.Mail.pwd+(c.data.headers.mailPass||"")+'</span><a id="pwd_btn_look" href="javascript:fGoto()" onclick="return false;" class="ml_10">'+Lang.Mail.lookpwd+"</a></div>");CC.power.offSensMail()&&r.push(SensitiveMail.getReadTips(a));r.push('<div class="mialContent" style="position:relative;">');this.mailContent=s;CC.isSecurityMail()?a.flag&&(a.flag.safemail_sign==
-1||a.flag.secureSigned==-1)?r.push("<div style='height:110px; font-size:14px; padding:40px;'>\u56e0\u65e0\u6cd5\u4fdd\u8bc1\u53d1\u4ef6\u4eba\u7684\u771f\u5b9e\u6027\uff0c\u6216\u90ae\u4ef6\u5185\u5bb9\u53ef\u80fd\u88ab\u7be1\u6539\uff0c\u8003\u8651\u5230\u5b89\u5168\u6027\uff0c\u8be5\u90ae\u4ef6\u5df2\u88ab\u5c4f\u853d\u3002</div>"):a.flag&&(a.flag.safemail_crypt==-1||a.flag.secureEncrypt==-1)?r.push("<div style='height:110px; font-size:14px; padding:40px;'>\u56e0\u65e0\u6cd5\u4fdd\u8bc1\u53d1\u4ef6\u4eba\u7684\u771f\u5b9e\u6027\uff0c\u6216\u90ae\u4ef6\u5185\u5bb9\u53ef\u80fd\u88ab\u7be1\u6539\uff0c\u8003\u8651\u5230\u5b89\u5168\u6027\uff0c\u8be5\u90ae\u4ef6\u5df2\u88ab\u5c4f\u853d\u3002</div>"):
r.push("<iframe frameborder=\"0\" scrolling=\"no\" id='mailContent' name='mailContent' onload='oSM.contentOnload(\""+d+'")\' style="width: 100%;" src=\''+gMain.webPath+"/static/se/mail/blank.htm'></iframe>"):r.push("<iframe frameborder=\"0\" scrolling=\"no\" id='mailContent' name='mailContent' onload='oSM.contentOnload(\""+d+'")\' style="width: 100%;" src=\''+gMain.webPath+"/static/se/mail/blank.htm'></iframe>");r.push("</div>");r.push(this.getThumbNailImage(d,t,{denyForward:w}));r.push("<div "+(t.length>
0?"":"class='attrBody'")+"  id='diskList_html' style='display:none;'></div>");GC.check("MAIL_INBOX_WRITE")&&(r.push('<div class="readMail_reply" id="readMail_reply">'),r.push(this.getQuickReplyHtml("oSM",d,d)),r.push("</div>"));r.push("</div>");r.push("</div>");h&&(r.push("<div id='readMail_sidebar' class='wl-mail-side' style='display:none;'>"),r.push(this.getContactMailUI()),r.push("</div>"));r.push("</div>");if(w){r.push("<script>");r.push("document.oncontextmenu = function(e){return false;};");
r.push("document.onselectstart = function(e){return false;};");r.push("<\/script>");r.push('<noscript><iframe src="*.htm"></iframe></noscript>');a=document.createElement("noscript");b=document.createElement("iframe");b.src="*.htm";try{top.document.body.appendChild(a),a.appendChild(b)}catch(F){}}this.showContactMail=h||!1;return r.join("")},mailContentLoaded:function(){this.showContactMail&&this.initContactMail()},mailInfoloaded:function(a){var b=this,a=a||document,c=jQuery("p:contains('Sensitive')",
a);if(c&&c.length){var d=c.parent().parent().next().find("p");c.parent().html("\u60a8\u53d1\u9001\u7684\u90ae\u4ef6\u53ef\u80fd\u89e6\u53d1\u4e86\u5b89\u5168\u7b56\u7565\u6216\u5305\u542b\u654f\u611f\u8bcd");d&&(d.html("\u82e5\u60a8\u60f3\u7ee7\u7eed\u6295\u9012\u8be5\u90ae\u4ef6\uff0c\u8bf7\u9009\u62e9<a href='#' id='encryptMail' onclick='return false;'>\u7ee7\u7eed\u53d1\u9001</a>"),jQuery("#encryptMail",a).bind("click",function(){var a="\u60a8\u9009\u62e9\u4e86\u4ee5\u52a0\u5bc6\u7684\u65b9\u5f0f\u7ee7\u7eed\u53d1\u9001\u8be5\u90ae\u4ef6\uff0c\u8bf7\u8f93\u5165\u52a0\u5bc6\u5bc6\u7801";
a+=parent.Lang.Mail.tips033+'\uff1a<input type="password" id="security_password" class="" /><br/>';a+=parent.Lang.Mail.tips034+'\uff1a<input type="password" id="security_repassword" class="" />';parent.CC.alert(a,function(){var a=jQuery("#security_password",parent.document).val(),c=jQuery("#security_repassword",parent.document).val();if(a.trim()=="")return alert(parent.Lang.Mail.tips017),!0;else if(a!=c)return alert(parent.Lang.Mail.tips031),!0;else b.encryptCode=a,b.makeMailtoZip()})}))}},makeMailtoZip:function(){var a=
CM[gConst.readMail+this.data.mid]["var"]||this.data;parent.MM.mailRequestApi({func:"mbox:emlEncZipCompose",data:{mid:a.omid,encryptCode:this.encryptCode,attachments:a.attachments},call:function(){parent.CC.showMsg("\u8be5\u90ae\u4ef6\u5df2\u52a0\u5bc6\u53d1\u9001\u6210\u529f",!0,!1,"option")},failCall:function(){parent.CC.showMsg("\u8be5\u90ae\u4ef6\u52a0\u5bc6\u53d1\u9001\u5931\u8d25",!0,!1,"error")},params:{comefrom:5,categoryId:"103000000",module:"web",guid:a.omid}})},initContactMail:function(){typeof ContactMailItemType==
"undefined"&&(window.ContactMailItemType={ME:0,OTHER:1});var a=document;a==parent.document&&(a=(a=window.frames[gConst.ifrmReadmail+this.name])?a.window.document:document);this.doc=a;var a=this.from.decodeHTML(),b=parent.gMain.userNumber,a=parent.Email.getValue(a)?parent.Email.getValue(a):a;this.loadContactMail(a,b);this.loadContactAttach(a,b);this.getAddressInfoFromServer(a)},getUserPhoneUI:function(){return'<a id="contact_mail_writeMessage" href="#" class="n_btn ml_5" onclick="return false;"><span><span>\u5199\u77ed\u4fe1</span></span></a>'},
getContactMailUI:function(){var a=[],b=this.from.decodeHTML(),c=parent.CC.getUserInfoFromLocalAddress({email:b}),d,b=parent.Email.getValue(b)==!1?b:parent.Email.getValue(b);if(c)d=c.phone;if(parent.GE.testContactMailPhone)d=parent.GE.testContactMailPhone;a.push('<div class="p_relative">');a.push('<div class="fro" style="+zoom:1;">');a.push('<div class="fro-top clearfix">');a.push('<a id="contact_mail_face_link" href="#" class="fl fro-img" onclick="return false;"><img src="'+parent.CC.getResourceAbsoluteURL()+
'/images/foimg.jpg" width="50" height="50"/></a>');a.push('<div class="fro-top-rt">');a.push('<h3 id="contact_mail_address_name">'+(typeof this.fromUserName!="undefined"?this.fromUserName:"")+"</h3>");a.push('<p id="contact_mail_address_email" class="tf">'+b+"</p>");a.push("</div>");a.push("</div>");a.push('<div class="wl-btner">');a.push('<a id="contact_mail_writeMail" href="#" class="n_btn ml_10" onclick="return false;"><span><span>\u5199\u4fe1</span></span></a>');if(d&&GC.check("MAIL_VAS_SMS"))a.push(this.getUserPhoneUI()),
this.userPhone=d;a.push("</div>");a.push('<div class="wl-tab">');a.push('<div class="wl-tab-hd">');a.push('<ul class="wl-tab-til clearfix">');a.push('<li class="wl-mail-lt on"><a id="contact_mail_mail_tab" href="#" onclick="return false;"><i class="i-readMail-file"></i><span>\u5f80\u6765\u90ae\u4ef6</span></a></li>');a.push('<li class=""><a id="contact_mail_attach_tab" href="#" onclick="return false;"><i class="i-fj mr_5"></i><span>\u5f80\u6765\u9644\u4ef6</span></a></li>');a.push("</ul>");a.push("</div>");
a.push('<div id="mailContact_mailListContainer" class="wl-tab-con"></div>');a.push('<div id="mailContact_attachListContainer" class="wl-tab-con" style="display:none;"></div>');a.push("</div>");a.push("</div>");a.push("</div>");return a.join("")},getAddressInfoFromServer:function(a){var b=this,c=a.indexOf("@")?a.split("@")[0]:a;parent.MM.mailRequest({func:"addr:userQuery",data:{rm_userid:c},call:function(a){if(a.code=="S_OK"&&(a=a["var"],(!b.contactMailCls||b.contactMailCls&&!b.contactMailCls.controls)&&
b.gotCotactControls(),a)){if(b.userPhone){if(a.mobileNumber)b.userPhone=a.mobileNumber}else if(a.mobileNumber)b.userPhone=a.mobileNumber,b.contactMailCls.controls.goMailBtn.after(b.getUserPhoneUI()),b.gotCotactControls();b.fromUserName=a.firstName||a.secondName?(a.firstName+a.secondName+"").encodeHTML():c.encodeHTML();b.contactMailCls.controls.namePanel.html(b.fromUserName);a.imagePath&&b.contactMailCls.controls.faceLink.find("img").attr("src",a.imagePath)}},failCall:function(){(!b.contactMailCls||
b.contactMailCls&&!b.contactMailCls.controls)&&b.gotCotactControls();if(b.contactMailCls.controls.namePanel)b.fromUserName=c.encodeHTML(),b.contactMailCls.controls.namePanel.html(b.fromUserName)},msg:""})},getContactMailItem:function(a,b){var c=a||{},d=b||{},e=[],f="",g="",h=c.type||"mail",j="";if(!ContactMailItemType)return"";typeof c.mode!="undefined"&&(c.mode==ContactMailItemType.ME?(f="log-l",g="dia-lt"):c.mode==ContactMailItemType.OTHER&&(f="log-w",g=""));e.push('<div class="wl-dialog '+f+' mb_5">');
e.push('<em class="diamond '+g+'"></em>');e.push('<div class="wl-dialog-con">');if(h=="mail")e.push('<div class="dialogcon-til tf"><a class="contact_mail_link" data-mid="'+b.mid+'" href="javascript:void(0)" onclick="return false;">'+(d.subject||"").encodeHTML()+"</a></div>"),e.push('<div class="dialog-digest">'),e.push((d.summary||"").encodeHTML()),e.push("</div>");else if(h=="attach")for(c=0;c<d.length;c++)j=parent.CC.getDownloadLink(d[c].mid,d[c].attachOffset,d[c].attachSize,d[c].attachName,d[c].attachType,
d[c].encode),j.indexOf("http")<0&&(j=location.protocol+"//"+location.host+j),e.push('<div class="dialogcon-til tf"><i class="i-fj mr_5"></i><a href="'+j+'">'+d[c].attachName.encodeHTML()+"</a></div>");e.push("</div>");e.push("</div>");return e.join("")},loadContactMail:function(a,b){if(a&&b){var c=this,d={order:"date",desc:1,isSearch:1,recursive:0,start:1,total:200,isFullSearch:0,operator:"and"},e=[];e.push({field:"from",operator:"eq",value:a+";"+b});e.push({field:"to",operator:"eq",value:b+";"+a});
d.condictions=e;d.exceptFids=[2,4];CC.getContactMail({searchParam:d,callback:function(a){a.code=="S_OK"&&(c.renderContactMail(c.filterContactMailData(a["var"])),c.registerContactMailEvents())}})}},filterContactMailData:function(a){for(var b=[],c=a.length||0,d,e,f=1,g=0;g<c;g++)d=a[g],e=parent.Email.getValue(d.from.decodeHTML()),parent.Email.getValue(d.to.decodeHTML()),d.to.decodeHTML().indexOf(e.toString())==-1&&f<15&&(b.push(d),f++);return b},loadContactAttach:function(a,b){if(a){var c=this;parent.MM.mailRequestApi({func:parent.gConst.func.attachList,
data:{start:0,total:15,order:"receiveDate",isSearch:1,stat:1,fid:0,desc:1,filter:{from:a,to:b}},call:function(a){a.code=="S_OK"&&c.renderContactAttach(a["var"])},msg:""})}},renderContactMail:function(a){var b=a.length,c,d,e,f,g=[],h=this.doc||document;if(!this.contactMailCls)this.contactMailCls={};this.contactMailCls.datas=a;if(!this.contactMailCls.attrs)this.contactMailCls.attrs={};if(b){for(var j=0;j<b;j++)if(c=a[j],d={},c)e=c.from,f=c.to,e&&(e=parent.Email.getValue(e)),f&&parent.Email.getValue(f),
d.mode=e==gMain.userNumber?ContactMailItemType.ME:ContactMailItemType.OTHER,g.push(this.getContactMailItem(d,c));g.unshift("<div class='wl-area'>");g.push("</div>");g.push('<div class=\'ta_c wl-spa\'><img align="top" src="'+parent.CC.getResourceAbsoluteURL()+'/images/wl-spa.jpg" width="252" height="6"></div>');g.push('<p class="ta_c"><a id="mailContact_view_more" href="#" onclick="return false;">\u67e5\u770b\u66f4\u591a</a></p>')}else g.push('<div style="text-align:center;">\u6682\u65e0\u5f80\u6765\u90ae\u4ef6</div>');
jQuery("#mailContact_mailListContainer",h).html(g.join(""));this.gotCotactControls()},renderContactAttach:function(a){var b=[],c={},d=this.doc||document,e;if(!this.contactMailCls)this.contactMailCls={};if((this.contactMailCls.attachDatas=a)&&a.length){for(var f=0,g=a.length;f<g;f++)c[a[f].mid]||(e=a[f].from.decodeHTML(),e=(e=parent.Email.getValue(e))?e==parent.gMain.userNumber?ContactMailItemType.ME:ContactMailItemType.OTHER:ContactMailItemType.ME,c[a[f].mid]={len:0,type:e,data:[]}),c[a[f].mid].len++,
c[a[f].mid].data.push(a[f]);this.contactMailCls.attachGroups=c;for(var h in c)b.push(this.getContactMailItem({mode:c[h].type,type:"attach"},c[h].data));b.unshift('<div class="wl-area">');b.push("</div>")}else b.push('<div style="text-align:center;">\u6682\u65e0\u5f80\u6765\u9644\u4ef6</div>');jQuery("#mailContact_attachListContainer",d).html(b.join(""))},gotCotactControls:function(){if(!this.contactMailCls)this.contactMailCls={};var a=this.doc||document;this.contactMailCls.controls={innerPanel:jQuery("#readMail_inner",
a),sidePanel:jQuery("#readMail_sidebar",a),mailTab:jQuery("#contact_mail_mail_tab",a),attachTab:jQuery("#contact_mail_attach_tab",a),mailListContainer:jQuery("#mailContact_mailListContainer",a),attachListContainer:jQuery("#mailContact_attachListContainer",a),switchCard:jQuery("#contact_mail_switch",a),faceLink:jQuery("#contact_mail_face_link",a),namePanel:jQuery("#contact_mail_address_name",a),goMailBtn:jQuery("#contact_mail_writeMail",a),goMessageBtn:jQuery("#contact_mail_writeMessage",a),viewMoreLink:jQuery("#mailContact_view_more",
a)}},registerContactMailEvents:function(){if(this.contactMailCls&&this.contactMailCls.controls){if(!this.contactMailCls.Evts)this.contactMailCls.Evts={};var a=this;Object.extend(this.contactMailCls.Evts,{showPanel:function(){a.contactMailCls.controls.sidePanel.show();a.contactMailCls.controls.innerPanel.css({"margin-right":"255px"});a.contactMailCls.controls.switchCard.removeClass("tx-tl").addClass("tx-tr");jQuery.browser.version=="6.0"&&a.contactMailCls.controls.switchCard.css("right","255px")},
hidePanel:function(b){a.contactMailCls.controls.innerPanel.css({"margin-right":"0"});b?a.contactMailCls.controls.sidePanel.hide():a.contactMailCls.controls.sidePanel.hide("normal");a.contactMailCls.controls.switchCard.removeClass("tx-tr").addClass("tx-tl");jQuery.browser.version=="6.0"&&a.contactMailCls.controls.switchCard.css("right","0px")},adjustHeight:function(){var b=setInterval(function(){var d=a.contactMailCls.attrs.memory||{},e;if(d.bodyHeight){e=d.bodyHeight;clearInterval(b);var d=jQuery(a.doc).find("#mailContent"),
f=jQuery("#mailhead",a.doc),g=jQuery("#readMail_reply",a.doc),h=jQuery("#attach_thumb_container",a.doc);a.contactMailCls.controls.sidePanel.css("height","inherit");var j=a.contactMailCls.controls.sidePanel.height(),n=f.height()||0,k=g.height()||0,h=h.height()||0,q=[],t=0;q.push(parseInt(f.css("margin-top")||0));q.push(parseInt(f.css("margin-bottom")||0));q.push(parseInt(f.css("padding-top")||0));q.push(parseInt(f.css("padding-bottom")||0));q.push(parseInt(g.css("margin-top")||0));q.push(parseInt(g.css("margin-bottom")||
0));q.push(parseInt(g.css("padding-top")||0));q.push(parseInt(g.css("padding-bottom")||0));for(f=0;f<q.length;f++)q[f]&&(t+=q[f]);e=Math.max(j,e+t+n+k+h,500);a.contactMailCls.controls.sidePanel.height(e);d.height(e-n-k-h-t)}},100)},slideSwitch:function(b){b=(parent.EV.getEvent(b).target.documentElement||a.doc).scrollTop||0;a.contactMailCls.controls.switchCard.css({top:b+30+"px"})},swrapCard:function(b){(b||0)==0?(a.contactMailCls.controls.attachTab.parent().removeClass("on"),a.contactMailCls.controls.mailTab.parent().addClass("on"),
a.contactMailCls.controls.attachListContainer.hide(),a.contactMailCls.controls.mailListContainer.show()):(a.contactMailCls.controls.attachTab.parent().addClass("on"),a.contactMailCls.controls.mailTab.parent().removeClass("on"),a.contactMailCls.controls.attachListContainer.show(),a.contactMailCls.controls.mailListContainer.hide());a.contactMailCls.Evts.adjustHeight()},storeUserHabit:function(a){parent.CC.writeUserAttributesToServer({contactMailHabit:a})},readMail:function(b){for(var d,e={},f=a.contactMailCls.datas,
g=0,h=f.length;g<h;g++)f[g].mid==b&&(d=f[g]);e.markRead=0;e.isSession=!1;e.fid=d.fid;e.sessionId=d.mailSession;e.isEncrypt=d.secureEncrypt=="1"?!0:!1;parent.CC.goReadMail(b,d.subject,e,d)},readMoreMail:function(){var b=[];b.push({field:"from",operator:"contains",value:a.fromMailAddr+";"+a.toMailAddr});b.push({field:"to",operator:"contains",value:a.toMailAddr+";"+a.fromMailAddr});parent.CC.advSearchMail(0,b,"",0,null)}});this.contactMailCls.controls.switchCard.unbind("click").bind("click",function(){jQuery(this).hasClass("tx-tr")?
(a.contactMailCls.Evts.hidePanel(),a.contactMailCls.Evts.storeUserHabit("hide")):(a.contactMailCls.Evts.showPanel(),a.contactMailCls.Evts.storeUserHabit("show"));return!1});this.contactMailCls.controls.mailTab.unbind("click").bind("click",function(){a.contactMailCls.Evts.swrapCard(0)});this.contactMailCls.controls.attachTab.unbind("click").bind("click",function(){a.contactMailCls.Evts.swrapCard(1)});this.contactMailCls.controls.sidePanel.find(".contact_mail_link").each(function(b,d){jQuery(d).unbind("click").bind("click",
function(){a.contactMailCls.Evts.readMail(jQuery(this).attr("data-mid"));return!1})});this.contactMailCls.controls.goMailBtn.unbind("click").bind("click",function(){parent.CC.compose(a.from);return!1});this.contactMailCls.controls.viewMoreLink.unbind("click").bind("click",function(){a.contactMailCls.Evts.readMoreMail();return!1});a.userPhone&&this.contactMailCls.controls.goMessageBtn.unbind("click").bind("click",function(){parent.CC.gotoSMS(a.userPhone);return!1});parent.EV.observe(this.doc,"scroll",
this.contactMailCls.Evts.slideSwitch);var b=parent.CC.getUserAttributeFromLocal("contactMailHabit");b!=""&&(b=="hide"?a.contactMailCls.Evts.hidePanel(!0):b=="show"&&a.contactMailCls.Evts.showPanel());this.contactMailCls.Evts.adjustHeight();typeof parent.documentEventManager!="undefined"&&parent.documentEventManager.addDoc(this.doc)}},getThumbNailImage:function(a,b,c){var d=b.length;imgLen=0;str="";attachUrl="";src="";fileSize="";imgHTML=[];html=[];html.push('<div id="attach_thumb_container" class=""><div class="attrAll">');
html.push('<span style="display:none" id="select_attach" class="fr attrall-title"></span>');html.push("<span><strong>\u9644\u4ef6\u56fe\u7247\u9884\u89c8</strong>(\u5171<var>{0}</var>\u4e2a)</span></div>");html.push('<ul class="attrList clearfix">');for(var e=0;e<d;e++)parent.CC.getAttachType(b[e].fileName,b[e].fileSize).type=="image"&&(str=location.protocol+"//"+location.host,attachUrl=parent.CC.getDownloadLink(a,b[e].fileOffSet,b[e].fileSize,b[e].fileName,"attach",1,"1"),attachUrl=attachUrl.indexOf("http")>
-1?attachUrl:str+attachUrl,fileSize=parent.Util.formatSize(b[e].fileSize,null,2),imgHTML.push('<li class="li_preview">'),imgHTML.push('<div class="imgInfo m_clearfix">'),imgHTML.push('<a class="imgBox" href="javascript:void(0);">'),imgHTML.push('<img width="58" height="58" rel="" '),parent.GC.check("CENTER_PREVIEW")&&imgHTML.push("onclick='showImg(\""+this.denyForward+'","'+a+'",'+e+")'"),imgHTML.push(' title="'+b[e].fileName+'" src="'+attachUrl+'" class="imgLink" index="0">'),imgHTML.push('</a><dl class="dl_wrapper"><dt><span title="'+
b[e].fileName+"("+fileSize+')" class="attrlist-title">'+b[e].fileName.toString().left(10,!0)+"</span>"),imgHTML.push("("+fileSize+")</dt><dd>"),imgHTML.push(this.getDownLoadHTML(attachUrl)),imgHTML.push(this.getOnLineReaderHTML(b[e],attachUrl,c,a,e)),this.denyForward!=1&&CC.isDisk()&&imgHTML.push(this.getSaveInDiskHTML(a,b[e].fileOffSet,b[e].fileSize,e)),imgHTML.push("</dd></dl></div></li>"),imgLen++);html.push(imgHTML.join(""));html.push("</ul></div>");return imgLen>0?html.join("").format(imgLen):
""},getStatus:function(a){var b=this.stateFlagArr,a=a||{},c="";return c=a.top?"<i class='"+(a.read?"status8":"status9")+"' title='"+b[7]+"'></i>":a.fixedtime?"<i class='status1' title='"+b[1]+"'></i>":a.read?"<i class='status5' title='"+b[5]+"'></i>":a.replied&&a.forwarded?"<i class='status2' title='"+b[2]+"'></i>":a.replied?"<i class='status3' title='"+b[3]+"'></i>":a.forwarded?"<i class='status4' title='"+b[4]+"'></i>":a.safemail_sign=="1"&&a.safemail_crypt=="1"?"<i class='i-redmedal' title='\u7b7e\u540d\u52a0\u5bc6\u90ae\u4ef6'></i>":
a.safemail_sign=="1"?"<i class='i-graymedal' title='\u7b7e\u540d\u90ae\u4ef6'></i>":a.safemail_crypt=="1"?"<i class='i-ykey' title='\u52a0\u5bc6\u90ae\u4ef6'></i>":"<i class='status6' title='"+b[0]+"'></i>"},sessionMailArr:[],ckMail:function(a){var a=this.sessionMails[a],b=a.fid,c=a.mid,d=a.mailSession,e=a.flags.read?1:0,f=a.flags&&a.flags.read=="1"?!0:!1;MM.getFolderObject(b);var g=CC.getMailText(a.subject,Lang.Mail.list_ReadingMail),h=!1;if(a.secureEncrypt=="1"||a.flags&&a.flags.secureEncrypt==
"1")h=!0;CC.goReadMail(c,g,{markRead:e,fid:b,sessionId:d,rcptFlag:a.rcptFlag,isSession:!1,isEncrypt:h,unread:f,ignoreCache:!0,returnHeaders:["X-IBC-SecMail"]},a)},getSessionMailHtml:function(){var a=this;GE.tab.isSession=!0;var b=a.sessionMails||[],c=[],d=gConst.readMail+a.mid,e=Util.formatDate(new Date((b[0]||{}).sendDate*1E3),"yyyy-mm-dd HH:nn:ss"),f=function(c,d,e){var f=[];CC.getMailText(d.subject,Lang.Mail.list_noSubject);var h=CC.getMailText(d.summary),g=Util.formatDate(new Date(d.sendDate*
1E3),"mm-dd HH:nn");Util.formatSize(d.size,null,1);var r=d.fid;a.sessionId=d.mailSession;CC.getMailText(d.from,Lang.Mail.list_nosender);CC.getMailText(d.to,Lang.Mail.list_nosender);MM.getModuleByFid(r);r=Email.getName(d.from);r=CC.getMailText(r,Lang.Mail.list_nosender);Email.getValue(d.from);var w=e?!0:!1,x=j.omid,d=(Email.getValue(d.from)||"").toLowerCase(),z=typeof aliasList=="undefined"?[]:aliasList,y=typeof domains=="undefined"?[]:domains,v=gMain.domain||"",G=[(gMain.loginId||gMain.mailId||gMain.uid||
"").toLowerCase()],v=[v],F=[],H=!1;if(z.length)for(var C=0;C<z.length;C++){var E=(z[C].value||"").split("@")[0].toLowerCase();G.push(E)}if(y.length)for(C=0;C<y.length;C++)v.push(y[C]);for(C=0;C<G.length;C++){z=jQuery.trim(G[C]);for(y=0;y<v.length;y++)E=jQuery.trim(v[y]||""),F.push(z+"@"+E)}for(C=0;C<F.length;C++)if(F[C]==d){H=!0;break}f.push('<div class="receive-time">');f.push("    <span>"+g+"</span>");f.push("</div>");H?(f.push('<div class="session-mode-right">'),f.push('   <div class="session-mode-photo photo-right">'),
f.push('       <div class="right-bg">'),f.push((r||"").charAt(0)),f.push("       </div>"),f.push("  </div>"),f.push('   <div class="session-mode-main">'),f.push('      <p class="session-mode-name">'),f.push(r),f.push("       </p>"),f.push('       <div class="session-mode-txt-box">'),f.push('           <div class="session-mode-txt">'+h+'<a href="javascript:;" onclick=MR.ckMail(\''+c+"')>\u3010\u67e5\u770b\u90ae\u4ef6\u8be6\u60c5\u3011</a></div>"),f.push('           <i class="i-r-arr"></i>')):(f.push('<div class="session-mode-left">'),
f.push('   <div class="session-mode-photo photo-left">'),f.push('       <div class="left-bg">'),f.push((r||"").charAt(0)),f.push("       </div>"),f.push("  </div>"),f.push('   <div class="session-mode-main">'),f.push('      <p class="session-mode-name">'),f.push(r),f.push("       </p>"),f.push('       <div class="session-mode-txt-box">'),f.push('           <div class="session-mode-txt">'+h+'<a href="javascript:;" onclick=MR.ckMail(\''+c+"')>\u3010\u67e5\u770b\u90ae\u4ef6\u8be6\u60c5\u3011</a></div>"),
f.push('           <i class="i-l-arr"></i>'));f.push("       </div>");f.push("   </div>");f.push("</div> ");f.push('<div class="tips-text" id="ms_body_{0}" style="{2}" ondblclick="oSM.showHideSessionMail({0},\'{1}\');">'.format(c,x,w?"":'display:none;"'));e&&f.push(a.getSessionMailContentHtml(c,e));f.push("</div>");f.push('<div class="-tipsTop -diamond"></div>');f.push("</div>");f.push("</div>");c==b.length-1&&f.push("<br><br>");return f.join("")};if(a.data&&a.data.headers)var g=a.data.headers.auditStatus;
var h="";if(g=="3"||g=="4")h=Lang.Mail.Write.audited+"\uff1a";else if(g=="5"||g=="6")h=Lang.Mail.Write.audited+"\uff1a";var j=j||CM[d]["var"],d=CC.getMailText((b[0]||a.mi).subject,Lang.Mail.list_noSubject),d=h+d;c.push('<div class="session-mode-head" style="margin-bottom:24px;">');c.push('    <div class="session-mode-title">');c.push(d);c.push("    </div>");c.push('    <div class="session-mode-state">');c.push('        <p class="session-mode-time"><label for="">\u65f6&nbsp;&nbsp;&nbsp;&nbsp;\u95f4\uff1a</label><span>'+
e+"</span></p>");c.push('        <span class="count-mail">\u5171'+b.length+"\u5c01</span>");CC.isLabelMail();c.push("</h2></div></div>");c.push('<div class="mailSection">');for(e=0;e<b.length;e++)c.push(f(e,b[e]));c.push("</div>");c.push("</div>");return c.join("")},getSessionMailContentHtml:function(a,b,c){var d=CC.getMailText(b.subject,Lang.Mail.list_noSubject);CC.getMailText(b.account);Util.formatDate(new Date(b.sendDate*1E3),"yyyy-mm-dd HH:nn:ss");var e=CC.getMailText(b.to);Email.getName(b.to);
var f=CC.getMailText(b.cc);CC.getMailText(b.bcc);var g=b.attachments||[],h=Email.getValue(b.account)||"",j=Email.getName(b.account)||b.account,j=CC.getMailText(j,Lang.Mail.list_nosender),n=CC.getMailContent(b),k=b.omid,q=[],t=b.flag,u=b.denyForward||0,s=b.sendWay||0;this.sendName=j;this.to=e;this.cc=f;this.sessionMail[k]={};this.sessionMail[k]=b;s===4&&b.meetingInfo&&(n=this.getMeetingHtml(b,n));q.push('<div class="mailSectionTitle p_relative" id="ms_head_{0}" >'.format(a));q.push('<div class="rMList"><span class="rMl">{0}</span><div class="rMr"><span >{1}</span></div></div>'.format(Lang.Mail.readMail_lb_subject,
d));q.push('<div class="rMList"><span class="rMl">{0}</span><div class="rMr"><span id="{2}to">{1}</span></div></div>'.format(Lang.Mail.readMail_lb_to,this.showMore(k,"to",-1),k));f&&q.push('<div class="rMList" id="ms_head_disp_cc_{0}"><span class="rMl">{1}</span><div class="rMr"><span class="fl">{2}</span></div></div>'.format(a,Lang.Mail.readMail_lb_cc,this.showMore(k,"cc",-1)));q.push(this.getAttachHtml(k,g,{denyForward:u}));q.push(this.getRemarkHtml("oSM",k,a,t));q.push(this.getActionHtml("oSM",
a,b,!1));CC.isSecurityMail()&&q.push(this.getSecurityMailHtml(b));q.push("</div>");q.push('<div class="mailText p_relative">');q.push('<div class="pl_5 pr_5 c_666">');this.mailContent=n;q.push('<iframe frameborder="0" allowtransparency="true" style="background-color=transparent"  scrolling="no" id=\'mailContent_'+k+"' name='mailContent_"+k+"' onload='oSM.contentOnload(\""+k+'", "'+u+"\")' width='100%' src='"+gMain.webPath+"/static/se/mail/blank.htm'></iframe>");q.push("</div>");q.push("</div>");q.push('<div class="read_mail_reply">');
q.push('<p class="mailSectionOperate">');parent.gMain.loginName&&parent.gMain.loginName===h||(g.length>0?q.push('<span style="position:static;'+(c?"_margin-top:10px;":"")+'" class="sessionMailTool_span fl"><a class="sessionMailTool" href="javascript:fGoto();" onclick="MR.showAttachReMenu(this,'+a+",'"+k+"',event,0,document);\" ><span><span>"+Lang.Mail.tb_Reply+'<i></i></span></span></a></span><span class="line fl">|</span>'):q.push('<a class="fl" href="javascript:void(0)" onclick=MR.doMenu(null,\'REPLY\',null,"'+
k+'")>'+Lang.Mail.tb_Reply+'</a><span class="line fl">|</span>'),g.length>0?q.push('<span style="position:static;'+(c?"_margin-top:10px;":"")+'" class="sessionMailTool_span fl"><a class="sessionMailTool" href="javascript:fGoto();" onclick="MR.showAttachReMenu(this,'+a+",'"+k+"',event,1,document);\" ><span><span>"+Lang.Mail.tb_ReplyAll+'<i></i></span></span></a></span><span class="line fl">|</span>'):q.push('<a class="fl" href="javascript:void(0)" onclick=MR.doMenu(null,\'REPLYALL\',null,"'+k+'")>'+
Lang.Mail.tb_ReplyAll+'</a><span class="line fl ">|</span>'));u||q.push('<a class="fl" href="javascript:void(0)" onclick=MR.doMenu(null,\'FORWARD\',null,"'+k+'")>'+Lang.Mail.tb_Forward+'</a><span class="line fl">|</span>');GC.check("MAIL_INBOX_DELETE")&&q.push('<a class="fl" href="javascript:void(0)" onclick=MR.del("'+k+'") >'+Lang.Mail.tb_Delete+"</a>");if(s!=2&&s!=3||!CC.isSessionMode())q.push('<span class="line fl">|</span><span  style="position:static;'+(c?"_margin-top:10px;":"")+'" class="sessionMailTool_span fl"><a class="sessionMailTool" href="javascript:fGoto();" onclick="MR.showMoreMenu(this,'+
a+",'"+k+"',event,document);\"><span><span>"+Lang.Mail.tb_more+"<i></i></span></span></a></span>");q.push("</p>");q.push("</div>");return q.join("")},getFileType:function(a){for(var a=a.toLowerCase(),b="other",c="other,tif,txt,psd,rar,zip,xml,html,java,fon,jpg,gif,png,bmp,tiff,mpeg,avi,wmv,mov,mpg,vob,rmvb,mp3,wma,wav,asf,mp4,sis,sisx,cab,doc,docx,pdf,xls,xlsx,ppt,pptx,swf,fla,share,folder,mp3-hover,upload,i-hand,flv,folder-m,folder-p,exe,css,rm,midi,chm,iso,vsd,no-load".split(","),d=0;d<c.length;d++)if(a.indexOf(c[d])>=
0){b=c[d];break}return b},getDate:function(a){return gMain.lang=="en_US"?Util.formatDate(a,"yyyy\u5e74mm\u6708dd\u65e5(\u5468ww) hh:nn"):Util.formatDate(a,"WW,MM dd,yyyy hh:nn")},getSecurityMailHtml:function(a){var b=[];if(typeof a.flag=="object"&&(a.flag.safemail_sign=="1"||a.flag.safemail_crypt=="1"||a.flag.safemail_sign==-1||a.flag.safemail_crypt==-1||a.flag.secureSigned==-1||a.flag.secureEncrypt==-1||a.flag.secureSigned==1||a.flag.secureEncrypt==1)){b.push('<div class="rMList">');b.push('<span class="rMl">\u5b89&nbsp;&nbsp; \u5168\uff1a</span>');
if(a.flag.safemail_sign==1||a.flag.secureSigned==1)b.push('<strong class="mb_ept">'),b.push('<i class="i-graymedal mr_5"></i>'),b.push('<span class="col_green">\u9a8c\u8bc1\u7b7e\u540d\u901a\u8fc7</span>'),b.push("</strong>");if(a.flag.safemail_sign==-1||a.flag.secureSigned==-1)b.push('<strong class="mb_ept">'),b.push('<i class="i-mixmedal mr_5"></i>'),b.push('<span class="col_red">\u7b7e\u540d\u9a8c\u8bc1\u672a\u901a\u8fc7</span>'),b.push("</strong>");if(a.flag.safemail_crypt==1||a.flag.secureEncrypt==
1)b.push('<strong class="mb_ept">'),b.push('<i class="i-ykey mr_5"></i>'),b.push('<span class="col_green">\u6570\u5b57\u52a0\u5bc6\u90ae\u4ef6</span>'),b.push("</strong>");if(a.flag.safemail_crypt==-1||a.flag.secureEncrypt==-1)b.push('<strong class="mb_ept">'),b.push('<i class="i-notPassed mr_5"></i>'),b.push('<span class="col_red">\u89e3\u5bc6\u5931\u8d25</span>'),b.push("</strong>");b.push("</strong>");b.push("</div>")}return b.join("")},getAttachHtml:function(a,b,c){var d=[];this.denyForward=c=
c.denyForward||0;if(!(b.length<=0)){this.attachImgList[a]||(this.attachImgList[a]=[]);d.push("<div class=\"rMList\" id='attach_{0}'>".format(a));d.push('<span class="rMl" '+(b.length==1?"style=padding-top:3px":"")+">"+this.getLang(Lang.Mail.readMail_lb_attach,"\u9644\u3000\u4ef6\uff1a")+"</span>");d.push('<div class="rMr">');var e=null,f=null;if(b.length>1){c||d.push(b.length+'\u4e2a&nbsp;&nbsp;&nbsp;<a  href="'+CC.getDownloadsLink(a)+"\"  class='download_link' style='padding-left:5px'>"+Lang.Mail.readmail_attach_downloadall+
"</a>");d.push("</div>");d.push('<div class="download-wrap">');for(var g=0;g<b.length;g++)e=Util.getFileClasssName(b[g].fileName),f=CC.getDownloadLink(a,b[g].fileOffSet,b[g].fileSize,b[g].fileName,b[g].type,b[g].encoding),CC.getAttachType(b[g].fileName,b[g].fileSize).type=="image"?this.attachImgList[a].push({imgUrl:"",fileName:b[g].fileName,downLoad:f}):this.attachImgList[a].push({}),d.push('<div class="download-div">'),d.push('<i class="'+e+'"></i>'),d.push('<span class="download-fileName">'+b[g].fileName.encodeHTML()+
"&nbsp;&nbsp;"+Util.formatSize(b[g].fileRealSize,null,2)+"</span>"),c||d.push('<a href="'+f+'"  class="readmail_download" style="padding-right:5px">'+Lang.Mail.readMail_download+"</a>"),d.push(this.getOnLineReaderHTML(b[g],f,c,a,g)),!CC.isOA()&&CC.isDisk()&&c!=1&&d.push('<a href="javascript:void(0);"  class="readmail_download" onclick="oSM.saveInDisk(\''+this.mid+"','"+b[g].fileOffSet+"','"+b[g].fileSize+"','"+g+"')\">\u5b58\u7f51\u76d8</a>"),d.push("</div>")}else e=Util.getFileClasssName(b[0].fileName),
f=CC.getDownloadLink(a,b[0].fileOffSet,b[0].fileSize,b[0].fileName,b[0].type,b[0].encoding),d.push('<div class="download-div">'),d.push('<i class="'+e+'"></i>'),d.push('<span class="download-fileName">'+b[0].fileName.encodeHTML()+"&nbsp;&nbsp;"+Util.formatSize(b[0].fileRealSize,null,2)+"</span>"),c||d.push(this.getDownLoadHTML(f)),CC.getAttachType(b[0].fileName,b[0].fileSize).type=="image"?this.attachImgList[a].push({imgUrl:"",fileName:b[0].fileName,downLoad:f}):this.attachImgList[a].push({}),d.push(this.getOnLineReaderHTML(b[0],
f,c,a,0)),!CC.isOA()&&CC.isDisk()&&c!=1&&d.push(this.getSaveInDiskHTML(this.mid,b[0].fileOffSet,b[0].fileSize,0)),d.push("</div>");d.push("</div>");d.push("</div>");return d.join("")}},saveInDisk:function(a,b,c,d){MM.attachList.showNDFSelector?MM.attachList.showNDFSelector(a,b,c,d):(new AttachList).showNDFSelector(a,b,c,d)},getDownLoadHTML:function(a){var b=[];b.push('<a href="'+a+'" class="readmail_download" style="padding-right:5px">'+Lang.Mail.readMail_download+"</a>");return b.join("")},getSaveInDiskHTML:function(a,
b,c,d){var e=[];e.push('<a href="javascript:void(0);" class="readmail_download" style="padding-left:5px"   onclick="oSM.saveInDisk(\''+a+"','"+b+"','"+c+"','"+d+"')\">\u5b58\u7f51\u76d8</a>");return e.join("")},getOnLineReaderHTML:function(a,b,c,d,e){if(!GC.check("CENTER_PREVIEW")||parseInt(parent.gMain.attachPreivewMaxSize)<a.fileRealSize)return"";b.indexOf("http")!=0&&(b=location.protocol+"//"+location.host+b);var f=CC.getAttachType(a.fileName,a.fileSize)||{isView:!1,type:""},g="";f.isView&&(a=
CC.getViewLink(gMain.webPath||"http://view.se139.com","cmail",gMain.sid,b,gMain.loginName,a.fileName,a.fileRealSize,gMain.mailId,a.fileId,c),g=f.type=="image"?"<a href='javascript:void(0)' class=\"download-fileName\" onclick='showImg(\""+c+'","'+d+'",'+e+")' >"+this.getLang(Lang.Mail.readMail_lb_viewAttach,Lang.Mail.onlineLook)+"</a>":'<a target="_blank" class="download-fileName" href="'+a+'" {0} >'+(f.type=="zip"?this.getLang(Lang.Mail.readMail_lb_OpenZip,Lang.Mail.open):this.getLang(Lang.Mail.readMail_lb_viewAttach,
Lang.Mail.onlineLook))+"</a>");return g},getAttachListHtml:function(a,b){var c=this.mid,b=b||[],d=[],e="",d=[];if(b&&b.length>0){e=Lang.Mail.readmail_attach_listcount.format(b.length);d.push('<div class="attrBody" id="ordinaryAttchList">');d.push("<div class=\"attrAll\" name='attachList'><span><strong>"+Lang.Mail.readmail_attach_common+"</strong>"+e+"</span>");b.length>1&&d.push('<a  href="'+CC.getDownloadsLink(c)+"\"  class='download_link' >"+Lang.Mail.readmail_attach_downloadall+"</a>");d.push("</div>");
d.push('<ul  class="attrList m_clearfix">');for(var f=0;f<b.length;f++){e=CC.getDownloadLink(c,b[f].fileOffSet,b[f].fileSize,b[f].fileName,b[f].type,b[f].encoding);d.push('<li><div class="imgInfo imgInfo_noBank m_clearfix" onMouseOut=\'oSM.showAttchBoder(this,"out")\' onMouseOver=\'oSM.showAttchBoder(this,"over")\'>');d.push("<a class='imgBox'><i class='big_"+Util.getFileClasssName(b[f].fileName)+"'></i></a>");d.push('<dl class="dl_wrapper">');var g=Util.formatSize(b[f].fileRealSize,null,2);d.push("<dt title='"+
b[f].fileName+"("+g+")'>"+b[f].fileName+'<span class="col666">('+g+")</span></dt>");d.push('<dd><a href="'+e+"\" class='download_link' >"+Lang.Mail.readMail_download+"</a></dd>");d.push("</dl></div></li>")}d.push("</ul>");d.push("</div>")}d.push('<a id="attchList_{0}" >'.format(a)+"</a>");return d.join("")},getRemarkHtml:function(a,b,c,d){var e=[];e.push('<div  id="ms_remark_{0}" {1}>'.format(c,d.memoFlag==1?"":'style="display:none"'));e.push('<div class="readMail_line"></div>');e.push('<div class="rMList">');
e.push('<span class="rMl">{0}</span>'.format(Lang.Mail.remark));e.push('<div class="rMr">');e.push('<div class="remarkTips shadow remark_bg"  id="remarkread_{0}" style="display:none;">'.format(c));e.push("<p onclick=\"{0}.editRemark('{1}','{2}')\" id=\"remarkContent_{2}\"></p>".format(a,b,c));e.push('<div class="remarkTips-title clearfix pt_5"><span><a href="javascript:;" onclick="{0}.editRemark(\'{1}\',\'{2}\')">{3}</a> '.format(a,b,c,Lang.Mail.remarkEdit));e.push("<a href=\"javascript:;\" onclick=\"{0}.delRemark('{1}','{2}')\">{3}</a></span></div>".format(a,
b,c,Lang.Mail.deleteRemark));e.push("</div>");e.push('<div class="remarkModify"  id="remarkwrite_{0}" style="display:none">'.format(c));e.push('<div class="w495 textarea_wrapper">');e.push('<textarea max id="remarktext_'+c+'" onblur=oSM.clearRemarkBlank(this,"'+b+'") onkeyup=oSM.getRemarkWriteNum(this,"'+b+'")  class="remark_textarea"></textarea>');e.push("</div>");e.push('<div style="margin-left:4px;margin-top:5px;">');e.push('<a class=\'n_btn_on mr_10\' ck="save" onclick="'+a+".saveRemark('"+b+
"','"+c+"');\"><span><span>"+Lang.Mail.saveRemark+'</span></span></a><a class="n_btn" ck="cancel" id="remarkdel_'+c+'" style="cursor:pointer" onclick='+a+".hideRemark('"+b+"','"+c+"');><span><span>"+Lang.Mail.cancelRemark+"</span></span></a>");e.push('<span class="write_num">'+Lang.Mail.hkinput+"<var id='remarkWriteNum_"+b+"'>50</var>"+Lang.Mail.font+"</span>");e.push("</div>");e.push("</div>");e.push("</div>");e.push("</div>");e.push("</div>");return e.join("")},getActionHtml:function(a,b,c){var d=
[],e=c.omid,f=c.flag,g=c.sendWay||0;d.push('<span class="readmialTool">');d.push("<a href='javascript:;' flagval="+(f.starFlag?f.starFlag:0)+"  title='"+(f.starFlag==1?Lang.Mail.haveStar:Lang.Mail.noStar)+"'><i onclick="+a+".starFlag(this,'"+e+"','"+b+"') id='StarFlag"+b+"' flagval="+(f.starFlag?f.starFlag:0)+'  class="'+(f.starFlag==1?"i_starFlag_on":"i_starFlag_off")+'"></i></a>  | ');g!=2&&g!=3&&d.push("<a href='javascript:;' onclick="+a+".newOpen('"+e+"') title='"+Lang.Mail.readMail_lb_newwindow+
'\'  ><i class="i_2win"></i></a> | ');d.push("<a href='javascript:;' onclick="+a+".showRemark('"+b+"'); flagval='"+(f.memoFlag?f.memoFlag:0)+"' id='remarkon_"+b+"'  ck=\"toggle\" title='"+(f.memoFlag==1?Lang.Mail.haveRemark:Lang.Mail.noRemark)+"'><i id='memoFlag_"+b+"'  flagval='"+(f.memoFlag?f.memoFlag:0)+"'  class='"+(f.memoFlag==1?"i_note_on":"i_note_off")+"' ></i></a>");g!=2&&g!=3&&d.push(" | <a href='javascript:;' onclick=MR.printMail('"+e+"') title='"+Lang.Mail.tb_Print+'\'><i class="i_alarm"></i></a> ');
d.push("</span>");d.push(TaskMail.getReadIconHtml(c,!0));return d.join("")},getQuickReplyHtml:function(a,b,c){var d=[];d.push("<div class=\"mlr10\" id='replyId_{0}' >".format(b));d.push("<div class='textarea_wrapper' style='padding:0 5px;'><input onclick=\"{0}.focusQuickReply('{1}','{2}')\" class=\"readMail_reply_txt\" type=\"text\" value=\"{3}\"/></div>".format(a,b,c,Lang.Mail.readMail_textarea_text));d.push("</div>");return d.join("")},getFocusQuickReply:function(a,b){var c=[],d="textContent_"+
a;c.push("<p><a href='javascript:;' onclick=\"MR.goCompose('"+gConst.func.replyAll+"','"+b+"' , '"+Lang.Mail.tb_ReplyAll+"');\">"+Lang.Mail.readmail_Switchmode+"</a></p>");c.push("<div class=\"textarea_wrapper height_remark\" style='position:relative;'><textarea style='height:80px' class=\"readMail_reply_textarea\" id='"+d+"'></textarea></div>");c.push('<div><a class="n_btn_on mt_5 mb_15" href="javascript:void(0)"><span><span onclick="sendReply(document.getElementById(\'{0}\'),\'{2}\');" >{1}</span></span></a></div>'.format(d,
Lang.Mail.readMail_lb_bt_send,b));return c.join("")},showSessionMailContent:function(a,b){var c=this;$("ms_head"+a);$("ms_body_"+a);var d=c.sessionMails[a],e=d.mid;MM.mailRequestApi({func:gConst.func.readMail,data:{mode:"both",filterStylesheets:0,filterImages:0,filterLinks:0,supportTNEF:0,fileterScripts:1,filterFrames:1,markRead:d.flags.read?1:0,encoding:parent.gConst.encode_utf8,mid:e,fid:d.fid},call:function(d){var g=d["var"];CM["readMail"+e]=d;d=c.getSessionMailContentHtml(a,g,!0);b(d,e)}})},checkDomain:function(a){for(var b=
!1,c=0;c<a.length;c++)for(var d=a[c].split(","),e=0;e<d.length;e++){var f=Email.getValue(d[e]);if(f&&(f=f.substr(f.indexOf("@")+1),gMain.domain==f))return b=!0}return b},showMDSHtml:function(a){var b=[],c=[];a.to&&c.push(a.to);a.cc&&c.push(a.cc);a.bcc&&c.push(a.bcc);if(this.fid==3&&this.rcptFlag!=5&&this.rcptFlag!=4)this.recallok=a.flag.recallok,a.flag.recallok==1||a.flag.recallok==2?(b.push('<span id="recallMsg{0}" style="padding-left:10px;font-weight:normal;">'.format(this.mid)),b.push('<span style="color:#BFBFBF;font-size:12px;">['+
this.getLang(Lang.Mail.recalled,Lang.Mail.RecallMessage_RecallOK)+"]</span>")):Util.DateDiff(new Date,this.date)<(gMain.recallTime||24)&&a.flag.recall==1?(b.push('<span id="recallMsg{0}" style="padding-left:10px;font-weight:normal;">'.format(this.mid)),b.push('<a id="aRecallMail" style="display:none" onclick="MR.showRecallMessageFrm()" href="javascript:;">['+this.getLang(Lang.Mail.recallMail,Lang.Mail.RecallMessage_RecallMail)+"]</a>")):b.push('<span id="recallMsg{0}" style="padding-left:10px;font-weight:normal;">'.format(this.mid)),
b.push("</span>");return b.join("")},showDSHtml:function(a){var b=this.mid,c=[];this.fid==3&&this.rcptFlag!=5&&(c.push("<div class='rMList'>"),c.push("<span class='rMl'>"+Lang.Mail.fxzt+"</span>"),Util.DateDiff(new Date,this.date)<(gMain.deliverStatusTime||24)?c.push("<div class='rMr' id='viewStatus"+this.mid+"'><a href=\"javascript:;\" class='check-detail' id=\"aStatus"+b+'" onclick="'+a+".displayMailDeliverStatusHTML('"+b+"')\">"+this.getLang(Lang.Mail.DeliverStatus_ViewDetail,Lang.Mail.ckdetail)+
"</a></div>"):c.push("<div class='rMr' id='failMsg"+this.mid+"'>"+this.getLang(Lang.Mail.DeliverStatus_OutModed,Lang.Mail.noSDetail)+"</div>"),c.push("</div>"),c.push("<div id='trContent"+this.mid+"' style='display:none'></div>"));return c.join("")},mailDeliverStatus:function(a,b){MM.mailRequestApi({func:"mbox:getDeliverStatus",data:{sort:1,start:0,total:5,mid:a},call:function(c){a?typeof b!="function"&&CC.exit():CC.exit();b(c)},failCall:function(){a?typeof b!="function"&&CC.exit():CC.exit();top.CC.showMsg("\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",
!0,null,"error")},msg:""})},getRecallData:function(){var a=this,b=this.mid;this.queryRecallData(function(c){if(c&&(a.recallData=c)&&c["var"]&&c["var"].recallUsers&&c["var"].recallUsers.length)c=jQuery("#ifrmReadmail_Content_readMail"+b).contents().find("#recallMsg"+b),c.length>0&&c.html('<a href="javascript:;" onclick="MR.beforeShowRecell()" style="display: inline;" id="aRecallMail">['+a.getLang(Lang.Mail.recallMail,Lang.Mail.RecallMessage_RecallMail)+"]</a>")})},queryRecallData:function(a){MM.mailRequestApi({func:"mbox:queryCanRecallReceivers",
data:{mid:this.mid},call:a,failCall:null,msg:""})},showRecallMessageFrm:function(){var a=this,b=[];b.push('<div style="border-top: 0 none;clear: both;height: auto;overflow: hidden;padding: 20px 0;width: 100%;">');b.push('<div style="padding: 0 20px;">');b.push('<div style="padding: 0 20px;">');b.push('<h1 style="text-align:left">'+a.getLang((Lang.Mail.zcrecall+"({0})"+Lang.Mail.demail+" ").format(gMain.domain),Lang.Mail.RecallMessage_SupportDomian.format(gMain.domain))+"</h1>");b.push('<ul id="ulRecallMail'+
a.mid+'" style="border: 1px solid #CCCCCC;text-align:left;height: 120px;margin: 0 0 12px;overflow: auto;padding: 0 3px;">');var c='<li style="float:none;width:auto;">';c+='<input type="checkbox" checked="checked" name="chkRecallMail'+a.mid+'" id="chkRecallMail{0}">';c+='<label title="{1}" style="display:inline-block;width:250px;margin-bottom:-4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"';c+=">{2}</label>";c+="</li>";var d="RecallMessageFrm"+a.mid;this.queryRecallData(function(e){for(var e=
e["var"].recallUsers,f=0;f<e.length;f++)b.push(c.format(e[f],e[f],e[f]));b.push("</ul>");b.push("<div style='display:none'><input type='checkbox' id='isSendBack' >"+Lang.Mail.sendMailconfirm+"</div>");b.push("</div></div></div>");b.push('<div class="boxIframeBtn">');b.push('<div class="topborder">');b.push(' <a href="javascript:;"  onclick="MM[\''+a.name+'\'].recalMessage()" class="n_btn_on mt_8"><span><span>'+a.getLang(Lang.Mail.cehui,Lang.Mail.RecallMessage_Recall)+"</span></span></a>");b.push(" </div>");
b.push(" </div>");e={id:d,title:a.getLang(Lang.Mail.choiseCehui,Lang.Mail.RecallMessage_CheckRecallMail),text:b.join(""),width:"400",zindex:1001};CC.msgBox(e)});if(window.gMain&&typeof gMain.recallFlag!=="undefined"&&parseInt(gMain.recallFlag,10)===2&&document.getElementById("isSendBack"))document.getElementById("isSendBack").style.display="inline"},beforeShowRecell:function(){var a=this,b="BeforeRecallResultFrm"+a.mid,c=[];c.push('<div style="padding:25px; "><ul class="clearfix"><li style="background:no-repeat url(\''+
parent.CC.getResourceAbsoluteURL()+'/images/u17.png \');width: 54px;height: 44px;float: left;"></li><li>\u786e\u5b9a\u8981\u64a4\u56de\u6b64\u90ae\u4ef6\u4e48\uff1f<br/>\u5982\u679c\u64a4\u56de\u6210\u529f\uff0c\u5bf9\u65b9\u5c06\u6536\u5230\u63d0\u793a\u90ae\u4ef6\u5df2\u88ab\u64a4\u56de\u7684\u90ae\u4ef6\u3002</li></ul><ul style=" margin-top: 20px; font-size: 13px;   color: rgb(141, 141, 141);"><li>\u90ae\u4ef6\u53d1\u9001\u672a\u8d85\u8fc715\u5929\uff0c\u5728\u5bf9\u65b9\u672a\u8bfb\u6216\u663e\u793a\u672a\u8bfb\u72b6\u6001\uff0c\u672a\u88ab\u5bf9\u65b9\u4ece\u90ae\u4ef6\u5ba2\u6237\u7aef\u6536\u53d6\u8fc7\uff0c\u624d\u652f\u6301\u64a4\u56de\u3002</li></ul></div>');
b={id:b,title:a.getLang(Lang.Mail.recallMail,Lang.Mail.RecallMessage_RecallMail),text:c.join(""),width:"350",zindex:1002,buttons:[{text:Lang.Mail.AdvSearch_OK,clickEvent:function(){a.showRecallMessageFrm()}}]};CC.msgBox(b)},showRecallResultFrm:function(a,b){var c=[],d="RecallResultFrm"+this.mid;c.push('<div style="border-top: 0 none;clear: both;height: auto;overflow: hidden;padding: 20px 0;width: 100%;">');c.push('<div style="padding: 0 20px;">');c.push('<div style="padding: 0 20px;">');c.push('<ul id="ulRecallResultFrm'+
this.mid+'" style="border: 1px solid #CCCCCC;text-align:left;height: 180px;margin: 0 0 12px;overflow: auto;padding: 0 3px;">');var e='<li style="float:none;width:auto;">';e+='<label style="display:inline-block;width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"';e+=' title="{0}">{0}</label>';e+='<span style="display:inline-block;color:{2}">{1}</span>';e+="</li>";Util.eachObj(a["var"],function(a,b){c.push(e.format(a,Lang.Mail["RecallMessage_Result_"+b]||Lang.Mail.RecallMessage_Result_99.format(b),
b==2?"green":"red"))});c.push("</ul>");c.push("</div></div></div>");b&&this.showretract(this.mid);d={id:d,title:this.getLang(Lang.Mail.cehuijieguo,Lang.Mail.RecallMessage_Result),text:c.join(""),width:"500",zindex:1001,buttons:[{text:Lang.Mail.AdvSearch_OK,isCancelBtn:!0}]};CC.msgBox(d)},recalMessage:function(){var a=this.mid,b=document.getElementsByName("chkRecallMail"+a),c=[],d=this,e=0,f=0;if(window.gMain&&typeof gMain.recallFlag!=="undefined"){var g=gMain.recallFlag;parseInt(g,10)===0&&(f=0);
parseInt(g,10)===1&&(f=1)}document.getElementById("isSendBack").checked&&(f=1);for(var h=!0,g=0;g<b.length;g++)b[g].checked?(c[e]=b[g].id.replace("chkRecallMail",""),e++):h=!1;if(c.length==0)alert(d.getLang(Lang.Mail.RecallMessage_CheckMail,Lang.Mail.choiseR));else{CC.closeMsgBox("RecallMessageFrm"+a);a={func:"mbox:recallMessage",data:{mid:a,rcpts:c,replyFlag:f},call:function(a){d.showRecallResultFrm(a,h)},msg:""};if(CC.isExtMail())a.data.opUser=gMain.mailId+"@"+gMain.domain;MM.mailRequestApi(a)}},
starFlag:function(a,b){var c=a.getAttribute("flagval"),c=1-c;MM.mailRequest({func:"mbox:updateMessagesStatus",data:{type:"starFlag",value:c,ids:[b]},call:function(b){b.code==gConst.statusOk&&(c==1?(El.setClass(a,"i_starFlag_on"),El.setAttribute(a,{title:Lang.Mail.haveStar,flagval:"1"})):(El.setClass(a,"i_starFlag_off"),El.setAttribute(a,{title:Lang.Mail.noStar,flagval:"0"})))}})},getRemarkDom:function(a){return{btn:$("remarkon_"+a),read:$("remarkread_"+a),write:$("remarkwrite_"+a),div:$("remark_"+
a),readVal:$("remarkContent_"+a),writeVal:$("remarktext_"+a)}},getRemark:function(a){var b=this.getRemarkDom(a);this.doGetRemark(a,b)},showRemark:function(a){this.doRemarkStatus(this.getRemarkDom(a))},hideRemark:function(a){this.doRemarkStatus(this.getRemarkDom(a),!0)},saveRemark:function(a,b){var c=this,d=this.getRemarkDom(a);this.doSaveRemark(a,d,function(){if(data.code==gConst.S_OK)$("remarkwrite_"+a).value=b.value,c.showRemark(a),c.remark=1})},editRemark:function(a){this.doEditRemark(this.getRemarkDom(a))},
doRemarkStatus:function(a,b){var c=a.btn.getAttribute("flagval");b?c==1&&this.hasRemark?(El.show(a.read),El.hide(a.write)):El.hide(a.div):(El.hide(a.read),El.show(a.write),a.div.style.display="")},doRequestRemark:function(a,b){a={func:"mbox:mailMemo",data:a,call:b};MM.mailRequestApi(a)},doSaveRemark:function(a,b,c){var d=this,e=b.writeVal.value.trim();if(e=="")return CC.alert(Lang.Mail.remarkContent),!1;if(e.length>50)return CC.alert(Lang.Mail.remarkLength),!1;this.doRequestRemark({opType:"add",mid:a,
memo:e},function(a){a.code==gConst.statusOk?(b.readVal.innerHTML=e.encodeHTML(),El.hide(b.write),El.show(b.read),El.setClass(b.btn,"i_note_on"),El.setAttribute(b.btn,{flagval:1}),b.memoFlag.className="i_note_on",b.btn.title=Lang.Mail.haveRemark,d.hasRemark=!0,typeof c=="function"&&c(a)):CC.alert(Lang.Mail.addRemarkFail)})},doDeleteRemark:function(a,b,c){var d=this,e=function(a){a.code==gConst.statusOk?(El.hide(b.div),b.writeVal.value="",El.setClass(b.memoFlag,"i_note_off"),El.setAttribute(b.memoFlag,
{flagval:0}),d.hasRemark=!1,typeof c=="function"&&c(a)):CC.alert(Lang.Mail.remarkDelFail)},f={opType:"delete",mid:a,memo:""};CC.confirm(Lang.Mail.confirmDelRemark,function(){d.doRequestRemark(f,e)})},doGetRemark:function(a,b,c){var d=function(a){if(a.code==gConst.statusOk){var d=a["var"].memo;b.writeVal.value=d;b.readVal.innerHTML=d.encodeHTML();El.show(b.read);El.hide(b.write);b.div.style.display="";typeof c=="function"&&c(a)}},e=b.btn.getAttribute("flagval"),a={opType:"get",mid:a,memo:""};e==1&&
this.doRequestRemark(a,d)},doEditRemark:function(a){El.hide(a.read);El.show(a.write)},showMoreMenu:function(a,b,c,d,e){d.cancelBubble=!0;var f=this,d=[];d.push({isShow:!0,name:"MAIL_READ_PRINT",text:Lang.Mail.tb_Print,attrs:"",url:function(){f.printMail(c)},children:[]});d.push({isShow:!0,name:"MAIL_READ_DOWNLOAD",text:Lang.Mail.readMail_tb_downloademl,attrs:"",url:function(){f.downloadsEmail(c)},children:[]});d.push({isShow:!0,name:"MAIL_READ_VIEW",text:Lang.Mail.tb_ViewSource,attrs:"",url:function(){f.viewMailSource(c)},
children:[]});var g=GE.cToolbar;g&&El.hide(g);CC.getMenu({id:"sm_more_"+b,name:"sm_more_"+b},d,null,null,a,e);a.lastChild.style.width="130px";a.lastChild.style.height="80px"},showAttachReMenu:function(a,b,c,d,e,f){d.cancelBubble=!0;var g=[],h=[];e==0?(g.push("MAIL_READ_REPLYATTACH"),g.push("MAIL_READ_REPLYNOATTACH"),h.push("REPLYATTACH","REPLYNOATTACH")):(g.push("MAIL_READ_REPLYALLATTACH"),g.push("MAIL_READ_REPLYALLNOATTACH"),h.push("REPLYALLATTACH","REPLYALLNOATTACH"));var j=this,d=[];ReadMail.fMenus[g[0]].url=
function(){j.doMenu(null,h[0],null,c)};d.push(ReadMail.fMenus[g[0]]);ReadMail.fMenus[g[1]].url=function(){j.doMenu(null,h[1],null,c)};d.push(ReadMail.fMenus[g[1]]);(g=GE.cToolbar)&&El.hide(g);CC.getMenu({id:"sm_moreAttrch_"+e+b,name:"sm_more_Attrch"+e+b},d,null,null,a,f);a.lastChild.style.width="110px";a.lastChild.style.height="55px"},sendQuickReply:function(a){var b="Re:"+MR.subject,c=MR.sendUser;a&&a.value.replace(/ /gi,"")==""?(parent.CC.alert(Lang.Mail.readMail_alert_onblur),a.focus()):a&&a.value==
Lang.Mail.readMail_textarea_text?(parent.CC.alert(Lang.Mail.readMail_alert_onblur),a.focus()):parent.CC.quickSendMail({account:top.gMain.userNumber,to:c,cc:"",bcc:"",showOneRcpt:0,isHtml:0,subject:b,content:a.value,priority:3,requestReadReceipt:0,saveSentCopy:0,inlineResources:0,scheduleDate:0,normalizeRfc822:0,attachments:[]},function(){parent.CC.alert(Lang.Mail.Write.RepliesSuccessfully,function(){a.value=Lang.Mail.replyTo+MR.sendName})},function(){parent.CC.alert(Lang.Mail.Write.MailsendFail)})},
notJunk:function(){this.move(1,Lang.Mail.list_NowMoveMail,Lang.Mail.folder_1);parent.CC.exit()},getMailContent:function(a){return a.decodeHTML()},setMailContent:function(a){return a.encodeHTML()},trim:function(a){return a.trim()},isExists:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1},showretract:function(a){jQuery("#ifrmReadmail_Content_readMail"+a).contents().find("#recallMsg"+a).html('<span style="color:#BFBFBF;font-size:12px;">['+Lang.Mail.recalled+"]</span>")}};
(function(a){window.SensitiveMail={addTips:function(){var a="";a+='<div style="display: none;" class="y_tips ta_c" id="tipsSensitive"><p>';a+="\u6b64\u90ae\u4ef6\u5939\u4e2d\u7684\u90ae\u4ef6\u5305\u542b\u654f\u611f\u4fe1\u606f\uff0c\u5efa\u8bae\u60a8\u9605\u8bfb\u540e\u7acb\u5373\u5220\u9664";a+='<a href="javascript:;" class="col_red ml_10" onclick="SensitiveMail.closeTips();">\u4e0d\u518d\u63d0\u9192</a>';a+="</p></div>";return a},openTips:function(){a("#tipsSensitive").slideDown()},closeTips:function(){a("#tipsSensitive").slideUp();
CC.writeUserAttributesToServer({tipsSensOpen:"true"})},openFolder:function(){CC.searchNewMail(0,!0,void 0,{signed:1})},getReadTips:function(a){var c=[],d="";if(a.flag&&a.flag.signed===1){typeof a.headers["X-RM-SENSITIVE-WORDS"]!=="undefined"&&a.headers["X-RM-SENSITIVE-WORDS"]!==null&&(c=a.headers["X-RM-SENSITIVE-WORDS"].split(","));for(a=0;a<c.length;a++)c[a]='"'+c[a]+'"';d='<div class="yellowTips">\u6b64\u90ae\u4ef6\u5939\u4e2d\u7684\u90ae\u4ef6\u5305\u542b\u654f\u611f\u8bcd <span class="col_red">'+
c.join(",")+"</span></div>"}return d}}})(jQuery);
function Setting(){this.isLoad=!1;this.name=gConst.setting;this.defaultMenu="index";this.menuId="MAIL";this.isIframe=!1;this.menuType={index:{text:Lang.Mail.Config.setIndex,menus:["index"]},info:{text:Lang.Mail.Config.Conventional,menus:["pref","skin","sign"]},account:{text:Lang.Mail.ConfigJs.accountAndSafe,menus:["account","password","folderlock","foldBind"]},mailManager:{text:Lang.Mail.Config.mailManager,menus:["defaultAccount","memManager"]},mail:{text:Lang.Mail.Config.mail,menus:["autoReply",
"autoForward","mailPOP","filter"]},mobilemail:{text:Lang.Mail.ConfigJs.smsNotify,menus:["notify","loginNotify"]},anti:{text:Lang.Mail.Config.anti,menus:["black","white","antiGarbage","antiViru"]},sso:{text:"\u6388\u6743\u767b\u5f55",menus:["sso"]}};this.menus="index,info,mail,account,mailManager,anti,mobilemail,sso".split(",");this.menuItem={index:{type:"index",name:Lang.Mail.tab_Setting},pref:{type:"info",name:Lang.Mail.ConfigJs.pref_preference,text:Lang.Mail.ConfigJs.pref_preference_desc},face:{type:"info",
name:Lang.Mail.ConfigJs.pref_faceset,text:Lang.Mail.ConfigJs.pref_faceset_desc},skin:{type:"info",name:Lang.Mail.ConfigJs.switchSkin,text:Lang.Mail.ConfigJs.switchSkin},sign:{type:"info",name:Lang.Mail.ConfigJs.pref_signature,text:Lang.Mail.ConfigJs.pref_signature_desc},autoReply:{type:"mail",name:Lang.Mail.ConfigJs.pref_autoresp,text:Lang.Mail.ConfigJs.pref_autoresp_desc},autoForward:{type:"mail",name:Lang.Mail.ConfigJs.pref_forward,text:Lang.Mail.ConfigJs.pref_forward_desc},mailPOP:{type:"mail",
name:Lang.Mail.ConfigJs.pref_pop_settings,text:parent.corpMailCollMsg},filter:{type:"mail",name:Lang.Mail.ConfigJs.pref_filter,text:Lang.Mail.ConfigJs.pref_filter_desc},account:{type:"account",name:Lang.Mail.ConfigJs.accountSettings,text:Lang.Mail.ConfigJs.pref_aliasname_desc},password:{type:"account",name:Lang.Mail.ConfigJs.pref_setpassword,text:Lang.Mail.ConfigJs.pref_setpassword_desc},folderlock:{type:"account",name:Lang.Mail.ConfigJs.safeLock,text:Lang.Mail.ConfigJs.safeLockDes},phoneBind:{type:"account",
name:Lang.Mail.ConfigJs.phoneBind,text:Lang.Mail.ConfigJs.phoneBindDes},defaultAccount:{type:"mailManager",name:Lang.Mail.ConfigJs.defaultAccount,text:Lang.Mail.ConfigJs.defaultAccount_desc},memManager:{type:"mailManager",name:Lang.Mail.ConfigJs.memManager,text:Lang.Mail.ConfigJs.memManager_desc},mailSearch:{type:"index",name:Lang.Mail.ConfigJs.pref_search_settings,text:Lang.Mail.ConfigJs.pref_search_settings_desc},black:{type:"anti",name:Lang.Mail.ConfigJs.pref_refuselist,text:Lang.Mail.ConfigJs.pref_refuselist_desc},
white:{type:"anti",name:Lang.Mail.ConfigJs.pref_safelist,text:Lang.Mail.ConfigJs.pref_safelist_desc,noload:!0},antiGarbage:{type:"anti",name:Lang.Mail.ConfigJs.fanlaji,text:Lang.Mail.ConfigJs.fangxirao},antiViru:{type:"anti",name:Lang.Mail.ConfigJs.virusMail,text:Lang.Mail.ConfigJs.virusGo},notify:{type:"mobilemail",name:Lang.Mail.ConfigJs.pref_mail_notify,text:Lang.Mail.ConfigJs.pref_mail_notify_desc},loginNotify:{type:"mobilemail",name:Lang.Mail.ConfigJs.loginNotify,text:"\u624b\u673a\u63a5\u6536\u767b\u5f55\u63d0\u9192\uff0c\u7b2c\u4e00\u65f6\u95f4\u638c\u63e1\u767b\u5f55\u60c5\u51b5"},
sso:{type:"sso",name:"\u6388\u6743\u767b\u5f55",text:"\u7b2c\u4e09\u65b9\u6388\u6743\u767b\u5f55\u7ad9\u70b9"}}}
Setting.prototype={initialize:function(){var a=MM[gConst.setting];this.menuData={};for(var b in this.menuItem){var c=this.menuItem[b],d=c.type;d!=this.defaultMenu&&(this.menuData[d]||(this.menuData[d]={title:this.menuType[d].text,items:{}}),this.menuData[d].items[b]=c)}GMC.initialize(this.name,this);a.menuId=this.menuId;a.defaultMenu="index"},getHtml:function(){var a=this.menuId==this.defaultMenu&&CC.checkConfig(this.defaultMenu)?this.getIndexHtml():"";return'<div id="{0}" style="padding:0px;margin:0px;clear:both;text-align:left;">{1}</div>'.format(gConst.mainSetting,
a)},getTopHtml:function(a){var a=a||this.defaultMenu,a=this.menuItem[a].type,b=this.menus,c=[];c.push('<div id="set_head" class="header"><div><ul class="nav-hd">');for(var d=0;d<b.length;d++){var e=b[d],f=this.getConfigSubMenu(e);if(f){var g=f;e=="account"&&(g=f+"','"+e);e=="mobilemail"&&(g=f+"','notify");e==a?c.push('<li class="currentd"><a href="javascript:fGoto();" onclick="CC.setConfig(\''+g+"');return false;\">"+this.menuType[e].text+"</a></li>"):c.push('<li><a href="javascript:fGoto();" onclick="CC.setConfig(\''+
g+"');return false;\">"+this.menuType[e].text+"</a></li>")}}c.push("</ul></div></div>");return c.join("")},getIndexHtml:function(){var a=[],b=this.name,c=this.menuData;a.push('<div id="pageSetIndex">');var d=this.getTopHtml("index");a.push(d);a.push("<div id='settingList'><ul class=\"userSet\">");for(var e in c)if(d=c[e].items,this.getConfigSubMenu(e)){a.push("<li><h2>{0}</h2><dl>".format(c[e].title));for(var f in d)CC.checkConfig(f)&&(a.push('<dt><a href="javascript:fGoto();" onclick="CC.setConfig(\'{1}\');return false;">{2}</a></dt>'.format(b,
f,d[f].name)),a.push("<dd>{0}</dd>".format(d[f].text)));a.push("</dl></li>")}a.push("</ul></div></div>");this.menuId=this.defaultMenu;return a.join("")},getUrlHtml:function(a,b){var c=[];c.push("<div class=\"bodySet\" style='align:text;' id='{0}_{1}'>".format(gConst.mainSetting,a));c.push('<div id="container">');c.push(OptionBase.prototype.getNavMenu(a));c.push(CC.getIframe(a,b,"no"));c.push("</div></div>");return c.join("")},update:function(a,b){a=a||this.defaultMenu;$(gConst.mainSetting).innerHTML=
b;CC.updateTitleNew(this.menuItem[a].name);this.setDivHeight()},doMenu:function(a,b){var c=b.replace("CONFIG_","").toLowerCase();c=="mailpop"?CC.setConfig("mailPOP"):CC.setConfig(c)},optSetting:function(a,b){function c(){a=="notify"||a=="loginNotify"?f&&typeof f.init=="function"&&f.init(function(){d.menuId=a}):(d.menuId=a,f&&typeof f.init=="function"&&f.init(a,b))}var d=this,a=a||d.defaultMenu,b=b||"";d.phoneBindTip(a,b);if(d.menuId!=a){if(a==d.defaultMenu)if(CC.checkConfig(this.defaultMenu)){d.menuId=
a;d.update(d.defaultMenu,d.getIndexHtml());pref.updatePosition("settingList");return}else a=d.getIndexMenu();if(CC.checkConfig(a)){var e=d.menuItem[a],f=window[a];d.menuItem[a]&&typeof d.menuItem[a].event=="function"?d.menuItem[a].event():e&&e.url?(d.menuId=a,d.update(d.defaultMenu,d.getUrlHtml(a,e.url+b))):f?c():window.setTimeout(function(){c()},100)}}else b.callback&&b.callback.call(window[a],null)},phoneBindTip:function(a,b){function c(){var a="";aTag="";wo=null;window.gMain&&gMain.webPath&&gMain.sid&&
(a=gMain.webPath+"/se/account/accountindex.do?sid="+gMain.sid+"&mode=Mobile");a&&(aTag="<a href="+a+">\u8fdb\u5165\u5e10\u6237\u7ba1\u7406\u4e2d\u5fc3</a>",wo=function(){window.location.href=a});CC.alert(Lang.Mail.ConfigJs.phoneBindTip,wo);a&&jQuery("#divDialogClosealertbtn_0").find("span").find("span").html("\u7acb\u5373\u7ed1\u5b9a")}function d(){var a=null,a=null;phoneBind.doService("mail:getUserInfo",{},function(a){if(a&&a["var"]&&a["var"].flags!=0&&a["var"].mobilePhone){if(window.gMain)gMain.hasPhone=
a["var"].mobilePhone}else if(c(),window.gMain)gMain.hasPhone=""},function(){if(window.gMain)gMain.hasPhone="fail"})}if(!window.gMain||!gMain.flags||!CC.isMobileBind(gMain.flags))GC.check("CENTER_BIND")&&(a=="notify"&&b=="notify"||a=="sms")&&d()},init:function(){},getToolbar:function(){},getToolbarMenu:function(){return[]},resize:function(){this.setDivHeight()},exit:function(){this.menuId="";return!0},setDivHeight:function(){},getIndexMenu:function(){for(var a=this.menus,b=0;b<a.length;b++){var c=
this.getConfigSubMenu(a[b]);if(c)return c}},getConfigSubMenu:function(a){for(var a=this.menuType[a].menus,b=0;b<a.length;b++)if(CC.checkConfig(a[b]))return a[b]}};
function Sms(){this.name=gConst.sms;this.config={sendsms:{text:Lang.Mail.tb_SendSMS,url:"/CMail/WebSMS/Send/SendSms.aspx"},smsrecord:{text:Lang.Mail.tb_SMSRecord,url:"/CMail/WebSMS/Record/SendedList.aspx"},smssign:{text:Lang.Mail.tb_SMSSign,url:"/CMail/WebSMS/SMSSign/SignList.aspx"},smstime:{text:Lang.Mail.tb_SMSTime,url:"/CMail/WebSMS/Record/SetTimeList.aspx"}};this.configSSO={600:"sendsms",601:"sendsms",602:"smsrecord",603:"smssign",604:"smstime"}}
Sms.prototype={initialize:function(){GMC.initialize(this.name,this)},getHtml:function(){return'<div id="'+gConst.mainToolbar+this.name+'"></div>'+GMC.getHtml(this.name,this.url)},init:function(){},getToolbar:function(){var a=this,b=a.config,c=[];c[c.length]={name:"sendsms",text:b.sendsms.text,clickEvent:function(b){a.optSms(b);GC.ossHit(7001)},className:"SMSCompose",hasMenu:!1};c[c.length]={name:"smssign",text:b.smssign.text,clickEvent:function(b){a.optSms(b);GC.ossHit(7002)},className:"SMSSignature",
hasMenu:!1};c[c.length]={name:"smstime",text:b.smstime.text,clickEvent:function(b){a.optSms(b);GC.ossHit(7003)},className:"SMSSetTime",hasMenu:!1};c[c.length]={name:"smsrecord",text:b.smsrecord.text,clickEvent:function(b){a.optSms(b);GC.ossHit(7004)},className:"SMSSent",hasMenu:!1};return c},getToolbarMenu:function(){return[]},resize:function(){this.setDivHeight()},exit:function(){GMC.gcMem(this.name);return!0},setDivHeight:function(){GMC.setDivHeight(this.name)},getUrl:function(a){var a=a||"sendsms",
b=this.config,c="",d="";(d=this.configSSO[a])?(c=b[d].url,d=b[d].text):(c=b[a].url,d=b[a].text);c=GC.getCookie("SMSServer")+"/"+(c||"/CMail/WebSMS/Send/SendSms.aspx")+"?sid="+GC.getSid();return{url:c,name:d}},setUrl:function(a){return GMC.setUrl(this.name,a)},optSms:function(a){a=this.getUrl(a.name);CC.updateTitleNew(a.name,a.url);this.setUrl(a.url)}};
(function(a,b){window.TaskMail={isOpen:!0,addMenuItem:function(a){var b=a.todoTaskCount,e=a.totalTaskCount;if(this.isOpen&&e>=0)GE.taskMailNum=b,GE.taskedMailNum=e-b,a["var"].splice(1,0,{fid:9999998,folderColor:0,location:2,folderPassFlag:0,hideFlag:0,keepPeriod:0,order:15,name:"\u5f85\u529e\u90ae\u4ef6",parentId:0,pop3Flag:0,reserve:0,stats:{attachmentNum:0,messageCount:e,messageSize:0,unreadMessageCount:b,unreadMessageSize:0},flag:{taskFlag:1},type:1,vipFlag:0,virtualFolder:!0})},removeMenuItem:function(){var a;
if(this.isOpen){for(a=0,len=MM[gConst.folderMain].Folders.sys.length;a<len;a++)if(MM[gConst.folderMain].Folders.sys[a].fid===9999998){MM[gConst.folderMain].Folders.sys.splice(a,1);break}for(a=0,len=CM[gConst.folderMain]["var"].length;a<len;a++)if(CM[gConst.folderMain]["var"][a].fid===9999998){CM[gConst.folderMain]["var"].splice(a,1);break}}},getListThHtml:function(){var a="";this.isOpen&&(a='<th width="40"></th>');return a},getListIconHtml:function(a){var b="";this.isOpen&&(b+='<td style="width:40px;" class="ceilTask">',
b+='<div class="p_relative">',b+=this.getIconHtml(a,"listMail"),b+="</div>",b+="</td>",b+='<\!--[if lt ie 8]><td style=" width:15px;"></td><![endif]--\>');return b},getReadIconHtml:function(a,b){var e="";this.isOpen&&(e+='<div class="read-undoMission ceilTask"><div class="p_relative">',e+=this.getIconHtml(a,"readMail",b),e+="</div></div>");return e},getIconHtml:function(a,d,e){var f=[],g={listMail:["i-rw","i-rwing","i-rwed"],readMail:["i-brw","i-brwing","i-brwed"]},h,j,n;d==="listMail"?(h="flags",
j="-4px"):(h="flag",a.mid=a.omid,j="10px",a.taskDate=a.headers.taskDate);if(!a.emailName)a.emailName=a.account===b?a.from.decodeHTML():Email.getName(a.account.decodeHTML());f.push('<a title="\u5f85\u529e\u90ae\u4ef6" data-action="showTaskMenu" href="javascript:;" data-taskDate = "'+a.taskDate+'" data-mail="'+a.emailName.encodeHTML()+'" data-mid="'+a.mid+'" data-time="'+a.sendDate+'" data-subject="'+a.subject.encodeHTML()+'"');a[h].taskFlag===1?f.push(' data-taskStatus="1" class="'+g[d][1]+'">'):a[h].taskFlag===
2?f.push(' data-taskStatus="2" class="'+g[d][2]+'">'):f.push(' data-taskStatus="0" class="'+g[d][0]+'">');f.push("</a>");d==="readMail"&&!e&&f.push('<p class="pt_5">\u5f85\u529e\u90ae\u4ef6</p>');+a.taskDate>0&&(n=this.getTimeStr(+a.taskDate));f.push('<div class="y_tips" style="position:absolute;top: '+j+'; font-weight: normal; line-height: 22px; left:-210px;width:195px;display: none;">\u5904\u7406\u65f6\u95f4\uff1a<span class="textTaskDate col_orange">'+n+"</span></div>");return f.join("")},bindTaskEvent:function(b){var d=
this;if(!d.isOpen)return!0;a("#menuTaskMail",b).length<1&&(d.createTaskMenu(b),menu=a("#menuTaskMail",b),menu.find(".module_pop > .btnTaskStatus").click(function(){var b=a(this).parent().parent().attr("data-mid"),c=a(this).attr("type");d.modTaskStatus(b,0,+c,a(this))}),menu.find(".module_pop > .btnAddRemind").click(function(){d.msgRemind(a(this),"add",b)}),menu.find(".module_pop > .btnModRemind").click(function(){d.msgRemind(a(this),"mod",b)}),menu.find(".module_pop > .btnDelRemind").click(function(){var b=
a(this).parent().parent().attr("data-mid");d.delMailCalendar(b,a(this))}));d.bindIconEvent("content",b);d.bindIconEvent("readMail_inner",b);d.bindIconEvent("readmail_body",b);a(b.body,b).click(function(){jQuery(".pop_wrapper",b).hide()})},bindIconEvent:function(b,d){var e=this;a("#"+b,d).data("binded")!=="true"&&(a("#"+b,d).data("binded","true"),a("#"+b,d).on("click",".ceilTask > .p_relative > a",function(b){var c,h,j,n,k,q,t;c=a(this).offset();h=c.left-130;c=c.top;j=a(this).attr("data-mid");n=a(this).attr("data-mail");
k=a(this).attr("data-subject");time=a(this).attr("data-time");t=~~a(this).attr("data-taskDate");q=~~a(this).attr("data-taskStatus");e.toggleMenu(q,t,d);a("#menuTaskMail",d).attr({"data-mid":j,"data-mail":n,"data-subject":k,"data-time":time}).css({left:h+"px",top:c+"px"}).toggle();b.stopPropagation()}).on("mouseenter",".ceilTask > .p_relative > a",function(){+a(this).attr("data-taskDate")>0&&a(this).siblings(".y_tips").fadeIn()}).on("mouseleave",".ceilTask > .p_relative > a",function(){a(this).siblings(".y_tips").fadeOut()}))},
toggleMenu:function(b,d,e){e=a("#menuTaskMail",e);b===0?(e.find("li[type=0]").hide(),e.find("li[type=1]").show(),e.find("li[type=2]").hide()):b===1?(e.find("li[type=0]").show(),e.find("li[type=1]").hide(),e.find("li[type=2]").show()):b===2&&(e.find("li[type=0]").show(),e.find("li[type=1]").show(),e.find("li[type=2]").hide());d>0?(e.find(".btnAddRemind").hide(),e.find(".btnDelRemind").show(),e.find(".btnModRemind").show()):(e.find(".btnAddRemind").show(),e.find(".btnDelRemind").hide(),e.find(".btnModRemind").hide())},
createTaskMenu:function(b){var d=[],e;e=top.window===window?"listMail":"readMail";d.push('<div id="menuTaskMail" class="pop_wrapper w120" style="position:absolute; overflow: hidden; z-index: 10000; display: none;">');d.push('<ul class="module_pop">');d.push('<li clsType="'+e+'" class="btnTaskStatus" type="2"><a href="javascript:;">\u6807\u8bb0\u5b8c\u6210</a></li>');d.push('<li clsType="'+e+'" class="btnAddRemind"><a href="javascript:;">\u6dfb\u52a0\u63d0\u9192</a></li>');d.push('<li clsType="'+e+
'" class="btnTaskStatus" type="1"><a href="javascript:;">\u6807\u8bb0\u4efb\u52a1</a></li>');d.push('<li clsType="'+e+'" class="btnModRemind"><a href="javascript:;">\u4fee\u6539\u63d0\u9192</a></li>');d.push('<li clsType="'+e+'" class="btnDelRemind"><a href="javascript:;">\u53d6\u6d88\u63d0\u9192</a></li>');d.push('<li clsType="'+e+'" class="btnTaskStatus" type="0"><a href="javascript:;">\u53d6\u6d88\u4efb\u52a1</a></li>');d.push("</ul>");d.push("</div>");a(b.body,b).append(d.join(""))},bindTextEvent:function(){a("#textCalCont").on("input propertychange",
function(){var b=a(this).val(),d=b.length;d>100?(a(this).val(b.substr(0,100)),a("#numCanInput").html(0)):a("#numCanInput").html(100-d)})},getBindPhoneHtml:function(){var a=[];a.push(CC.getIframe("bindPhoneFrm",gMain.webPath+"/se/account/accountindex.do?sid="+gMain.sid+"&mode=Mobile","no","width:700px;height:464px;margin-left:-194px;margin-top:-120px;"));return a.join("")},checkAlert:function(){var b=this;jQuery("#checkSmsNotify").on("click",function(){a("#checkSmsNotify").is(":checked")&&(GC.check("CENTER_BIND")?
b.checkBindPhone():(a("#checkSmsNotify").attr("checked",!1),CC.alert("\u60a8\u6ca1\u6709\u7ed1\u5b9a\u624b\u673a\u7684\u6743\u9650\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd!",function(){a("#shareLayer").css({"z-index":"2100"});setTimeout(function(){a(".shareLayer").css("display","block")},100)}),a("#shareLayer")&&a("#divDialogalert")&&(a("#divDialogalert").css({"z-index":"2301"}),a("#shareLayer").css("z-index","2300"))))})},checkTips:function(){var b=a("#checkMailNotify"),d=a("#checkSmsNotify"),
e=a("#checkKeepOne");b.on("click",function(){!b.is(":checked")&&!d.is(":checked")&&(e.css("display","inline"),b.attr("checked","checked"),setTimeout(function(){e.css("display","none")},3E3))});d.on("click",function(){!b.is(":checked")&&!d.is(":checked")&&(e.css("display","inline"),b.attr("checked","checked"),setTimeout(function(){e.css("display","none")},3E3))})},showBindPage:function(){var b={},b=this.getBindPhoneHtml();setInterval(function(){jQuery("#unbindmobile_btn",jQuery("#divDialogremindNotify").contents().find("iframe").contents()).hide();
jQuery("#changemobile_btn",jQuery("#divDialogremindNotify").contents().find("iframe").contents()).hide()},500);b={id:"remindNotify",title:"\u7cfb\u7edf\u63d0\u793a",text:b,type:"div",width:507,zindex:20211,dragStyle:1,buttonType:"confirm",buttons:[{text:Lang.Mail.main_bt_back,clickEvent:function(){a("#shareLayer")&&(a("#shareLayer").css({"z-index":"2100"}),a("#checkSmsNotify").attr("checked",!1),setTimeout(function(){a(".shareLayer").css("display","block")},100))},isCancelBtn:!0}]};CC.msgBox(b);a("#shareLayer")&&
a("#divDialogremindNotify")&&(a("#divDialogremindNotify").css({"z-index":"2301",overflow:"hidden"}),a("#shareLayer").css("z-index","2300"))},checkBindPhone:function(){var a=this,b=null,b=null;phoneBind.doService("mail:getUserInfo",{},function(b){if(b&&b["var"]&&b["var"].flags!=0&&b["var"].mobilePhone){if(window.gMain)return gMain.hasPhone=b["var"].mobilePhone,top.gMain.flags=1,!0}else{a.showBindPage();if(window.gMain)gMain.hasPhone="";top.gMain.flags=0;return!1}},function(){if(window.gMain)gMain.hasPhone=
"fail";top.gMain.flags=0;return!1})},checkBindLast:function(){var a=null,a=null;phoneBind.doService("mail:getUserInfo",{},function(a){if(a&&a["var"]&&a["var"].flags!=0&&a["var"].mobilePhone){if(window.gMain)top.gMain.flags=1}else top.gMain.flags=0},function(){top.gMain.flags=0})},msgRemind:function(b,d){var e=this,f=e.getConfirmHtml(),g={},h={},j=[],n=[],k,q=b.parent().parent(),t=q.attr("data-mid"),u=q.attr("data-mail"),s=q.attr("data-subject");d==="add"?(k="add",g="\u6dfb\u52a0\u63d0\u9192",h.time=
(new Date).getTime()+864E5,q=new Date(~~q.attr("data-time")*1E3),q=q.getMonth()+1+"\u6708"+q.getDate()+"\u65e5 "+q.getHours()+":"+q.getMonth(),h.cont="\u8bf7\u5904\u7406"+q+"\u6765\u81ea"+u+"\u7684\u90ae\u4ef6\uff1a"+s):(k="mod",g="\u4fee\u6539\u63d0\u9192");g={id:"confirm",title:g,type:"text",width:460,text:f,zindex:20011,dragStyle:1,buttonType:"confirm",buttons:[{text:Lang.Mail.Ok,clickEvent:function(){e.checkCalInput()&&a("#checkSmsNotify").is(":checked")&&top.gMain.flags?e.setMailCalendar(t,k,
b):e.checkCalInput()&&!a("#checkSmsNotify").is(":checked")&&e.setMailCalendar(t,k,b)}},{text:Lang.Mail.Cancel,clickEvent:function(){},isCancelBtn:!0}]};e.checkBindLast();CC.msgBox(g);e.bindTextEvent();for(f=0;f<24;f++)j.push({text:f,value:f});e.loadDrop("calHourDrop","spanCalHour","selectCalHour",j);for(f=0;f<60;f++)n.push({text:f,value:f});e.loadDrop("calMinuteDrop","spanCalMinute","selectCalMinute",n);d==="add"?e.setCalendarValue(h):e.getMailCalendar(t);new CCalendar(jQuery("#textCalDate"),{onSelectBack:function(){return!0},
expired:!0});e.checkAlert();e.checkTips()},loadDrop:function(b,d,e,f){this[b]=new DropSelect({id:d,data:f,type:"opMailType",selectedValue:"-1",width:75,height:200});a("#"+e).html(this[b].getHTML());this[b].loadEvent()},getConfirmHtml:function(){var a=[];a.push('<div class="box-cont">');a.push('<p class="p-remind mb_10">\u5728\u4ee5\u4e0b\u65f6\u95f4\u63d0\u9192\u6211\uff1a<span class="col_orange fw_b" id="textCalTime"></span></p>');a.push('<div class="in-form mb_10">');a.push('<div class="input-cont clearfix">');
a.push('<input type="text" name="" id="textCalDate" readonly="readonly" class="in-t" />');a.push('<i class="i-keyboard"></i></div>');a.push(' <span id="selectCalHour"></span>');a.push(' <span class="hour">\u65f6</span>');a.push(' <span id="selectCalMinute"></span>');a.push(' <span class="minute">\u5206</span>');a.push("</div>");a.push('<dl class="box-cont-dl">');a.push('<dt class="title">\u63d0\u9192\u5185\u5bb9\uff1a</dt>');a.push("<dd>");a.push('<textarea class="box-texar" id="textCalCont"></textarea>');
a.push("</dd>");a.push('<dd>\u60a8\u8fd8\u53ef\u4ee5\u8f93\u5165<span class="col_orange" id="numCanInput"></span>\u5b57\uff0c\u6700\u591a<span class="col_orange">100</span>\u5b57</dd>');a.push('<dd class="mt_8">');a.push('<input type="checkbox" checked="checked" id="checkMailNotify" /> \u90ae\u4ef6\u63d0\u9192   <input type="checkbox" id="checkSmsNotify" class="ml_20"  /> \u77ed\u4fe1\u63d0\u9192  <span style="display:none" class="col_orange ml_20" id="checkKeepOne">\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u79cd\u63d0\u9192\u65b9\u5f0f</span>');
a.push("</dd>");a.push("</dl>");a.push("</div>");return a.join("")},checkCalInput:function(){var b=jQuery("#textCalDate").val().replace(/\-/g,"/")+" "+this.calHourDrop.getValue()+":"+this.calMinuteDrop.getValue()+":00",d=(new Date).getTime(),b=(new Date(b)).getTime();if(a("#textCalCont").val().trimAll().length<1)return CC.alert("\u63d0\u9192\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a",function(){},"\u7cfb\u7edf\u63d0\u793a"),!1;if(a("#textCalCont").val().trimAll().length>100)return CC.alert("\u63d0\u9192\u5185\u5bb9\u4e0d\u80fd\u8d85\u8fc7100\u5b57",
function(){},"\u7cfb\u7edf\u63d0\u793a"),!1;return b<d?(CC.alert("\u4e0b\u53d1\u63d0\u9192\u7684\u65f6\u95f4\u4e0d\u80fd\u65e9\u4e8e\u5f53\u524d\u65f6\u95f4\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u63d0\u9192\u65f6\u95f4",function(){},"\u7cfb\u7edf\u63d0\u793a"),!1):!0},modTaskStatus:function(c,d,e,f,g){var h=this,j={func:"mbox:setTaskMessages",data:{type:"taskFlag",value:e,time:d,ids:[c]},call:function(){var f,j,t,u,s;u=a(".ceilTask > .p_relative > a[data-mid="+c+"]");j=~~u.attr("data-taskstatus");s=
window.frames["ifrmReadmail_Content_readMail"+c];LM.loadFolderMain();e===2?(f=2,t="\u5f85\u529e\u4efb\u52a1\u5df2\u6807\u8bc6\u4e3a\u5df2\u5b8c\u6210",GE.taskedMailNum++,GE.taskMailNum--,h.delMailCalendar(c,b,!0),a("#tab_b_sys0").length!=0&&a("#tab_b_sys0").css("display")!="none"&&typeof a("#tab_b_sys0").css("display")!="undefined"&&CC.receiveMail({taskFlag:1})):e===1?(f=1,t="\u6dfb\u52a0\u5f85\u529e\u4efb\u52a1\u6210\u529f",j===0?GE.taskMailNum++:j===2&&(GE.taskedMailNum--,GE.taskMailNum++)):(f=
0,t="\u53d6\u6d88\u5f85\u529e\u4efb\u52a1\u6210\u529f",h.delMailCalendar(c,b,!0),j===1?GE.taskMailNum--:j===2&&GE.taskedMailNum--);g||CC.showMsg(t,!0,!1,"option");s&&a(".ceilTask > .p_relative > a",s.document).attr({"class":n[1][e],"data-taskStatus":f,"data-taskDate":d});u.attr({"class":n[0][e],"data-taskStatus":f,"data-taskDate":d});d>0&&(f=new Date(d*1E3),f=f.getFullYear()+"-"+(f.getMonth()+1)+"-"+f.getDate()+" "+f.getHours()+":"+f.getMinutes(),u.siblings(".y_tips").find(".textTaskDate").html(f),
s&&a(".ceilTask > .p_relative > a",s.document).siblings(".y_tips").find(".textTaskDate").html(f))},failCall:function(){LM.loadFolderMain()},msg:""},n=[["i-rw","i-rwing","i-rwed"],["i-brw","i-brwing","i-brwed"]];f.attr("clsType");MM.mailRequestApi(j)},setMailCalendar:function(b,d,e,f){var g,h=this,j=jQuery("#textCalDate").val(),n=~~h.calHourDrop.getValue(),k=~~h.calMinuteDrop.getValue();g=(n<10?"0"+n:n).toString()+(k<10?"0"+k:k).toString();var q=jQuery("#textCalCont").val(),t=(new Date(j.replace(/\-/g,
"/")+" "+n+":"+k+":00")).getTime()/1E3,u,s=0,r=0;u=d==="add"?"calendar:addMailCalendar":"calendar:updateMailCalendar";s=a("#checkMailNotify").is(":checked")?1:0;r=a("#checkSmsNotify").is(":checked")?1:0;g={url:h.getWebsiteUrl()+"/calendar/s",func:u,data:{comeFrom:0,recMyEmail:s,recMySms:r,startTime:g,endTime:g,content:q,title:q,dateFlag:j,endDateFlag:j,enable:1,dateDesc:j,mid:b},call:function(){if(!f)if(d==="add")CC.showMsg("\u6dfb\u52a0\u5f85\u529e\u63d0\u9192\u6210\u529f",!0,!1,"option");else{CC.showMsg("\u4fee\u6539\u5f85\u529e\u63d0\u9192\u6210\u529f",
!0,!1,"option");var g=a("#ifrmReadmail_Content_readMail"+b).contents(),g=a(".divTips",g),q=n.toString()+":"+k.toString();g.length>0&&a("span",g).html("\u5df2\u8bbe\u4e3a\u5f85\u529e\u90ae\u4ef6\uff0c"+j+" "+q+"\u63d0\u9192\u3002")}h.modTaskStatus(b,t,1,e,!0)},failCall:function(){},msg:""};MM.mailRequestApi(g)},delMailCalendar:function(a,b,e){var f=this,g={url:f.getWebsiteUrl()+"/calendar/s",func:"calendar:delMailCalendar",data:{mid:a,comeFrom:0,actionType:0},call:function(){e||CC.showMsg("\u53d6\u6d88\u5f85\u529e\u63d0\u9192\u6210\u529f",
!0,!1,"option");b&&f.modTaskStatus(a,0,1,b,!0)},failCall:function(){e||CC.showMsg("\u53d6\u6d88\u5f85\u529e\u63d0\u9192\u5931\u8d25",!0,!1,"option")},msg:""};MM.mailRequestApi(g)},setCalendarValue:function(b){var d=b.cont||"",b=new Date(b.time),e=b.getFullYear()+"-"+(b.getMonth()+1<10?"0"+(b.getMonth()+1):b.getMonth()+1)+"-"+(b.getDate()<10?"0"+b.getDate():b.getDate());tStr=e+" "+b.getHours()+":"+b.getMinutes();a("#textCalDate").val(e);a("#textCalTime").html(tStr);this.calHourDrop.setValue(b.getHours());
this.calMinuteDrop.setValue(b.getMinutes());a("#textCalCont").val(d);a("#numCanInput").html(100-d.length)},getMailCalendar:function(b){var d=this,e=a("#checkMailNotify"),f=a("#checkSmsNotify"),b={url:d.getWebsiteUrl()+"/calendar/s",func:"calendar:getMailCalendar",data:{mid:b,comeFrom:0},call:function(a){var b=a["var"],c=b.dateFlag.replace(/\-/g,"/")+" ";b.startTime.length<=2?c+="00:"+b.startTime:b.startTime.length===3?(c+=b.startTime.slice(0,1),c+=":"+b.startTime.slice(1)):(c+=b.startTime.slice(0,
2),c+=":"+b.startTime.slice(2));c+=":00";d.setCalendarValue({cont:a["var"].content,time:(new Date(c)).getTime()});b.recMyEmail&&b.recMyEmail==1?e.attr("checked","checked"):e.attr("checked",!1);b.recMySms&&b.recMySms==1&&top.gMain&&top.gMain.flags?f.attr("checked","checked"):f.attr("checked",!1)},failCall:function(){},msg:""};MM.mailRequestApi(b)},getWebsiteUrl:function(){return location.protocol+"//"+location.host},getTimeStr:function(a){a=new Date(a*1E3);return a.getFullYear()+"-"+(a.getMonth()+
1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()}}})(jQuery);function Weather(){this.name=gConst.weather;this.imgUrl=GC.frmPath;this.url=GC.apiServer+"/WebService/GetWeatherDetail.aspx";this.userNumber=gMain.userNumber}
Weather.prototype={init:function(){this.weatherDiv=$("homeWeatherDiv");this.weatherDetailDiv=$("homeCityDiv");this.weatherDiv&&this.weatherDetailDiv&&(this.getWeatherDetail(),this.getWeather())},setData:function(a,b,c,d){a=this.url+"?usernumber="+this.userNumber+a;El.show($("weatherLoading"));El.hide($("weatherContent"));if(!WeatherForecast||d)CC.requestWebApi(a,function(){if(typeof WeatherForecast=="object"){if(c)Weather.data=WeatherForecast;b(WeatherForecast);El.hide($("weatherLoading"));El.show($("weatherContent"))}});
else if(typeof WeatherForecast=="object"){if(c)Weather.data=WeatherForecast;b(WeatherForecast);El.hide($("weatherLoading"));El.show($("weatherContent"))}},showWeather:function(a){a?El.hide(this.weatherDetailDiv):El.show(this.weatherDetailDiv);a=EV.getEvent();EV.stopPropagation(a)},doChangeCity:function(a){var b=$("selCity").value;b==""?alert(Lang.Mail.weather_SelectViewCity):a?this.getWeatherList(!1,a):this.getWeather(0,b,!0)},getWeather:function(a,b,c){function d(b){var c=[],d=e.weatherDiv,f=$("iconWeather"),
q=MM.home.userInfo.nowTime.getFullYear()+"-"+b.Weather[a].date,t=Util.parseDate(q,"yyyy-m\u6708d\u65e5"),q=b.Weather[a].pic0,t=Util.formatDate(t,Lang.Mail.date_mmddww),u=e.imgUrl+"/images/weather/"+q+".gif";if(q)c[c.length]="<li>"+t+'<a class="city" href="javascript:fGoto();" onclick="MM[\'weather\'].showWeather()">'+b.city+"</a></li>",c[c.length]="<li>"+g+"&nbsp;"+b.Weather[a].temper1+"~"+b.Weather[a].temper0+"</li>",c[c.length]='<li><a href="javascript:fGoto();" onclick="MM[\'weather\'].getWeather('+
(1-a)+');return false;">'+(a?Lang.Mail.weather_Today:Lang.Mail.weather_Tomorrow)+'</a><a href="javascript:fGoto();" onclick="MM[\'weather\'].showWeather();">'+Lang.Mail.weather_ViewOtherCity+"</a></li>",f.style.backgroundImage="url("+u+")",f.alt=b.weather;d.innerHTML=c.join("");e.getWeatherList(!0)}var e=this;$("selCity");a=a||0;typeof a=="string"&&(a=a.toInt());var f="";b&&(f+="&areaCode="+b);var g=a?Lang.Mail.weather_TomorrowTemper:Lang.Mail.weather_TodayTemper;if(b||!Weather.data)e.setData(f,d,
!0,c||!1);d(Weather.data)},getWeatherDetail:function(){var a=[],b=this.weatherDetailDiv;a[a.length]='<a class="close" href="javascript:fGoto();" onclick="MM[\'weather\'].showWeather(true)">\u5173\u95ed</a>';a[a.length]='<p class="action"><label id="cityDiv"></label>';a[a.length]='<select name="selProvince" id="selProvince" onchange="MM[\'weather\'].getCity(this.options[this.selectedIndex].value)">';a[a.length]="<option>==\u7701\u4efd==</option>";"\u5317\u4eac,\u5929\u6d25,\u4e0a\u6d77,\u5e7f\u4e1c,\u5e7f\u897f,\u6cb3\u5317,\u6cb3\u5357,\u6e56\u5317,\u6e56\u5357,\u798f\u5efa,\u5c71\u4e1c,\u5b89\u5fbd,\u6d59\u6c5f,\u56db\u5ddd,\u91cd\u5e86,\u8d35\u5dde,\u4e91\u5357,\u6c5f\u82cf,\u5c71\u897f,\u8fbd\u5b81,\u5409\u6797,\u5185\u8499\u53e4,\u9ed1\u9f99\u6c5f,\u897f\u85cf,\u9655\u897f,\u7518\u8083,\u9752\u6d77,\u5b81\u590f,\u65b0\u7586,\u6c5f\u897f,\u6d77\u5357,\u53f0\u6e7e,\u9999\u6e2f,\u6fb3\u95e8".split(",").each(function(b,
d){a[a.length]='<option value="'+(101+b)+'">'+d+"</option>"});a[a.length]="</select>";a[a.length]='<select id="selCity" name="selCity">';a[a.length]='<option value="">==\u5730\u5e02==</option></select>';a[a.length]='<a class="btn btnSee" href="javascript:fGoto();" onclick="MM[\'weather\'].doChangeCity(true);return false;"><b class="r1"></b><span class="rContent"><span>\u67e5\u770b</span></span><b class="r1"></b></a>';a[a.length]='<a class="btn btnSetDefault" href="javascript:fGoto();" onclick="MM[\'weather\'].doChangeCity();return false;"><b class="r1"></b><span class="rContent"><span>\u8bbe\u4e3a\u9ed8\u8ba4\u57ce\u5e02</span></span><b class="r1"></b></a>';
a[a.length]="</p>";a[a.length]='<div id="weatherContent">';a[a.length]="</div>";a[a.length]='<div class="weatherLoading" id="weatherLoading">\u6570\u636e\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019....</div>';a[a.length]="</div>";b.innerHTML=a.join("")},getWeatherList:function(a,b){function c(a){var b=$("weatherContent");$("cityDiv").innerHTML=a.city;d[d.length]='<ul id="detailWeatherList">';a.Weather.each(function(b,c){d[d.length]=b==a.Weather.length-1?'<li class="last">':"<li>";if(c.pic0&&c.pic1){var e=
h+"/images/weather/small/"+c.pic0+".gif",f=h+"/images/weather/small/"+c.pic1+".gif";d[d.length]="<p>"+c.date+"</p>";d[d.length]='<p><img alt="'+c.weather+'" src="'+e+'" /><img alt="'+c.weather+'" src="'+f+'" /></p>';d[d.length]="<p>"+c.weather+"</p>";d[d.length]='<p><span class="from">'+c.temper1+'</span>\uff5e<span class="to">'+c.temper0+"</span></p>"}d[d.length]="</li>"});d[d.length]="</ul>";d[d.length]='<dl id="detailWeatherInfo">';e.each(function(b,c){var e=a["index"+b];d[d.length]="<dt>"+c+"</dt>";
d[d.length]='<dd title="'+e+'">'+e+"</dd>"});d[d.length]="</dl>";b.innerHTML=d.join("")}var d=[],e="\u7a7f\u8863\u6307\u6570,\u611f\u5192\u6307\u6570,\u6668\u7ec3\u6307\u6570,\u4ea4\u901a\u6307\u6570,\u4e2d\u6691\u6307\u6570,\u516c\u56ed\u6307\u6570,\u9632\u6652\u6307\u6570,\u65c5\u884c\u6307\u6570".split(","),f=$("selCity"),g="",h=this.imgUrl||"";if(f)g=f.value;f="";g&&(f+="&areaCode="+g);b&&(f+="&view=view");a?c(Weather.data):this.setData(f,c,!1,!0)},getCity:function(a){var b=[];a+="";switch(a){case "101":b[b.length]=
["\u5317\u4eac","54511"];break;case "102":b[b.length]=["\u5929\u6d25","54517"];break;case "103":b[b.length]=["\u4e0a\u6d77","58367"];break;case "104":b[b.length]=["\u5e7f\u5dde","59287"];b[b.length]=["\u6f6e\u5dde","59312"];b[b.length]=["\u8087\u5e86","59278"];b[b.length]=["\u6c55\u5c3e","59501"];b[b.length]=["\u6cb3\u6e90","59293"];b[b.length]=["\u97f6\u5173","59082"];b[b.length]=["\u63ed\u9633","59315"];b[b.length]=["\u6885\u5dde","59117"];b[b.length]=["\u4e2d\u5c71","59485"];b[b.length]=["\u60e0\u5dde",
"59298"];b[b.length]=["\u4e1c\u839e","59289"];b[b.length]=["\u6e05\u8fdc","59280"];b[b.length]=["\u6c5f\u95e8","59473"];b[b.length]=["\u8302\u540d","59659"];b[b.length]=["\u4e91\u6d6e","59471"];b[b.length]=["\u9633\u6c5f","59663"];b[b.length]=["\u6c55\u5934","59316"];b[b.length]=["\u6df1\u5733","59493"];b[b.length]=["\u73e0\u6d77","59488"];b[b.length]=["\u6e5b\u6c5f","59658"];b[b.length]=["\u4f5b\u5c71","59279"];break;case "105":b[b.length]=["\u5357\u5b81","59432"];b[b.length]=["\u767e\u8272","59211"];
b[b.length]=["\u67f3\u5dde","59046"];b[b.length]=["\u68a7\u5dde","59265"];b[b.length]=["\u7389\u6797","59453"];b[b.length]=["\u6842\u5e73","59254"];b[b.length]=["\u8d3a\u5dde","59065"];b[b.length]=["\u94a6\u5dde","59632"];b[b.length]=["\u8d35\u6e2f","59249"];b[b.length]=["\u9633\u6714","59051"];b[b.length]=["\u6842\u6797","57957"];b[b.length]=["\u5317\u6d77","59644"];b[b.length]=["\u6cb3\u6c60","59023"];break;case "106":b[b.length]=["\u77f3\u5bb6\u5e84","53698"];b[b.length]=["\u5510\u5c71","54534"];
b[b.length]=["\u5f20\u5bb6\u53e3","54401"];b[b.length]=["\u5eca\u574a","54515"];b[b.length]=["\u90af\u90f8","53892"];b[b.length]=["\u90a2\u53f0","53798"];b[b.length]=["\u6ca7\u5dde","54616"];b[b.length]=["\u8861\u6c34","54702"];b[b.length]=["\u627f\u5fb7","54423"];b[b.length]=["\u79e6\u7687\u5c9b","54449"];b[b.length]=["\u4fdd\u5b9a","54602"];break;case "107":b[b.length]=["\u90d1\u5dde","57083"];b[b.length]=["\u5f00\u5c01","57091"];b[b.length]=["\u5b89\u9633","53898"];b[b.length]=["\u7126\u4f5c",
"53982"];b[b.length]=["\u9e64\u58c1","53990"];b[b.length]=["\u5e73\u9876\u5c71","57171"];b[b.length]=["\u5546\u4e18","58005"];b[b.length]=["\u6fee\u9633","54900"];b[b.length]=["\u5357\u9633","57178"];b[b.length]=["\u8bb8\u660c","57089"];b[b.length]=["\u4fe1\u9633","57297"];b[b.length]=["\u4e09\u95e8\u5ce1","57051"];b[b.length]=["\u9a7b\u9a6c\u5e97","57290"];b[b.length]=["\u5468\u53e3","57195"];b[b.length]=["\u65b0\u4e61","53986"];b[b.length]=["\u6d1b\u9633","57073"];b[b.length]=["\u5f00\u5c01","57091"];
break;case "108":b[b.length]=["\u6b66\u6c49","57494"];b[b.length]=["\u9ec4\u5188","57498"];b[b.length]=["\u6069\u65bd","57447"];b[b.length]=["\u8346\u5dde","57476"];b[b.length]=["\u795e\u519c\u67b6","57362"];b[b.length]=["\u5341\u5830","57256"];b[b.length]=["\u54b8\u5b81","57590"];b[b.length]=["\u8944\u6a0a","57278"];b[b.length]=["\u5b5d\u611f","57482"];b[b.length]=["\u968f\u5dde","57381"];b[b.length]=["\u9ec4\u77f3","58407"];b[b.length]=["\u8346\u95e8","57377"];b[b.length]=["\u9102\u5dde","57496"];
b[b.length]=["\u5b9c\u660c","57461"];break;case "109":b[b.length]=["\u957f\u6c99","57687"];b[b.length]=["\u90b5\u9633","57766"];b[b.length]=["\u5e38\u5fb7","57662"];b[b.length]=["\u90f4\u5dde","57972"];b[b.length]=["\u5409\u9996","57649"];b[b.length]=["\u682a\u6d32","57780"];b[b.length]=["\u5a04\u5e95","57763"];b[b.length]=["\u6e58\u6f6d","57773"];b[b.length]=["\u6c38\u5dde","57866"];b[b.length]=["\u5cb3\u9633","57584"];b[b.length]=["\u8861\u9633","57872"];b[b.length]=["\u6000\u5316","57749"];b[b.length]=
["\u97f6\u5c71","57771"];b[b.length]=["\u5f20\u5bb6\u754c","57558"];b[b.length]=["\u8861\u5c71","57777"];break;case "110":b[b.length]=["\u798f\u5dde","58847"];b[b.length]=["\u9f99\u5ca9","58927"];b[b.length]=["\u5357\u5e73","58834"];b[b.length]=["\u5b81\u5fb7","58846"];b[b.length]=["\u8386\u7530","58946"];b[b.length]=["\u6cc9\u5dde","59137"];b[b.length]=["\u4e09\u660e","58828"];b[b.length]=["\u6f33\u5dde","59126"];b[b.length]=["\u53a6\u95e8","59134"];b[b.length]=["\u6b66\u5937\u5c71\u5e02","58730"];
break;case "111":b[b.length]=["\u6d4e\u5357","54823"];b[b.length]=["\u67a3\u5e84","58024"];b[b.length]=["\u804a\u57ce","54806"];b[b.length]=["\u66f2\u961c","54918"];b[b.length]=["\u6d4e\u5b81","54915"];b[b.length]=["\u4e34\u6c82","54938"];b[b.length]=["\u83cf\u6cfd","54906"];b[b.length]=["\u6cf0\u5b89","54827"];b[b.length]=["\u65e5\u7167","54945"];b[b.length]=["\u4e1c\u8425","54736"];b[b.length]=["\u9752\u5c9b","54857"];b[b.length]=["\u5a01\u6d77","54774"];b[b.length]=["\u6cf0\u5c71","54826"];b[b.length]=
["\u70df\u53f0","54765"];b[b.length]=["\u6f4d\u574a","54843"];b[b.length]=["\u6dc4\u535a","54830"];break;case "112":b[b.length]=["\u5408\u80a5","58321"];b[b.length]=["\u5de2\u6e56","58326"];b[b.length]=["\u868c\u57e0","58221"];b[b.length]=["\u5b89\u5e86","58424"];b[b.length]=["\u516d\u5b89","58311"];b[b.length]=["\u6ec1\u5dde","58236"];b[b.length]=["\u9a6c\u978d\u5c71","58336"];b[b.length]=["\u961c\u9633","58203"];b[b.length]=["\u5ba3\u57ce","58433"];b[b.length]=["\u94dc\u9675","58429"];b[b.length]=
["\u6dee\u5317","58116"];b[b.length]=["\u829c\u6e56","58334"];b[b.length]=["\u4eb3\u5dde","58102"];b[b.length]=["\u5bbf\u5dde","58122"];b[b.length]=["\u6dee\u5357","58224"];b[b.length]=["\u9ec4\u5c71\u7ad9","58437"];b[b.length]=["\u4e5d\u534e\u5c71","58423"];break;case "113":b[b.length]=["\u676d\u5dde","58457"];b[b.length]=["\u6e56\u5dde","58450"];b[b.length]=["\u91d1\u534e","58549"];b[b.length]=["\u5b81\u6ce2","58563"];b[b.length]=["\u4e3d\u6c34","58646"];b[b.length]=["\u8862\u5dde","58633"];b[b.length]=
["\u5609\u5174","58452"];b[b.length]=["\u53f0\u5dde","58660"];b[b.length]=["\u821f\u5c71","58477"];b[b.length]=["\u911e\u53bf","58562"];b[b.length]=["\u4e50\u6e05","58656"];b[b.length]=["\u6e29\u5dde","58659"];b[b.length]=["\u821f\u5c71","58477"];break;case "114":b[b.length]=["\u6210\u90fd","56294"];b[b.length]=["\u6cf8\u5dde","57602"];b[b.length]=["\u5185\u6c5f","57504"];b[b.length]=["\u51c9\u5c71","56571"];b[b.length]=["\u963f\u575d","56171"];b[b.length]=["\u5df4\u4e2d","57313"];b[b.length]=["\u5e7f\u5143",
"57206"];b[b.length]=["\u4e50\u5c71","56386"];b[b.length]=["\u7ef5\u9633","56196"];b[b.length]=["\u5fb7\u9633","56198"];b[b.length]=["\u6500\u679d\u82b1","56666"];b[b.length]=["\u96c5\u5b89","56287"];b[b.length]=["\u5b9c\u5bbe","56492"];b[b.length]=["\u81ea\u8d21","56396"];b[b.length]=["\u7518\u5b5c\u5dde","56146"];b[b.length]=["\u8fbe\u5dde","57328"];b[b.length]=["\u5ce8\u7709\u5c71","56385"];break;case "115":b[b.length]=["\u91cd\u5e86","57516"];break;case "116":b[b.length]=["\u8d35\u9633","57816"];
b[b.length]=["\u5b89\u987a","57806"];b[b.length]=["\u8d64\u6c34","57609"];b[b.length]=["\u9075\u4e49","57713"];b[b.length]=["\u94dc\u4ec1","57741"];b[b.length]=["\u516d\u76d8\u6c34","56693"];b[b.length]=["\u6bd5\u8282","57707"];b[b.length]=["\u51ef\u91cc","57825"];b[b.length]=["\u90fd\u5300","57827"];break;case "117":b[b.length]=["\u901a\u4ec0","59941"];b[b.length]=["\u6606\u660e","56778"];b[b.length]=["\u4fdd\u5c71","56748"];b[b.length]=["\u695a\u96c4","56768"];b[b.length]=["\u5fb7\u5b8f","56844"];
b[b.length]=["\u7ea2\u6cb3","56975"];b[b.length]=["\u4e34\u6ca7","56951"];b[b.length]=["\u6012\u6c5f","56533"];b[b.length]=["\u66f2\u9756","56783"];b[b.length]=["\u601d\u8305","56964"];b[b.length]=["\u6587\u5c71","56994"];b[b.length]=["\u7389\u6eaa","56875"];b[b.length]=["\u662d\u901a","56586"];b[b.length]=["\u5927\u7406","56751"];b[b.length]=["\u4e3d\u6c5f","56651"];b[b.length]=["\u5fb7\u94a6","56444"];break;case "118":b[b.length]=["\u6606\u5c71","58356"];b[b.length]=["\u5357\u4eac","58238"];b[b.length]=
["\u5357\u901a","58259"];b[b.length]=["\u592a\u4ed3","58377"];b[b.length]=["\u82cf\u5dde","58357"];b[b.length]=["\u5f90\u5dde","58027"];b[b.length]=["\u5b9c\u5174","58346"];b[b.length]=["\u9547\u6c5f","58248"];b[b.length]=["\u6dee\u5b89","58145"];b[b.length]=["\u5e38\u719f","58352"];b[b.length]=["\u76d0\u57ce","58151"];b[b.length]=["\u6cf0\u5dde","58246"];b[b.length]=["\u82cf\u5dde","58357"];b[b.length]=["\u65e0\u9521","58354"];b[b.length]=["\u8fde\u4e91\u6e2f","58044"];b[b.length]=["\u626c\u5dde",
"58245"];b[b.length]=["\u5e38\u5dde","58343"];break;case "119":b[b.length]=["\u592a\u539f","53772"];b[b.length]=["\u9633\u6cc9","53782"];b[b.length]=["\u664b\u57ce","53976"];b[b.length]=["\u664b\u4e2d","53778"];b[b.length]=["\u4e34\u6c7e","53868"];b[b.length]=["\u8fd0\u57ce","53959"];b[b.length]=["\u957f\u6cbb","53882"];b[b.length]=["\u6714\u5dde","53578"];b[b.length]=["\u5ffb\u5dde","53674"];b[b.length]=["\u5927\u540c","53487"];b[b.length]=["\u4e94\u53f0\u5c71","53588"];break;case "120":b[b.length]=
["\u6c88\u9633","54342"];b[b.length]=["\u846b\u82a6\u5c9b","54453"];b[b.length]=["\u65c5\u987a","54660"];b[b.length]=["\u672c\u6eaa","54346"];b[b.length]=["\u671d\u9633","54324"];b[b.length]=["\u629a\u987a","54353"];b[b.length]=["\u94c1\u5cad","54249"];b[b.length]=["\u8fbd\u9633","54347"];b[b.length]=["\u8425\u53e3","54471"];b[b.length]=["\u961c\u65b0","54237"];b[b.length]=["\u5927\u8fde","54662"];b[b.length]=["\u4e39\u4e1c","54497"];b[b.length]=["\u978d\u5c71","54339"];b[b.length]=["\u9526\u5dde",
"54337"];break;case "121":b[b.length]=["\u957f\u6625","54161"];b[b.length]=["\u5ef6\u5409","54292"];b[b.length]=["\u5409\u6797","54172"];b[b.length]=["\u767d\u5c71","54371"];b[b.length]=["\u767d\u57ce","50936"];b[b.length]=["\u56db\u5e73","54157"];b[b.length]=["\u677e\u539f","50946"];b[b.length]=["\u8fbd\u6e90","54260"];b[b.length]=["\u957f\u767d","54386"];b[b.length]=["\u5927\u5b89","50945"];b[b.length]=["\u901a\u5316","54363"];break;case "122":b[b.length]=["\u547c\u548c\u6d69\u7279","53463"];b[b.length]=
["\u5305\u5934","53446"];b[b.length]=["\u8d64\u5cf0","54218"];b[b.length]=["\u6d77\u62c9\u5c14","50527"];b[b.length]=["\u9521\u6797\u6d69\u7279","54102"];b[b.length]=["\u4e4c\u6d77","53512"];b[b.length]=["\u9102\u5c14\u591a\u65af","53543"];b[b.length]=["\u7259\u514b\u77f3","50526"];b[b.length]=["\u6ee1\u6d32\u91cc","50514"];break;case "123":b[b.length]=["\u54c8\u5c14\u6ee8","50953"];b[b.length]=["\u7261\u4e39\u6c5f","54094"];b[b.length]=["\u9f50\u9f50\u54c8\u5c14","50745"];b[b.length]=["\u5927\u5e86",
"50842"];b[b.length]=["\u4f0a\u6625","50774"];b[b.length]=["\u53cc\u9e2d\u5c71","50884"];b[b.length]=["\u9e64\u5c97","50775"];b[b.length]=["\u9e21\u897f","50978"];b[b.length]=["\u4f73\u6728\u65af","50873"];b[b.length]=["\u4e03\u53f0\u6cb3","50971"];b[b.length]=["\u7ee5\u5316","50853"];b[b.length]=["\u9ed1\u6cb3","50468"];b[b.length]=["\u7261\u4e39\u6c5f","54094"];b[b.length]=["\u5927\u5174\u5b89\u5cad","50442"];b[b.length]=["\u9ed1\u6cb3","50468"];break;case "124":b[b.length]=["\u62c9\u8428","55591"];
b[b.length]=["\u660c\u90fd","56137"];b[b.length]=["\u963f\u91cc","55437"];b[b.length]=["\u90a3\u66f2","55299"];b[b.length]=["\u65e5\u5580\u5219","55578"];b[b.length]=["\u5c71\u5357","55598"];b[b.length]=["\u6797\u829d","56312"];break;case "125":b[b.length]=["\u897f\u5b89","57036"];b[b.length]=["\u97e9\u57ce","53955"];b[b.length]=["\u6c49\u4e2d","57127"];b[b.length]=["\u5b9d\u9e21","57016"];b[b.length]=["\u54b8\u9633","57048"];b[b.length]=["\u6986\u6797","53646"];b[b.length]=["\u6e2d\u5357","57045"];
b[b.length]=["\u5546\u5dde","57143"];b[b.length]=["\u94dc\u5ddd","53947"];b[b.length]=["\u534e\u5c71","57046"];b[b.length]=["\u5ef6\u5b89","53845"];break;case "126":b[b.length]=["\u5170\u5dde","52889"];b[b.length]=["\u767d\u94f6","52896"];b[b.length]=["\u5e86\u9633","53829"];b[b.length]=["\u9152\u6cc9","52533"];b[b.length]=["\u5929\u6c34","57006"];b[b.length]=["\u6b66\u5a01","52679"];b[b.length]=["\u5f20\u6396","52652"];b[b.length]=["\u7518\u5357","50741"];b[b.length]=["\u4e34\u590f","52984"];b[b.length]=
["\u5e73\u51c9","53915"];b[b.length]=["\u5b9a\u897f","52995"];b[b.length]=["\u91d1\u660c","52675"];b[b.length]=["\u6566\u714c","52418"];break;case "127":b[b.length]=["\u897f\u5b81","52866"];b[b.length]=["\u6d77\u5317","52754"];b[b.length]=["\u6d77\u5357","52856"];b[b.length]=["\u6d77\u897f","52737"];b[b.length]=["\u9ec4\u5357","56065"];b[b.length]=["\u6d77\u4e1c","52875"];b[b.length]=["\u679c\u6d1b","56043"];b[b.length]=["\u7389\u6811","56029"];break;case "128":b[b.length]=["\u94f6\u5ddd","53614"];
b[b.length]=["\u56fa\u539f","53817"];b[b.length]=["\u4e2d\u536b","53704"];b[b.length]=["\u77f3\u5634\u5c71","53518"];b[b.length]=["\u5434\u5fe0","53612"];break;case "129":b[b.length]=["\u4e4c\u9c81\u6728\u9f50","51463"];b[b.length]=["\u963f\u52d2\u6cf0","51076"];b[b.length]=["\u963f\u514b\u82cf","51628"];b[b.length]=["\u660c\u5409","51368"];b[b.length]=["\u54c8\u5bc6","52203"];b[b.length]=["\u548c\u7530","51828"];b[b.length]=["\u5580\u4ec0","51709"];b[b.length]=["\u514b\u62c9\u739b\u4f9d","51243"];
b[b.length]=["\u77f3\u6cb3\u5b50","51356"];b[b.length]=["\u5854\u57ce","51133"];b[b.length]=["\u5e93\u5c14\u52d2","51656"];b[b.length]=["\u4f0a\u5b81","51431"];b[b.length]=["\u5410\u9c81\u756a","51573"];break;case "130":b[b.length]=["\u5357\u660c","58606"];b[b.length]=["\u4e95\u5188\u5c71","57894"];b[b.length]=["\u840d\u4e61","57786"];b[b.length]=["\u4e5d\u6c5f","58502"];b[b.length]=["\u4e0a\u9976","58637"];b[b.length]=["\u629a\u5dde","58617"];b[b.length]=["\u5409\u5b89","57799"];b[b.length]=["\u9e70\u6f6d",
"58627"];b[b.length]=["\u5b9c\u6625","57793"];b[b.length]=["\u5e90\u5c71","58506"];b[b.length]=["\u8d63\u5dde","57993"];b[b.length]=["\u90fd\u660c","58517"];b[b.length]=["\u65b0\u4f59","57796"];b[b.length]=["\u666f\u5fb7\u9547","58527"];break;case "131":b[b.length]=["\u6d77\u53e3","59758"];b[b.length]=["\u510b\u5dde","59845"];b[b.length]=["\u743c\u5c71","59757"];b[b.length]=["\u901a\u4ec0","59941"];b[b.length]=["\u6587\u660c","59856"];b[b.length]=["\u4e09\u4e9a","59948"];b[b.length]=["\u897f\u6c99",
"59981"];b[b.length]=["\u5357\u6c99\u5c9b","59997"];break;case "132":b[b.length]=["\u53f0\u5317","58968"];b[b.length]=["\u9ad8\u96c4","59554"];break;case "133":b[b.length]=["\u9999\u6e2f","45005"];break;case "134":b[b.length]=["\u6fb3\u95e8","45011"]}var c=$("selCity");c.options.length=1;b.each(function(a,b){var f=new Option(b[0],b[1]);c.options.add(f)})}};
function AddrList(a,b,c){var c=c||{},d=c.type||0;this.userLen=this.groupLen=12;var e=c.text||"";this.win=(this.srcWin=b)||window;this.doc=b.document;this.id=a;this.div=this.doc.getElementById(a);this.textId=e;this.objText=this.doc.getElementById(e);this.value=c.value||0;this.list=c.list||["EP","CS","PERSON"];this.type=d||"email";this.addrType=LMD.listIndex[d]||LMD.listIndex.email;this.setCall=c.setCall||"";this.loadCall=c.loadCall;this.setTemplate=c.setTemplate?c.setTemplate:"$NAME$ <$VALUE$>";this.addrGroup=
LMD.addrGroup;this.listObj=[];this.addrDataPower=LMD.addrDataPower;this.isIframe=c.isIframe||!1}
AddrList.prototype.init=function(a){var b=this;b.eventName=b.isIframe?"parent.AddrList.":"AddrList.";b.htmlData={};a&&(GE.addrList[b.id]="");if(GE.addrList[b.id])this.div.innerHTML=GE.addrList[b.id];else{if(this.div.innerHTML=="")b.div.innerHTML="<h1>{0}</h1>".format(parent.Lang.Mail.sys_LoadingData+Lang.Mail.sys_Waiting);LMD.isComplete?b.loadData():LMD.isLoad?window.setTimeout(function(){b.init()},200):LMD.loadData(function(a){b.loadData(a)})}};
AddrList.prototype.loadData=function(a){var b=(new Date).getTime(),c=LMD.listDataTree,d="";if(typeof this.srcWin=="object")try{if(LMD.isComplete&&LMD.listDataTree){d=this.getHtmlData(c);GE.addrList[this.id]=d;var e=(new Date).getTime();IsDebug&&(d="<h1>time1: {0} ms time2:{1} ms</h1>".format(e-b,a||0)+d);this.div.innerHTML=d}}catch(f){ch("AddrList.loadData",f)}};
AddrList.prototype.getHtmlData=function(a){for(var b=[],c=0,d=this.list,e=0;e<d.length;e++){var f=LMD.typeIndex[d[e]],g=a[f];g&&(b[c]='<h1 id="h1_{0}">{1}</h1><dl id="dl_{0}" class="wsWrapper">{2}</dl>'.format(f,this.addrGroup[f],this.getGroupHtml(g)),c++)}return b.join("")};
AddrList.prototype.getGroupHtml=function(a){var b=LMD.groupIndex,c=b.tid,d=b.id,e=b.name,b=b.items,f=[],g=[],h=LMD.typeIndex.RECENT,j=0,n=0,k=this.groupLen,q="{0}setValue('{1}','$VALUE$',window);".format(this.eventName,this.textId);if(this.setCall&&typeof this.setCall=="string")q=this.setCall;for(var t in a){var u=a[t],s=u[c],r=u[d],w=this.getListHtml(u[b]||[],s),x=u[e],u=x.lefts(k,!0),x=x.replace('"','"'),z="";s==h?z+='<dd id="dd_{0}_{1}" style="display:block;" eventAttr="{2}" addrType="{3}">'.format(s,
r,q,this.addrType):(z+='<dt id="dt_{0}_{1}" onclick="{5}showGroup(this,window,{0},\'{1}\');" title="{2}">{3}({4})</dt>'.format(s,r,x,u,w.length,this.eventName),z+='<dd id="dd_{0}_{1}" style="display:none;" eventAttr="{2}" addrType="{3}">'.format(s,r,q,this.addrType));z+=w.join("");z+="</dd>";r=="-1"?(g[j]=z,j++):(f[n]=z,n++)}f=f.concat(g);return f.join("")};
AddrList.prototype.getListHtml=function(a){var b=this.type,c=LMD.listIndex.name,d=[],e=a.length,f=this.userLen,g=0,h=this.addrType,j="{0}setValue('{1}','$VALUE$',window);".format(this.eventName,this.textId);if(this.setCall&&typeof this.setCall=="string")j=this.setCall;for(var n=0;n<e;n++){var k=a[n],q=k[c],t=k[c].lefts(f,!0),u=k[h];Vd.checkData(b,u)&&(k={name:q,value:u},q=(q+" <"+u+">").encodeHTML(),d[g]='<a href="javascript:{0};" title="{1}">{2}</a>'.format(AddrList.getReplaceValue(j,k),q,t),g++)}return d};
AddrList.prototype.fillGroupList=function(){"{0}setValue('{1}','{2}',window);".format(this.eventName,this.textId,m);this.setCall&&typeof this.setCall=="string"&&AddrList.getReplaceValue(this.setCall,ao)};AddrList.showGroup=function(a,b){var b=b||window,c=a.id.replace("dt","dd"),c=b.document.getElementById(c);c.style.display=="none"?(El.addClass(a,"on"),c.style.display="block"):(El.removeClass(a,"on"),c.style.display="none")};
AddrList.setValue=function(a,b,c){var d=c.document.getElementById(a);if(d&&b&&(a=c.document.getElementById(a).value,b=AddrList.getSetValue(a,b)))d.value=b,d.focus()};AddrList.getSetValue=function(a,b,c,d){var e="";if(b){var c=c||b,d=d||",",a=(a||"").replace(/[,;\uff0c\uff1b]+/gi,d),a=a.replace(/^[,;\uff0c\uff1b]|[,;\uff0c\uff1b]$|\s+/gi,""),f=a.lastIndexOf(d);b.inStr(a)||(e=f>0?a.lefts(f+1)+c+d:c+d)}return e};
AddrList.getReplaceValue=function(a,b){var c="";a&&b&&(c=a.replace("$NAME$",b.name||""),c=c.replace("$VALUE$",b.value||""),c=c.replace("$WORD$",b.word||""));return c};AddrList.replaceHtml=function(a){var b=a.cloneNode(!1);a.parentNode.replaceChild(b,a);return b};function MatchAddr(a){this.matchIsCase=a.matchIsCase||!1;this.matchIsStr=a.matchIsStr||!0;this.matchIsStart=a.matchIsStart||!1;this.template=this.regexp=null}
MatchAddr.prototype.init=function(a,b){try{return this.regexp=this.getRegExp(a),this.template=b,!0}catch(c){return!1}};MatchAddr.prototype.getRegExp=function(a){var b="i",c="",a=a||"";this.matchIsCase&&(b="");this.matchIsStr&&(a=a.replace(/([.\\[\]()\^$]|\\\\)/,"\\$1"));this.matchIsStart&&(c="^");c+=a+"";a=null;return RegExp(c,b)};MatchAddr.prototype.isMatch=function(a){var b=!1,c=this.regexp;c&&(b=c.test(a));return b};
MatchAddr.prototype.getMatch=function(a){var b="",b=this.template,c=this.regexp,a=a||{},d=["value","name","word","fullword"],a={word:a.word,value:a.value,name:a.name,fullword:a.fullword,isOk:!1};if(c&&typeof a=="object")for(var e=0;e<d.length;e++){var f=d[e],g=a[f],h=c.exec(g);if(h&&g){b=g.replace(h[0],b.replace("$KEY$",h[0]));a[f]=b;a.isOK=!0;break}}return a};
function AutoFill(a,b,c){c=c||{};this.loadCount=10;this.loadTime=0;this.id=(typeof a=="object"?a.id:a)||"";c.div=c.div||"";c.text=c.text||"";this.win=b||window;this.doc=this.win.document||document;this.objText=typeof a=="object"?a:this.doc.getElementById(a);this.text=c.text?typeof c.text=="object"?c.text:this.doc.getElementById(c.text):null;this.line=c.line||15;this.startNum=c.startNum||1;this.cacheKey=c.cacheKey||"email";this.matchIsCase=c.matchIsCase||!1;this.matchIsStr=c.matchIsStr||!0;this.matchIsStart=
c.matchIsStart||!1;this.hasName=c.hasName||!1;this.noHideDiv=c.noHideDiv||!1;this.autocomplete=!0;if(c.autocomplete==!1)this.autocomplete=!1;this.call=c.call||Util.emptyFunction;this.setCall=c.setCall;this.statsCall=c.statsCall;this.resultCall=c.resultCall;this.matchCall=c.matchCall;this.changeCall=c.changeCall;this.data=[];this.list=[];this.div=typeof c.div=="object"?c.div:this.doc.getElementById(c.div);this.index=-1;this.isOk=!0;this.isSearch=!!this.div;this.matchIndexs=[];this.matchValue=this.beforeMatchValue=
"";this.isAutoSize=c.isAutoSize||!1;this.showTemplate=c.showTemplate?c.showTemplate:"&quot;$NAME$&quot; &lt;$VALUE$&gt;";this.setTemplate=c.setTemplate?c.setTemplate:"$NAME$ &lt;$VALUE$&gt;";this.keyTemplate=c.keyTemplate?c.keyTemplate:"<strong>$KEY$</strong>";this.fixWidth=c.fixWidth||0;this.offsetFun=c.offsetFun||function(){return[0,0]};this.fromType=c.fromType||"default";if(this.isSearch)this.showTemplate='<span class="name">$VALUE$</span><span>$NAME$</span>',this.keyTemplate="<b>$KEY$</b>";this.single=
c.single;this.cancelSearch=!0}AutoFill.cache={};
AutoFill.prototype.init=function(a){function b(){var a=EV.getEvent()||c.win.event;EV.getCharCode(a)!=KEYCODES.ENTER&&c.showList(c)}var c=this;c.text=c.text||c.objText;c.dataType=a;a=null;a=c.data;if(LMD.isComplete&&typeof a=="object"){if(!c.isSearch){a=c.doc.getElementById("autoFill_Div_"+c.id);if(!a)a=El.createElement("div","autoFill_Div_"+c.id,"autoComplete",c.doc),c.doc.body.appendChild(a),a.className="autoComplete",a.oncontextmenu=function(){return!1},El.hide(a);c.div=a}c.objText.ondbclick=b;
c.autocomplete&&(EV.addEvent(c.objText,"keydown",function(){var a=EV.getEvent()||c.win.event;if(EV.getCharCode(a)==KEYCODES.ENTER)return c.setValue(c.index),parent.EV.stopEvent(a),!1}),EV.observe(c.objText,"keyup",b));c.objText.autocomplete="off";if(c.isAutoSize)c.ats=new AutoTextSize(c.objText,c.win,{max:3});if(typeof c.win.fGoto!="function")c.win.fGoto=Util.emptyFunction;c.noHideDiv||c.initHideEvent(c.doc);AutoFill.cache[c.cacheKey]||(AutoFill.cache[c.cacheKey]={})}};
AutoFill.prototype.showList=function(a){var b=this;if(a){var c=EV.getEvent()||this.win.event,d=EV.getCharCode(c);if(d=a.doKeyCode(d)){a.list.length=0;var c=b.autocomplete==!1?a.text:EV.getTarget(c),e=c.value,e=e.replace(/[\s]+/gi,""),f;a.dataType=="email"?(e=e.replace(",",";"),f=e.lastIndexOf(";")):(e=e.replace(";",","),f=e.lastIndexOf(","));var g=e.substr(f+1);if(a.single)g=c.value;g==""||",;".indexOf(g)>-1?(typeof a.statsCall=="function"?a.statsCall(0):El.hide(a.div),a.matchValue="",a.beforeMatchValue=
"",a.isOk=!1):a.isOk=g.length>=a.startNum?!0:!1}a.isOk=a.isOk&&d;if(a.isOk){typeof a.changeCall=="function"&&a.changeCall(g,a.beforeMatchValue);typeof a.statsCall=="function"&&a.statsCall(1);a.index=-1;var h=a.line,j="",n=a.doc.createElement("a");n.href="javascript:fGoto();";var k=a.data,q=function(c){c&&(k=c);var d=new MatchAddr({matchIsCase:a.matchIsCase,matchIsStr:a.matchIsStr,matchIsStart:a.matchIsStart});if(d.init(g,a.keyTemplate)){El.removeChildNodes(a.div);if(a.isSearch)c=El.createElement("div",
"autoFind_Div_"+a.id,"action",a.doc),c.innerHTML=Lang.Mail.addr_FindStr,a.div.appendChild(c);var e=0,f=[],q={};g.length>1&&g.substring(0,g.length-1);a.matchValue=g;f=f||[];f=f.unique();a.beforeMatchValue=a.matchValue;c=function(c){var f=k[c],c=f.value,h=f.name,g=b.text.value?b.text.value.replace(/\s/g,""):b.text.value;if(c.inStr(g)&&c!=g)return!1;g=d.getMatch(f);if(g.isOK&&!q[c]){q[c]=1;if(typeof a.matchCall=="function")a.matchCall(f);else{f=n.cloneNode(!0);f.id=a.isSearch?e+"_autoSearch":e+"_autoComplete";
j=a.getReplaceValue(a.showTemplate,g);f.innerHTML=j;f.onmouseover=function(){a.doMouseOver(this.id)};f.onmousedown=function(){a.doClick(this.id)};a.list[e]={name:h,value:c,node:f};if(e==0)f.className="hover";a.div.appendChild(f)}e++}};(new Date).getTime();if(f.length>=h||f.length==0)for(var f=0,x=k.length;f<x&&e<h;f++)c(f);(new Date).getTime();if(typeof a.resultCall=="function")a.resultCall(e,a.matchValue);else if(a.isSearch){if(a.doc.getElementById("autoFind_Div_"+a.id).innerHTML=Lang.Mail.addr_FindStr,
e==0)a.doc.getElementById("autoFind_Div_"+a.id).innerHTML=Lang.Mail.addr_FindNoLinkMan}else e>0?(a.div.style.width=b.fixWidth?b.fixWidth+"px":Math.max(El.width(a.objText)-2,0)+"px",f=c=0,typeof a.offsetFun=="function"&&(f=a.offsetFun(),c=f[0],f=f[1]),a.div.style.left=El.getX(a.objText)+c+"px",a.div.style.top=El.getY(a.objText)+El.height(a.objText)+f+"px",El.show(a.div)):(delete a.matchIndexs[a.matchValue],El.hide(a.div));a.doKeyCode(40)}};parent.gMain.synMode&&parent.gMain.synMode=="1"?(e=this.queryResult(e,
function(a){q(a)}),b.cancelSearch=setTimeout(e,500)):q()}}};AutoFill.prototype.initHideEvent=function(a){function b(){try{El.hide(c.div)}catch(a){}}var c=this,a=a||window.document;if(!c.win.isInitHideEvent)EV.observe(a||window.document,"click",b),c.win.isInitHideEvent=!0};
AutoFill.prototype.doKeyCode=function(a){function b(a){var b=c.list.length;a<0&&(a=b-1);a>=b&&(a=0);(b=c.list[c.index])&&El.removeClass(b.node,"hover");if(b=c.list[a])c.index=a,El.addClass(b.node,"hover")}var c=this;if(a==13||a>=37&&a<=40){switch(a){case 13:c.setValue(c.index);break;case 37:case 38:b(c.index-1);break;case 39:case 40:b(c.index+1)}return!1}else return!0};
AutoFill.prototype.doMouseOver=function(a){var a=(a||"").split("_")[0]||0,b=this.list[a];b&&El.addClass(b.node,"hover");if(a!=this.index)(b=this.list[this.index])&&El.removeClass(b.node,"hover"),this.index=a};AutoFill.prototype.doClick=function(a){var b=this,a=(a||"").split("_")[0]||0;b.setValue(a);setTimeout(function(){b.objText.focus()},0)};
AutoFill.prototype.getReplaceValue=function(a,b){var c="";a&&b&&(c=a.replace("$NAME$",b.name||""),c=c.replace("$VALUE$",b.value||""),c=c.replace("$WORD$",b.word||""));return c};
AutoFill.prototype.setValue=function(a){this.matchIndexs=[];var b;b=this.dataType=="email"?";":",";var a=Math.max(a,0),a=Math.min(a,this.list.length),c=this.list[a],a=this.text;if(c){var d=c.value,e=AddrList.getReplaceValue(this.setTemplate,c);if(this.setCall)this.setCall(d,e.decodeHTML());else{if(b=AddrList.getSetValue(a.value,c.value,e,b))a.value=b,a.focus();El.setCursorPos(this.objText)}this.noHideDiv||El.hide(this.div);this.isAutoSize&&this.ats.doSize();typeof this.call=="function"&&this.call(a)}else EV.preventDefault()};
AutoFill.datas=[];AutoFill.prototype.queryResult=function(a,b){var c=this;clearTimeout(this.cancelSearch);return function(){MM.mailRequest({func:"suite:mix_search",data:{total:c.line,content:a},call:function(c){for(var c=c["var"],e=[],f=0;f<c.length;f++)e.push({fullword:a,id:c[f].email,name:c[f].first_name,value:c[f].email,word:a});b(e)},failCall:function(){}})}};
var KEYCODES={A:65,C:67,X:88,V:86,UP:38,DOWN:40,ENTER:13,SPACE:32,TAB:9,LEFT:37,RIGHT:39,DELETE:46,BACKSPACE:8,SEMICOLON:jQuery.browser.mozilla||jQuery.browser.opera?59:186,COMMA:188,getKeyCode:function(a){return a.keyCode}};function initAppDomain(){var a=/(^|;)\s*maindomain=([^;]*)\s*(;|$)/.exec(document.cookie),b="";if(a!=null&&(b=decodeURIComponent(a[2]))&&b!=location.host)document.domain=b}initAppDomain();
(function(a){var b=a(window),c=a(document),d="CCalendar-"+ +new Date+"-",e=0,f=function(a,b){this.initialize.apply(this,arguments);e++};f.prototype={constructor:f,initialize:function(b,c){this.element=a(b);this.format=g.parseFormat(c.format||this.element.data("date-format")||"yyyy-mm-dd");this.isInput=this.element.is("input");var n=f.defcfg,k;for(k in n)c[k]===void 0&&(c[k]=n[k]);c.id=c.id||d+e;this.picker=a("<div/>",{id:c.id,"class":"ui-date"}).appendTo("body").bind({click:a.proxy(this.click,this)});
this.component=this.element.is(".date")?this.element.find(".add-on"):!1;this.create(c);this.isInput?this.element.bind({focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this)}):this.component?this.component.bind("click",a.proxy(this.show,this)):this.element.bind("click",a.proxy(this.show,this))},setOptions:function(a){this.options=a;this.options.startDate&&typeof this.options.startDate==="string"&&(this.options.startDate=g.parseDate(this.options.startDate,this.format));this.lang=g.lang[this.options.lang];
this.options.maxDate&&(this.options.maxDate=g.parseDate(this.options.maxDate,this.format));this.options.minDate&&(this.options.minDate=g.parseDate(this.options.minDate,this.format));this.date={year:this.options.startDate.getFullYear(),month:this.options.startDate.getMonth(),days:this.options.startDate.getDate()}},create:function(a){this.setOptions(a);this.fill(this.date)},click:function(b){b.stopPropagation();b.preventDefault();var c=this.options,b=a(b.target).closest("a")[0];if(!b)return!1;if(b.getAttribute("data-disabled")==
"true")return!1;var d=b.getAttribute("data-action");if(!d)return!1;switch(d){case "SELECT_YEAR":this.createYearModel(this.date.year,b);break;case "PREV-10-YEAR":case "NEXT-10-YEAR":this.createYearModel(parseInt(b.getAttribute("data-year")),null);break;case "SELECT_MONTH":this.createMonthModel(this.date.month,b);break;case "YEAR":this.fill({year:parseInt(b.getAttribute("data-year"))});break;case "MONTH":this.fill({month:parseInt(b.getAttribute("data-month")-1)});break;case "DAY":this.select(b);break;
case "TODAY":this.select(b);this.update();break;case "YEAR_LEFT":this.date.year-=c.showCount;this.fill(this.date);break;case "YEAR_RIGHT":this.date.year+=c.showCount;this.fill(this.date);break;case "MONTH_LEFT":this.date.month-=c.showCount;this.date.month<0&&(this.date.month+=12,this.date.year--);this.fill(this.date);break;case "MONTH_RIGHT":this.date.month+=c.showCount,this.date.month>11&&(this.date.month-=12,this.date.year++),this.fill(this.date)}},fill:function(b){var c=this.options,d,e=b.year||
this.date.year,b=b.month==void 0?this.date.month:b.month,f=new Date(g.today.year,g.today.month,g.today.date);this.date.year=e;this.date.month=b;var t=this.dom?this.dom.main:a("<div/>",{"class":"main"}).appendTo(this.picker);t.empty();for(var u=0;u<c.showCount;u++){var s=g.getDaysInMonth(e,b);d=g.getPNDate(e,b+1,-1);var r=g.getPNDate(e,b+1,1),w=(new Date(e,b,1)).getDay(),x,z=a("<div/>",{"class":"ui-date-list ui-month"+u+(c.showCount>1&&e==g.today.year&&b==g.today.month+1?" ui-month-cur":"")}),y=['<div class="ui-date-head ui-date-top">'];
u==0&&y.push('<a  data-action="YEAR_LEFT" class="ui-year-left" href="javascript:void(0)" title="'+this.lang.previousYear+'">&laquo;</a><a  data-action="MONTH_LEFT" class="ui-month-left" href="javascript:void(0)" title="'+this.lang.previousMonth+'">&lsaquo;</a>');y.push('<a  data-action="SELECT_YEAR"  class="ui-year" href="javascript:void(0)" title="'+this.lang.selectYear+'">'+e+'</a>\u5e74<a  data-action="SELECT_MONTH" class="ui-month" data-year="'+e+'" href="javascript:void(0)" data-dom="month" title="'+
this.lang.selectMonth+'" >'+((b+1<10?"0":"")+(b+1))+"</a>\u6708");u+1==c.showCount&&y.push('<a  data-action="MONTH_RIGHT"  class="ui-month-right" href="javascript:void(0)" title="'+this.lang.nextMonth+'">&rsaquo;</a><a  data-action="YEAR_RIGHT"  class="ui-year-right" href="javascript:void(0)" title="'+this.lang.nextYear+'">&raquo;</a>');y.push('</div><div class="ui-date-content clearfix"><div class="ui-date-week">');for(var v=0;v<7;v++)y.push('<span class="ui-week '+v+'">'+this.lang.week[v]+"</span>");
y.push('</div><div class="ui-date-days">');for(var G=w=w==0?6:w-1;w>=0;w--)x=d.day-w,y.push('<div class="'+(c.expired?"ui-days-old":"")+" ui-days-other d-"+x+'"><a data-old="'+(c.expired?"1":"0")+'" data-action="DAY"  href="javascript:void(0)" data-year="'+d.year+'" data-month="'+(d.month+1)+'" data-day="'+x+'">'+x+"</a></div>");for(v=1;v<=s;v++){d=!1;w=(new Date(e,b,v)).getDay();y.push('<div class="d-'+w);if(c.maxDate&&c.maxDate<=new Date(e,b,v)||c.minDate&&c.minDate>=new Date(e,b,v))d=!0,y.push(" ui-days-disabled");
c.expired&&new Date(e,b,v)<f&&y.push(" ui-days-old");g.today.year==e&&g.today.month==b&&g.today.date==v&&y.push(" ui-days-current");y.push('"><a  data-action="DAY"  href="javascript:void(0)" data-year="'+e+'" data-month="'+(b+1)+'" data-day="'+v+'" data-disabled="'+d+'" data-old="'+(new Date(e,b,v)<f?1:0)+'" >'+v+"</a></div>")}for(v=1;v<42-s-G;v++)y.push('<div class="ui-days-other">'),y.push('<a data-action="DAY"  href="javascript:void(0)" data-year="'+r.year+'" data-month="'+(r.month+1)+'" data-day="'+
v+'">'+v+"</a>"),y.push("</div>");y.push("</div></div>");z.html(y.join(""));t.append(z);++b==12&&(e++,b=0)}g.ie&&(this.picker.width(210*c.showCount),g.ie==6&&this.picker.append(a("<div />",{"class":"ui-date-mark"}).css({width:this.picker.innerWidth(),height:this.picker.innerHeight()}).html('<iframe frameborder="0" src="about:blank" scrolling="no"></iframe>')));this.dom={main:t}},createYearModel:function(b,c){var d=a(".ui-year-list",this.dom.main);if(d.length==0)d=a("<div/>",{"class":"ui-year-list"}),
this.dom.main.append(d),this.dom.year=d,this.dom.main.bind("mousedown",function(b){a(b.target).closest(".ui-year-list").length==0&&d.hide();return!1});if(c){var e=a(c).position();d.css({top:e.top+17,left:e.left-18.5}).show()}for(var e=[{value:b-10,label:"&laquo;",role:"PREV-10-YEAR"}],f=b-6;f<b+4;f++)e.push({value:f,label:f,role:"YEAR"});e[7]={value:b,label:b,role:"YEAR",current:!0};e.push({value:b+10,label:"&raquo;",role:"NEXT-10-YEAR"});for(var f=[],t=0,u=e.length;t<u;t++){var s=e[t];f.push('<a href="javascript:void(0)" data-action="'+
s.role+'" class="'+(s.value<g.today.year?" ui-date-old":"")+(s.value==g.today.year?" ui-date-current":"")+'" data-year="'+s.value+'">'+s.label+"</a>")}d.html(f.join(""))},createMonthModel:function(b,c){var d=a(".ui-month-list",this.dom.main);if(d.length==0)d=a("<div/>",{"class":"ui-month-list"}),this.dom.main.append(d),this.dom.month=d,this.dom.main.bind("mousedown",function(b){a(b.target).closest(".ui-month-list").length==0&&d.hide();return!1});if(c){var e=a(c).position();d.css({top:e.top+26,left:e.left-
11.5}).show()}for(var e=[],f=1;f<=12;f++)e.push({value:f,label:f,role:"MONTH"});for(var f=[],t=0,u=e.length;t<u;t++){var s=e[t];f.push('<a href="javascript:void(0)" data-action="'+s.role+'" class="'+(s.value<g.today.month+1?" ui-date-old":"")+(s.value==g.today.month+1?" ui-date-current":"")+'" data-month="'+s.value+'">'+s.label+"</a>")}d.html(f.join(""))},update:function(a){a=g.parseDate(typeof a==="string"?a:this.isInput?this.element.prop("value"):this.element.data("date"),this.format);this.fill({year:a.getFullYear(),
month:a.getMonth(),day:a.getDate()})},select:function(a){if(this.options.expired&&a.getAttribute("data-old")==1)return!1;var b=a.getAttribute("data-year"),c=b.substr(2),d=parseInt(a.getAttribute("data-month")),e=d<10?"0"+d:d,f=parseInt(a.getAttribute("data-day")),u=f<10?"0"+f:f,s=new Date(b,d-1,f),r=s.getTime(),a=g.formatDate(s,this.format),b={yyyy:b,yy:c,mm:e,m:d,dd:u,d:f,back:a,date:s,time:r};if(this.options.onSelect&&!this.options.onSelect.call(this,b))return null;this.isInput?this.element.prop("value",
a):(this.component&&this.element.find("input").prop("value",a),this.element.data("date",a));if(this.options.onSelectBack)return this.options.onSelectBack.call(this,b)&&this.hide(),!1},show:function(d){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.width=this.component?this.component.outerWidth():this.element.outerWidth();this.offset();b.bind("resize",a.proxy(this.offset,this));d&&(d.stopPropagation(),d.preventDefault());var e=this;c.unbind("mousedown").bind("mousedown",
function(b){a(b.target).closest(".ui-date").length==0&&e.hide()});this.element.trigger({type:"show",date:this.date})},offset:function(){var a=this.component?this.component.offset():this.element.offset(),c=a.top,a=a.left,d=b.width(),e=this.picker.width();this.picker.css({top:c+this.height,left:d<=e+a?a-e+this.width:a})},hide:function(){this.picker.hide();b.unbind("resize",this.offset);this.isInput||a(document).unbind("mousedown",this.hide);this.element.trigger({type:"hide",date:this.date})}};var g=
{ie:document.all&&navigator.userAgent.match(/\s{1}\d{1}/),lang:{cn:{week:"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(","),previousMonth:"\u4e0a\u4e00\u6708",nextMonth:"\u4e0b\u4e00\u6708",previousYear:"\u4e0a\u4e00\u5e74",nextYear:"\u4e0b\u4e00\u5e74",selectYear:"\u9009\u62e9\u5e74",selectMonth:"\u9009\u62e9\u6708",more:"\u66f4\u591a",today:"\u4eca"}},today:{year:(new Date).getUTCFullYear(),month:(new Date).getMonth(),date:(new Date).getDate()},isLeapYear:function(a){return a%4===0&&
a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,g.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},getPNDate:function(a,b,c){(b+=c||0)<1?(b=12,a--):b>12&&(b=1,a++);a=new Date(a,b,0);return{year:a.getFullYear(),month:a.getMonth(),day:a.getDate()}},parseFormat:function(a){var b=a.match(/[.\/\-\s].*?/),a=a.split(/\W+/);if(!b||!a||a.length===0)throw Error("Invalid date format.");return{separator:b,parts:a}},parseDate:function(a,b){var c=a.split(b.separator),a=new Date,d;a.setHours(0);
a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);if(c.length===b.parts.length){for(var e=a.getFullYear(),f=a.getDate(),g=a.getMonth(),s=0,r=b.parts.length;s<r;s++)switch(d=parseInt(c[s],10)||1,b.parts[s]){case "dd":case "d":f=d;a.setDate(d);break;case "mm":case "m":g=d-1;a.setMonth(d-1);break;case "yy":e=2E3+d;a.setFullYear(2E3+d);break;case "yyyy":e=d,a.setFullYear(d)}a=new Date(e,g,f,0,0,0)}return a},formatDate:function(a,b){var c={d:a.getDate(),m:a.getMonth()+1,yy:a.getFullYear().toString().substring(2),
yyyy:a.getFullYear()};c.dd=(c.d<10?"0":"")+c.d;c.mm=(c.m<10?"0":"")+c.m;for(var a=[],d=0,e=b.parts.length;d<e;d++)a.push(c[b.parts[d]]);return a.join(b.separator)}};f.defcfg={id:null,showCount:1,startDate:new Date,maxDate:!1,minDate:!1,expired:!1,lang:"cn",isShowTo:!1,onSelect:null,onSelectBack:null};window.CCalendar=f;a.fn.ccalendar=function(b){var c=Array.apply(null,arguments);c.shift();return this.each(function(){var d=a(this),e=d.data("CCalendar"),g=typeof b==="object"&&b;e||d.data("CCalendar",
e=new f(this,g));typeof b=="string"&&typeof e[b]=="function"&&e[b].apply(e,c)})};a.fn.ccalendar.Constructor=f})(jQuery);
function Tree(a,b){if(typeof a!="string"||a=="")throw Error("\u521b\u5efa\u7c7b\u5b9e\u4f8b\u7684\u65f6\u5019\u8bf7\u628a\u7c7b\u5b9e\u4f8b\u7684\u5f15\u7528\u53d8\u91cf\u540d\u4f20\u9012\u8fdb\u6765\uff01");this.url="#";this.target="_self";this.name=a;this.wordLine=!1;this.currentNode=null;this.useArrow=!0;this.nodes={};this.node={};this.names="";this._d="\u000f";this.index=0;this.divider="_";this.rootId="0";this.checkbox=b||!1;this.checkedNodes=[];this.className=this.wordLine?"CMailTreeWord":"CMailTree";
this.colors={highLight:"#F6F0D0",highLightText:"#333",mouseOverBgColor:"#333"};this.icons={L0:"L0.gif",L1:"L1.gif",L2:"L2.gif",L3:"L3.gif",L4:"L4.gif",PM0:"P0.gif",PM1:"P1.gif",PM2:"P2.gif",PM3:"P3.gif",empty:"L5.gif",root:"root.gif",folder:"folder.gif",file:"file.gif",exit:"exit.gif"};this.iconsExpand={PM0:"M0.gif",PM1:"M1.gif",PM2:"M2.gif",PM3:"M3.gif",folder:"folderopen.gif",exit:"exit.gif"};this.getElementById=function(a){if(typeof a!="string"||a=="")return null;if(document.getElementById)return document.getElementById(a);
if(document.all)return document.all(a);try{return eval(a)}catch(b){return null}};this.toString=function(){this.browserCheck();this.dataFormat();this.node[this.rootId]={id:this.rootId,parentId:this.rootId,path:this.rootId,isLoad:!1,childNodes:[],childAppend:"",sourceIndex:this.rootId};this.load(this.rootId);var a=this.node[this.rootId].childNodes,b="<A id='"+this.name+"_RootLink' href='#' style='DISPLAY: none'></A>";if(a.length>0){this.node[this.rootId].hasChild=!0;for(var e=0;e<a.length;e++)b+=this.nodeToHTML(a[e],
e==a.length-1);setTimeout(this.name+".atRootIsEmpty();"+this.name+".focusClientNode('"+a[0].id+"'); ",10)}this.useArrow&&(document.attachEvent?document.attachEvent("onkeydown",this.onkeydown):document.addEventListener&&document.addEventListener("keydown",this.onkeydown,!1));return"<DIV class='"+this.className+"' onclick='"+this.name+".clickHandle(event)' ondblclick='"+this.name+".dblClickHandle(event)'>"+b+"</DIV>"};this.onkeydown=function(b){b=window.event||b;switch(b.keyCode||b.which){case 37:eval(a).upperNode();
break;case 38:eval(a).pervNode();break;case 39:eval(a).lowerNode();break;case 40:eval(a).nextNode()}}}
Tree.prototype.browserCheck=function(){var a=window.navigator.userAgent.toLowerCase();if(/msie/i.test(a)){if(this.navigator=/opera/i.test(a)?"opera":"",!this.navigator)this.navigator="msie"}else if(/gecko/i.test(a))if(a=window.navigator.vendor.toLowerCase(),a=="firefox")this.navigator="firefox";else if(a=="netscape")this.navigator="netscape";else{if(a=="")this.navigator="mozilla"}else this.navigator="msie";if(window.opera)this.wordLine=!1};
Tree.prototype.atRootIsEmpty=function(){for(var a=this.node[this.rootId].childNodes,b=0;b<a.length;b++)if(a[b].isLoad||this.expand(a[b].id),a[b].text==""){var c=a[b].childNodes[0],d=c.hasChild;this.wordLine?(c=this.getElementById(this.name+"_tree_"+c.id),c=c.childNodes[0].childNodes[0].childNodes[0],c.innerHTML=a[b].childNodes.length>1?"\u250c":"\u2500"):(c.iconExpand=a[b].childNodes.length>1?d?"PM0":"L0":d?"PM3":"L3",this.getElementById(this.name+"_expand_"+c.id).src=this.icons[c.iconExpand].src)}};
Tree.prototype.dataFormat=function(){var a=[],b;for(b in this.nodes)a[a.length]=b;this.names=a.join(this._d+this._d);this.totalNode=a.length};Tree.prototype.load=function(a){var b=this.node[a],c=this.divider,d=this._d,e=b.sourceIndex.substr(b.sourceIndex.indexOf(c)+c.length),c=this.names.match(RegExp("(^|"+d+")"+e+c+"[^"+d+c+"]+("+d+"|$)","g")),e=this.node[a].childNodes;if(c)for(var d=RegExp(d,"g"),f=0;f<c.length;f++)e[e.length]=this.nodeInit(c[f].replace(d,""),a);b.isLoad=!0};
Tree.prototype.nodeInit=function(a,b){this.index++;var c=this.nodes[a],d=this.divider,e=this.getAttribute(c,"text"),f=this.getAttribute(c,"hint"),g=this.getAttribute(c,"data"),h=this.getAttribute(c,"type"),j=this.getAttribute(c,"id"),n=this.getAttribute(c,"checkName"),k="false",q=this.getAttribute(c,"checkValue"),k=this.node[b].checked?"true":this.getAttribute(c,"checked"),t=a.substr(a.indexOf(d)+d.length);this.node[this.index]={id:this.index,nodeId:j,text:e,hint:f?f:e,icon:this.getAttribute(c,"icon"),
path:this.node[b].path+d+this.index,isLoad:!1,isExpand:!1,parentId:b,parentNode:this.node[b],sourceIndex:a,childAppend:"",data:g||"",checked:k,checkName:n||"",checkValue:q||"",type:h||""};this.nodes[a]="index:"+this.index+";"+c;this.node[this.index].hasChild=this.names.indexOf(this._d+t+d)>-1;if(this.node[this.index].hasChild)this.node[this.index].childNodes=[];return this.node[this.index]};
Tree.prototype.getAttribute=function(a,b){if(RegExp("(^|;|\\s)"+b+"\\s*:\\s*([^;]*)(\\s|;|$)","i").test(a))return RegExp.$2.replace(/[\x0f]/g,";").replace(/\'/g,"&#39;")};
Tree.prototype.nodeToHTML=function(a,b,c){var d=this.nodes[a.sourceIndex],e=this.getAttribute(d,"target"),f=this.getAttribute(d,"data"),d=this.getAttribute(d,"url");if(!d)d=this.url;f&&(d+=(d.indexOf("?")==-1?"?":"&")+f);if(!e)e=this.target;var f=a.id,g=a.hasChild,h=a.parentId==this.rootId;if(h&&a.icon=="")a.icon="root";if(a.icon==""||typeof this.icons[a.icon]=="undefined")a.icon=g?"folder":"file";a.iconExpand=b?"\u2514":"\u251c";var j=a.text.encodeHTML(),n=j.indexOf(".")>0?j.substr(j.lastIndexOf(".")+
1):"",k=[];k[k.length]="<DIV noWrap='True'><NOBR>";if(!h)a.childAppend=a.parentNode.childAppend+(b?"\u3000":"\u2502"),this.wordLine?(k[k.length]="<SPAN>"+a.parentNode.childAppend+(b?"\u2514":"\u251c")+"</SPAN>",g&&(k[k.length]="<SPAN class='pm' id='"+this.name+"_expand_"+f+"'></SPAN>")):(a.iconExpand=g?b?"PM2":"PM1":b?"L2":"L1",k[k.length]="<SPAN>"+this.word2image(a.parentNode.childAppend),k[k.length]="<IMG align='absmiddle' id='"+this.name+"_expand_"+f+"' src='"+this.icons.empty.src+"' style='vertical-align:middle;cursor: "+
(!a.hasChild?"":this.navigator=="msie"||this.navigator=="opera"?"hand":"pointer")+"'></SPAN>");this.checkbox&&(k[k.length]="<input type='checkbox' name='"+a.checkName+"' value='"+a.checkValue+"' id='"+this.name+"_checbox_"+f+"' style='height:15px;' onclick=\""+this.name+".checkChild('"+f+"')\"",a.checked=="true"&&(k[k.length]=" checked='"+a.checked),k[k.length]=">");a.icon&&a.icon=="folder"&&(k[k.length]='<span  style="position:relative;top:5px;"><i class="filing-unfold"></i></span>');a.icon&&a.icon==
"file"&&(k[k.length]="<i class='"+this.getFileType(n)+'\' style="margin-bottom:-5px;"></i>');a.sourceIndex.substr(a.sourceIndex.indexOf(this.divider)+this.divider.length);k[k.length]="<A class='MzTreeview file_disk_text' hideFocus='1' id='"+this.name+"_link_"+f+"' href='"+d+"' target='"+e+"' ";k[k.length]=" title='"+a.hint+"' onfocus=\""+this.name+".focusLink('"+f+'\')" onclick="return '+this.name+".nodeClick('"+f+"')\">"+j+"</A></NOBR></DIV>";b=k.join("");h&&a.text==""&&(b="");return b="\r\n<SPAN id='"+
this.name+"_tree_"+f+"'>"+b+"<SPAN style='DISPLAY: "+(c?"block":"none")+"'></SPAN></SPAN>"};Tree.prototype.getFileType=function(a){for(var a=a.toLowerCase(),b="other",c="other,tif,txt,psd,rar,zip,xml,html,java,fon,jpg,gif,png,bmp,tiff,mpeg,avi,wmv,mov,mpg,vob,rmvb,mp3,wma,wav,asf,mp4,sis,sisx,cab,doc,docx,pdf,xls,xlsx,ppt,pptx,swf,fla,share,folder,mp3-hover,upload,i-hand,flv,folder-m,folder-p,exe,css,rm,midi,chm,iso,vsd,no-load".split(","),d=0;d<c.length;d++)if(a.indexOf(c[d])>=0){b=c[d];break}return b};
Tree.prototype.word2image=function(a){for(var b=[],c=0;c<a.length;c++){var d="";switch(a.charAt(c)){case "\u2502":d="L4";break;case "\u2514":d="L2";break;case "\u3000":d="empty";break;case "\u251c":d="L1";break;case "\u2500":d="L3";break;case "\u250c":d="L0"}d!=""&&(b[b.length]="<IMG align='absMiddle' src='"+this.icons.empty.src+"' height='20'>")}return b.join("")};
Tree.prototype.buildNode=function(a){var b=[];if(this.node[a].hasChild){for(var c=this.node[a].childNodes,b=[],d=0;d<c.length;d++)b[b.length]=this.nodeToHTML(c[d],d==c.length-1);a=this.getElementById(this.name+"_tree_"+a).childNodes;a[a.length-1].innerHTML=b.join("")}};
Tree.prototype.focusClientNode=function(a){if(!this.currentNode)this.currentNode=this.node[this.rootId];var b=this.getElementById(this.name+"_link_"+a);if(b){b.focus();var c=this.getElementById(this.name+"_link_"+this.currentNode.id);if(c)c.style.color="",c.style.backgroundColor="";b.style.color=this.colors.highLightText;b.style.backgroundColor=this.colors.highLight;this.currentNode=this.node[a]}};Tree.prototype.focusLink=function(a){this.currentNode&&this.currentNode.id==a||this.focusClientNode(a)};
Tree.prototype.expand=function(a,b){var c=this.node[a];if(!b||!c.isExpand){if(c.icon=="folder"){var d=this.getElementById(this.name+"_checbox_"+a);d&&(d=jQuery(d).next().find("i"))&&d.attr("class")&&(d.attr("class").trim()=="filing-unfold"?d.attr("class","folder"):d.attr("class","filing-unfold"))}if(c.hasChild&&((d=this.getElementById(this.name+"_tree_"+a))&&(d=d.childNodes[d.childNodes.length-1]),d)){c.isExpand=b||d.style.display=="none";var e=c.isExpand,f=this.icons[c.iconExpand],g=this.iconsExpand[c.iconExpand],
h=this.getElementById(this.name+"_expand_"+a);if(h)this.wordLine?h.innerHTML=!e?"+":"-":h.src=(!e?f.src:typeof g=="undefined"?f.src:g.src).replace("2.gif","1.gif");if(!e&&this.currentNode.path.indexOf(c.path)==0&&this.currentNode.id!=a)try{this.getElementById(this.name+"_link_"+a).click()}catch(j){this.focusClientNode(a)}d.style.display=!e?"none":"block";if(!c.isLoad&&(this.load(a),c.id!=this.rootId))c.hasChild&&c.childNodes.length>200?(setTimeout(this.name+".buildNode('"+a+"')",1),d=this.getElementById(this.name+
"_tree_"+a).childNodes,c="<DIV noWrap><NOBR><SPAN>"+(this.wordLine?c.childAppend+"\u2514":this.word2image(c.childAppend+"\u2514"))+"</SPAN>",c+="<IMG border='0' height='16' align='absmiddle' src='"+this.icons.file.src+"'>",c+="<A style='background-Color: "+this.colors.highLight+"; color: "+this.colors.highLightText+"; font-size: 9pt'>\u8bf7\u7a0d\u5019...</A></NOBR></DIV>",d[d.length-1].innerHTML=c):this.buildNode(a)}}};
Tree.prototype.nodeClick=function(a){a=this.nodes[this.node[a].sourceIndex];eval(this.getAttribute(a,"method"));return!(!this.getAttribute(a,"url")&&this.url=="#")};
Tree.prototype.getPath=function(a){Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1};var b=this._d,c=this.divider,d=[];for(d[0]=a;a!=this.rootId&&a!="";)if(RegExp("(^|"+b+")([^"+b+c+"]+"+c+a+")("+b+"|$)").test(this.names)){a=RegExp.$2.substring(0,RegExp.$2.indexOf(c));if(d.indexOf(a)>-1)break;d[d.length]=a}else break;return d.reverse()};
Tree.prototype.focus=function(a,b){if(b){var c=this.getPath(a);if(c[0]!=this.rootId)alert("\u8282\u70b9 "+a+" \u6ca1\u6709\u6b63\u786e\u7684\u6302\u9760\u6709\u6548\u6811\u8282\u70b9\u4e0a\uff01\r\n\u8282\u70b9 id \u5e8f\u5217 = "+c.join(this.divider));else for(var d=this.node[this.rootId],e=c.length,f=1;f<e;f++)if(d.hasChild)for(var g=c[f-1]+this.divider+c[f],h=0;h<d.childNodes.length;h++)if(d.childNodes[h].sourceIndex==g){d=d.childNodes[h];f<e-1?this.expand(d.id,!0):this.focusClientNode(d.id);break}}else setTimeout(this.name+
".focus('"+a+"', true)",100)};
Tree.prototype.clickHandle=function(a){a=window.event||a;a=a.srcElement||a.target;switch(a.tagName){case "IMG":a.id&&(a.id.indexOf(this.name+"_icon_")==0?this.focusClientNode(a.id.substr(a.id.lastIndexOf("_")+1)):a.id.indexOf(this.name+"_expand_")==0&&this.expand(a.id.substr(a.id.lastIndexOf("_")+1)));break;case "A":a.id&&this.focusClientNode(a.id.substr(a.id.lastIndexOf("_")+1));break;case "SPAN":a.className=="pm"&&this.expand(a.id.substr(a.id.lastIndexOf("_")+1));break;default:if(this.navigator==
"netscape")a=a.parentNode;a.tagName=="SPAN"&&a.className=="pm"&&this.expand(a.id.substr(a.id.lastIndexOf("_")+1))}};Tree.prototype.dblClickHandle=function(a){a=window.event||a;a=a.srcElement||a.target;if((a.tagName=="A"||a.tagName=="IMG")&&a.id)a=a.id.substr(a.id.lastIndexOf("_")+1),this.node[a].hasChild&&this.expand(a)};
Tree.prototype.upperNode=function(){this.currentNode&&(this.currentNode.id==this.rootId||this.currentNode.parentId==this.rootId||(this.currentNode.hasChild&&this.currentNode.isExpand?this.expand(this.currentNode.id,!1):this.focusClientNode(this.currentNode.parentId)))};
Tree.prototype.lowerNode=function(){if(!this.currentNode)this.currentNode=this.node[this.rootId];this.currentNode.hasChild&&(this.currentNode.isExpand?this.focusClientNode(this.currentNode.childNodes[0].id):this.expand(this.currentNode.id,!0))};
Tree.prototype.pervNode=function(){if(this.currentNode){var a=this.currentNode;if(a.id!=this.rootId)for(var b=this.node[a.parentId].childNodes,c=0;c<b.length;c++)if(b[c].id==a.id){if(c>0){for(a=b[c-1];a.hasChild;)this.expand(a.id,!0),a=a.childNodes[a.childNodes.length-1];this.focusClientNode(a.id)}else this.focusClientNode(a.parentId);break}}};
Tree.prototype.nextNode=function(){var a=this.currentNode;a||(a=this.node[this.rootId]);if(a.hasChild)this.expand(a.id,!0),this.focusClientNode(a.childNodes[0].id);else for(;typeof a.parentId!="undefined";)for(var b=this.node[a.parentId].childNodes,c=0;c<b.length;c++)if(b[c].id==a.id)if(c<b.length-1){this.focusClientNode(b[c+1].id);return}else a=this.node[a.parentId]};
Tree.prototype.expandAll=function(){if(this.node[this.rootId].childNodes.length!=0)for(var a=this.node[this.rootId].childNodes[0],b=!1,c=!1;a.id!=this.rootId;){var c=this.node[a.parentId].childNodes,d=c.length;if(c[d-1].id==a.id&&(b||!a.hasChild))a=this.node[a.parentId],b=!0;else if(a.hasChild&&!b){this.expand(a.id,!0);for(var c=!1,e=0;e<a.childNodes.length;e++)if(a.childNodes[e].hasChild){a=a.childNodes[e];c=!0;break}c||(b=!0)}else{b=!1;for(e=0;e<d;e++)if(c[e].id==a.id){a=c[e+1];break}}}};
Tree.prototype.setIconPath=function(a){var b=0,c=(new Date).getTime(),d;for(d in this.icons){var e=this.icons[d];this.icons[d]=new Image;this.icons[d].src=a+e;if(b==9&&(new Date).getTime()-c>20)this.wordLine=!0;b++}for(d in this.iconsExpand)e=this.iconsExpand[d],this.iconsExpand[d]=new Image,this.iconsExpand[d].src=a+e};Tree.prototype.setURL=function(a){this.url=a};Tree.prototype.setTarget=function(a){this.target=a};
Tree.prototype.checkChild=function(a){var b=this.getElementById(this.name+"_checbox_"+a);this.node[a].checked=b.checked;this.selChild(a);this.selParent(a)};Tree.prototype.selParent=function(a){a=this.node[a];if(a.parentId!=this.rootId){for(var a=a.parentNode,b=!0,c=0;c<a.childNodes.length;c++)if(!this.getElementById(this.name+"_checbox_"+a.childNodes[c].id).checked){b=!1;break}this.getElementById(this.name+"_checbox_"+a.id).checked=b;a.checked=b;this.selParent(a.id)}};
Tree.prototype.selChild=function(a){var b=this.node[a];if(b.hasChild)for(var c=0;c<b.childNodes.length;c++){var d=this.getElementById(this.name+"_checbox_"+this.node[a].childNodes[c].id);if(d)d.checked=b.checked,this.node[a].childNodes[c].checked=b.checked;this.selChild(this.node[a].childNodes[c].id)}};
Tree.prototype.getCheckedNodesRecursion=function(a,b){var c=a||this.node[this.rootId],b=b||"";if(c.hasChild)for(var d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];e.checked&&(b?b==e.checkValue&&(this.checkedNodes[this.checkedNodes.length]=e):this.checkedNodes[this.checkedNodes.length]=e);this.getCheckedNodesRecursion(e,b)}};Tree.prototype.getCheckedNodes=function(a,b){this.checkedNodes=[];this.getCheckedNodesRecursion(a,b);return this.checkedNodes};
(function(a,b){var c=a(b),d=a(document),e=function(a,b){this.initialize.apply(this,arguments)};e.prototype={constructor:e,initialize:function(b,c){this.element=a(b);this.colors=c.colors||gConst.labelColor;this.direction=c.direction||e.direction.Left;this.target=a(c.target);this.isInput=this.target.is("input");this.callback=c.callback||null;this._getDOM();this._bind()},_getDOM:function(){for(var b=[],c=0,d=this.colors.length;c<d;c++)b.push('<li data-index="'+c+'" data-rol="action"><a href="javascript:;"><i class="i-colorsquare '+
this.colors[c]+'"></i></a></li>');this.box=a("<div />",{"class":"menuPop shadow creatTagpop"}).css({position:"absolute",zIndex:"9000",height:"120px",display:"none",top:0,left:0}).html("<ul>"+b.join("")+"</ul>").appendTo("body")},_bind:function(){this.box.bind({click:a.proxy(this._click,this)});this.element.bind({click:a.proxy(this.show,this)})},_click:function(b){b=a(b.target).closest("li");b.data("rol")&&this.setValue(b.data("index"))},setValue:function(a){this.element.attr("data-val",a);this.target.length&&
this.target[this.isInput?"val":"html"](a);if(this.callback)if(this.callback.call(this,a,this.colors[a]))return!1;else this.hide();this.hide()},getValue:function(){return this.element.data("val")},show:function(){if(this.closed)return!1;this.height=this.element.outerHeight();this.width=this.element.outerWidth();this.box.show();this.offset();c.bind("resize",a.proxy(this.offset,this));var b=this;d.bind("mousedown",function(c){c=a(c.target);c.closest(b.box).length==0&&c.closest(b.element).length==0&&
b.hide()});this.closed=!0},hide:function(){this.box.hide();this.closed=!1;c.unbind("resize");d.unbind("mousedown")},offset:function(){var a=this.element.offset(),b=a.top,a=a.left,d=c.width(),e=c.height(),n=this.box.width(),k=this.box.height(),b={top:e<=k+b?b-(k+this.height-3):b+this.height};switch(this.direction){case "Left":b.left=a>=n?a-n-7+this.width:a;break;case "Right":b.left=d<=n+a?a-n+this.width:a}this.box.css(b)}};e.direction={Top:"Top",Right:"Right",Bottom:"Bottom",Left:"Left"};b.ColorBox=
e;a.fn.colorbox=function(b){var c=Array.apply(null,arguments);c.shift();return this.each(function(){var d=a(this),j=d.data("ColorBox"),n=typeof b==="object"&&b;j||d.data("ColorBox",j=new e(this,n));typeof b=="string"&&typeof j[b]=="function"&&j[b].apply(j,c)})};a.fn.colorbox.Constructor=e})(jQuery,window);function Contact(a,b){this.contact=a;this.addAsGroup=!1;this.config=b||{}}Contact.prototype.type=3;Contact.prototype.isFilter=!0;Contact.prototype.isShowValue=!1;
Contact.prototype.getSelectValue=null;Contact.prototype.isAsyn=!0;Contact.prototype.isShowTitle=!0;Contact.prototype.titleValue=3;Contact.prototype.groupMap=null;Contact.prototype.group_contactListMap=null;Contact.prototype.RecentContactsMap=null;Contact.prototype.filterList=null;Contact.prototype.filterList_hash=[];Contact.prototype.size=100;Contact.prototype.clearonclick=null;Contact.prototype.ogrList=[];Contact.prototype.deptList_temp='<li id=\'li_{1}_{0}\' style=\'overflow:hidden\' ><span style=\'{2};display:block;\'  class=\'fw_b departList_span\'  onclick="{6}(\'{0}\',{1},{3})" ><div ><a href="###" style="width:{7}px;" class="departList_a" title="{4}" ><i class="i-sadd mr_5" id="i_{1}_{0}"></i>{4}</a>{5}</div></span></li>';
Contact.prototype.showLinkMan=function(a,b){var c=this,d=setInterval(function(){if(parent.LMD.loadStatus==1){clearInterval(d);var e=LMD.groupMap;c.titleValue=c.type;var f=LMD.group_contactListMap_mail;this.group_contactListMap=f;this.groupMap=e;var g=[],h=LMD.addrGroup;g["2"]=h[2];g["0"]=parent.langconf?parent.langconf.crop_addr||"":h[0];g["5"]=h[5];h=[];h.push("<div class='deptList_div'>");for(var j="<li id='li_{3}_{0}'><span class='fw_b pl_27 departList_span'   onclick=\""+c.contact+'.{1}(\'{0}\',{3},1)"><div><a href="###" class="departList_a" title="{2}"><i class="i-sadd mr_5" id="i_{3}_{0}"></i>{2}</a>{4}</div></span></li>',
n=0;n<a.length;n++){h.push("<ul >");h.push('<li><a href="javascript:void(0)"  onclick="'+c.contact+"."+(a[n]=="0"?"showChildLinkMan_Asyn":"showChildLinkMan")+"('"+(a[n]=="2"?"-2":"0")+"',"+a[n]+')" class="fw_b pl_15 contactType_a" onmouseover="this.className=\'fw_b pl_15 contactType_a overColor\'" onmouseout="this.className=\'fw_b pl_15 contactType_a\'"><i id=\'i_'+a[n]+"_"+(a[n]=="2"?"-2":"0")+'\' class="i-hminus" ></i>'+g[a[n]]+"</a>");h.push("<ul  id='ul_"+a[n]+"_"+(a[n]=="2"?"-2":"0")+"'>");var k=
"";if(a[n]=="2"){if(k=f["2_-1"]&&f["2_-1"].length>0?c.addAsGroup?"<i  class='addgroup' title='\u6dfb\u52a0\u5168\u90e8' deptId='{0}' type='{1}'     style='margin-right: 5px;float: right;margin-top: -18px;display:none'></i>".format(-1,2):"":"",h.push(j.format("-1","showChildLinkMan",Lang.Mail.noGroupPerson,2,k)),e["2_0"])for(var q=0;q<e["2_0"].length;q++){var t=e["2_0"][q][1],k=f["2_"+t]&&f["2_"+t].length>0?c.addAsGroup?"<i  class='addgroup' title='\u6dfb\u52a0\u5168\u90e8' deptId='{0}' type='{1}'     style='margin-right: 5px;float: right;margin-top: -18px;display:none'></i>".format(t,
2):"":"";h.push(j.format(t,"showChildLinkMan",e["2_0"][q][2],2,k))}}else c.showChildLinkMan_Asyn(0,0,0,!0);h.push("</ul></li></ul>")}h.push("</div>");jQuery("#"+b).html(h.join(""));c.bindEvent();c.bindAddGroup()}},300)};Contact.prototype.inItContanct=function(a,b,c,d){var e=this;e.createBody(b,function(){parent.CC.showDiv(e.getHTML(),function(){var a=e.getSelectContact();c(a)},Lang.Mail.tab_addr,d,a,"565")})};
Contact.prototype.bindEvent=function(){var a=this;jQuery(".departList_span").live("mouseover",function(){jQuery(this).addClass("overColor");jQuery(this).find(".addgroup").show()});jQuery(".departList_span").live("mouseout",function(){jQuery(this).removeClass("overColor");jQuery(this).find(".addgroup").hide()});jQuery(".deptList_div").on("click",".nextPage",function(){a.go(this,null,null,null,a)})};
Contact.prototype.createBody=function(a,b,c){function d(a){for(var b=0;b<g.config.showList.length;b++)if(g.config.showList[b].email==a)return!0;return!1}for(var e=[],f=0;f<a.length;f++)a[f]=="0"?GC.check("CONTACTS_ENT")&&e.push("0"):a[f]=="2"&&GC.check("CONTACTS_PER")&&e.push("2");if(e.length==0)CC.alert("\u60a8\u6ca1\u6709\u6743\u9650\u4f7f\u7528\u8be5\u529f\u80fd");else{this.getSelectValue=c||this.addContact;var g=this;b&&b.call(this,null);a=this.filterList||[];if(a.length>0)for(b=0;b<a.length;b++)a[b]!=
""&&(this.filterList_hash[a[b]]="y");c=LMD.orgContactList_autoFile;if(this.config.showList){f=[];for(b=0;b<c.length;b++)d(c[b].id)&&f.push(c[b]);c=f}f=[];if(a.length>0)for(b=0;b<c.length;b++)c[b].type==0&&!this.filterList_hash[c[b].value]&&f.push(c[b]);else f=c;AutoFill.datas.email=f;this.loadseachList();setTimeout(function(){g.showLinkMan(e,"deptList")},200)}};
Contact.prototype.getHTML=function(a){var b=[];b.push('<div id="divDialogalert" >');b.push('<div class="dContent" style="text-align:left; border: 0px;">');b.push('<ul style="padding:10px 10px 10px '+(a?"0":"16")+"px;overflow:hidden;_zoom:1;height:"+(this.config&&this.config.maxCount?"410":"391")+'px">');b.push('<li style="width:'+(a?"213":"238")+'px;" class="fl">');b.push("<p style=\"color:#333;\" class='selectContact_title' >"+Lang.Mail.selectPerson+"</p>");b.push('<div class="j_search">');b.push('<input type="txt" value=\''+
Lang.Mail.addr_QuickSearchLink+'\' style="width: 160px;" class="j_search_txt fl" id="searchKey" name="searchKey" onclick='+this.contact+".seachkey_onclick(this) onblur="+this.contact+".seachkey_onblur(this);>");b.push('<input type="button"  style="width:27px;" class="j_search_btn fr" id="searchDelete">');b.push("</div>");b.push("<div class=\"branchListWrap\"   style='overflow-y: auto; height: 330px;min-height:330px;'>");b.push('<div class="li0 scrollStyle deptList-a" id="deptList" >');b.push(Lang.Mail.main_msg_loading);
b.push("</div>");b.push('<div id="divResult" style="display:none">');b.push('<ul class="searchContent" id="ulResult" style="width:auto;">');b.push('<li class="searchResult" style="height: 433px;" id="tab_search_div"></li>');var c="";this.config&&this.config.maxCount&&(c='<div class="tipsTxt" style="color: #fc0000;display:none;"  id="maxLimit">\u53ea\u9650\u4e8e\u9009\u62e9'+this.config.maxCount+"\u4e2a\u7528\u6237</div>");b.push("</ul></div></div>"+c+"</li>");a||(b.push('<li style="width:55px;padding-top:183px;height:240px;vertical-align:middle;text-align:center;" class="fl"><i class="i-contact-rfx" id="btnSel"></i></li>'),
b.push('<li style="width:238px;" class="fl">'),b.push('<p class="mb_5">'+Lang.Mail.select+'\uff08<span id="selCount">0</span>'+Lang.Mail.person+' <span  id="clearData" onclick='+this.contact+'.empty()><a href="javascript:;" class="clear-a">'+Lang.Mail.folder_Empty+"</a></span>\uff09</p>"),b.push('<div class="branchListWrap" style="margin-top:1px;height:358px;min-height:330px;">'),b.push('<div class="deptList" style="height:358px;">'),b.push('<ul  id="sel_contactList" name="sel_contactList">'),b.push("</ul></div></div></li>"));
b.push("</ul></div></div>");return b.join("")};
Contact.prototype.loadseachList=function(){var a=this,b={div:"tab_search_div",line:20,noHideDiv:!0,autocomplete:!0,text:"searchKey",statsCall:function(a){(a||0)==0?(jQuery("#deptList").attr("style","display:block"),jQuery("#tab_search_div").attr("style","display:none"),jQuery("#searchDelete").attr("class","j_search_btn fr")):(jQuery("#searchDelete").attr("class","j_search_btn fr searchDelete"),jQuery("#deptList").attr("style","display:none"),jQuery("#tab_search_div").attr("style","display:block"));
jQuery("#ulResult").show();jQuery("#divResult").show()},setCall:function(b,d){var e=d.substring(0,d.indexOf("<"));a.addContact(e,b,b)}};EV.observe($("searchDelete"),"click",function(){$("searchKey").value=Lang.Mail.addr_QuickSearchLink;$("searchKey").style.color="";b.statsCall(0)});EV.observe($("searchKey"),"click",function(){jQuery("#searchKey").css("color","black")});LMD.fillEmail("searchKey",window,b)};
Contact.prototype.showChildLinkMan=function(a,b,c){var d=this;clearTimeout(this.clearonclick);this.clearonclick=setTimeout(function(){function e(a){for(var b=0;b<d.config.showList.length;b++)if(d.config.showList[b].email==a)return!0;return!1}function f(c){d.isFilter?h[b+"_"+a][c][d.type]!=""&&h[b+"_"+a][c][0]==b&&j.push("<li style='overflow:hidden'><span class='contactList_span' onmouseover=\"this.className='overColor contactList_span'\" onmouseout=\"this.className='contactList_span'\"  style='display:block;"+
n+"' "+(d.isShowTitle?"title="+h[b+"_"+a][c][d.titleValue]:"")+" onclick="+d.contact+".getSelectValue('"+h[b+"_"+a][c][2].encodeHTML()+"','"+h[b+"_"+a][c][d.type]+"','"+h[b+"_"+a][c][1]+"')><a href='javascript:;' >"+h[b+"_"+a][c][2]+"</a></span></li>"):j.push("<li style='overflow:hidden'><span class='contactList_span' onmouseover=\"this.className='overColor contactList_span'\" onmouseout=\"this.className='contactList_span'\"  style='display:block;"+n+"' "+(d.isShowTitle?"title="+h[b+"_"+a][c][d.titleValue]:
"")+" onclick="+d.contact+".getSelectValue('"+h[b+"_"+a][c][2].encodeHTML()+"','0','"+h[b+"_"+a][c][1]+"')><a href='javascript:;' >"+h[b+"_"+a][c][2]+"</a></span></li>")}var g=jQuery("#i_"+b+"_"+a);if(g.hasClass("i-hminus")){if(g.removeClass("i-hminus").addClass("i-sadd"),jQuery("#ul_"+b+"_"+a).length>0){jQuery("#ul_"+b+"_"+a).hide();return}}else if(g.removeClass("i-hminus").removeClass("i-sadd").addClass("i-hminus"),jQuery("#ul_"+b+"_"+a).length>0){jQuery("#ul_"+b+"_"+a).show();return}var g=LMD.groupMap,
h=LMD.group_contactListMap_mail,j=[],n="padding-left:"+(27+c*16)+"px";if(g[b+"_"+a]&&b=="0")for(var k=0;k<g[b+"_"+a].length;k++){var q=g[b+"_"+a][k][1],t="";h[b+"_"+q]&&h[b+"_"+q].length>0&&(t=d.addAsGroup?"<i  class='addgroup' title='\u6dfb\u52a0\u5168\u90e8' deptId='"+q+"' type='"+b+"'     style='margin-right: 5px;float: right;margin-top: -18px;display:none'></i>":"");j.push(d.deptList_temp.format(q,b,n,c+1,g[b+"_"+a][k][2],t,d.contact+".showChildLinkMan","164"))}if(h[b+"_"+a])for(g=0;g<h[b+"_"+
a].length;g++)d.config.showList?e(h[b+"_"+a][g][3])&&f(g):f(g);g="";j.join("")!=""&&(g="<ul id='ul_"+b+"_"+a+"'>"+j.join("")+"</ul>");jQuery("#li_"+b+"_"+a).append(g)},300)};
Contact.prototype.showChildLinkMan_Asyn=function(a,b,c,d){clearTimeout(this.clearonclick);var e=this;this.clearonclick=setTimeout(function(){var f=b+"_"+a;if(!d)if(jQuery("#i_"+f).hasClass("i-sadd")){if(jQuery("#i_"+f).removeClass("i-sadd").addClass("i-hminus"),jQuery("#ul_"+f).length>0){jQuery("#ul_"+f).show();return}}else if(jQuery("#i_"+f).removeClass("i-hminus").addClass("i-sadd"),jQuery("#ul_"+f).length>0){jQuery("#ul_"+f).hide();return}for(var g=[],h="padding-left:"+(27+c*16)+"px",j=LMD.groupMap[b+
"_"+a]||[],n=0;n<j.length;n++){var k=j[n][1],q="<i  class='addgroup' title='\u6dfb\u52a0\u6574\u7ec4' deptId='"+k+"' type='0'  style='margin-right: 5px;float: right;margin-top: -18px;display:none'></i>";e.addAsGroup||(q="");g.push(e.deptList_temp.format(k,b,h,c+1,j[n][2],q,e.contact+".showChildLinkMan_Asyn","164"))}j="#ul_0_"+a;jQuery(j).length>0?jQuery(j).append(g.join("")):jQuery("#li_"+f).append("<ul id='ul_0_"+a+"'>"+g.join("")+"</ul>");e.go(null,a,0,h)},300)};
Contact.prototype.go=function(a,b,c,d,e){var f=this;e&&(f=e);e={total:100,recursive_flag:0,search_flag:1};d?(e.start=c*100+1,e.deptId=b):(c=parseInt(jQuery(a).attr("index")),b=jQuery(a).attr("id"),e.start=c*100+1,e.deptId=b,d=jQuery(a).attr("a_style"));c>0&&jQuery(a).parents("li:eq(0)").remove();var g=[];MM.mailRequest({func:"addr:searchUsers",data:e,call:function(a){function e(a){for(var b=0;b<f.config.showList.length;b++)if(f.config.showList[b].email==a)return!0;return!1}var n="0_"+b;if(a.code==
"S_OK"){var k=a["var"]||[],a=k.length==100;if(f.config.showList){for(var q=[],t=0;t<k.length;t++)e(k[t].email)&&q.push(k[t]);k=q}q="<li style='overflow:hidden'><span class='contactList_span' onmouseover=\"this.className='overColor contactList_span'\" onmouseout=\"this.className='contactList_span'\"  style='display:block;{0}' title='{1}' onclick="+f.contact+".getSelectValue('{2}','{1}','{3}')><a href='javascript:;' >{2}</a></span></li>";for(t=0;t<k.length;t++)g.push(q.format(d,k[t].email,k[t].firstName.encodeHTML(),
k[t].id));k="#ul_0_"+b;t="<li class='ta_c' style='overflow:hidden; padding-bottom:5px;'><a href='javascript:;' style='padding-right:0; color:#003be2;' id='"+b+"' index='"+(c+1)+"' a_style='"+d+"' class='nextPage' >\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a>>  </a></li>";jQuery(k).length>0?jQuery(k).append(g.join("")+(a?t:"")):jQuery("#li_"+n).append("<ul id='ul_0_"+b+"'>"+g.join("")+"</ul>"+(a?t:""))}}})};
Contact.prototype.addContact=function(a,b,c){var d=jQuery("a[name=selContact]");if(this.config&&this.config.maxCount&&d.length>=this.config.maxCount)jQuery("#maxLimit").show();else{for(var e=0;e<d.length;e++)if(d.eq(e).attr("id")==b)return;jQuery("#sel_contactList").append("<li  id='li"+c+'\' onmouseover="this.className=\'overColor\'" onmouseout="this.className=\'\'"><span class="pl_5 ml_10 selContact_span"><a href="javascript:void(0)" class="i-contact-close fr mt_3 mr_15" onclick='+this.contact+
".removeContact('"+c+"')></a><a class='selectedContact' id='"+b+"' "+(this.isFilter?"title='"+a+"&lt;"+b+"&gt;":"title='"+a+"'")+'\' name="selContact">'+a+(this.isShowValue?"&lt;"+b+"&gt;":"")+"</a></span></li>");jQuery("#selCount").html(d.length+1)}};
Contact.prototype.addOrgContact_Dept=function(a){a=this.group_contactListMap["0_"+a];if(!a){for(var b=0;b<a.length;b++){for(var c=a[b].id,d=a[b].email,e=a[b].userName,f=jQuery("a[name=selContact]"),g=0;g<f.length;g++)if(f.eq(g).attr("id")==d)return;jQuery("#sel_contactList").append("<li  id='li"+c+'\' onmouseover="this.className=\'overColor\'" onmouseout="this.className=\'\'"><span class="pl_5 ml_10 selContact_span"><a href="javascript:void(0)" class="i-contact-close fr mt_3 mr_15" onclick='+this.contact+
".removeContact('"+c+"')></a><a class='selectedContact' id='"+d+"' "+(this.isFilter?"title='"+e+"&lt;"+d+"&gt;":"title='"+e+"'")+'\' name="selContact">'+e+(this.isShowValue?"&lt;"+d+"&gt;":"")+"</a></span></li>")}jQuery("#selCount").html(f.length+a.length)}};Contact.prototype.getSelectContact=function(){var a=[];jQuery("a[name=selContact]").each(function(b,c){a.push({id:c.id,value:c.title,name:jQuery(c).text()})});return a};
Contact.prototype.addAllContact=function(a,b){function c(a){if(a)for(var b=0;b<a.length;b++)d.addContact(a[b][2],a[b][d.type],a[b][1])}clearTimeout(this.clearonclick);var d=this,e=LMD.group_contactListMap_mail;b=="2"?c(e[b+"_"+a]):b=="0"&&(e=LMD.deptObj[a])&&d.addContact(e[2],e[4],e[1])};Contact.prototype.removeContact=function(a){a=document.getElementById("li"+a);jQuery(a).remove();a=parseInt(jQuery("#selCount").html())-1;jQuery("#selCount").html(a.toString())};
Contact.prototype.empty=function(){jQuery("#sel_contactList").empty();jQuery("#selCount").html("0")};Contact.prototype.seachkey_onblur=function(a){var b=Lang.Mail.addr_QuickSearchLink;if(a.value.trim()=="")a.value=b,$("searchKey").style.color=""};Contact.prototype.seachkey_onclick=function(a){if(a.value==Lang.Mail.addr_QuickSearchLink)a.value="",$("searchKey").style.color="black"};
Contact.prototype.closeSeach=function(a){jQuery(a).attr("class")=="close_t"?(jQuery(a).attr("class","btn"),jQuery("#deptList").attr("style","display:block"),jQuery("#tab_search_div").attr("style","display:none"),jQuery("#ulResult").hide(),jQuery("#divResult").hide(),jQuery("#searchKey").val(Lang.Mail.addr_QuickSearchLink)):contact.seachDeptUser_asyn(jQuery("#searchKey").val())};
Contact.prototype.bindAddGroup=function(){var a=this;jQuery(".deptList_div").click(function(b){b=b.target;b.nodeName=="I"&&jQuery(b).attr("class")=="addgroup"&&a.addAllContact(b.getAttribute("deptId"),b.getAttribute("type"))})};Contact.prototype.Ajax=function(a,b,c,d){parent.MM.doService({url:a,func:b,data:c,failCall:function(a){parent.CC.alert(a.summary)},call:function(a){d(a)},param:""})};function ContexMenu(){this.init.apply(this,arguments)}
ContexMenu.prototype={init:function(a){this.currentMenuName=a.currentMenuName;this.parent=a.win||window;this.e=a.e;this.passFlag=a.passFlag||!1;this._getMenuObj();this._getSelectedId();this._changeInitCondition()},_getMenuObj:function(){var a=this,b=parent.El.createElement("div","","pop_wrapper w135");b.id="ContexMenuContainer";a.HasEnableClick={};for(var c=parent.El.createElement("ul","","module_pop"),d=a.currentMenuName,e={span_1:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",
id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u67e5\u770b\u672a\u8bfb"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u521b\u5efa\u5206\u62e3\u89c4\u5219"}],span_2:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"}],span_3:[{liClass:"",isLiEmpty:"false",
aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"},{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u67e5\u770b\u6295\u9012\u72b6\u6001"}],span_4:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"},
{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u6e05\u7a7a\u5df2\u5220\u9664"},{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u67e5\u770b\u5220\u4fe1\u72b6\u6001"}],span_5:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u6e05\u7a7a\u5783\u573e\u90ae\u4ef6"}],
span_6:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u6e05\u7a7a\u75c5\u6bd2\u90ae\u4ef6"}],span_12:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",
aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"}],span_13:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u6807\u8bb0\u4e3a\u5df2\u8bfb"}],span_14:[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",
aShowValue:"\u5168\u90e8\u5ba1\u6838\u901a\u8fc7"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u5168\u90e8\u5ba1\u6838\u4e0d\u901a\u8fc7"}],"span_-1":[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u5c55\u5f00\u5b50\u76ee\u5f55",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u65b0\u5efa\u90ae\u4ef6\u5939"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u90ae\u4ef6\u5939\u7ba1\u7406"}],
"span_-2":[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u5c55\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u65b0\u5efa\u6807\u7b7e"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u6807\u7b7e\u7ba1\u7406"}],"span_-3":[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u6253\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",
aShowValue:"\u65b0\u5efa\u90ae\u4ef6\u5939"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u521b\u5efa\u5206\u62e3\u89c4\u5219"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u90ae\u4ef6\u5939\u7ba1\u7406"}],"span_-4":[{liClass:"",isLiEmpty:"false",aClass:"",aHref:"",aShowValue:"\u5c55\u5f00",id:d+"_"},{liClass:"line",isLiEmpty:"true"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u65b0\u5efa\u6807\u7b7e"},{liClass:"",isLiEmpty:"false",
aClass:"notuse",aHref:"",aShowValue:"\u521b\u5efa\u5206\u62e3\u89c4\u5219"},{liClass:"",isLiEmpty:"false",aClass:"notuse",aHref:"",aShowValue:"\u6807\u7b7e\u7ba1\u7406"}]}[d],f=0;f<e.length;f++){var g=e[f];if(g){var h=parent.El.createElement("li","","");g.liClass!=""&&parent.El.addClass(h,g.liClass);if(g.isLiEmpty=="false"){var j=parent.El.createElement("a","",g.liClass);parent.El.setAttr(j,{innerHTML:g.aShowValue,id:d+"_"+f,href:"javascript:;"});h.appendChild(j)}c.onclick=function(b){a._doContexMenuClick(b)};
c.appendChild(h)}}b.appendChild(c);a.objDivContainer=b;CC.IsEnableContexMenu()&&parent.El.insertElement(document.body,b,"beforeEnd");parent.El.setStyle(a.objDivContainer,{left:"0px",top:"0px",opacity:"1"});a.menuHeight=parent.El.height(b);a.menuWidth=parent.El.width(b)},_getMenuPositionX:function(a){if(!a)return 0;var b=0,b=parent.El.docWidth(),a=a.clientX+document.body.scrollLeft-document.body.clientLeft;return b=a+this.menuWidth>b?a-this.menuWidth:a},_getMenuPositionY:function(a){if(!a)return 0;
var b=0,b=parent.El.docHeight(),a=a.clientY+document.body.scrollTop-document.body.clientTop;return b=a+this.menuHeight>b?a-this.menuHeight:a},show:function(a){parent.El.setStyle(this.objDivContainer,{left:""+this._getMenuPositionX(a)+"px",top:""+this._getMenuPositionY(a)+"px"})},hide:function(){parent.El.hide(this.objDivContainer)},_doContexMenuClick:function(a){parent.El.hide(this.objDivContainer);a=EV.getTarget(a,!1).getAttribute("id");if(!a)return!1;var b=GE.folderObj.inbox;if(a=="span_1_0")CC.goFolder("1",
b);else if(a=="span_1_2"&&this.HasEnableClick.span_1_2)CC.filterMail(1,[],{read:1},2,b);else if(a=="span_1_3"&&this.HasEnableClick.span_1_3)this.setAllMailRead("sys1");else if(a=="span_1_5")this.setMailConfig();else if(a=="span_2_0")CC.goFolder(2,"sys2");else if(a=="span_3_0")CC.goFolder("strip","sys3");else if(a=="span_3_2"&&this.HasEnableClick.span_3_2)this.setAllMailRead("sys3");else if(a=="span_3_3")CC.goLogLink("\u81ea\u52a9\u67e5\u8be2","send");else if(a=="span_4_0")CC.goFolder(4,"sys4");else if(a==
"span_4_2"&&this.HasEnableClick.span_4_2)this.setAllMailRead("sys4");else if(a=="span_4_3")MM.folderMain.opt("empty",4);else if(a=="span_4_4")CC.goLogLink("\u81ea\u52a9\u67e5\u8be2","del");else if(a=="span_12_0")CC.goFolder(12,"sys12");else if(a=="span_12_2"&&this.HasEnableClick.span_12_2)this.setAllMailRead("sys12");else if(a=="span_5_0")CC.goFolder(5,"sys5");else if(a=="span_5_2"&&this.HasEnableClick.span_5_2)this.setAllMailRead("sys5");else if(a=="span_5_3")MM.folderMain.opt("empty",5);else if(a==
"span_6_0")CC.goFolder(6,"sys6");else if(a=="span_6_2"&&this.HasEnableClick.span_6_2)this.setAllMailRead("sys6");else if(a=="span_6_3")MM.folderMain.opt("empty",6);else if(a=="span_13_0")CC.goFolder(13,"sys13");else if(a=="span_13_2"&&this.HasEnableClick.span_13_2)this.setAllMailRead("sys13");else if(a=="span_14_0")CC.goFolder(14,"sys14");else if(a!="span_14_2"&&a!="span_14_3")if(a=="span_-1_0"){var a=document.getElementById("leftFolderContainer_-1"),b=jQuery("#ulService").children("li[id='-1']")[0],
c=b.childNodes[0];LM.showOrHiddenMyLabel(a,c,b)}else a=="span_-1_2"?MM.folderMain.opt("addUser"):a=="span_-1_3"?CC.goFolderMain(function(){CC.isLabelMail()&&MM.folderMain.folderCallback(-1)}):a=="span_-2_0"?(a=document.getElementById("leftFolderContainer_-2"),b=jQuery("#ulService").children("li[id='-2']")[0],c=b.childNodes[0],LM.showOrHiddenMyLabel(a,c,b)):a=="span_-2_2"?MM.folderMain.opt("addLabel"):a=="span_-2_3"?CC.goFolderMain(function(){CC.isLabelMail()&&MM.folderMain.folderCallback(-2)}):a==
"span_-3_0"?this.passFlag&&gMain.lock_close?(a={},a.obj=jQuery("#"+LM.selectFolderId),a.p=this,a.id=id,folderlock.unlocked(0,"leftLock",a)):(a=this.selectedId,CC.goFolder(a,"user"+a)):a=="span_-3_2"?MM.folderMain.opt("addUser"):a=="span_-3_3"?this.setMailConfig():a=="span_-3_4"?CC.goFolderMain(function(){CC.isLabelMail()&&MM.folderMain.folderCallback(-1)}):a=="span_-4_0"?(a=this.selectedId,a=="9999999"?CC.receiveMail(!0):CC.goFolder(a,"label"+a)):a=="span_-4_2"?MM.folderMain.opt("addLabel"):a=="span_-4_3"?
this.setMailConfig("label"):a=="span_-4_4"&&CC.goFolderMain(function(){CC.isLabelMail()&&MM.folderMain.folderCallback(-2)})},setAllMailRead:function(a){a=MM[a];a.isAll=!0;a.mark("","read",0,"\u5df2\u8bfb");a.isAll=!1},_changeInitCondition:function(){var a=document.getElementById("leftFolderContainer_-2");if(a&&(a=a.style.display=="none",jQuery("#span_-2_0")[0]))jQuery("#span_-2_0")[0].innerHTML=a?"\u5c55\u5f00":"\u6298\u53e0";if(a=document.getElementById("leftFolderContainer_-1"))if(a=a.style.display==
"none",jQuery("#span_-1_0")[0])jQuery("#span_-1_0")[0].innerHTML=a?"\u5c55\u5f00\u5b50\u76ee\u5f55":"\u6298\u53e0\u5b50\u76ee\u5f55";if((a=document.getElementById("span_-4_0"))&&a)a.innerHTML="\u6253\u5f00";if(MM.folderMain.Folders[GE.folder.sys])this._getUnreadCount(1)>0?(jQuery("#span_1_2").removeClass("notuse"),jQuery("#span_1_3").removeClass("notuse"),this.HasEnableClick.span_1_2=!0,this.HasEnableClick.span_1_3=!0):(jQuery("#span_1_2").addClass("notuse"),jQuery("#span_1_3").addClass("notuse"),
this.HasEnableClick.span_1_2=!1,this.HasEnableClick.span_1_3=!1),this._getUnreadCount(3)>0?(jQuery("#span_3_2").removeClass("notuse"),this.HasEnableClick.span_3_2=!0):(jQuery("#span_3_2").addClass("notuse"),this.HasEnableClick.span_3_2=!1),this._getUnreadCount(4)>0?(jQuery("#span_4_2").removeClass("notuse"),this.HasEnableClick.span_4_2=!0):(jQuery("#span_4_2").addClass("notuse"),this.HasEnableClick.span_4_2=!1),GC.check("MAIL_INBOX_DELETE")||jQuery("#span_4_3").hide(),this._getUnreadCount(12)>0?(jQuery("#span_12_2").removeClass("notuse"),
this.HasEnableClick.span_12_2=!0):(jQuery("#span_12_2").addClass("notuse"),this.HasEnableClick.span_12_2=!1),this._getUnreadCount(5)>0?(jQuery("#span_5_2").removeClass("notuse"),this.HasEnableClick.span_5_2=!0):(jQuery("#span_5_2").addClass("notuse"),this.HasEnableClick.span_5_2=!1),this._getUnreadCount(6)>0?(jQuery("#span_6_2").removeClass("notuse"),this.HasEnableClick.span_6_2=!0):(jQuery("#span_6_2").addClass("notuse"),this.HasEnableClick.span_6_2=!1),this._getUnreadCount(13)>0?(jQuery("#span_13_2").removeClass("notuse"),
this.HasEnableClick.span_13_2=!0):(jQuery("#span_13_2").addClass("notuse"),this.HasEnableClick.span_13_2=!1),GC.check("MAIL_VAS_LOG")!="1"?(jQuery("#span_3_3").hide(),jQuery("#span_4_4").hide()):(jQuery("#span_3_3").show(),jQuery("#span_4_4").show()),GC.check("MAIL_VAS_LOG")=="1"&&this.selectedId=="9999999"?jQuery("#span_-4_3").hide():jQuery("#span_-4_3").show(),GC.check("MAIL_INBOX_DELETE")||jQuery("#span_5_3").hide(),GC.check("MAIL_MANAGER_FILTER")||(jQuery("#span_1_5").parent().hide(),jQuery("#span_1_5").parent().prev().hide(),
jQuery("#span_-3_3").parent().hide(),jQuery("#span_-4_3").parent().hide())},_getSelectedId:function(){try{var a=EV.getTarget(this.e,!1).getAttribute("id");a||(a=EV.getTarget(this.e,!1).parentNode.getAttribute("id"));if(a){var b=a.match(/span_(\d*)/);if(b.length>1)this.selectedId=b[1]}}catch(c){}},_getUnreadCount:function(a){var b=MM.folderMain.Folders[GE.folder.sys],c="-1";if(b)for(var d=0;d<b.length;d++){var e=b[d];if(e.fid==a){c=e.stats.unreadMessageCount;break}}return c},setMailConfig:function(a){var b=
LM.selectFolderId,c=MM.getFolderObject(b);CC.setConfig("filter",{name:c.name,folderId:b,callback:function(){if("label"==a){filter.showAdd();if($("option_check_dealType5"))$("option_check_dealType5").checked=!0,filter.attrs.dropLabel.setValue(c.fid);filter.attrs.dropLabel.setValue(c.fid)}else if(filter.showAdd(),$("option_check_dealType2"))$("option_check_dealType2").checked=!0}})}};
function DiskDialog(a){this.singDiskHtml='<li name={6} ><div  style="padding-left:{3}px;width:540px" class="tf"><a class="{7} mr_5" id="{4}" index={5} title="{2}" href="###"></a><input type="checkbox" style="{0}" class="mr_5" version="{8}"  id="{4}"    ><i class="{1} mr_5" ></i>{2}</div></li>';this.showType=a||0}
DiskDialog.prototype={create:function(a,b){var c=this;this.showType=b||0;var d='<div class="pop-wrap" style="padding:0;height:300px;overflow-y:auto">';d+='<div class="storage">';d+='<div id="disk_control_div" class="img_pop" style=" background:#fff; width:auto; padding:10px 0 0 0;">';d+=c._getheadHtml();d+=c.getDiskHtml();c.showType==1&&c.getTempDiskHtml();d+="</div>";d+=c._getNoFileHtml();d+="</div></div>";parent.CC.showDiv(d,function(){c.getSelectResult(a)},"\u9009\u62e9\u6587\u4ef6",null,"diskListContrOl",
"565");c.bindEvent()},_getheadHtml:function(){var a='<div class="img_tabTop"><ul style="height:28px;" class="ml_10 fl"><li id="tempDisk_li_up" type="disk" class="diskControlMenu r '+(this.showType==0?"current":"")+'">\u7f51\u76d8\u6587\u4ef6</li>';a+='<li id="tempDisk_li_list" type="tempDisk" class="diskControlMenu '+(this.showType==1?"current":"")+'">\u6587\u4ef6\u4e2d\u8f6c\u7ad9</li></ul></div>';return a},_getNoFileHtml:function(){var a=[];a.push('<div class="LoadTip" id="noFileHtml" style="padding-top: 10px;display:none">');
a.push(' <div id="temp_Storage_List" style="height:330px;overflow-y:auto;" class="storage-con list">');a.push('<div style="" id="temp_notData" class="rebackwrap"><p>\u6682\u65e0\u6587\u4ef6\uff0c\u4f60\u53ef\u4ee5\u4ece\u7535\u8111\u9009\u62e9\u6587\u4ef6\u6dfb\u52a0\u4e0a\u4f20</p><p class="pt_5"></p></div>');a.push("</div></div>");return a.join("")},getDiskHtml:function(){var a=[];a.push('<div style="display:'+(this.showType==1?"none":"block")+'" id="diskList_div">');a.push(' <div style="padding:15px 0;">');
a.push('<ul id="diskList" class="select-tx" style="border:0px">');a.push("</ul></div></div>");this.showType==0&&this.getChildNodeHtml(-2,0,"diskList");return a.join("")},bindEvent:function(){var a=this;jQuery(".diskControlMenu").click(function(){var b=jQuery(this).attr("type");jQuery(".diskControlMenu").removeClass("current");jQuery(this).addClass("current");b=="disk"?(jQuery("#diskList_div").show(),jQuery("#tempDisk_div_list").hide(),jQuery("#diskList").find("li").length==0?a.getChildNodeHtml(-2,
0,"diskList"):jQuery("#noFileHtml").hide()):(jQuery("#diskList_div").hide(),jQuery("#tempDisk_div_list").length>0&&jQuery("#tempDisk_div_list").html().length>0?(jQuery("#tempDisk_div_list").show(),jQuery("#noFileHtml").hide()):a.getTempDiskHtml())});jQuery("#diskList").click(function(b){var c=jQuery(b.target);if(b.target.nodeName=="A"){var b=c.attr("id"),d=jQuery("#diskList").find("[name='"+b+"']");c.hasClass("i-hminus")?(c.removeClass("i-hminus").addClass("i-sadd"),d.hide()):(d.length==0?a.getChildNodeHtml(b,
parseInt(c.attr("index")),c.parents("li:eq(0)")):d.show(),c.removeClass("i-sadd").addClass("i-hminus"))}})},getTempDiskHtml:function(){var a=this;this.queryTempDiskList(function(b){var b=b["var"].datalist,c=[];c.push('<div class="LoadTip" id="tempDisk_div_list" style="padding-top: 10px;">');b=b[0].files;if(b.length==0)jQuery("#noFileHtml").show();else{jQuery("#noFileHtml").hide();c.push('<table width="100%" id="temp_table_list" class="enclosure_table storage-table">');c.push("<thead><tr>");c.push('<th style="width:28px;padding-left:20px;" class="jnotice_border_r">');
c.push('<input type="checkbox" style="margin-left:8px;*margin-left:-1px" id="chkDisk_AllChecked"></th>');c.push('<th class="jnotice_border_r">');c.push('<a><em style="display: inline-block; width: 14px;"></em>\u6587\u4ef6\u540d</a></th>');c.push('<th style="width:70px" class="size"><a>\u5927\u5c0f</a></th>');c.push('<th style="width:136px;border-right:medium none;" class="time"><a>\u5269\u4f59\u65f6\u95f4</a>');c.push("</th></tr></thead>");c.push('<tbody id="tempDisk_data_list">');for(var d=0;d<b.length;d++)c.push("<tr>"),
c.push('<td width="28" style="padding-left:20px;"><input type="checkbox" style="margin:0 0 0 8px;_margin:0;" class="fl"  fileSize="'+b[d].size+'" shareTime="'+b[d].shareTime+'" fileName="'+b[d].fname+'" url="'+b[d].url+'" name="chkTempDisk" id="'+b[d].seqno+'"></td>'),c.push('<td class="tf"><i class="'+Util.getFileClasssName(b[d].fname)+'" onclick="" style="margin:0 4px 0 0;"></i><span  class="filename_css" title="'+b[d].fname+'">'+b[d].fname.encodeHTML()+"</span></td>"),c.push('<td width="70"><span class="pl_10">'+
Util.formatSize(b[d].size,null,2)+"</span></td>"),c.push('<td width="136"><span class="pl_10">'+a._getSurplusTime(b[d].shareTime)+"</span></td>"),c.push("</tr>");c.push("</tbody>");c.push("</table>");c.push("</div>");jQuery("#disk_control_div").append(c.join(""));jQuery("#chkDisk_AllChecked").click(function(){jQuery(this).is(":checked")?jQuery("#temp_table_list").find("input[name='chkTempDisk']").attr("checked","true"):jQuery("#temp_table_list").find("input[name='chkTempDisk']").removeAttr("checked")})}})},
_getSurplusTime:function(a){var b=new Date,c="",c=parent.Util.DateDiffMore(b,a,"d"),d=0;c>0?(d=parent.Util.DateDiffMore(parent.Util.DateAdd("d",c,b),a,"h"),c=c+"\u5929"+d+"\u5c0f\u65f6"):(d=parent.Util.DateDiffMore(b,a,"h"),d>0?c=d+"\u5c0f\u65f6":(a=parent.Util.DateDiffMore(b,a,"n"),c=a>0?a+"\u5206\u949f":"\u4e0d\u8db31\u5206\u949f"));return c},getChildNodeHtml:function(a,b,c){var d=[],e=this;this.queryDiskList({diskType:1,status:1,parentId:a},function(f){for(var f=f["var"].resultList,g=0;g<f.length;g++){var h=
"i-sadd";if(f[g].fileType==2||f[g].fileCount==0)h+=" v-hidden ";d.push(e.singDiskHtml.format(f[g].fileType==1?"display:none":"",f[g].fileType==1?"folder":Util.getFileClasssName(f[g].fileName),f[g].fileName,b==0?5:b*23,f[g].appFileId,b+1,a,h,f[g].version))}jQuery("#noFileHtml").hide();f.length==0&&b==0?(jQuery("#noFileHtml").show(),jQuery("#tempDisk_div_up").hide(),jQuery("#diskList_div").hide()):(typeof c=="string"?(c=jQuery("#"+c),c.append(d.join(""))):c.after(d.join("")),jQuery("#diskList_div").show(),
jQuery("#diskList").find("div").mouseover(function(){jQuery(this).addClass("on")}),jQuery("#diskList").find("div").mouseout(function(){jQuery(this).removeClass("on")}))})},getSelectResult:function(a){var b=[];jQuery("#temp_table_list").find("input[type='checkbox']").each(function(){var a=jQuery(this).attr("filename");if(a){var c=jQuery(this).attr("url"),f=jQuery(this).attr("sharetime"),g=jQuery(this).attr("filesize"),h=jQuery(this).attr("id");jQuery(this).is(":checked")&&b.push({name:a,size:g,url:c,
id:h,shareTime:f})}});var c=[];jQuery("#diskList").find("input[type='checkbox']").each(function(){var a=jQuery(this).attr("id"),b=jQuery(this).attr("version");jQuery(this).is(":checked")&&c.push({appFileId:a,fileVersion:b})});c.length>0?this.queryDiskLink({diskType:1,comeFrom:10,extCodeFlag:0,fileIdList:c},function(c){for(var c=c["var"].chailInfos,e=0;e<c.length;e++)b.push({name:c[e].fileName,size:c[e].fileSize,url:c[e].chainUrl,id:Math.ceil(Math.random()*1E7)});a(b)}):a(b)},queryDiskList:function(a,
b){MM.doService({url:gMain.urlCloudp+"/service/disk/search.do",func:"disk:search",isNotAddUrl:!0,data:a,call:b})},queryTempDiskList:function(a){MM.doService({url:gMain.webPath+"/service/disk//userdisk.do",func:"disk:listFileByEml",isNotAddUrl:!0,data:{diskType:3,isSubFile:1,isSubDir:1,orderField:"share_time"},call:a})},queryDiskLink:function(a,b){MM.doService({url:gMain.urlCloudp+"/service/share/fileshare.do",func:"share:addChain",isNotAddUrl:!0,data:a,call:b})}};
function DropSelect(a){var a=a||{},b=this;this.id=a.id||"selectDrop";this.data=a.data||[];this.type=a.type||"";this.selectedValue=a.selectedValue||"";this.width=a.width||0;this.height=a.height||0;this.widthStr=a.width?"width:"+a.width+"px;":"";this.heightStr=a.height?"height:"+a.height+"px;":"";this.idList={div:"drop_Div_"+this.id,text:"drop_Text_"+this.id,ul:"drop_UL_"+this.id,drop:"drop_"+this.id,dropSelect:"drop_select_"+this.id};this.folderList=a.folderList||[];this.itemClick=a.itemClick||"";
a=typeof EV=="undefined"?parent.EV:EV;a.observe(window.document,"click",function(){b.isShow&&b.hideItem();b.isShow=!0});b.curSelectIndex=0;a.observe(window.document,"keyup",function(a){if(b.DropSelectObj&&b.DropSelectObj.find("#"+b.idList.drop).attr("class")!="menuPop shadow wherewjPop hide")if(a.keyCode==40){jQuery(b.liList[b.curSelectIndex]).removeClass("on");if(b.curSelectIndex==b.liList.length-1)b.curSelectIndex=-1;b.curSelectIndex++;if(a=b.liList[b.curSelectIndex]){jQuery(a).addClass("on");var d=
jQuery(a).children().children(),a=d.attr("val"),e=d.attr("text").split("|"),d=d.attr("level");b.setShowItem((e[1]?'<i class="i-colorsquare mr_5 '+e[1]+'"></i>':"")+e[0],a,d)}}else if(a.keyCode==38){jQuery(b.liList[b.curSelectIndex]).removeClass("on");if(b.curSelectIndex==0)b.curSelectIndex=b.liList.length;b.curSelectIndex--;if(a=b.liList[b.curSelectIndex])jQuery(a).addClass("on"),d=jQuery(a).children().children(),a=d.attr("val"),e=d.attr("text").split("|"),d=d.attr("level"),b.setShowItem((e[1]?'<i class="i-colorsquare mr_5 '+
e[1]+'"></i>':"")+e[0],a,d)}else a.keyCode==13&&b.hideItem()})}
DropSelect.prototype.loadLiSelected=function(){var a=this,b=0;a.liList=a.DropSelectObj.find("#"+a.idList.ul).find("li[id]");a.liList.each(function(){var c=jQuery(this).children().children(),d=c.attr("val"),e=c.attr("text").split("|"),c=c.attr("level");if(a.selectedValue==d)jQuery(this).addClass("on"),a.setShowItem((e[1]?'<i class="i-colorsquare mr_5 '+e[1]+'"></i>':"")+e[0],d,c),a.curSelectIndex=b;jQuery(this).attr("index",b);b++;this.onmouseover=function(){jQuery(a.liList[a.curSelectIndex]).removeClass("on");
jQuery(this).addClass("on");a.curSelectIndex=jQuery(this).attr("index").toInt()}});if(a.curSelectIndex==0){var c=a.liList[0],d=jQuery(c).children().children();if(d.length){var e=d.attr("val"),f=d.attr("text").split("|"),d=d.attr("level");a.setShowItem((f[1]?'<i class="i-colorsquare mr_5 '+f[1]+'"></i>':"")+f[0],e,d);jQuery(c).addClass("on")}}};
DropSelect.prototype.loadEvent=function(a){var b=this,a=document.getElementById(b.idList.dropSelect)||a,c=jQuery(a),a=c.find("#"+b.idList.div);b.DropSelectObj=c;var d=b.idList.drop,e=b.idList.text,f=b.idList.ul,g=b.itemClick;b.isShow=!1;a.click(function(){b.isShow=!1;var a=c.find("#"+d).attr("class");b.data.length&&(a=="menuPop shadow wherewjPop"?b.hideItem():(b.showItem(),b.setHeight()))});a=c.find("#"+f).children();for(f=0;f<a.length;f++)a[f].onclick=function(){b.isShow=!1;var a=jQuery(this).children().children(),
d=c.find("#"+e),f=jQuery(a).attr("text").split("|"),k=jQuery(a).attr("val");(a=jQuery(a).attr("level"))&&d.attr("level",a);d.html((f[1]?'<i class="i-colorsquare mr_5 '+f[1]+'"></i>':"")+f[0].encodeHTML());d.attr("val",k);b.hideItem();typeof g=="function"&&g(k,f[0],this)};b.loadLiSelected()};DropSelect.prototype.hideItem=function(){var a=this.idList.drop;this.DropSelectObj&&this.DropSelectObj.find("#"+a).attr("class","menuPop shadow wherewjPop hide")};
DropSelect.prototype.showItem=function(){var a=this.idList.drop;this.DropSelectObj&&this.DropSelectObj.find("#"+a).attr("class","menuPop shadow wherewjPop")};DropSelect.prototype.setShowItem=function(a,b,c){this.DropSelectObj.find("#"+this.idList.text).html(a);this.DropSelectObj.find("#"+this.idList.text).attr("val",b);c&&this.DropSelectObj.find("#"+this.idList.text).attr("level",c)};DropSelect.prototype.getValue=function(){return this.DropSelectObj.find("#"+this.idList.text).attr("val")};
DropSelect.prototype.getAttrValue=function(a){return this.DropSelectObj.find("#"+this.idList.text).attr(a)||""};
DropSelect.prototype.setValue=function(a){if(this.type=="fileTree"){var b=MM.getFolderObject(a),c="";if(b)c=(b.type==5?'<i class="i-colorsquare mr_5 '+gConst.labelColor[b.folderColor]+'"></i>':"")+b.name;else if(this.folderList)for(b=0;b<this.folderList.length;b++){var d=this.folderList[b];if(d.value==a){c=d.text;break}}this.DropSelectObj.find("#"+this.idList.text).html(c);this.DropSelectObj.find("#"+this.idList.text).attr("val",a)}else for(b=0;b<this.data.length;b++)d=this.data[b],d.value==a&&(this.DropSelectObj.find("#"+
this.idList.text).html(d.text),this.DropSelectObj.find("#"+this.idList.text).attr("val",d.value))};DropSelect.prototype.setWidth=function(a){this.DropSelectObj.find("#"+this.idList.drop).width(a);this.DropSelectObj.width(a)};DropSelect.prototype.setHeight=function(a){a=a||this.height;if(a>0){var b=this.DropSelectObj.find("#"+this.idList.drop);b.height()>a&&b.height(a)}};
DropSelect.prototype.getHTML=function(){var a=[],b='<li style="padding:0" id="li_{0}_{1}" name="{0}"><a id="drop_{0}_{1}" href="javascript:void(0);">';b+='<span  val="{1}" text="{2}" {3}> {2} </span></a></li>';a.push('<span class="dropDown" style="{0}" id="{1}">'.format(this.widthStr,this.idList.dropSelect));a.push('<span id="{0}">'.format(this.idList.div));a.push('<span class="dropDownA" href="javascript:void(0);">');a.push('<i class="i_triangle_d"></i>');a.push("</span>");a.push('<span id="'+this.idList.text+
'"  class="dropDownText"></span>');a.push("</span>");a.push('<div class="menuPop shadow wherewjPop hide" id="{0}" style="{1}overflow:auto;">'.format(this.idList.drop,this.widthStr));a.push('<ul id="{0}">'.format(this.idList.ul));if(this.type=="fileTree"){var c=this.data,d=this.id,e=this.folderList,f=function(b,c,e,g){var h=null,u="",s="",s="",r=!1,w="",x="",z=[],y=!1,g=g||0;g++;for(var v=0;v<b.length;v++)h=b[v],w=h.fid||h.folderId,x=h.name.encodeHTML()||h.folderName,u=c||"",z=h.nodes||h.childFolderList,
r=v==b.length-1,s=!e||e==0?"":r?"\u2514 ":"\u251c ",h.type==5&&(u='<i class="i-colorsquare mr_5 '+gConst.labelColor[h.folderColor]+'"></i>',y=!0),s=u+s+x.encodeHTML(),a.push('<li id="li_{0}_{1}" name="{0}"><a href="javascript:void(0);" id="drop_{0}_{1}">'.format(d,w)),a.push('<span class="text" val="{1}" text="{2}{5}" level="{4}">{3}</span></a>'.format(d,w,x,s,g,y?"|"+gConst.labelColor[h.folderColor]:"")),a.push("</li>"),z&&z.length>0&&(u+=r||e==0?"&nbsp;":"\u2502 ",f(z,u,w,g))};if(e)for(var g=0;g<
e.length;g++){var h=e[g];if(typeof h.position=="undefined"||h.position=="top")a.push(b.format(d,h.value,h.text.encodeHTML(),h.attr||"")),h.addDownHTML&&(h.addDownHTML=="line"?a.push('<li class="line"></li>'):a.push(h.addDownHTML))}f(c);if(e)for(g=0;g<e.length;g++)h=e[g],h.position=="down"&&(a.push(b.format(d,h.value,h.text.encodeHTML(),h.attr||"")),h.addDownHTML&&(h.addDownHTML=="line"?a.push('<li class="line"></li>'):a.push(h.addDownHTML)))}else for(g=0;g<this.data.length;g++)h=this.data[g],a.push(b.format(this.id,
h.value,String(h.text).encodeHTML(),h.attr||"")),h.addDownHTML&&(h.addDownHTML=="line"?a.push('<li class="line"></li>'):a.push(h.addDownHTML));a.push("</ul>");a.push("</div>");a.push("</span>");return a.join("")};function FileSelect(a){a=a||{};this.id=a.id||"selectDiskFilesTree";this.data=a.data||{};this.url="/disk/userdisk.do";this.iconPath=(a.iconPath||gMain.resourceRoot)+"/images/tree/";this.isOk=this.isload=!1}
FileSelect.prototype.loadData=function(){MM.doService({url:this.url,func:"disk:listFileByEml",call:function(a){a=a["var"];FS.isOk=a.retcode;FS.data=a.datalist;FS.update()},failCall:function(){FS.isOk=!1;FS.data=null;FS.update()},data:{diskType:0,isSubDir:1,isSubFile:1}})};
FileSelect.prototype.show=function(a){this.type=this.type||1;this.prj=this.prj;this.folder=a.folder||!1;this.callback=a.callback;this.checkbox=a.checkbox||!1;this.len=a.len||30;window.FSTree=new Tree("FSTree",this.checkbox);this.tree=window.FSTree;this.tree.setIconPath(this.iconPath);this.width=400;this.loadData();a=[];a[a.length]='<div class="pageConectDialog" id="DiskFilesTreeDiv">';a[a.length]='<div id="'+this.id+'_div" class="FileSelectTree"></div>';a[a.length]='<div class="boxIframeBtn"><div class="topborder">';
a[a.length]='<a class="n_btn_on mt_8" href="javascript:fGoto();"  onclick="FS.ok();return false;"><span><span>'+Lang.Mail.Ok+"</span></span></a>";a[a.length]='<a class="n_btn mt_8" href="javascript:fGoto();"  onclick="FS.hide();return false;"><span><span>'+Lang.Mail.Close+"</span></span></a>";a[a.length]="</div></div></div>";a={id:this.id,title:Lang.Mail.disk_Select,text:a.join(""),width:this.width,zindex:1100,buttons:[]};CC.msgBox(a)};
FileSelect.prototype.update=function(){this.isOk?(this.makeTree(),$(this.id+"_div").innerHTML=this.tree.toString(),this.tree.expandAll()):$(this.id+"_div").innerHTML=Lang.Mail.disk_LoadDataFail};FileSelect.prototype.hide=function(){CC.closeMsgBox(this.id)};FileSelect.prototype.ok=function(){var a=null,a=this.checkbox?this.folder?this.getCheckedValue("0"):this.getCheckedValue("1"):this.getSelect();this.hide();this.callback&&this.callback(a)};
FileSelect.prototype.makeTree=function(){var a=this.data;if(a)for(var b=0;b<a.length;b++){var c=a[b];this.makeNode({id:c.dirid,pid:0,text:c.dirname,type:0,data:"type=0&size=&url=&id="+c.dirid});var d=c.files;this.makeFoldersNodes(c.subdir,c.dirid);this.folder||this.makeFilesNodes(d,c.dirid)}};
FileSelect.prototype.makeFoldersNodes=function(a,b){var c=0;if(a&&a.length>0)for(c=0;c<a.length;c++){var d=a[c].subdir,e=a[c].files,f=a[c].dirid;this.makeNode({id:f,text:a[c].dirname,data:"type=0&size=&url=&id="+f,pid:b,type:0});this.makeFoldersNodes(d,f);this.folder||this.makeFilesNodes(e,f)}};
FileSelect.prototype.makeFilesNodes=function(a,b){var c=0;if(a&&a.length>0)for(c=0;c<a.length;c++){var d=a[c],e=d.seqno,f=encodeURIComponent(d.url);this.makeNode({pid:b,id:e,text:d.fname,data:"id="+e+"&type=1&url="+f+"&size="+d.size,type:1})}};
FileSelect.prototype.makeNode=function(a){var b=a.text.decodeHTML(),c=Util.getFileShortName(b,this.len),b="id:{0};text:{1};hint:{2};data:{3}".format(a.id,c,b,a.data);this.checkbox&&(b+=";checkValue:"+a.type);b+=a.type==1?";icon:file":";icon:folder";this.tree.nodes[a.pid+"_"+a.id]=b};
FileSelect.prototype.getCheckedValue=function(a){var b=[];this.tree.getCheckedNodes(null,a);if(a=this.tree.checkedNodes)for(var c=0;c<a.length;c++){var d=a[c],e=GC.getUrlParamValue(d.data,"size"),f=GC.getUrlParamValue(d.data,"url"),g=GC.getUrlParamValue(d.data,"id"),f=decodeURIComponent(f);b[b.length]={id:g,name:d.hint,size:e,url:f}}return b};
FileSelect.prototype.getSelect=function(){var a=[],b=this.tree.currentNode;if(b)var a=GC.getUrlParamValue(b.data,"size"),c=GC.getUrlParamValue(b.data,"url"),d=GC.getUrlParamValue(b.data,"id"),c=decodeURIComponent(c),a=[{id:d,name:b.hint,size:a,url:c}];return a};function imageCode(){this.setAttribute.apply(this,arguments)}imageCode.guid=+(new Date).getTime();
imageCode.prototype={options:{imgWidth:170,imgHeight:53,layoutType:"topbottom",inputWidth:50,serverURL:"http://imgcode.kf139.com:10080/getimage",txtVerifyCodeID:"",focusShow:!1,placeHold:"",clientID:1,containerID:""},setAttribute:function(a){var b={},c=this,d;for(d in this.options)b[d]=this.options[d];for(d in a)b[d]=a[d];this.options=b;var e=document.getElementById(b.txtVerifyCodeID);if(e===null){e=document.createElement("input");e.type="text";var f=document.getElementById(b.containerID);if(f===
null)return;else f.appendChild(e)}this.input=e;e.setAttribute("maxLength",1);e.style.width=b.inputWidth+"px";e.style.imeMode="disabled";var g=b.placeHold.replace(/^\s+|\s+$/g,"");if(g!=="")e.value=g,e.style.color="#CCC",e.onfocus=function(){if(this.value===g)this.value="",e.style.color="";b.focusShow&&c.show()},e.onblur=function(){if(this.value.replace(/^\s+|\s+$/g,"")==="")e.style.color="#CCC",this.value=g};this.img=document.createElement("img");this.img.src=b.serverURL+"?clientid="+b.clientID+"&"+
++imageCode.guid;this.img.width=b.imgWidth;this.img.height=b.imgHeight;this.img.style.cursor="pointer";f=this.input.parentNode;a=document.createElement("div");this.p=d=document.createElement("p");d.innerHTML='\u56fe\u4e2d\u663e\u793a\u7684\u56fe\u6848\u662f\u4ec0\u4e48?\u5c06\u4f60\u8ba4\u4e3a\u6b63\u786e\u7b54\u6848\u524d\u7684 <font style="color:#ff6600">\u5b57\u6bcd\u6216\u6570\u5b57</font> \u586b\u5165\u6846\u4e2d(\u4e0d\u533a\u5206\u5927\u5c0f\u5199)<br><a href="javascript:;">\u770b\u4e0d\u6e05 \u6362\u4e00\u5f20</a>';
f.replaceChild(a,e);if(b.focusShow)this.img.style.display=this.p.style.display="none";if(b.layoutType==="onecolumn")this.img.style.marginTop="5px",this.img.style.marginBottom="0px",d.style.marginTop="5px",a.appendChild(e),a.style.width=Math.max(e.offsetWidth,~~b.imgWidth)+"px",a.appendChild(this.img),a.appendChild(d);else if(b.layoutType==="topbottom")this.input.style.marginBottom="0px",a.appendChild(e),f=document.createElement("div"),f.style.marginTop="5px",a.appendChild(f),this.img.style.marginRight=
"12px",this.img.style[document.all?"styleFloat":"cssFloat"]="left",d.style.margin=0,d.style.marginLeft=this.input.offsetWidth+10+"px",f.appendChild(this.img),f.appendChild(d);else if(b.layoutType==="leftright")this.input.style.marginRight="5px",f=document.createElement("div"),a.appendChild(f),e.style["float"]="left",f.appendChild(e),this.img.style.flost="left",this.img.setAttribute("align","top"),f.appendChild(this.img),a.appendChild(d);this.p.getElementsByTagName("a")[0].onclick=this.img.onclick=
function(){c.refresh()}},show:function(){this.img.style.display=this.p.style.display=""},refresh:function(){var a=this.options;if(/msie 6/i.test(navigator.userAgent)){var b=new Image,c=this;b.src=a.serverURL+"?clientid="+a.clientID+"&"+ ++imageCode.guid;b.onload=function(){c.img.src=b.src}}else this.img.src=a.serverURL+"?clientid="+a.clientID+"&"+ ++imageCode.guid},getValue:function(){return this.input.value},getErrorMsg:function(){return"\u8f93\u5165\u683c\u5f0f\u4e0d\u7b26\u5408\u8981\u6c42"},isValid:function(){return/^[0-9a-z]$/i.exec(this.input.value)?
!0:!1}};
function LinkManDialog(){this.id="selectLinkMan";this.searchDivId="dd_search";this.displayDivId="dd_display";this.searchKeyId="LMDSearchKey";this.searchDeleteId="LMDSearchDelete";this.maxSearchLine=100;this.loadCount=3;this.loadTime=0;this.isUser=!0;this.lastType=1;this.lastGroup="-1";this.addrType=15;this.rtb=this.returnCallback=null;this.selLinkMan=new Hashtable;this.isComplete=!1;this.url=this.html="";this.addrDataPower=[0,0,0,0,0,0];this.addrGroup=[];this.addrValue=[1,2,4,8,16,32];this.dataType=[];
this.dataTypeValue=["email","mobile","fax"];this.listIndex={tid:0,id:1,name:2,email:3,mobile:4,fax:5,word:6,spell:7};this.groupIndex={tid:0,id:1,name:2,items:3};this.groupListIndex={tid:0,gid:1,lid:2};this.typeIndex={EP:0,CS:1,PERSON:2,MAILGROUP:3,GROUPMEMBER:4,RECENT:5};this.type=0;this.opt={};this.isSearch=!1;this.personalGroupMap=[];this.emailGroupMap=[];this.groupMap=[];this.group_contactListMap_mail=[];this.group_contactListMap_phone=[];this.loadStatus=0;this.RecentContactsMap=[];this.deptPersonCount_mail=
[];this.deptPersonCount_phone=[];this.emailGroupCount=[];this.userContancts=[];this.orgContactList_autoFile=[];this.allContactList_autoFile=[];this.init=function(){this.addrGroup=Lang.Mail.addr_AddrType.split(",");this.dataType=Lang.Mail.addr_ValueType.split(",");this.dataUrl=gMain.webPath+"/service/contacts";this.initHtml()};this.initHtml=function(){var a=[];a[a.length]='<div class="pageConectDialog" id="LMDDiv"><dl>';a[a.length]="<dt>"+Lang.Mail.addr_SelectAddrItem+"<span>("+Lang.Mail.addr_SelectAddrItemTips+
")</span>";a[a.length]='<div class="searchArea"><div id="searchButton" class="searchInput">';a[a.length]='<div><input type="text" value="" title="" id="'+this.searchKeyId+'" name="'+this.searchKeyId+'" class="searchInput" maxlength="20"></div>';a[a.length]='<a id="'+this.searchDeleteId+'" class="" href="javascript:fGoto();"></a></div></div>';a[a.length]="</dt>";a[a.length]='<dd class="dd1">';a[a.length]='<ul id="ulTabs">';for(i=0;i<this.addrGroup.length;i++)a[a.length]=i==0?'<li id="addrGroup_'+(i+
1)+'" onclick="LMD.fillGroup('+(i+1)+');" class="on" style="display:none;">'+this.addrGroup[i]+"</li>":'<li id="addrGroup_'+(i+1)+'" onclick="LMD.fillGroup('+(i+1)+');" style="display:none;">'+this.addrGroup[i]+"</li>";a[a.length]="</ul>";a[a.length]='<div class="scWrapper">';a[a.length]='<div id="'+this.displayDivId+'">';a[a.length]='<div class="nav" id="LMDdivGroup"></div>';a[a.length]='<span class="select"><select id="LMDSelect" name="LMDSelect" ondblclick="LMD.addSel(\'LMDSelect\');" onkeydown="LMD.doKeyDown(\'LMDSelect\',0);" multiple size="7"></select></span>';
a[a.length]="</div>";a[a.length]='<div id="'+this.searchDivId+'" style="display:none;">';a[a.length]='<div class="searchSelect" id="LMDSearchResult"><select id="LMDSearchSelect" name="LMDSearchSelect" ondblclick="LMD.addSel(\'LMDSearchSelect\');" onkeydown="LMD.doKeyDown(\'LMDSearchSelect\',0);" multiple size="7"></select></div>';a[a.length]='<span class="searchSelect" id="LMDSearchNoResult" style="display:none;"></span>';a[a.length]="</div>";a[a.length]='<div class="action">';a[a.length]='<a class="btn" href="javascript:fGoto();" onclick="LMD.addAll();"><b class="r1"></b><span class="rContent"><span>'+
Lang.Mail.addr_AddAllItem+'</span></span><b class="r1"></b></a>';a[a.length]='<a class="btn" href="javascript:fGoto();" onclick="LMD.addSel();"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.addr_AddSelItem+'</span></span><b class="r1"></b></a>';a[a.length]='<a class="btn" href="javascript:fGoto();" onclick="LMD.refresh();"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.addr_Fresh+'</span></span><b class="r1"></b></a>';a[a.length]="</div></div></dd>";a[a.length]="<dt>"+Lang.Mail.addr_SelectAddrItem+
"<span>("+Lang.Mail.addr_SelectAddrItemTips+")</span></dt>";a[a.length]='<dd class="dd0">';a[a.length]='<div class="scWrapper">';a[a.length]='<span class="select"><select id="LMDSelected" name="LMDSelected" ondblclick="LMD.removeSel();" onkeydown="LMD.doKeyDown(1);" multiple size="6"></select></span>';a[a.length]='<div class="action">';a[a.length]='<a class="btn" href="javascript:fGoto();"  onclick="LMD.removeAll();"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.addr_DelAllItem+'</span></span><b class="r1"></b></a>';
a[a.length]='<a class="btn" href="javascript:fGoto();"  onclick="LMD.removeSel();"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.addr_DelSelItem+'</span></span><b class="r1"></b></a>';a[a.length]="</div></div></dd></dl>";a[a.length]='<p class="action">';a[a.length]='<a class="btn" href="javascript:fGoto();"  onclick="LMD.ok();"><b class="r1"></b><span class="rContent"><span>'+Lang.Mail.Ok+'</span></span><b class="r1"></b></a>';a[a.length]='<a class="btn" href="javascript:fGoto();"  onclick="LMD.hide();"><b class="r1"></b><span class="rContent"><span>'+
Lang.Mail.Close+'</span></span><b class="r1"></b></a>';a[a.length]="</p></div>";this.html=a.join("")};this.init();this.initGroup=function(){for(var a=1;a<this.addrGroup.length+1;a++)if(this.addrValue[a-1]&this.addrType&&this.addrDataPower[a-1])$("addrGroup_"+a).style.display=""};this.fillGroup=function(a){this.isSearch&&this.changeDiv(0);if(!a)a=this.lastType;for(var b=1;b<this.addrGroup.length+1;b++)b==a?$("addrGroup_"+b).className="on":$("addrGroup_"+b).className="";var b=$("LMDdivGroup"),c=[],
d=0,e=this.listDataTree[a];c[0]='<a href="javascript:fGoto();" onclick="LMD.fillLink(\''+a+"','-1')\">"+Lang.Mail.addr_All+"</a>";for(var f in e){var g=e[f];c[d+1]='<a href="javascript:fGoto();" onclick="LMD.fillLink(\''+a+"','"+g.Gid+"');\">"+g.Gname+"</a>";d++}b.innerHTML=c.join("");this.fillLink(a,"0")};this.fillLink=function(a,b){function c(a,b,c){var e="";!d.checkIsExist(a,c)&&c&&b!=""&&c!=""&&d.addOption(g,a,b+" "+c,c)}var d=this;if(!a)a=d.lastType;if(!b)b=d.lastGroup;d.lastType=a;d.lastGroup=
b;var e=0,f,g=$("LMDSelect"),h=d.dataTypeValue[d.type],j=d.listDataTree[a],n=null,k=0,q=null;d.clearOption(g);if(b=="0")for(var t in j){n=j[t].items;k=n.length;for(e=0;e<k;e++)q=n[e],f=q[h],c(q.id,q.name,f)}else{n=j[b].items;k=n.length;for(e=0;e<k;e++)q=n[e],f=q[h],c(q.id,q.name,f)}if(g.options.length>0)g.options[0].selected=!0};this.addOption=function(a,b,c,d){c=new Option(c,d);c.id=b;a.options.add(c)};this.addItem=function(a,b){if(b){var c=b.value,d=b.id;if(!this.checkIsExist(d,c)){var e=b.name+
" "+c;b.name!=""&&c!=""&&this.addOption(a,d,e,c)}}};this.clearOption=function(a){for(var b=a.options.length;b>-1;b--){var c=a.options[b];c&&a.removeChild(c)}};this.getLinkManByValue=function(a){for(var a=a.trim(),b=this.dataTypeValue[this.type],c=this.listData,d=0;d<c.length;d++)if(c[d][b]==a)return c[d];return""};this.checkIsExist=function(a,b){return this.selLinkMan.contains(a)||this.selLinkMan.has(b)};this.add=function(a){for(var b=$("LMDSelected"),c,d,e,a=a||[],f=0,g=a.length;f<g;f++)e=this.getLinkManByValue(a[f]),
e!=null?(d=e[this.dataTypeValue[this.type]],c=e.name+" "+d,e.name!=""&&d!=""&&this.addOption(b,e.id,c,d),this.selLinkMan.add(e.id,d)):a[f]!=null&&a[f]!=""&&(d=a[f],c=d+" "+d,d!=""&&this.addOption(b,d,c,d))};this.addSel=function(){var a=$(this.isSearch?"LMDSearchSelect":"LMDSelect"),b=$("LMDSelected"),c=[],d=0;if(a.length==0)return!1;for(var e=0,f=a.length;e<f;e++){var g=a.options[e];if(g.selected){var d=g.id,h=g.value.trim(),g=new Option(g.text,h);if(!this.checkIsExist(d,h))g.id=d,b.options.add(g),
this.selLinkMan.add(d,h);d=c[c.length]=e}}if(c.length>0)b.options[0].selected=!0;if(!this.isSearch){if(a.options.length>0&&(d=d-1>0?d-1:0,d>0))a.options[d].selected=!0;for(b=c.length-1;b>-1;b--)(e=a.options[c[b]])&&a.removeChild(e)}};this.addAll=function(){var a=$("LMDSelect");this.isSearch&&(a=$("LMDSearchSelect"));var b=$("LMDSelected");if(a.length==0)return!1;for(var c=0;c<a.length;c++){var d=a.options[c],e=d.id,f=d.value,g=new Option(d.text,f);if(!this.checkIsExist(e,f))g.id=e,b.options.add(g),
this.selLinkMan.add(d.id,d.value)}a.options[0].selected=!0;this.clearOption(a)};this.removeSel=function(){var a=$("LMDSelected"),b=0;if(a.length==0)return!1;for(var c=a.length-1;c>-1;c--){var d=a.options[c];d.selected&&(a.removeChild(d),this.selLinkMan.remove(d.id),b=c)}if(a.options.length>0)a.options[b-1>0?b-1:0].selected=!0;this.fillLink()};this.removeAll=function(){this.clearOption($("LMDSelected"));this.selLinkMan.clear();this.fillLink()};this.doKeyDown=function(a,b){var c=EV.getEvent();EV.getCharCode(c)==
46&&(b?LMD.removeSel(a):LMD.addSel(a))};this.show=function(a,b,c,d,e){if(this.isComplete){if(typeof e=="object")LMD.opt=e;this.type=c=c||0;if(d)this.addrType=d;CC.msgBox({id:this.id,title:Lang.Mail.addr_SelectLinkMan+this.dataType[c],text:this.html,width:560,zindex:1100,buttons:[]});this.selLinkMan.clear();(c=a.value)||(c="");c=c.replace(/;/gi,",");c=c.replace(/^,|,$/gi,"");d=c.split(",");c&&d&&d.length>0&&this.add(d);this.rtb=$(a);this.returnCallback=b;this.initGroup();this.fillGroup(1);this.initSearch()}else CC.alert(Lang.Mail.addr_AddrNotComplate)};
this.refresh=function(){this.loadData();this.fillGroup()};this.hide=function(){CC.closeMsgBox(LMD.id)};this.ok=function(){for(var a=[],b=LMD.opt.max,c=$("LMDSelected"),d=0,e=c.options.length;d<e;d++)a[d]=c.options[d].value;if(typeof b=="number"&&b>0&&a.length>b)CC.alert(Lang.Mail.addr_MaxSelect.format(b));else{a=a.join(",");if(this.rtb)this.rtb.value=a;this.hide();this.returnCallback&&this.returnCallback(a);this.rtb&&(GC.textChange(this.rtb),this.rtb.focus())}};this.changeDiv=function(a){(a||0)==
0?(LMD.isSearch=!1,$(LMD.searchKeyId).value="",$(LMD.searchDeleteId).className="",$(LMD.searchDivId).style.display="none",$(LMD.displayDivId).style.display=""):(LMD.isSearch=!0,$(LMD.searchDeleteId).className="searchDelete",$(LMD.searchDivId).style.display="",$(LMD.displayDivId).style.display="none")};this.initSearch=function(){var a=this,b=$(a.searchKeyId),c=a.dataTypeValue[a.type],d=AutoFill.datas[c],e=$("LMDSearchSelect"),f=$("LMDSearchNoResult");El.show($("LMDSearchResult"));El.hide(f);b=new AutoFill(b,
window,{div:a.searhDiv,line:20,isSearch:1,single:!0,statsCall:a.changeDiv,matchCall:function(b){b&&a.addItem(e,b)},changeCall:function(){a.clearOption(e)},resultCall:function(a,b){b=b.encodeHTML();a==0?(El.hide($("LMDSearchResult")),f.innerHTML=Lang.Mail.addr_SearchNoResult.format(b),El.show(f)):(El.hide(f),El.show($("LMDSearchResult")))}});b.data=d;b.init(c);a.fillData=d;EV.addEvent($(a.searchDeleteId),"click",function(){$(a.searchKeyId).value="";a.changeDiv(0)})}}var LMD=new LinkManDialog,FS=new FileSelect;
LMD.initData=function(){this.isComplete=this.isLoad=!1;this.listDataTree=[];this.listData=[];this.groupData=[];this.tempGroupLink=[];for(var a=0;a<this.addrGroup.length+1;a++)this.listDataTree[a]={},this.tempGroupLink[a]={},this.listDataTree[a]["-1"]=[a,-1,Lang.Mail.Write.Others,[]],this.groupData[a]=[],this.listData[a]=[];for(a=0;a<this.dataTypeValue.length;a++)AutoFill.datas[this.dataTypeValue[a]]=[]};
LMD.addContact_Cache=function(a,b,c,d,e){LMD.group_contactListMap_mail[a+"_"+b]||(LMD.group_contactListMap_mail[a+"_"+b]=[]);LMD.group_contactListMap_mail[a+"_"+b].push([a,c,d,e,"","","","",0]);a=="2"&&(LMD.userContancts[c]="y")};LMD.initGroupData=function(a){for(var b=this.groupIndex,c=a.length,d=b.tid,e=b.id,b=b.name,f=0;f<c;f++){var g=a[f],h=parseInt(g[d],10),j=parseInt(g[e],10);this.listDataTree[h][j]=[h,j,g[b],[]]}};
LMD.initGroupListData=function(a){for(var b=this.groupListIndex,c=a.length,d=b.tid,e=b.gid,b=b.lid,f=0;f<c;f++){var g=a[f];this.tempGroupLink[g[d]][g[b]]=g[e]}};
LMD.initContactFilter=function(a){if(GE)GE.addressLocalStore=a;this.groupMap=[];this.group_contactListMap_mail=[];this.group_contactListMap_phone=[];this.RecentContactsMap=[];this.loadStatus=0;this.userContancts=[];this.orgContactList_autoFile=[];this.allContactList_autoFile=[];this.deptObj={};if(a!=""){for(var b=a[0],c=a[1],a=a[2],d=0;d<b.length;d++){b[d][0]=="0"&&(this.deptObj[b[d][1]]=b[d]);var e=b[d][0]+"_"+b[d][3];this.groupMap[e]||(this.groupMap[e]=[]);this.groupMap[e].push(b[d])}for(var b=
[],d=[],e=[],f=[],g=[],h=0;h<a.length;h++){var j=a[h];if(j[3]!=""){var n=j[3].decodeHTML();n.indexOf("<")>0&&(n=n.substring(n.indexOf("<")+1,n.indexOf(">")),a[h][3]=n);j[0]=="5"&&this.allContactList_autoFile.push({id:j[3],name:j[2],value:j[3],word:j[6],fullword:j[7]});j[0]==3&&e.push({id:j[3],name:j[2],value:j[3],word:j[6],fullword:j[7]});j[0]==0&&(g.push({id:j[3],name:j[2],value:j[3],word:j[6],fullword:j[7]}),this.orgContactList_autoFile.push({id:j[3],name:j[2],value:j[3],word:j[6],fullword:j[7],
type:j[0]}));j[0]==2&&(f.push({id:j[3],name:j[2],value:j[3],word:j[6],fullword:j[7]}),this.orgContactList_autoFile.push({id:j[3],name:j[2],value:j[3],word:j[6],fullword:j[7],type:j[0]}))}j[4]!=""&&b.push({id:j[1],name:j[2],value:j[4],word:j[6],fullword:j[7]});if(j[0]==5||j[0]==3)this.RecentContactsMap[j[0]]||(this.RecentContactsMap[j[0]]=[]),this.RecentContactsMap[j[0]].push(j);else if(j[0]==0||j[0]==2)d[j[0]+"_"+j[1]]=j,j[0]==2&&j[3]!=""&&(this.userContancts[j[3]]="y")}this.allContactList_autoFile=
this.allContactList_autoFile.concat(f,g);if(gMain.hideMailGroup!="1")this.allContactList_autoFile=this.allContactList_autoFile.concat(e);for(a=0;a<c.length;a++)if(e=d[c[a][0]+"_"+c[a][2]])e[3]!=""&&(this.group_contactListMap_mail[e[0]+"_"+c[a][1]]||(this.group_contactListMap_mail[e[0]+"_"+c[a][1]]=[]),this.group_contactListMap_mail[e[0]+"_"+c[a][1]].push(e)),e[4]!=""&&(this.group_contactListMap_phone[e[0]+"_"+c[a][1]]||(this.group_contactListMap_phone[e[0]+"_"+c[a][1]]=[]),this.group_contactListMap_phone[e[0]+
"_"+c[a][1]].push(e));AutoFill.datas.email=this.allContactList_autoFile;AutoFill.datas.mobile=b}this.loadStatus=1};
LMD.initListData=function(a){var b=a.length,c=this.listIndex;this.listData=a||[];for(var d=c.id,e=c.name,f=c.email,g=c.mobile,h=c.fax,j=c.word,n=this.groupIndex.items,c=c.spell,k=0;k<b;k++){var q=a[k],t=q[0],u=this.tempGroupLink[t][q[1]]||"-1";q.Gid=u;var s=AutoFill.datas.email,r=AutoFill.datas.mobile,w=AutoFill.datas.fax;typeof this.listDataTree[t][u]=="object"&&this.listDataTree[t][u][n].push(q);Vd.checkData("email",q[f])&&s.push({id:q[d],name:q[e],value:q[f],word:q[j],fullword:q[c]});Vd.checkData("mobile",
q[g])&&r.push({id:q[d],name:q[e],value:q[g],word:q[j],fullword:q[c]});Vd.checkData("phone",q[h])&&w.push({id:q[d],name:q[e],value:q[h],word:q[j],fullword:q[c]})}a=AutoFill.datas.email;b=AutoFill.datas.mobile;d=AutoFill.datas.fax;a.data=a.unique(function(a){return a.value+a.word+a.name});b.data=b.unique(function(a){return a.value+a.word+a.name});d.data=d.unique(function(a){return a.value+a.word+a.name})};
LMD.loadData=function(){if(!LMD.isLoad&&!LMD.isComplete){LMD.isLoad=!0;var a={url:LMD.dataUrl,func:"addr:autoWriteLetter",method:"post",isNotAddUrl:!0,data:{sycn:gMain.synMode?parseInt(gMain.synMode):0},call:function(a){LMD.initContactFilter(a["var"]);LMD.isComplete=!0},failCall:function(){LMD.isComplete=!1}};MM.doService(a)}};LMD.freshData=function(a){LMD.isComplete=!1;LMD.isLoad=!1;LMD.initData();LMD.loadData(a)};LMD.loadList=function(a,b,c){try{var d=new AddrList(a,b,c);d.init();return d}catch(e){}};
LMD.fillMobile=function(a,b,c){return LMD.loadTimeout(a,b,c,"mobile")};LMD.fillEmail=function(a,b,c){return LMD.loadTimeout(a,b,c,"email")};LMD.fillFax=function(a,b,c){return LMD.loadTimeout(a,b,c,"fax")};LMD.autoFillInstances={};LMD.loadTimeout=function(a,b,c,d){function e(){if(typeof b=="object")if(LMD.isComplete)try{var f=new AutoFill(a,b,c);f.data=AutoFill.datas[d];f.init(d);return LMD.autoFillInstances[typeof a=="object"?a.id:a]=f}catch(g){}else window.setTimeout(e,500)}return e()};
function control_Init(){typeof performance!="undefined"&&performance==="1"||(LMD.initData(),window.setTimeout(function(){try{!LMD.isLoad&&!LMD.isComplete&&LMD.loadData()}catch(a){}},gConst.loadAddr_Timeout))}function MarqueeContent(){this.init.apply(this,arguments)}var marqueeInterval=[],marqueeId=0,marqueeHeight=24;
MarqueeContent.prototype={init:function(a){this.marqueeDelay=a.marqueeDelay||15E3;this.doc=a.doc;this.contentItem=a.marqueeContent;this.getHTML()},getHTML:function(){var a=this,b='<div id="marqueeBox" style="overflow:hidden;height:'+marqueeHeight+'px" ><div>'+a.contentItem[0]+"</div>";jQuery("#top_tips_container",this.doc).html(b.decodeHTML());marqueeId++;marqueeInterval[0]=setInterval(function(){a.startMarquee()},a.marqueeDelay);if(b=jQuery("#marqueeBox",a.doc)[0])a.marqueeBox=b,b.onmouseover=function(){clearInterval(marqueeInterval[0])},
b.onmouseout=function(){marqueeInterval[0]=setInterval(function(){a.startMarquee()},a.marqueeDelay)}},startMarquee:function(){var a=this,b=a.contentItem[marqueeId];b||(b="");marqueeId++;marqueeId>=a.contentItem.length&&(marqueeId=0);if(marqueeBox=a.marqueeBox){if(marqueeBox.childNodes.length==1){var c=document.createElement("DIV");c.innerHTML=b;marqueeBox.appendChild(c)}else marqueeBox.childNodes[0].innerHTML=b,marqueeBox.appendChild(marqueeBox.childNodes[0]),marqueeBox.scrollTop=0;clearInterval(marqueeInterval[1]);
marqueeInterval[1]=setInterval(function(){a.scrollMarquee()},24)}},scrollMarquee:function(){this.marqueeBox.scrollTop++;this.marqueeBox.scrollTop%marqueeHeight==marqueeHeight-1&&clearInterval(marqueeInterval[1])},add:function(a){this.contentItem.push(a)},refresh:function(){this.getHTML()}};function MarqueeTitle(a){this.title=a||"";this.speed=1E3;this.init.apply(this,arguments)}
MarqueeTitle.prototype={init:function(){if(!document.all)if(document&&document.getElementsByTagName("title").length)this.container=document.getElementsByTagName("title")[0];else{var a=document.getElementsByTagName("head")[0];this.container=document.createElement("title");a.appendChild(this.container)}this.originalTitle=this.getTitle()},setTitleText:function(a){if(a)this.title=a},setTitle:function(a){if(document.all)document.title=a;else if(this.container)this.container.innerHTML=a},getTitle:function(){if(document.all)return document.title;
else{var a;if(document&&document.getElementsByTagName("title").length)a=document.getElementsByTagName("title")[0];else{var b=document.getElementsByTagName("head")[0];a=document.createElement("title");a.innerHTML="";b.appendChild(a)}return a.innerHTML}},repeat:function(a){var b="";if(this.title&&this.title.length&&a&&a-0>0)for(var c=0;c<a-0;c++)b+=this.title;return b},run:function(){var a=this,b=this.repeat(2),c=this.title.length,d=0;if(!this.running)this.running=!0,this.interval=setInterval(function(){a.setTitle(b);
b=b.substr(1);d++;d>=c&&(b=a.repeat(2),d=0)},this.speed)},stop:function(){clearInterval(this.interval);this.running=!1;this.setTitle(this.originalTitle)}};
(function(a){var b=function(a){if(window.gMain&&gMain.urlCloudp&&gMain.urlCloudp.charAt(0)!="/")gMain.urlCloudp="/"+gMain.urlCloudp;this.id=a.id||"NDFileSelector_common";this.title=a.title||Lang.Mail.ConfigJs.cmulu;this.type=a.type||b.type.folder;this.data=a.data||[];this.notFidList=a.notFidList;this.diskType=a.diskType||0;this.loadType=a.loadType||b.loadType.one;this.cancelCall=a.cancelCall;this.width=a.width||0;this.attachUrl=a.attachUrl;this.fileSize=a.fileSize;this.attachName=a.attachName||"";
this.dircss={de:"tree-folder",on:"tree-folder-on"};this.diricocss={de:"i-nav-off",on:"i-nav-on",kong:"i-nav-kong"};this.selectedFid="-1";this.postData=a.postData||{select:{url:gMain.urlCloudp+gConst.netDiskUrl_fileSearch,func:gConst.func.diskSearch,data:{diskType:1,status:1,fileType:"1",parentId:"-1"}},add:{url:gMain.urlCloudp+gConst.netDiskUrl_addFile,data:{parentId:"-1",fileName:"",diskType:1,comeFrom:0}}};this.childData=[];this.varData=[];this.init()};b.loadType={all:"all",one:"one"};b.type={file:"file",
folder:"folder"};b.prototype={init:function(){var a=this;a.data.length==0&&a.initData(function(){a.show()})},initData:function(a){var d=this;d.ajax(d.postData.select.url,d.postData.select.func,d.postData.select.data,function(e){if(e.code=="S_OK"){if(d.loadType==b.loadType.one){if(e["var"]&&e["var"].resultList){d.childData=e["var"].resultList;if(e["var"].resultList[0]&&e["var"].resultList[0].appFileId)d.selectedFid=e["var"].resultList[0].appFileId;if(e["var"].resultList[0]&&e["var"].resultList[0].fileName)d.selectedName=
e["var"].resultList[0].fileName}}else d.data=e["var"].resultList;d.varData=e["var"];a()}else d.childData=[],d.data=[]},function(){})},ajax:function(a,b,e,f,g){parent.MM.doService({absUrl:a,func:b,data:e,failCall:g,call:f,param:""})},getTreeHTML:function(){return this.loadType==b.loadType.one?this.getOneLoad():this.getAllLoad()},getRowLiHTML:function(a,b){var e=[];if(!this.notFidList||this.notFidList.length==0||!this.notFidList.has(a.appFileId)){var f=a.fileName,f=f.length>15?f.substr(0,14)+"...":
f,g=a.haveSub=="1"?this.diricocss.de:this.diricocss.kong;e.push("<li id='ff_li_"+a.appFileId+"'><div id='ff_div_"+a.appFileId+"'>");e.push('<a href="javascript:fGoto();"><i class="'+g+'"></i></a>');e.push('<i class="i-tx-sfile mr_5"></i>');e.push('<span class="'+(b?this.dircss.on:this.dircss.de)+"\" title='"+a.fileName+"'>"+f+"</span>");e.push("</div><ul></ul></li>");if(b)this.selectedFid=a.appFileId}return e.join("")},getOneLoad:function(a){var b=[];b.push('<div class="select-tx" id="'+this.id+"\" style='height:300px;overflow-y:auto;'>");
b.push('<ul class="select-tx-ul">');if(this.diskType==2)b.push(this.getRowLiHTML({appFileId:this.varData.groupId,fileName:this.varData.groupName,haveSub:this.varData.resultList.length>0?"1":""},!0));else{for(var e=[],f=0;f<this.childData.length;f++){var g;g=this.getRowLiHTML(this.childData[f],!0);b.push(g);e.push(g)}if(a)return e.join("")}b.push("</ul>");b.push("</div>");return b.join("")},getAllLoad:function(){},okCall:function(){var a={parentId:this.selectedFid,fileName:this.attachName,diskType:1,
fileUrl:this.attachUrl,userId:gMain.mailId,fileSize:this.fileSize},b=gConst.func.netDisk_attachUpload,e=gMain.urlCloudp+gConst.netDiskUrl_addFile;CC.showMsg("\u9644\u4ef6\u6b63\u5728\u5b58\u7f51\u76d8\uff0c",!0,!1,"loadding");this.ajax(e,b,a,function(){CC.showMsg(Lang.Mail.ConfigJs.savedToDisk,!0,!1,"option")},function(){CC.showMsg(Lang.Mail.ConfigJs.saveToDiskFail,!0,!1,"error")})},show:function(){var a=this,b=a.title,e=a.getTreeHTML();CC.showDiv(e,function(){a.okCall(a.selectedFid)},b,a.cancelCall,
"",a.width,[{text:Lang.Mail.ConfigJs.newFolder,"class":"n_btn  mt_5 ml_10 fl",clickEvent:function(){a.createFolder();return!0}}]);a.addEvent()},createFolder:function(){var b=this;a("#"+b.id+"_cf").remove();var d=[];d.push("<li id='"+b.id+"_cf'>");d.push("<div>");d.push('<i class="i-nav-kong"></i>');d.push('<i class="i-tx-sfile mr_5"></i>');d.push("<input id='"+b.id+'_cf_txt\' type="text" class="select-tx-txt w75" maxlength="50">');d.push("<a id='"+b.id+'_cf_ok\' class="ml_5" href="javascript:fGoto();"><i class="i-tx-yes"></i></a>');
d.push("<a id='"+b.id+'_cf_no\' class="ml_5" href="javascript:fGoto();"><i class="i-tx-no"></i></a>');d.push("</div>");d.push("</li>");a("span[class='"+b.dircss.on+"']").parent().next().removeClass("hide").append(d.join(""));a("#"+b.id+"_cf_txt").focus().select();a("#"+b.id+"_cf_ok").click(function(){var d=a("#"+b.id+"_cf_txt").val();if(d)if(d.checkSpecialChar()){var f=a(this).parent().parent().parent().parent(),g=a(this).parent().parent().parent(),f=f.attr("id"),f=f.substr(f.lastIndexOf("_")+1);
b.postData.add.data.parentId=f;b.postData.add.data.fileName=d;b.ajax(b.postData.add.url,"common:createFolder",b.postData.add.data,function(a){a.code="S_OK";CC.showMsg("\u65b0\u5efa\u6587\u4ef6\u5939\u6210\u529f",!0,!1,"option");b.initData(function(){g.html(b.getFolderChildHTML());b.addEvent()})},function(){})}else CC.alert("\u6587\u4ef6\u5939\u540d\u79f0\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26");else CC.alert(Lang.Mail.ConfigJs.folderEmpty)});a("#"+b.id+"_cf_no").click(function(){a("#"+b.id+
"_cf").remove()})},getFolderChildHTML:function(){var a=[];if(this.childData&&this.childData.length>0)for(var b=0;b<this.childData.length;b++)a.push(this.getRowLiHTML(this.childData[b]));return a.join("")},getSelectedFid:function(){return p.selectedFid},getSelectedItem:function(){var a={};if(this.loadType==b.loadType.one)for(var d=0;d<this.childData.length;d++){var e=this.childData[d];if(e.appFileId==this.selectedFid){a=e;break}}return a},addEvent:function(){var b=this;a("#"+b.id).find("div[id]").each(function(){var d=
this;d.onclick=function(){a("#"+b.id).find("span[class='"+b.dircss.on+"']").attr("class","tree-folder");a(d).children().last().attr("class",b.dircss.on);var e=a(d).next();e.children().length>0&&(e.attr("class")?(e.removeClass("hide"),a(d).find("a i").attr("class",b.diricocss.on)):(e.addClass("hide"),a(d).find("a i").attr("class",b.diricocss.de)));b.onClickLi(d)}})},onClickLi:function(c){var d=this,e=c.id.substr(7);d.selectedFid=e;d.selectedName=a(c).find("span").text();if(d.loadType==b.loadType.one)d.postData.select.data.parentId=
e,a(c).parent().find("li").length==0&&a(c).find("."+d.diricocss.kong).length==0&&d.initData(function(){a(c).next().html("");var b=d.getFolderChildHTML();b&&(a(c).find("a i").attr("class",d.diricocss.on),a(c).next().append(b),d.addEvent())})}};window.NDFileSelector=b})(jQuery);function NoviceWizard(){this.init.apply(this,arguments)}
NoviceWizard.prototype={init:function(){this.initWizard();this.registerEvent()},initWizard:function(){this.nextStep(1)},registerEvent:function(){},nextStep:function(a){var b=this,c=gMain.resourceRoot;if(b.objWizardContainer)b.objWizardContainer.innerHTML="";for(var d=0;d<4;d++)if(d==a-1){var e=parent.El.createElement("div","",""),f=parent.El.createElement("div","","backdrop");e.appendChild(f);e.onclick=function(b){if(a==4){var c=document.getElementById("account_panel");if(c)c.style.display="block",
c.onmouseout=function(){c.style.display="block"};parent.EV.stopEvent(b)}};var g=parent.El.createElement("img","","");if(a==1)parent.El.setStyle(g,{position:"absolute",top:"115px",left:"5px",zIndex:20200}),parent.El.setAttr(g,{width:190,height:32,alt:"",src:c+"/images/guaid/wm.jpg"});else if(a==2){jQuery("#boxWorkOrder i").click();f=El.pos(jQuery("#diskTemp a")[0]);if(!f){b.nextStep(3);return}parent.El.setStyle(g,{position:"absolute",top:f[1]+"px",left:f[0]-8+"px",zIndex:20200});parent.El.setAttr(g,
{width:87,height:28,alt:"",src:c+"/images/guaid/state.jpg"})}else a==3?(parent.El.setStyle(g,{position:"absolute",top:"0px",left:"88px",zIndex:20200}),parent.El.setAttr(g,{width:236,height:30,alt:"",src:c+"/images/guaid/toplinks.jpg"})):a==4&&window.setTimeout(function(){var a=document.getElementById("account_panel");if(a)a.style.display="block",a.onmouseout=function(){a.style.display="block"}},100);e.appendChild(g);f=El.pos(jQuery("#diskTemp")[0]);g=!1;window.ActiveXObject&&navigator.userAgent.toLowerCase().match(/msie ([\d.]+)/)[1]==
6&&(g=!0);var h;if(a==1){if(h=parent.El.createElement("div","","guaide1"),g)h.style.filter="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src="+c+"/images/guaid/ng1.png,no-repeat)"}else if(a==2){h=parent.El.createElement("div","","guaide2");if(g)h.style.filter="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src="+c+"/images/guaid/ng2.png,no-repeat)";parent.El.setStyle(h,{top:f[1]-150+"px"})}else if(a==3){if(h=
parent.El.createElement("div","","guaide3"),g)h.style.filter="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src="+c+"/images/guaid/ng3.png,no-repeat)"}else if(a==4&&(h=parent.El.createElement("div","","guaide4"),g))h.style.filter="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src="+c+"/images/guaid/ng4.png,no-repeat)";g=parent.El.createElement("a","","guaide_cls");g.onclick=function(a){b.closeWizard();parent.EV.stopEvent(a)};
var j;a==1?(j=parent.El.createElement("div","","guaideWrap1"),parent.El.setStyle(g,{right:"8px",top:"29px"})):a==2?(j=parent.El.createElement("div","","guaideWrap2"),parent.El.setStyle(j,{top:f[1]-163+"px"}),parent.El.setStyle(g,{right:"3px",top:"21px"})):a==3?(j=parent.El.createElement("div","","guaideWrap3"),parent.El.setStyle(g,{top:"85px",right:"-3px"})):a==4&&(j=parent.El.createElement("div","","guaideWrap4"),parent.El.setStyle(g,{right:"15px",top:"86px"}));g.href="javascript:;";j.appendChild(h);
j.appendChild(g);f=parent.El.createElement("a","","guaide_btn");f.href="javascript:;";f.onclick=function(c){b.nextStep(a+1);parent.EV.stopEvent(c)};a==1?parent.El.setStyle(f,{left:"213px",top:"140px"}):a==2?parent.El.setStyle(f,{left:"217px",top:"133px"}):a==3?parent.El.setStyle(f,{left:"213px",top:"202px"}):a==4&&parent.El.setStyle(f,{left:"164px",top:"205px"});j.appendChild(f);e.appendChild(j);parent.El.setStyle(e,{zoom:"1"});parent.El.insertElement(document.body,e,"beforeEnd");b.objWizardContainer=
e}a==5&&(CC.msgBox({id:"NoviceWizardSetp5",dragStyle:1,title:"\u6e29\u99a8\u63d0\u793a",text:"<div style='color: rgb(188, 188, 188);padding: 10px 20px 0;'>\u7528\u4e8e\u5bc6\u7801\u627e\u56de\u3001\u91cd\u7f6e\u5bc6\u7801</div><div style='padding: 10px 20px;'>\u4e3a\u4e86\u60a8\u7684\u8d26\u53f7\u5b89\u5168\uff0c\u5efa\u8bae\u60a8\u7ed1\u5b9a\u624b\u673a\u6216\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898</div>",scoll:"auto",buttons:[{text:"\u7ed1\u5b9a\u624b\u673a",clickEvent:function(){top.location.href=
parent.gMain.webPath+"/se/account/accountindex.do?sid="+parent.gMain.sid+"&mode=Mobile"},isCancelBtn:!1},{text:"\u5bc6\u4fdd\u95ee\u9898",clickEvent:function(){top.location.href=parent.gMain.webPath+"/se/account/accountindex.do?sid="+parent.gMain.sid+"&mode=PassSec"},isCancelBtn:!1}],sysCloseEvent:!0}),b.hideAccountPanel())},hideAccountPanel:function(){var a=document.getElementById("account_panel");if(a)a.style.display="none"},closeWizard:function(){this.objWizardContainer.innerHTML="";this.hideAccountPanel()},
show:function(){},hide:function(){}};function AutoTextSize(a,b,c){c=c||{};this.win=b||window;this.doc=this.win.document||document;this.id=a;this.text=this.doc.getElementById(a);this.maxH=c.max||54;this.addHeight=18;this.lastHeight=0;this.resizeCall=c.resizeCall;this.init()}AutoTextSize.create=function(a,b,c){c=c||{};return new AutoTextSize(a,b,c)};
AutoTextSize.prototype={init:function(){var a=this,b=this.text;this.lastHeight=0;this.origHeight=b.style.height.toInt();El.setStyle(b,{resize:"none",overflowY:"auto",overflowX:"hidden",wordBreak:"break-all",lineHeight:this.addHeight+"px"});this.clone=this.clone(b);El.width(this.clone,El.width(b));Browser.isIE?EV.addEvent(a.text,"propertychange",function(){a.doSize()},!0):EV.addEvent(a.text,"input",function(){a.doSize()})},clone:function(a){var b=a.cloneNode(!0),c={};El.removeAttr(b,["id","name"]);
["height","lineHeight","textDecoration","letterSpacing"].each(function(b,e){c[e]=a.style[e]});El.setStyle(b,{position:"absolute",top:"0px",left:"-9999px"});El.setStyle(b,c);El.setAttr("tabIndex","-1");El.insertElement(a,b,"beforeBegin");return b},doSize:function(){var a=this.text,b=this.clone;El.height(a);El.setSize(b,{width:El.width(a)});b.value=a.value;b.scrollTop=1E4;var c=b.scrollTop;El.height(a);b=Math.max(b.scrollTop,this.origHeight);c+this.addHeight>this.maxH?b=this.maxH:c>0?b+=this.addHeight:
b=this.origHeight;if(this.lastHeight!=b)El.height(a,b),this.lastHeight=b,El.setCursorPos(a),typeof this.resizeCall=="function"&&this.resizeCall.call()}};var RichInputBox=function(){this.init.apply(this,arguments)};RichInputBox.instances=[];RichInputBox.getInstanceByContainer=function(a){for(var b=0;b<RichInputBox.instances.length;b++){var c=RichInputBox.instances[b];if(c.container==a||c.jContainer==a)return c}return null};
RichInputBox.dispose=function(){RichInputBox.contextmenu&&RichInputBox.contextmenu[0]&&RichInputBox.contextmenu.hide()};
RichInputBox.prototype={init:function(a){this.type=a.type?a.type:"email";this.itemCount=0;this.autoDataSource=a.autoDataSource;this.autoHeight=a.autoHeight;this.maxMailNum=a.maxMailNum;this.mailNumError=a.mailNumError||function(){};this.change=a.change||function(){};this.itemCreated=a.itemCreated||function(){};this.itemDeleted=a.itemDeleted||function(){};this.errorfun=a.errorfun||"";this.evt=a.evt;var b=this;RichInputBox.instances.push(this);this.id=RichInputBox.instances.length;var c="RichInputBoxSetValueHandler"+
RichInputBox.instances.length;a.container.innerHTML='<div class="RichInputBoxLayout"><div class="RichInputBox" id="RichInputBoxID"><input id="rib_input_'+RichInputBox.instances.length+'" backspacedeleteoff="true" tabindex="'+RichInputBox.instances.length+'" setvaluehandler="'+c+'" type="text" class="write-input" /></div></div>';if(jQuery.browser.msie&&jQuery.browser.version<=6)a.container.firstChild.style.height="18px";if(a.autoHeight)a.container.firstChild.style.maxHeight="1000px";this.container=
a.container.firstChild.firstChild;this.jContainer=jQuery(this.container);this.textbox=this.container.firstChild;this.jTextBox=jQuery(this.textbox);this.items={};this.lastInsertItem=null;this.hashMap={};this.mobilelimit=a.mobilelimit||"";window[c]=function(){b.createItemFromTextBox()};RichInputBox.Tool.bindEvent(this,this.jContainer,RichInputBox.Events.Container);RichInputBox.Tool.bindEvent(this,this.jTextBox,RichInputBox.Events.TextBox);a.plugins=RichInputBox.Plugin.getDefaultPlugin(this);for(c=0;c<
a.plugins.length;c++)try{a.plugins[c](this)}catch(d){}if(!RichInputBox.Events.bindDocument)RichInputBox.Tool.bindEvent(null,jQuery(document.body),RichInputBox.Events.Document),RichInputBox.Events.bindDocument=!0},getItems:function(){var a=[],b=this;this.jContainer.find("div[rel]").each(function(){var c=this.getAttribute("rel");(c=b.items[c])&&a.push(c)});return a},isRepeat:function(a){if(this.type=="mobile")var b=NumberTool.getNumber(a);else this.type=="email"&&(b=MailTool.getAddr(a));if(b&&this.hashMap[b]){for(p in this.items)if((a=
this.items[p])&&a.hashKey==b){RichInputBox.Tool.blinkBox(a.element,"blinkColor");break}return!0}else return!1},insertItem:function(a,b,c,d){var e=!1;if(!c)var f=!b&&!c,c=this.jTextBox;for(var a=a.split(/[;\uff1b,\uff0c]/),g=a.length,h=a.length,j=0;j<g;j++){var n=a[j].trim();if(!this.checkMailNum()){this.statusInfo={len:g,fail:h};this.mailNumError(this);this.createMode="";return}if(n!=""&&(this.type=="email"&&(n=this.fixEmail(n,parent.gMain.domain)),this.repeatable||!this.isRepeat(n)))e=new RichInputBox.Item(this,
n,this.mobilelimit),this.items[e.itemId]=e,b?c.after(e.element):c.before(e.element),d&&e.select(),this.lastInsertItem=e,this.itemCount++,this.maxMailNum--,h--,e=!0}this.clearTipText();this.resize();try{f&&this.textbox.getAttribute("TabPress")!="1"&&this.textbox.focus()}catch(k){}this.hideTipTextExt();this.hideTipTextExt=function(){};this.showTipTextExt=function(){};b={len:g,fail:h};b.mode=this.createMode||"";this.statusInfo=b;this.change&&e&&this.change();if(this.itemCreated)this.itemCreated(b),this.createMode=
""},fixEmail:function(a,b){return a.indexOf("@")>0?a:a+"@"+b},checkMailNum:function(){return typeof this.maxMailNum=="number"&&this.maxMailNum<=0?!1:!0},resize:function(){var a=this;RichInputBox.Tool.delay("reisze"+this.id,function(){RichInputBox.Tool.resizeContainer(a.container,a.autoHeight);if(a.onresize)a.onresize()},100)},getTextBoxNextItem:function(){var a=this.textbox.nextSibling;if(a){if(a=a.getAttribute("rel"))return this.items[a]}else return null},getTextBoxPrevItem:function(){var a=this.textbox.previousSibling;
if(a){if(a=a.getAttribute("rel"))return this.items[a]}else return null},unselectAllItems:function(){for(var a in this.items){var b=this.items[a];b&&b.unselect()}this.lastClickItem=null},selectAll:function(){for(var a in this.items){var b=this.items[a];b&&b.select()}},copy:function(){for(var a=this.getSelectedItems(),b=[],c=0;c<a.length;c++)b.push(a[c].allText);RichInputBox.Tool.Clipboard.setData(b);jQuery.browser.msie&&window.clipboardData.setData("Text",b.join(";"))},cut:function(){for(var a=this.getSelectedItems(),
b=[],c=0;c<a.length;c++)b.push(a[c].allText),a[c].remove();RichInputBox.Tool.Clipboard.setData(b);jQuery.browser.msie&&window.clipboardData.setData("Text",b.join(";"))},paste:function(){this.createMode="paste";if(jQuery.browser.msie){var a=window.clipboardData.getData("Text");if(a&&(/[;,\uff1b\uff0c]/.test(a)||this.type=="email"&&MailTool.checkEmailText(a)||this.type=="mobile"&&NumberTool.isChinaMobileNumberText(a)))return this.insertItem(a),!1}else return(a=prompt("\u56e0\u4e3a\u4f60\u7684\u6d4f\u89c8\u5668\u7684\u5b89\u5168\u8bbe\u7f6e\u539f\u56e0\uff0c\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\u526a\u8d34\u677f\uff0c\u8bf7\u5c06\u5185\u5bb9\u7c98\u8d34\u5728\u4ee5\u4e0b\u8f93\u5165\u6846\u5185\uff1a"))&&
(/[;,\uff1b\uff0c]/.test(a)||this.type=="email"&&MailTool.checkEmailText(a)||this.type=="mobile"&&NumberTool.isChinaMobileNumber(a))&&this.insertItem(a),!1},getSelectedItems:function(){var a=[],b;for(b in this.items){var c=this.items[b];c&&c.selected&&a.push(c)}return a},clear:function(){this.items={};this.hashMap={};this.itemCount=0;this.jContainer.find("div[rel]").remove()},removeSelectedItems:function(){for(var a=this.getSelectedItems(),b=0;b<a.length;b++)a[b].remove()},createItemFromTextBox:function(){this.tipText&&
this.clearTipText();var a=this.textbox,b=a.value.trim();if(b!=""&&b!=this.tipText)a.value="",a.style.width="2px",this.insertItem(b)},moveTextBoxTo:function(a,b){var c=this.jTextBox;b?a.after(c):a.before(c);RichInputBox.Tool.fixTextBoxWidth(c);window.focus();c.focus()},moveTextBoxToLast:function(){var a=this.textbox;a.parentNode.lastChild!=a&&a.parentNode.appendChild(a);jQuery.browser.msie&&window.focus()},disposeItemData:function(a){delete this.items[a.itemId];this.itemCount--;a.hashKey&&delete this.hashMap[a.hashKey];
this.change&&this.change();this.itemDeleted&&this.itemDeleted()},trySelect:function(a,b){var c,d;if(!(a.y==b.y&&a.x==b.x)){a.y==b.y?a.x<b.x?(c=a,d=b):(c=b,d=a):a.y<b.y?(c=a,d=b):(c=b,d=a);for(var e,f=this.jContainer.find("div"),g,h=0;h<f.length;h++){var j=f.eq(h),n=j.offset(),k=n.left+j.width(),q=n.top+j.height(),t=!1;g||(g=j.height());if(e)d.x>n.left&&d.y>n.top?t=!0:d.y-n.top>g&&(t=!0);else if(c.x<k&&c.y<=q||q-c.y>=g)e=j,t=!0;j=this.items[j.attr("rel")];t?j.select&&j.select():j.unselect&&j.unselect()}}},
itemIdNumber:0,getNextItemId:function(){return this.itemIdNumber++},setTipText:function(a){this.tipText=a;var b=this.jTextBox;b.val(a);b.css("color","silver").val(a);this.showTipText=!0;if(!this.bindTipTextBoxEvent)b.mousedown(this.clearTipText).keydown(this.clearTipText),this.bindTipTextBoxEvent=!0;RichInputBox.Tool.fixTextBoxWidth(b,!0)},setTipTextExt:function(a){var b=this;this.tipTextExt=a;this.jTextBox.focus(function(){b.showTipTextExt()}).blur(function(){b.hideTipTextExt()})},hideTipTextExt:function(){this.tipTextExtContainer&&
this.tipTextExtContainer.hide()},showTipTextExt:function(){if(this.tipTextExt){var a=this.jContainer;if(!this.tipTextExtContainer)this.tipTextExtContainer=jQuery("<div style='font-size:12px;position:absolute;padding:3px 5px 3px 5px;border:1px solid silver;'></div>").text(this.tipTextExt).appendTo(document.body);var b=a.offset();this.tipTextExtContainer.css({left:b.left-2,top:b.top+a.height()+1,display:""})}},clearTipText:function(a){var a=a&&a.richInputBox||this,b=this.jTextBox||jQuery(this);a.tipText&&
b.val()==a.tipText&&b.val("").css("color","black");this.showTipText=!1;setTimeout(function(){RichInputBox.Tool.fixTextBoxWidth(b)},0)},focus:function(){try{top.jQuery.browser.msie?this.textbox.focus():this.textbox.select()}catch(a){}},hasItem:function(){return this.getItems().length>0},getRightEmails:function(){for(var a=this.getItems(),b=[],c=0;c<a.length;c++)a[c].error||b.push(a[c].allText);return b},getRightNumbers:function(){return this.getRightEmails()},getErrorText:function(){for(var a=this.getItems(),
b=0;b<a.length;b++)if(a[b].error)return a[b].allText;return null},createStyle:function(){RichInputBox.styleLoaded=!0},getItemByEmail:function(a){var b=this.getItems();if(b.length)for(var c=0;c<b.length;c++)if(parent.Email.getValue(b[c].allText)==a)return b[c];return null}};
RichInputBox.Tool={unselectable:function(a){jQuery.browser.msie?a.unselectable="on":(a.style.MozUserSelect="none",a.style.KhtmlUserSelect="none")},fixTextBoxWidth:function(a,b){var c=RichInputBox.Events.currentRichInputBox;c&&c.change&&c.change();this.tagName=="INPUT"&&(a=jQuery(this));if(a.val()=="")a.width(10);else{jQuery.browser.msie&&!b?c=a[0].createTextRange().boundingWidth-0:(c=jQuery("#widthHelper"),c.length==0&&(c=jQuery("<span style='position:absolute;left:0px;top:0px;visibility:hidden;'                id='widthHelper'></span>").appendTo(document.body),
c.css({fontSize:a.css("font-size"),fontFamily:a.css("font-family"),border:0,padding:0})),c=c.text(a.val().replace(/ /g,"1")).width()-0);c%100==0&&c>1E3&&(c/=100);c+=13;var d=(a.parent().width()||1E3)-3;c>d&&(c=d);c<10&&(c=10);a.width(c)}},resizeContainer:function(a,b){if(a=a.parentNode)if(b){if(a.style.height!="auto")a.style.height="auto"}else{var c=a.style.height;if(jQuery.browser.msie&&jQuery.browser.version<=6&&(a.style.height="18px",a.scrollHeight>a.clientHeight))a.style.height=Math.min(45,a.scrollHeight)+
"px";return c!=a.style.height?!0:!1}},getNearlyElement:function(a){for(var b=a.richInputBox.jContainer.find("div"),c=[],d=0;d<b.length;d++){var e=b.eq(d),f=e.offset().top;a.y>=f&&a.y<f+e.outerHeight(!0)&&c.push(e)}for(var g,b=!0,d=0;d<c.length;d++){e=c[d];g=e.offset().left;if(a.x<g+e.width()/2){g=e;b=!1;break}g=e}return g?{element:g,isAfter:b}:null},bindEvent:function(a,b,c){for(var d in c)b.bind(d,function(b){return function(c){c.richInputBox=a;return b.call(this,c)}}(c[d]))},draw:function(a,b){if(!window.drawDiv)window.drawDiv=
jQuery("<div style='position:absolute;left:0px;top:0px;border:1px solid blue;'></div>").appendTo(document.body);var c=Math.abs(a.x-b.x),d=Math.abs(a.y-b.y);drawDiv.width(c);drawDiv.height(d);drawDiv.css({left:Math.min(a.x,b.x),top:Math.min(a.y,b.y)})},Clipboard:{setData:function(a){this.items=a},hasData:function(){return Boolean(this.items)&&this.items.length>0},getData:function(){return(this.items||[]).concat()}},hidDragEffect:function(){this.dragEffectDiv&&this.dragEffectDiv.hide()},drawDragEffect:function(a){if(!this.dragEffectDiv)this.dragEffectDiv=
jQuery("<div style='position:absolute;            border:2px solid #444;width:7px;height:8px;z-index:5000;overflow:hidden;'></div>").appendTo(document.body);this.dragEffectDiv.css({left:a.x+4,top:a.y+10,display:"block"})},hidDrawInsertFlag:function(){this.drawInsertFlagDiv&&this.drawInsertFlagDiv.hide()},drawInsertFlag:function(a){if(!this.drawInsertFlagDiv)this.drawInsertFlagDiv=jQuery("<div style='position:absolute;            background-color:black;width:1px;height:15px;z-index:5000;overflow:hidden;border:0;'></div>").appendTo(document.body);
for(var b,c=0;c<RichInputBox.instances.length;c++){var d=RichInputBox.instances[c];if(RichInputBox.Tool.isContain(d.container,a.target)){b=d;break}}if(b)var e=RichInputBox.Tool.getNearlyElement({richInputBox:b,x:a.x,y:a.y});e?(a=e.element.offset(),this.drawInsertFlagDiv.css({left:a.left+(e.isAfter?e.element.width()+2:-2),top:a.top,display:"block"}),this.insertFlag={element:e.element,isAfter:e.isAfter,richInputBox:b}):this.insertFlag={richInputBox:b}},isContain:function(a,b){for(;b;){if(a==b)return!0;
b=b.parentNode}return!1},delay:function(a,b,c){if(!this.delayKeys)this.delayKeys={};this.delayKeys[a]&&clearTimeout(this.delayKeys[a].timer);this.delayKeys[a]={};this.delayKeys[a].func=b;var d=this;this.delayKeys[a].timer=setTimeout(function(){d.delayKeys[a]=null;b()},c||0)},fireDelay:function(a){this.delayKeys&&this.delayKeys[a]&&(this.delayKeys[a].func(),clearTimeout(this.delayKeys[a].timer))},mouseupDelay:function(a){RichInputBox.Tool.fireDelay("drawInsertFlag");var b=RichInputBox.Events.currentRichInputBox;
if(b){if(RichInputBox.Tool.dragEnable){var a=RichInputBox.Tool.dragItems,c=RichInputBox.Tool.insertFlag;if(c&&a&&c.richInputBox){if(b.id==c.richInputBox.id)return;var d=c.richInputBox;b.repeatable=!0;d.maxMailNum==0&&d.maxMailNum++;for(var e=0;e<a.length;e++){var f=a[e];d.insertItem(f.allText,c.isAfter,c.element,!0)}b.repeatable=!1;for(e=0;e<a.length;e++)f=a[e],f.remove()}}else if(b.selectArea)b.trySelect(b.startPosition,{x:a.clientX,y:a.clientY}),b.getSelectedItems().length==0&&Utils.focusTextBox(b.textbox);
else return;if(jQuery.browser.msie){if(RichInputBox.Events.captureElement)RichInputBox.Events.captureElement.releaseCapture(),RichInputBox.Events.captureElement=null}else window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);RichInputBox.Tool.dragEnable=!1;b.selectArea=!1;RichInputBox.Tool.dragItems=null;RichInputBox.Tool.insertFlag=null;RichInputBox.Tool.hidDragEffect();RichInputBox.Tool.hidDrawInsertFlag()}},blinkBox:function(a,b){a.addClass(b);var c,d=setInterval(function(){c&&clearTimeout(c);a.addClass(b);
c=setTimeout(function(){a.removeClass(b)},100)},200);setTimeout(function(){d&&clearInterval(d)},1E3)}};RichInputBox.Item=function(){this.init.apply(this,arguments)};
RichInputBox.Item.prototype={init:function(a,b,c){this.richInputBox=a;this.itemId=a.getNextItemId();this.allText=b;if(a.type=="email")a.errorfun?a.errorfun(this,b):(this.error=!MailTool.checkEmailText(b),this.errorMsg="\u8be5\u5730\u5740\u683c\u5f0f\u6709\u9519\uff0c\u8bf7\u53cc\u51fb\u4fee\u6539");else if(a.type=="mobile")parent.CorpType=="2"?NumberTool.isChinaMobileNumberText(b)?NumberTool.checkMobileText(b,c)?(this.error=!1,this.errorMsg=""):(this.error=!0,this.errorMsg="\u4e0d\u652f\u6301\u5411\u7535\u4fe1\u3001\u8054\u901a\u7528\u6237\u53d1\u9001"):
(this.error=!0,this.errorMsg="\u8be5\u53f7\u7801\u4e0d\u662f\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\uff0c\u8bf7\u53cc\u51fb\u4fee\u6539"):(this.error=!NumberTool.isChinaMobileNumberText(b),this.errorMsg="\u8be5\u53f7\u7801\u4e0d\u662f\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\uff0c\u8bf7\u53cc\u51fb\u4fee\u6539");if(this.error)c=this.element=jQuery("<div class='addrItem' style='cursor: pointer;' title='{0}'><span unselectable='on' class='error'></span>;</div>".format(this.errorMsg)),c.find("span:eq(0)").text(b);
else if(c=this.element=jQuery("<div unselectable='on' style='cursor: pointer;' class='addrItem'><b unselectable='on'></b><span unselectable='on'></span>;</div>"),a.type=="email"){var d=this.addr=MailTool.getAccount(b)+"@"+MailTool.getDomain(b);a.hashMap[this.hashKey=d]=!0;b.indexOf("<")!=-1?(c.find("b").text('"'+MailTool.getName(b)+'"'),c.find("span:eq(0)").text("<"+d+">")):c.find("b").text(d);c.attr("title",b)}else d=NumberTool.getNumber(b),a.hashMap[this.hashKey=d.toLowerCase()]=!0,b.indexOf("<")!=
-1?(c.find("b").text('"'+NumberTool.getName(b)+'"'),c.find("span:eq(0)").text("<"+d+">")):c.find("b").text(d),c.attr("title",d);c.attr("rel",this.itemId);RichInputBox.Tool.unselectable(c[0]);this.selected=!1;RichInputBox.Tool.bindEvent(a,c,RichInputBox.Events.Items)},select:function(){this.element.addClass("selected");richInputBox=this.richInputBox;this.selected=!0;if(jQuery.browser.msie)RichInputBox.Tool.delay("ItemFocus",function(){richInputBox.focus()});else if(jQuery.browser.opera){var a=richInputBox.container.parentNode.scrollTop;
richInputBox.textbox.focus();richInputBox.container.parentNode.scrollTop=a}else richInputBox.focus()},unselect:function(){this.element.removeClass("selected");this.selected=!1},remove:function(){delete this.richInputBox.items[this.itemId];this.richInputBox.disposeItemData(this);this.element.remove();this.richInputBox.resize()}};Keys={A:65,C:67,X:88,V:86,Enter:13,Space:32,Left:37,Up:38,Right:39,Down:40,Delete:46,Backspace:8,Semicolon:jQuery.browser.mozilla||jQuery.browser.opera?59:186,Comma:188,Tab:9};
RichInputBox.Events={Document:{mousemove:function(a){var b=RichInputBox.Events.currentRichInputBox;if(b){var c={x:a.clientX,y:a.clientY,target:a.target};RichInputBox.Tool.dragEnable?(RichInputBox.Tool.drawDragEffect(c),RichInputBox.Tool.delay("drawInsertFlag",function(){RichInputBox.Tool.drawInsertFlag(c)},10),a.preventDefault()):b.selectArea&&(b.trySelect(b.startPosition,c),a.preventDefault())}},mousedown:function(a){for(var a=a.target,b;a;){if(a.className=="RichInputBox"){b=RichInputBox.getInstanceByContainer(a);
break}a=a.parentNode}RichInputBox.Events.currentRichInputBox=b;for(a=0;a<RichInputBox.instances.length;a++){var c=RichInputBox.instances[a];c!=b&&c.unselectAllItems()}},mouseup:function(a){RichInputBox.Tool.delay("mouseupDelayFlg",function(){RichInputBox.Tool.mouseupDelay(a);RichInputBox.Tool.dragEnable=!1;RichInputBox.Tool.hidDragEffect()},10)},click:function(){RichInputBox.dispose()}},Container:{keydown:function(a){function b(a){var b=h.getSelectedItems();b.length>0&&h.moveTextBoxTo(b[0].element);
h.removeSelectedItems();window.focus();h.jTextBox.focus();a.preventDefault()}function c(){var a=h.getSelectedItems();a.length>0&&h.moveTextBoxTo(a[0].element);h.removeSelectedItems();window.focus();h.jTextBox.focus()}function d(a){h.selectAll();a.preventDefault()}function e(){return h.copy()}function f(){return h.cut()}function g(){return h.paste()}if(!(a.target.tagName=="INPUT"&&a.target.value!="")){var h=a.richInputBox;h.resize();switch(a.keyCode){case Keys.Backspace:return b.apply(this,arguments);
case Keys.Delete:return c.apply(this,arguments);case Keys.A:if(a.ctrlKey)return d.apply(this,arguments);case Keys.C:if(a.ctrlKey)return e.apply(this,arguments);case Keys.X:if(a.ctrlKey)return f.apply(this,arguments);case Keys.V:if(a.ctrlKey)return g.apply(this,arguments)}}},click:function(a){if(a.target.className=="RichInputBox"){var b=a.richInputBox;b.getSelectedItems().length>0||(a=RichInputBox.Tool.getNearlyElement({richInputBox:b,x:a.clientX,y:a.clientY}))&&b.moveTextBoxTo(a.element,a.isAfter)}},
mousedown:function(a){var b=a.richInputBox,c=a.target;if(c.parentNode&&c.parentNode.className.indexOf("addrItem")!=-1)c=c.parentNode;b.startPosition={x:a.clientX,y:a.clientY};if(c.className.indexOf("addrItem")!=-1)RichInputBox.Tool.dragEnable=!0,a=c.getAttribute("rel"),a=b.items[a],c=b.getSelectedItems(),jQuery.inArray(a,c)==-1&&c.push(a),RichInputBox.Tool.dragItems=c;else if(c==b.container||c.tagName=="INPUT"&&c.value=="")b.unselectAllItems(),b.createItemFromTextBox(),b.moveTextBoxToLast(),b.selectArea=
!0;else{RichInputBox.Tool.dragEnable=!1;b.selectArea=!1;return}jQuery.browser.msie?(RichInputBox.Events.captureElement=this,this.setCapture()):window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);RichInputBox.Events.currentRichInputBox=b},contextmenu:function(){}},TextBox:{keyup:RichInputBox.Tool.fixTextBoxWidth,paste:function(){RichInputBox.Tool.fixTextBoxWidth.call(this);if(window.navigator.userAgent.indexOf("Firefox")>=0){var a=this;setTimeout(function(){var b=a.value;a.value="";a.value=b},0)}},
cut:RichInputBox.Tool.fixTextBoxWidth,focus:function(a){a&&a.richInputBox&&a.richInputBox.clearTipText();_LastFocusAddressBox=a.richInputBox},blur:function(a){a=a.richInputBox;this.getAttribute("dblclicking")=="1"?this.setAttribute("dblclicking",null):(a.createItemFromTextBox(),a.getItems()==0&&a.tipText&&a.setTipText(a.tipText),a.evt&&typeof a.evt.blurFunc=="function"&&a.evt.blurFunc(a))},keydown:function(a){function b(){if(this.value==""&&!(j.getSelectedItems().length>0)){var a=j.getTextBoxPrevItem();
a&&a.remove();this.focus()}}function c(){if(this.value==""){var a=j.getTextBoxNextItem();a&&a.remove();this.focus()}}function d(){this.value.trim()!=""&&setTimeout(function(){j.createItemFromTextBox()},0);return!1}function e(){if(this.value==""){var a=j.getTextBoxPrevItem();if(a)return j.jTextBox.insertBefore(a.element),j.jTextBox.focus(),j.textbox.createTextRange&&j.textbox.createTextRange().select(),!1}}function f(){if(this.value==""){var a=j.getTextBoxNextItem();if(a)return j.jTextBox.insertAfter(a.element),
j.jTextBox.focus(),j.textbox.createTextRange&&j.textbox.createTextRange().select(),!1}}function g(a){if(this.value==""){var b=j.jTextBox.offset();(a=RichInputBox.Tool.getNearlyElement({x:b.left,y:b.top+(a.isUp?-5:j.jContainer.find("div").eq(0).outerHeight(!0)),richInputBox:j}))&&j.moveTextBoxTo(a.element,a.isAfter);return!1}}function h(){this.setAttribute("TabPress","1");var a=this;setTimeout(function(){a.setAttribute("TabPress",null)},0)}RichInputBox.Tool.fixTextBoxWidth.call(this);if(!a.shiftKey&&
!a.ctrlKey){var j=a.richInputBox;switch(a.keyCode){case Keys.Backspace:return b.apply(this,arguments);case Keys.Delete:return c.apply(this,arguments);case Keys.Semicolon:case Keys.Comma:case Keys.Enter:return d.apply(this,arguments);case Keys.Left:return e.apply(this,arguments);case Keys.Right:return f.apply(this,arguments);case Keys.Up:case Keys.Down:return a.isUp=a.keyCode==Keys.Up,g.apply(this,arguments);case Keys.Tab:return h.apply(this,arguments)}}}},Items:{dblclick:function(a){var b=a.richInputBox,
a=b.items[this.getAttribute("rel")];a.element.replaceWith(b.jTextBox);a.remove();b.textbox.value=a.allText+";";RichInputBox.Tool.fixTextBoxWidth.call(b.textbox);b.textbox.setAttribute("dblclicking","1");Utils.focusTextBox(b.textbox);setTimeout(function(){b.textbox.setAttribute("dblclicking",null)},0)},mousedown:function(a){var b=a.richInputBox;if(!a.shiftKey&&!a.ctrlKey){a=b.items[this.getAttribute("rel")];if(!a.selected)for(var b=b.getSelectedItems(),c=0;c<b.length;c++)b[c].unselect();a.select()}},
click:function(a){function b(a){if(c.lastClickItem&&c.lastClickItem!=a){var b=c.getItems(),d=jQuery.inArray(c.lastClickItem,b),a=jQuery.inArray(a,b),h=Math.min(d,a),j=Math.max(d,a);jQuery(b).each(function(a){a>=h&&a<=j?this.select():this.unselect()})}}this.focus();var c=a.richInputBox,d=c.items[this.getAttribute("rel")];!a.shiftKey&&!a.ctrlKey?(c.unselectAllItems(),d.select()):a.shiftKey?b(d):a.ctrlKey&&(d.selected?d.unselect():d.select());c.lastClickItem=d},mouseover:function(){this.removeClassTimer&&
clearTimeout(this.removeClassTimer);jQuery(this).addClass("mouseover")},mouseout:function(){var a=jQuery(this);this.removeClassTimer=setTimeout(function(){a.removeClass("mouseover")},0)}}};RichInputBox.Plugin={AutoComplete:function(a){AutoCompleteMenu.createAddrMenu(a.textbox,1)},AutoCompleteMobile:function(a){AutoCompleteMenu.createPhoneNumberMenuFromLinkManList(a.textbox,!0)},getDefaultPlugin:function(){return[]}};var RTB_items={},RTB_length=1;
function RichTextBox(){this.initiliaze.apply(this,arguments)}
(function(){RichTextBox.prototype={initiliaze:function(a){a=a||{};this.id=a.id+""||RTB_length;this.initilized=!1;RTB_items[this.id]=this;RTB_length++},init:function(a){var b=this;if(!this.initilized){this.menu=null;this.isHtml=!0;this.savedBookmark=null;try{var c=jQuery("#htmlEditor"+this.id)[0],d=c.contentWindow,e=d.document,f=e.body;this.ifmElement=c;this.win=d;this.doc=e;this.body=f;this.$=function(a){return b.doc.getElementById(a)}}catch(g){}if(this.ifmElement&&this.win&&this.doc&&this.body){this.initilized=
!0;if(this.ifmElement.style.display!="none"&&(document.addEventListener?this.doc.addEventListener("click",function(){b.hideMenu()},!0):document.attachEvent&&this.doc.attachEvent("onclick",function(){b.hideMenu()}),top.jQuery(document,this.win).ready(function(){b.active()}),!parent.Browser.isIE))this.doc.designMode="on",this.doc.contentEditable=!0;if(a)typeof a!="object"&&typeof a=="string"&&(a=document.getElementById(a)),a.innerHTML=this.getHtml();if(top.Browser.isIE&&this.doc&&this.ifmElement)parent.EV.observe(this.ifmElement,
"beforedeactivate",function(){b.savedBookmark=b.getBookMark(b.doc)}),parent.EV.observe(this.ifmElement,"activate",function(){if(b.savedBookmark)b.moveToBookMark(b.doc,b.savedBookmark),b.savedBookmark=null}),parent.GE.compatIETag=function(a){if(a.keyCode==13&&b.getEditorMode()&&(a=b.getEditorValue(),a==""||/^<p>/i.test(a)))if(a=="")b.setEditorValue("<div></div>");else{b.setEditorValue(a.replace(/<p>&nbsp;<\/p>/img,"<div></div>").replace(/<p>(.*?)<\/p>/img,"<div>$1</div>"));try{b.moveRange(-1),b.moveRange(2)}catch(c){}}},
parent.EV.observe(b.doc,"keyup",parent.GE.compatIETag)}else this.initilized=!1,b.init()}},showMenu:function(a){this.getEditorMode()?(a=document.getElementById(a),this.hideMenu(),a.style.display="block",this.menu=a,a=parent.EV.getEvent()||event,parent.EV.stopEvent(a)):this.menu=null},hideMenu:function(){var a=this.menu;if(a)a.style.display="none"},active:function(){jQuery("#txtAdvSearch",top.document).focus().blur()},doMenu:function(a,b){var c=this,d=!0;if(this.getEditorMode()){this.win.focus();switch(a.toLowerCase()){case "insertimage":if(top.Browser.isIE&&
top.Browser.ie!=9){var d="<img crs='{0}' src='{0}' />".format(b),e=c.getSelection(c.win),f=c.getRangeObj(e);if(e.type.toLowerCase()=="control")f.item(0).outerHTML=d;else try{f.pasteHTML(d)}catch(g){c.body.innerHTML=d+c.body.innerHTML}top.jQuery("img[crs='{0}']".format(b),c.doc).each(function(){this.src=b;top.jQuery(this,c.doc).removeAttr("crs")});d=!1}else d=!0;break;default:d=!0}d&&(b?c.doc.execCommand(a,!1,b):parent.Browser.isIE?c.doc.execCommand(a):c.doc.execCommand(a,!1,!1));this.hideMenu()}else this.menu=
null},initFrameContent:function(){if(this.doc&&this.doc.body)this.doc.body.innerHTML="<div></div>"},showPortrait:function(){if(this.getEditorMode()){this.hideMenu();this.menu=document.getElementById("divPortrait"+this.id);var a=document.getElementById("divPortrait"+this.id);a.style.display="block";if(a.innerHTML==""){var b=parent.gConst.portraitUrl;a.innerHTML="<iframe id='frmPortrait"+this.id+"' border='0' marginWidth=0 marginHeight=0 frameBorder=no style='width:208px;height:202px' src='#'></iframe>";
document.getElementById("frmPortrait"+this.id).src=b+"&id="+this.id}(a=parent.EV.getEvent()||event)&&parent.EV.stopEvent(a)}else this.menu=null},getEditorMode:function(){return this.isHtml},getHtmlToTextContent:function(){var a=this.doc.getElementsByTagName("BODY")[0],b="";if(parent.Browser.isIE)b=a.innerText;else if(a=a.innerHTML,a=a.replace(/<script(?:.*?)>.*?<\/script>/g,""),a=a.replace(/<style(?:.*?)>.*?<\/style>/g,""),a==""||a=="<br>"||a=="<br/>")return"";else a=a.replace(/<br\s?\/?>/ig,"\n"),
b=document.createElement("div"),b.innerHTML=a,b=b.textContent;return b},setEditorValue:function(a){if(this.getEditorMode())this.body.innerHTML=a.replace(/\n/g,"")},getEditorValue:function(){var a=this.body;return this.getEditorMode()?a.innerHTML.replace(/\n+(<br>)*$/,""):""},disable:function(){var a=parent.jQuery("#editor_layer_"+this.id),b=parent.El.getSize(parent.jQuery("#editor_body"+this.id)[0]);a&&a.length?a.css({height:b.height+"px"}).show():(parent.jQuery("#editor_body"+this.id).append('<div id="editor_layer_'+
this.id+'"></div>'),parent.jQuery("#editor_layer_"+this.id).addClass("cover-layer").css({position:"absolute",width:"100%",height:b.height+"px",top:0}).show())},enable:function(){var a=parent.jQuery("#editor_layer_"+this.id);a&&a.length&&a.hide()},getBookMark:function(a){var b=a.selection.createRange(),a=a.body.innerHTML.length,c={};if(b.getBookmark)c.bookmark=b.getBookmark(),c.startOffset=b.moveStart("character",-a),c.endOffset=b.moveEnd("character",a);return c},moveToBookMark:function(a,b){if(b&&
b.bookmark){var c=a.body.createTextRange(),d=a.body.innerHTML.length;c.moveToBookmark(b.bookmark);var e=c.duplicate(),f=e.moveStart("character",-d),d=e.moveEnd("character",d);if(f!=b.startOffset||d!=b.endOffset)c.moveStart("character",f-b.startOffset),c.moveEnd("character",d-b.endOffset);try{c.select()}catch(g){}}},getRangeObj:function(a){if(a.createRange)return a.createRange();else if(a.getRangeAt)return a.getRangeAt(0);else if(this.doc.createRange){var b=this.doc.createRange();b.setStart(a.anchorNode,
a.anchorOffset);b.setEnd(a.focusNode,a.focusOffset);return b}},getSelection:function(a){var a=a||window,b;if(a.getSelection)b=a.getSelection();else if(a.document.selection)b=a.document.selection;return b},moveRange:function(a){var b=this.getRangeObj(this.getSelection(this.win));b.moveStart("character",a);b.moveEnd("character",a);b.select()},setIfrmTabIndex:function(a){this.ifrm_tabIndex=a},setIfrmStyle:function(a){var b="";if(typeof a=="object")for(var c in a)c&&c[a]&&(b+=c+":"+a[c]+";");else typeof a==
"string"&&(b=a);this.ifrm_style=b},getHtml:function(){var a=[],b="",c="";if(this.ifrm_tabIndex)c=this.ifrm_tabIndex;this.ifrm_style&&(b=this.ifrm_style+"width:100%;");c!=""&&(c='tabIndex="'+c+'"');a.push("<div id='editor__"+this.id+'\' class="edi_container">');a.push('<div id="editor_body'+this.id+'" class="eidt-body">');a.push('<div id="editorToolbar'+this.id+'" class="eidt-bar">');a.push('<div id="editor_tool_bar_up'+this.id+'" class="eidt-bar-li"> <a href="javascript:fGoto();" onclick="RTB_items[\''+
this.id+'\'].doMenu(\'Bold\');" class="edit-btn" title="\u52a0\u7c97">');a.push("<\!-- \u9009 \u4e2d \u52a0\u4e0a  edit-btn-on --\>");a.push('<span class="edit-btn-rc"> <b class="ico-edit ico-edit-b">');a.push("\u52a0\u7c97");a.push('</b> </span> </a> <span class="line"></span> <a class="edit-btn editor-btn-select" href="javascript:fGoto();" onclick="RTB_items[\''+this.id+"'].showMenu('fontFamily"+this.id+'\');" title="\u5b57\u4f53"> <span class="edit-btn-rc">');a.push("\u5b57\u4f53");a.push('</span> </a> <a class="edit-btn editor-btn-select" href="javascript:fGoto();" onclick="RTB_items[\''+
this.id+"'].showMenu('fontSize"+this.id+'\');" title="\u5b57\u53f7">');a.push('<span class="edit-btn-rc">');a.push("\u5b57\u53f7");a.push('</span> </a> <span class="line"></span> <a href="javascript:fGoto();" class="edit-btn" title="\u5b57\u4f53\u989c\u8272" onclick="RTB_items[\''+this.id+"'].showMenu('fontColorSelect"+this.id+'\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-color">');a.push("\u5b57\u4f53\u989c\u8272");a.push('</b> </span> </a> <a href="javascript:fGoto();" class="edit-btn" title="\u80cc\u666f\u8272" onclick="RTB_items[\''+
this.id+"'].showMenu('bgColorSelect"+this.id+'\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-fb">');a.push("\u80cc\u666f\u8272");a.push('</b> </span> </a> <span class="line"></span> ');a.push('<span id="spanEditor'+this.id+'"> <a href="javascript:fGoto();" class="edit-btn" title="\u659c\u4f53" onclick="RTB_items[\''+this.id+'\'].doMenu(\'Italic\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-i">');a.push("\u659c\u4f53");a.push('</b> </span> </a> <a href="javascript:fGoto();" class="edit-btn" title="\u4e0b\u5212\u7ebf" onclick="RTB_items[\''+
this.id+'\'].doMenu(\'Underline\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-ud">');a.push("\u4e0b\u5212\u7ebf");a.push('</b> </span> </a> <span class="line"></span> <a href="javascript:fGoto();" class="edit-btn" title="\u5de6\u5bf9\u9f50" onclick="RTB_items[\''+this.id+'\'].doMenu(\'Justifyleft\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-alil">');a.push("\u5de6\u5bf9\u9f50");a.push('</b> </span> </a> <a href="javascript:fGoto();" class="edit-btn" title="\u5c45\u4e2d\u5bf9\u9f50" onclick="RTB_items[\''+
this.id+'\'].doMenu(\'Justifycenter\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-aliz">');a.push("\u5c45\u4e2d\u5bf9\u9f50");a.push('</b> </span> </a> <a href="javascript:fGoto();" class="edit-btn" title="\u53f3\u5bf9\u9f50" onclick="RTB_items[\''+this.id+'\'].doMenu(\'Justifyright\');"> <span class="edit-btn-rc"> <b class="ico-edit ico-edit-alir">');a.push("\u53f3\u5bf9\u9f50");a.push("</b> </span> </a></div>");a.push("</div>");a.push("<\!----\u7f16\u8f91\u5668\u5b50\u83dc\u5355-----\>");
a.push('<div id="fontFamily'+this.id+'" class="pop_wrapper w178 font_Family" style="display:none;">');a.push('<ul class="fontType popList-style">');a.push('<li><a style="font-family: \'\u5b8b\u4f53\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','\u5b8b\u4f53');\"><i></i>\u5b8b\u4f53</a></li>");a.push('<li><a style="font-family: \'\u9ed1\u4f53\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+
this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','\u9ed1\u4f53');\"><i></i>\u9ed1\u4f53</a></li>");a.push('<li><a style="font-family: \'\u6977\u4f53\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','\u6977\u4f53');\"><i></i>\u6977\u4f53</a></li>");a.push('<li><a style="font-family: \'\u96b6\u4e66\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+
this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','\u96b6\u4e66');\"><i></i>\u96b6\u4e66</a></li>");a.push('<li><a style="font-family: \'\u5e7c\u5706\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','\u5e7c\u5706');\"><i></i>\u5e7c\u5706</a></li>");a.push('<li><a style="font-family: \'Arial\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+
this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Arial');\"><i></i>Arial</a></li>");a.push('<li><a style="font-family: \'Arial Black\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Arial Black');\"><i></i>Arial Black</a></li>");a.push('<li><a style="font-family: \'Arial Narrow\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+
this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Verdana');\"><i></i>Arial Narrow</a></li>");a.push('<li><a style="font-family: \'Times New Roman\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Times New Roman');\"><i></i>Times New Roman</a></li>");a.push('<li><a style="font-family: \'Verdana\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+
this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Verdana');\"><i></i>Verdana</a></li>");a.push('<li><a style="font-family: \'Comic Sans MS\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current');jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Verdana');\"><i></i>Comic Sans MS</a></li>");a.push('<li><a style="font-family: \'Courier\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+
this.id+" a').removeClass('current');jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Verdana');\"><i></i>Courier</a></li>");a.push('<li><a style="font-family: \'System\';" href="javascript:fGoto();" onclick="jQuery(\'#fontFamily'+this.id+" a').removeClass('current');jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontname','Verdana');\"><i></i>System</a></li>");a.push("</ul>");a.push("</div>");a.push('<div id="fontSize'+this.id+'" class="pop_wrapper w175 font_Size" style="display:none;">');
a.push('<ul class="popList-style fontSize">');a.push('<li><a href="javascript:fGoto();" onclick="jQuery(\'#fontSize'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontsize',3);\" style=\"font-size:small\"><i></i>");a.push("<span>\u7279\u5c0f</span>");a.push("</a></li>");a.push('<li><a href="javascript:fGoto();" onclick="jQuery(\'#fontSize'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontsize',4);\" style=\"font-size:medium\"><i></i>");
a.push("<span>\u4e2d</span>");a.push("</a></li>");a.push('<li><a href="javascript:fGoto();" onclick="jQuery(\'#fontSize'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontsize',5);\" style=\"font-size:larger\"><i></i>");a.push("<span>\u5927</span>");a.push("</a></li>");a.push('<li><a href="javascript:fGoto();" onclick="jQuery(\'#fontSize'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontsize',6);\" style=\"font-size:large\"><i></i>");
a.push("<span>\u8f83\u5927</span>");a.push("</a></li>");a.push('<li><a href="javascript:fGoto();" onclick="jQuery(\'#fontSize'+this.id+" a').removeClass('current'); jQuery(this).addClass('current');RTB_items['"+this.id+"'].doMenu('fontsize',7);\" style=\"font-size:x-large\"><i></i>");a.push("<span>\u5f88\u5927</span>");a.push("</a></li>");a.push("</ul>");a.push("</div>");a.push('<div id="bgColorSelect'+this.id+'" class="menuPop shadow font-colorpop bg_ColorSelect" style="display:none;">');a.push('<div class="fontcolor-list m_clearfix"> <a href="javascript:fGoto();" onclick="RTB_items[\''+
this.id+"'].doMenu('backcolor','#000000');\"><span style=\"background-color: rgb(0, 0, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#993300');\"><span style=\"background-color: rgb(153, 51, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#333300');\"><span style=\"background-color: rgb(51, 51, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#003300');\"><span style=\"background-color: rgb(0, 51, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#003366');\"><span style=\"background-color: rgb(0, 51, 102);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#000080');\"><span style=\"background-color: rgb(0, 0, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#333399');\"><span style=\"background-color: rgb(51, 51, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#333333');\"><span style=\"background-color: rgb(51, 51, 51);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#800000');\"><span style=\"background-color: rgb(128, 0, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FF6600');\"><span style=\"background-color: rgb(255, 102, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#808000');\"><span style=\"background-color: rgb(128, 128, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#008000');\"><span style=\"background-color: rgb(0, 128, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#008080');\"><span style=\"background-color: rgb(0, 128, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#0000FF');\"><span style=\"background-color: rgb(0, 0, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#666699');\"><span style=\"background-color: rgb(102, 102, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#808080');\"><span style=\"background-color: rgb(128, 128, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#FF0000');\"><span style=\"background-color: rgb(255, 0, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FF9900');\"><span style=\"background-color: rgb(255, 153, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#99CC00');\"><span style=\"background-color: rgb(153, 204, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#339966');\"><span style=\"background-color: rgb(51, 153, 102);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#33CCCC');\"><span style=\"background-color: rgb(51, 204, 204);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#3366FF');\"><span style=\"background-color: rgb(51, 102, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#800080');\"><span style=\"background-color: rgb(128, 0, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+
"'].doMenu('backcolor','#999999');\"><span style=\"background-color: rgb(153, 153, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FF00FF');\"><span style=\"background-color: rgb(255, 0, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FFCC00');\"><span style=\"background-color: rgb(255, 204, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FFFF00');\"><span style=\"background-color: rgb(255, 255, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#00FF00');\"><span style=\"background-color: rgb(0, 255, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#00FFFF');\"><span style=\"background-color: rgb(0, 255, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#00CCFF');\"><span style=\"background-color: rgb(0, 204, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#993366');\"><span style=\"background-color: rgb(153, 51, 102);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#C0C0C0');\"><span style=\"background-color: rgb(192, 192, 192);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FF99CC');\"><span style=\"background-color: rgb(255, 153, 204);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FFCC99');\"><span style=\"background-color: rgb(255, 204, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+
"'].doMenu('backcolor','#FFFF99');\"><span style=\"background-color: rgb(255, 255, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#CCFFCC');\"><span style=\"background-color: rgb(204, 255, 204);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#CCFFFF');\"><span style=\"background-color: rgb(204, 255, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#99CCFF');\"><span style=\"background-color: rgb(153, 204, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('backcolor','#CC99FF');\"><span style=\"background-color: rgb(204, 153, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('backcolor','#FFFFFF');\"><span style=\"background-color: rgb(255, 255, 255);\"></span></a> </div>");a.push("</div>");a.push('<div id="fontColorSelect'+this.id+'" class="menuPop shadow font-colorpop font_ColorSelect" style="display:none;">');a.push('<div class="fontcolor-list m_clearfix"> <a href="javascript:fGoto();" onclick="RTB_items[\''+
this.id+"'].doMenu('forecolor','#000000');\"><span style=\"background-color: rgb(0, 0, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#993300');\"><span style=\"background-color: rgb(153, 51, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#333300');\"><span style=\"background-color: rgb(51, 51, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#003300');\"><span style=\"background-color: rgb(0, 51, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#003366');\"><span style=\"background-color: rgb(0, 51, 102);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#000080');\"><span style=\"background-color: rgb(0, 0, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#333399');\"><span style=\"background-color: rgb(51, 51, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#333333');\"><span style=\"background-color: rgb(51, 51, 51);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#800000');\"><span style=\"background-color: rgb(128, 0, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FF6600');\"><span style=\"background-color: rgb(255, 102, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#808000');\"><span style=\"background-color: rgb(128, 128, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#008000');\"><span style=\"background-color: rgb(0, 128, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#008080');\"><span style=\"background-color: rgb(0, 128, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#0000FF');\"><span style=\"background-color: rgb(0, 0, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#666699');\"><span style=\"background-color: rgb(102, 102, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#808080');\"><span style=\"background-color: rgb(128, 128, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#FF0000');\"><span style=\"background-color: rgb(255, 0, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FF9900');\"><span style=\"background-color: rgb(255, 153, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#99CC00');\"><span style=\"background-color: rgb(153, 204, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#339966');\"><span style=\"background-color: rgb(51, 153, 102);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#33CCCC');\"><span style=\"background-color: rgb(51, 204, 204);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#3366FF');\"><span style=\"background-color: rgb(51, 102, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#800080');\"><span style=\"background-color: rgb(128, 0, 128);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+
"'].doMenu('forecolor','#999999');\"><span style=\"background-color: rgb(153, 153, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FF00FF');\"><span style=\"background-color: rgb(255, 0, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FFCC00');\"><span style=\"background-color: rgb(255, 204, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FFFF00');\"><span style=\"background-color: rgb(255, 255, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#00FF00');\"><span style=\"background-color: rgb(0, 255, 0);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#00FFFF');\"><span style=\"background-color: rgb(0, 255, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#00CCFF');\"><span style=\"background-color: rgb(0, 204, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#993366');\"><span style=\"background-color: rgb(153, 51, 102);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#C0C0C0');\"><span style=\"background-color: rgb(192, 192, 192);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FF99CC');\"><span style=\"background-color: rgb(255, 153, 204);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FFCC99');\"><span style=\"background-color: rgb(255, 204, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+
"'].doMenu('forecolor','#FFFF99');\"><span style=\"background-color: rgb(255, 255, 153);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#CCFFCC');\"><span style=\"background-color: rgb(204, 255, 204);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#CCFFFF');\"><span style=\"background-color: rgb(204, 255, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#99CCFF');\"><span style=\"background-color: rgb(153, 204, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+
this.id+"'].doMenu('forecolor','#CC99FF');\"><span style=\"background-color: rgb(204, 153, 255);\"></span></a> <a href=\"javascript:fGoto();\" onclick=\"RTB_items['"+this.id+"'].doMenu('forecolor','#FFFFFF');\"><span style=\"background-color: rgb(255, 255, 255);\"></span></a> </div>");a.push("</div>");a.push('<div id="divPortrait'+this.id+'" class="fontSelect div_Portrait"></div>');a.push('<div id="divImage'+this.id+'" class="fontSelect div_Image"></div>');a.push("<\!----\u7f16\u8f91\u5668\u5b50\u83dc\u5355\u7ed3\u675f-----\>");
a.push('<div class="eidt-content">');a.push('<iframe tabindex="8" hidefocus="1" id="htmlEditor'+this.id+'" name="htmlEditor'+this.id+'" frameborder="0" src=\''+top.gMain.webPath+'/static/se/mail/editor.htm\' marginHeight="0" marginWidth="0" width="100%" style="'+b+'" '+c+"></iframe>");a.push('<textarea id="sourceEditor'+this.id+'" name="sourceEditor'+this.id+'" class="eidt-textarea"style="height:100%;width:100%;display:none;border:0px;white-space: pre-wrap;white-space: -moz-pre-wrap;white-space: -pre-wrap;white-space: -o-pre-wrap;word-wrap: break-word;"></textarea>');
a.push("</div>");a.push('<a href="javascript:void(0)" class="stationery"></a> </div>');a.push("</div>");return a.join("")}}})();RTB_items.init=function(){for(var a in RTB_items)RTB_items[a]instanceof RichTextBox&&RTB_items[a].initilized!==!0&&RTB_items[a].init()};function Tips_Message(a,b,c,d,e){this.title=c;this.width=a?a:200;this.height=b?b:120;this.speed=e;this.timer=0;this.autoHide=!0;this.HideTime=6E3;this.innerHTML=d}
Tips_Message.prototype.hidden=function(){var a=this;this.timer=setInterval(function(){var b=parseInt(document.getElementById("tip").style.height);parseInt(b)<=0?(document.getElementById("tip").style.display="none",clearInterval(a.timer)):document.getElementById("tip").style.height=parseInt(b)-5+"px"},this.speed)};
Tips_Message.prototype.show=function(){document.getElementById("tip");var a=this.height+24,b="<DIV id ='tip' style='border:solid 1px #000000;overflow:hidden;display:none  Z-INDEX: 99999;width: "+this.width+"px;height:0px;  POSITION: absolute;right: 0px;bottom: 0px; '>";b+="<TABLE style='BORDER-TOP: #ffffff 1px solid; BORDER-LEFT: #ffffff 1px solid' cellSpacing=0 cellPadding=0 width='100%' border=0>";b+="<TR>";b+="<TD style='FONT-SIZE: 12px; width=30 height=24></TD>";b+="<TD style='PADDING-LEFT: 4px; FONT-WEIGHT: normal; FONT-SIZE: 12px; PADDING-TOP: 4px' vAlign=center width='100%'>"+
this.title+"</TD><TD style='PADDING-RIGHT: 2px; PADDING-TOP: 2px' vAlign=center align=right width=19>";b+="<SPAN title=\ufffd\u0631\ufffd style='FONT-WEIGHT: bold; FONT-SIZE: 20px; CURSOR: hand; COLOR: red; MARGIN-RIGHT: 4px' id='btSysClose' >\ufffd\ufffd</SPAN></TD>";b+="</TR>";b+="<tr><td colspan='3'>";b+=this.innerHTML;b+="</td></tr></table>";b+="</DIV>";document.write(b);var c=this;this.timer=setInterval(function(){var b=parseInt(document.getElementById("tip").style.height);parseInt(b)>=a?clearInterval(c.timer):
document.getElementById("tip").style.height=parseInt(b)+5+"px"},this.speed);document.getElementById("btSysClose").onclick=function(){c.hidden()};c.autoHide&&setTimeout(function(){c.hidden()},c.HideTime)};function ToolTips(){this.init.apply(this,arguments)}ToolTips.type={Default:1,Confirm:2,Drag:3,Close:4};ToolTips.direction={Top:"Top",Right:"Right",Bottom:"Bottom",Left:"Left"};
ToolTips.prototype={init:function(a){this.id=a.id||"tips";this.inputId=a.inputId||"";this.win=a.win||window;this.type=a.type||ToolTips.type.Default;this.direction=a.direction||ToolTips.direction.Top;this.closeTime=a.closeTime||5;this.containerId=this.id+"_container";this.headerId=this.id+"_header";this.contentId=this.id+"_content";this.buttonsId=this.id+"_buttons";this.okId=this.buttonsId+"_ok";this.cancelId=this.buttonsId+"_cancel";this.containerLeft=a.left;this.containerTop=a.top;this.okHandler=
a.ok||function(){};this.cancelHandler=a.cancel||function(){};this.afterInput=a.afterInput||!1},initEvents:function(){var a=this;this.type==ToolTips.type.Default&&setTimeout(function(){a.close()},a.closeTime*1E3);this.type==ToolTips.type.Confirm&&(parent.EV.observe(jQuery("#"+this.okId)[0],"click",function(){a.okHandler();a.close()},!1),parent.EV.observe(jQuery("#"+this.cancelId)[0],"click",function(){a.cancelHandler();a.close()},!1))},getHtml:function(a){var b=[];b.push('<div class="tips-text">');
this.type==ToolTips.type.Close&&b.push('<div id="'+this.headerId+'"></div>');b.push('<div id="'+this.contentId+'">'+a+"</div>");this.type==ToolTips.type.Confirm&&(b.push('<p id="'+this.buttonsId+'" style="text-align:center; padding-bottom: 5px;">'),b.push('<a id="'+this.okId+'" href="javascript:fGoto()" class="btnNormal vm mt_5"><span>'+Lang.Mail.Ok+"</span></a>"),b.push('<a id="'+this.cancelId+'" href="javascript:fGoto()" class="btnNormal vm mt_5 ml_5"><span>'+Lang.Mail.Cancel+"</span></a>"),b.push("</p>"));
b.push("</div>");b.push('<div class="tips'+this.getDirectionClass(this.direction)+' diamond"></div>');return b.join("")},getDirectionClass:function(a){switch(a){case ToolTips.direction.Top:return"Bottom";case ToolTips.direction.Right:return"Left";case ToolTips.direction.Bottom:return"Top";case ToolTips.direction.Left:return"Right"}return a},show:function(a,b){var c=this.getHtml(b);if(a){var d=jQuery("#"+this.containerId)[0];if(!d){var e=this.win.document,d=parent.El.createElement("div",this.containerId,
"tips write-tips",e);this.afterInput?(jQuery(d).css({display:"inline",marginLeft:"8px",marginTop:"0",position:""}),jQuery("#"+this.inputId).after(d)):e.body.appendChild(d)}d.innerHTML=c;parent.El.insertElement(a,d,"afterEnd");if(this.afterInput)this.initEvents();else{var e=parent.El.getSize(d),f=parent.El.getSize(a);switch(this.direction){case ToolTips.direction.Top:c=this.containerLeft?this.containerLeft+"px":"0px";e=this.containerTop?this.containerTop+"px":-(e.height+4)+"px";parent.El.setStyle(d,
{top:e,left:c});break;case ToolTips.direction.Bottom:c=this.containerLeft?this.containerLeft+"px":"0px";e=this.containerTop?this.containerTop+"px":f.height+4+"px";parent.El.setStyle(d,{top:e,left:c});break;case ToolTips.direction.Left:c=this.containerLeft?this.containerLeft+"px":-(f.width+4)+"px";e=this.containerTop?this.containerTop+"px":-((e.height-f.height)/2)+"px";parent.El.setStyle(d,{top:e,left:c});break;case ToolTips.direction.Right:c=this.containerLeft?this.containerLeft+"px":f.width+4+"px",
e=this.containerTop?this.containerTop+"px":-((e.height-f.height)/2)+"px",parent.El.setStyle(d,{top:e,left:c})}parent.El.show(d);this.initEvents();try{a.focus()}catch(g){}}}},close:function(){var a=jQuery("#"+this.containerId,this.win.document);a&&a[0]&&a.remove()}};
var VdPassWord=function(a){var b=jQuery,c="",d="",e="";if(typeof gMain!="undefined"){if(typeof gMain.userNumber!="undefined")c=gMain.userNumber,d=c.substring(0,c.indexOf("@"));if(typeof gMain.trueName!="undefined")e=gMain.trueName}else gMain="";this.pwd=b("#"+a.pwdId);this.NotContains=a.NotContains||{Account:c,Mobile:d,Alias:e};this.pwdMinLen=a.pwdMinLen||(gMain&&gMain.pwdMinLen?gMain.pwdMinLen:6);this.pwdMaxLen=a.pwdMaxLen||(gMain&&gMain.pwdMaxLen?gMain.pwdMaxLen:20);this.showSec=a.showSec;this.sLevel=
(a.sLevel>3?3:a.sLevel)||0;this.position=a.position||"Bottom";this.init()};VdPassWord.pos={Right:"Right",Bottom:"Bottom"};VdPassWord.prototype.init=function(){this.NotifyCode=1;this.msg=Lang.Mail.Config.PwdNew01;this.SafeLevel=0;this.createTipDiv();this.evKeyUp();this.evBlur()};VdPassWord.prototype.evBlur=function(){this.pwd.blur(function(){})};VdPassWord.prototype.evKeyUp=function(){var a=this;this.pwd.keyup(function(b){EV.getCharCode(b)!=13&&a.securityTips()})};
VdPassWord.prototype.PwdCheck=function(a,b){function c(b,c){if(b!=0){var d=a,f,g,h;h=g=f=!1;for(var j=d.toLowerCase(),k="",n=0;n<j.length;n++)if(k=j.substr(n,1),"0123456789".indexOf(k)!=-1){f=!0;break}for(n=0;n<j.length;n++)if(k=j.substr(n,1),"abcdefghijklmnopqrstuvwxyz".indexOf(k)!=-1){g=!0;break}for(n=0;n<j.length;n++)if(k=j.substr(n,1),"~!@#$%^&*()_+{}[]:\"|<>?,./;'\\".indexOf(k)!=-1){h=!0;break}b=d.length<parseInt(e.pwdMinLen)?0:!f&&!h?1:!f&&!g?1:f&&g&&!h?2:f&&!g&&h?2:!f&&g&&h?2:3}e.SafeLevel=
b;e.NotifyCode=c;d=b;switch(c){case 1:e.msg=Lang.Mail.Config.PwdNew01;break;case 2:e.msg=Lang.Mail.ConfigJs.simpleTip;break;case 3:e.msg=Lang.Mail.Config.PwdNew03;break;case 4:e.msg=Lang.Mail.ConfigJs.simpleTip;break;case 5:e.msg=Lang.Mail.Config.PwdNew05;break;case 6:e.msg=Lang.Mail.Config.PwdNew06;break;case 7:e.msg=Lang.Mail.ConfigJs.simpleTip;break;case 8:e.msg=Lang.Mail.ConfigJs.simpleTip;break;case 9:e.msg=Lang.Mail.ConfigJs.pwdLimit.format(e.pwdMinLen,e.pwdMaxLen)}if(c==0&&d<e.sLevel){d="";
switch(e.sLevel){case 1:e.msg="\u5bc6\u7801\u4e0d\u5b89\u5168";break;case 2:e.msg="\u5bc6\u7801\u5f3a\u5ea6\u4e0d\u80fd\u4e3a\u5f31";break;case 3:d=Lang.Mail.ConfigJs.safety,e.msg=Lang.Mail.ConfigJs.qdMust+d}e.NotifyCode=10}else if(c==0)e.NotifyCode=0,e.msg=Lang.Mail.ConfigJs.vdPass}function d(a){var b;b=a?RegExp("^"+a.charAt(0).replace(/([^a-zA-Z0-9])/,"\\$1")+"+$").test(a):void 0;if(b)return!0;a:{b="abcdefghijklmnopqrstuvwxyz,ABCDEFGHIJKLMNOPQRSTUVWXYZ,0123456789,9876543210,zyxwvutsrqponmlkjihgfedcba,ZYXWVUTSRQPONMLKJIHGFEDCBA".split(",");
for(var c=0;c<b.length;c++)if(b[c].indexOf(a)>=0){a=!0;break a}a=!1}return a?!0:!1}var e=this,b=e.NotContains,a=e.pwd.val(),f="lovely,tigger,123456,12345,123456789,password,iloveyou,princess,rockyou,1234567,12345678,abc123,nicole,daniel,babygirl,monkey,jessica,levely,michael,ashley,654321,qwerty,iloveu,michelle,111111,0,tigger,password1,sunshine,chocolate,anthony,angel,FRIENDS,soccer".split(",");String.prototype.LTrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.RTrim=function(){return this.replace(/(\s*$)/g,
"")};String.prototype.Trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.replaceAll=function(a,b){return this.replace(RegExp(a,"gm"),b)};var g,h;if(a=="")return c(0,1);if(a.length<parseInt(e.pwdMinLen)||a.length>parseInt(e.pwdMaxLen))return a.length<parseInt(e.pwdMinLen)&&(g=0),c(0,9);for(var j=a,n,k=0;k<f.length;k++)if(j=a,n=f[k],j==n)return g=0,h=2,c(g,h);if(b){if(b.Account&&a==b.Account)return c(0,3);if(b.Mobile&&a==b.Mobile)return c(0,3);if(b.Alias&&a==b.Alias)return c(0,
3)}f=!1;b&&b.Account&&!f&&(h=a,h.indexOf(b.Account)!=-1&&(f=!0),h=h.replaceAll(b.Account,""));b&&b.Mobile&&!f&&(h=a,h.indexOf(b.Mobile)!=-1&&(f=!0),h=h.replaceAll(b.Mobile,""));b&&b.Alias&&!f&&(h=a,h.indexOf(b.Alias)!=-1&&(f=!0),h=h.replaceAll(b.Alias,""));return h&&f&&h.length<=3?c(0,4):!/\D/.test(a)?c(0,0):/.*[\u4e00-\u9fa5]+.*$/.test(a)?c(0,6):d(a.substring(1))||d(a.substring(0,a.length-1))?c(0,7):function(a){for(var b=1;b<a.length;b++){var c=a.substring(0,b);if(d(c)){var e=a.substring(b,a.length);
if((/[a1]/.test(c)||/[a1]/.test(e))&&d(e))return!0}}return!1}(a)?c(0,8):c(g,0)};VdPassWord.prototype.showTip=function(){switch(this.position){case VdPassWord.pos.Bottom:this.tipDiv.show();break;case VdPassWord.pos.Right:this.tipDiv.css({display:"inline",zoom:1,position:"absolute",marginLeft:"8px",paddingLeft:0})}};
VdPassWord.prototype.createTipDiv=function(){var c;var a=jQuery,b=[];b.push('<li id="secGrade" class="pl155 pb_15">');b.push('<div class="pw-security">');b.push("<p  id='securityTip'>"+Lang.Mail.ConfigJs.PasswordSecurity);b.push("\uff1a<em id='emText'>"+Lang.Mail.ConfigJs.ordinary+"</em></p>");b.push("<p class='security-line' id='securityTip1'  >");b.push("<span id='password_sp1' class=\"orange-bg\">1</span>");b.push("<span class=\"orange-bg\" id='password_sp2'>2</span>");b.push("<span class=\"grey-bg\" id='password_sp3'>3</span></p>");
b.push("</div></li><\!--pw-security--\>");c=this.tipDiv=a(b.join("")),b=c;switch(this.position){case "Bottom":this.pwd.parent().after(b);break;case "Right":this.pwd.after(b)}this.showSec||a("#secGrade").hide()};
VdPassWord.prototype.securityTips=function(){var a=jQuery,b="";this.PwdCheck();b=this.SafeLevel;this.showTip();switch(b){case 0:case 1:a("#emText").html(Lang.Mail.ConfigJs.week);a("#password_sp1").removeClass().addClass("orange-bg");a("#password_sp2").removeClass().addClass("grey-bg");a("#password_sp3").removeClass().addClass("grey-bg");break;case 2:a("#emText").html(Lang.Mail.ConfigJs.ordinary);a("#password_sp1").removeClass().addClass("orange-bg");a("#password_sp2").removeClass().addClass("orange-bg");
a("#password_sp3").removeClass().addClass("grey-bg");break;case 3:a("#emText").html(Lang.Mail.ConfigJs.safety),a("#password_sp1").removeClass().addClass("orange-bg"),a("#password_sp2").removeClass().addClass("orange-bg"),a("#password_sp3").removeClass().addClass("orange-bg")}};
var P=function(a,b,c){return function e(f,g){function h(){var a=this instanceof h?this:new j;a.init.apply(a,arguments);return a}function j(){}g===c&&(g=f,f=Object);h.Bare=j;var n=j[a]=f[a],k=j[a]=h[a]=h.p=new j,q;k.constructor=h;h.extend=function(a){return e(h,a)};return(h.open=function(a){typeof a==="function"&&(a=a.call(h,k,n,h,f));if(typeof a==="object")for(q in a)b.call(a,q)&&(k[q]=a[q]);if(!("init"in k))k.init=f;return h})(g)}}("prototype",{}.hasOwnProperty);
(function(a,b){if(!(typeof module==="object"&&module.exports)&&!(typeof define==="function"&&define.amd))a.WLogin=b(a.CC,a.jQuery,a)})(this,function(a,b,c){var d=P(function(d){var f=b(this),g={id:"WLogin",model:"MAIL",title:"\u767b\u5f55\u9a8c\u8bc1",width:"424",func:"user:login",webPath:gMain.webPath,href:gMain.returnUrl||"/webmail/login/login.do",mail:gMain.loginName||""},h={};d.go=function(a,b){var d=this.get("href"),b=b||"err_004";a===1&&b?d+="?code="+b:a===2&&(d+="?from=iframe");c.location=d};
d.set=function(a,b){var c,d;if(a==null)return this;typeof a==="object"?d=a:(d={})[a]=b;for(c in d)b=d[c],h[c]=b};d.get=function(a){return h[a]};d.has=function(a){return this.get(a)!=null};d.init=function(a){a=b.extend({},g||{},a);this.set(a)};d.post=function(){var a=d.get("mail").split("@"),c=d.password.val();a&&(d.userid.val(b.trim(a[0])||""),d.domain.val(b.trim(a[1])||""));if(b.trim(c)==="")return d.go(1),!1;d.iform.submit();return!0};d.show=function(c){c=c||a.showDiv;c('                <div class="pop-wrap">                    <div class="msgDialog fz_14">                        <form method="post" action="{webPath}/login/loginapi.do" id="login_form">                            <p>\u60a8\u7684\u90ae\u7bb1\u53ef\u80fd\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u8fdb\u884c\u64cd\u4f5c\uff0c\u5bfc\u81f4\u767b\u5f55\u8d85\u65f6\uff0c\u5df2\u88ab\u9000\u51fa\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55</p>                            <p class="mt_20">\u8d26\u53f7\uff1a{mail}</p>                            <p class="mt_10">\u5bc6\u7801\uff1a                                <input type="password" name="password" class="rm_txt w162" name="titleText" maxlength="15" value="" tabindex="1">                            </p>                            <input type="hidden" name="loginType" value="WEB" />                             <input type="hidden" name="returnurl" value="{href}" />                            <input type="hidden" name="userid" id="userid" />                               <input type="hidden" name="domain" id="domain" value="" />                                      <input type="hidden" name="model" id="model" value="{model}" />                             </form>                    </div>                </div>'.replace(/{([^}]+)}/g,
function(a,b){var c=h[b];return typeof c==="string"?c:""}),this.post,this.get("title"),function(){d.go(2)},this.get("id"),this.get("width"));d.element=b("#divDialogconfirm"+d.get("id"));d.password=b(":password",d.element);d.iform=b("#login_form",d.element);d.userid=b("#userid",d.element);d.domain=b("#domain",d.element);f.trigger("show",d);d.password.focus().select();d.password.on("keypress",function(a){a.keyCode===13&&d.post()});return d};d.on=function(){f.on.apply(f,arguments)};d.trigger=function(){f.trigger.apply(f,
arguments)};d.hide=function(){d.trigger("hide");d.element.hide();a.hideTransparent();f.off();return!0}});d.show=function(a,b){d(b).show(a)};return d});
